---
title             : "English Negative Constructions and Communicative Functions in Early Child Language"
shorttitle        : "Negation and communicative functions"

author: 
  - name        : "Zoey Liu"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    address       : ""
    email         : ""
  - name          : "Masoud Jasbi"
    affiliation   : "2"

affiliation:
  - id            : "1"
    institution   : "Boston College"
  - id            : "2"
    institution   : "UC Davis"

authornote: |
  Add complete departmental affiliations for each author here. Each new line herein must be indented, like this line.

  Enter author note here.

abstract: |
  How does the abstract concept of linguistic negation develop in early child language? Prior research has suggested that abstract negation develops in stages and from more concrete communicative functions such as rejection, prohibition, or non-existence. The evidence for the emergence of these functions in stages is mixed, however, leaving the possibility that negation is an abstract concept since the beginning that can serve multiple specific functions depending on early communicative environment. Leveraging automatic annotations of large-scale child speech corpora in English, we examine the production trajectores of seven negative constructions that tend to convey communicative functions previously discussed in the literature. The results demonstrate the emergence and gradual increase of these constructions in child speech within the age range of 18-36 months. Production mostly remains stable, regular, and close to parents' levels after this age range. These findings are consistent with two hypotheses: first, that negation starts as an abstract concept that can convey multiple functions from the beginning; and second, that negation develops in distinct stages for separate communicative functions but the developmental patterns at different stages are early and quick, leaving our methods incapable of detecting them from the available corpus data.

keywords: >
    negation; syntactic construction; communicative function; development; child language.
    
wordcount         : "X"

bibliography      : ["neg_construction.bib"]

floatsintext      : yes
figurelist        : no
tablelist         : no
footnotelist      : no
linenumbers       : yes
mask              : no
draft             : no

documentclass     : "apa6"
classoption       : "man"
output            : papaja::apa6_pdf
fig_caption: yes
---

```{r setup, include = FALSE, message=FALSE, warning=FALSE}
library("papaja")
library(data.table)
library(plyr)
library(devtools)
library(childesr)
library(tidyverse)
library(tm)
library(forcats)
library(gridExtra)
library(png)
library(grid)
library(ggplot2, warn.conflicts = FALSE, quietly=TRUE)
library(xtable)
library('RColorBrewer')
library(gridExtra)
library(tidyverse)
library(AICcmodavg)
library(broom)
library(corrr)
library(dplyr)
library(knitr)
library(kableExtra)
library(readr)
library(tidyr)
```

<!--
+ new analysis: focusing on 12-24 months range and plot proportions of each category in half-a-month age bins
+ Some plots don't have correct cumulative ratios yet, for example the first point starts below the first age bin ratio which should not be the case?
+ What justifies log transformation of the frequency data? Would our conclusions hold without it?
+ Can we fit a curve (e.g. exponential approach curve) that uses the data from age>24 months to guess where each construction originates between 12-24 months?
+ Discourse level negation does not make sense with prohibitions:
    - Prohibitions -- Parent: Eat your food! Child: No! (= I won't eat my food NOT Don't eat your food!)
+ How much lexical diversity is there in each construction? For example with epistemic negation, are children just saying "don't know" or are they saying different combinations of negation and "know". Maybe this can only focus on the 12-24 age bin
+ Good to have at least 8 corpus example for each function (4 for sentence level and 4 for discourse level)
+ "This is not mine" is currently counted as labeling in this draft but I think we decided to count them as possession in the future
+ Figure 17 is confusing because the epistemic category is dropped and suddenly the graph legend changes completely so hard to track again which color was what category
+ we should probably use red for negative and green for positive
-->

# Introduction

\textcolor{blue}{(1) I made some changes in the abstract. Should we point out that the two hypothesis are (somewhat) contradicting? What satisfies as one starts earlier than another? Or would it be better ot say there's large overpa between the developmental patterns of negation conveying different communication functions.}

\textcolor{blue}{(2) I forgot whether the Introduction part is final. I made changes to the first paragraph, just trying to make it sound less like "English is special" :). I also feel perhaps in some places the term "child language" can be rephrased (child speech).}

\textcolor{blue}{(3) Is there a citation for *no* is one of the first produced words (but before that we said it's a morpheme) in English?}

Negation is a basic human concept and foundational to many areas of human knowledge such as logic and mathematics. <!--All previously studied languages use one or more morphemes like *not* (English), *lā* (Arabic), or *bù* (Mandarin Chinese) to express negation. Within the domain of linguistics, the concept of negation can be expressed in various ways, e.g., inclusion of negative morphemes like *not* (English), *lā* (Arabic), or *bù* (Mandarin Chinese) in the expressions. One important feature of linguistic negation is that it conveys an abstract meaning which serves different communicative functions in different contexts. For example, a coffee shop can use it to divide the menu into "coffee" and "not coffee" sections, with "not coffee" bringing together diverse items such as tea and hot chocolate. The same shop can use it in a sign like "no mask, no entry" to regulate customer behavior. An employee could say "I don't like Mondays" to communicate their dislike of working on Mondays.--> Within the domain of linguistics, the abstract concept of negation is able to serve different communicative functions in different contexts. For example, in English, a coffee shop menu can combine the negative morpheme *not* with the word "coffee" to form the expression of "not coffee", which brings together diverse items such as tea and hot chocolate that are separate from just coffee. The same shop can use the other negative morphemes such as *no* in a sign like "no mask, no entry" to regulate customer behavior. In Mandarin Chinese, an employee could say "wo bu xihuan xingqiyi ("I not like Monday")", where *bu* <!--(*bù*)--> conveys negation to expressthe dislike of working on Mondays. <!--Despite their abstract meanings, negative morphemes like *no* are among the first words produced by children.--> Therefore, a fundamental question in cognitive development and language acquisition is: how does the concept of negation emerge and develop in the human mind.? In particular, are early developmental stages of negation in child speech specific to a few functions? Or does negation emerge as an abstract and multi-functional concept from the beginning?


Previous literature has proposed that abstract negation develops from less abstract communicative functions in fixed ordered stages [@mcneill1968; @bloom1970language; @pea1978; @choi1988semantic]. For instance, @darwin1872expression hypothesized that headshake as a sign for negation develops from infants' habit to refuse or reject food from parents by withdrawing their heads. Similarly, @pea1978 proposed that at first, children use *no* to convey "rejection". In a second stage, they conceptualize and express non-existence of objects (e.g. "no water [in the cup]"), and finally in the third stage, negation reaches an abstract status that can deny truth of statements (e.g. "that is not a cow"). For @pea1978, this order reflected a natural order in the conceptual space: from the more primitive concepts of internal desires to the more complex of external existence and finally abstract truth. As we will discuss in the next section, the theoretical and empirical landscape is, however, not so clean and simple. Over the past fifty years, many studies have proposed different communicative functions and orders of acquisition, without reaching a consensus. We will discuss some possible causes for this but it is important to emphasize previous literature has mainly argued for the following hypotheses: that the abstract concept of negation develops in fixed ordered stages from concrete communicative functions, and that children's early linguistic productions reflect these stages. 

In this study, we provide evidence from child-speech corpora in English that suggests the functional development of negation in fixed ordered stages cannot be taken for granted. Given previous studies and our own, we conclude that it is possible that negation starts as an abstract concept that can be used to perform different communicative functions, and it is possible that it develops relatively quickly in functional stages becoming more abstract between 18-36 months of age.

In general discussion, we explain the limitations regarding inference from observational studies on children's linguistic productions. We argue that existence of stages in children's linguistic production does not necessarily imply stages in their conceptual or even linguistic development overall. Conversely, from absence of stages in children's linguistic productions one cannot conclude absence of stages in conceptual or linguistic development as a whole. 

<!--
However, previous experiments have mainly relied on manual annotations of corpus data to determine the communicative function of a given negative utterance, which in turn has limited their work to only a handful of children per study. Here we aim to go beyond existing work via utilizing a large collection of child speech corpora in English [@macwhinney2000childes] along with computational tools to automatically identify negative utterances that tend to convey the communicative functions discussed in prior research (Table 1). In particular, our study investigates three questions: (1) how does the developmental trajectory of the negative constructions for each function look like? (2) for utterances expressing the same function, does the developmental trajectory differ depending on particular lexical items that negation modifies (e.g. *like* or *want* for rejection)? (3) taking all functions into account, do they share similar developmental characteristics, or would there be function-specific differences?
-->
# Previous Studies

\textcolor{blue}{ZL: (1) Is there a page number for the quoted content from Darwin? I also feel it's bit long}

\textcolor{blue}{ZL: (2) "Izanami had an abstract concept of negation"; What does this mean?}

@darwin1872expression proposed one of the earliest accounts that explained the emergence of negation based on its function. He hypothesized that negation originates from early expressions of human desire, and that nodding and shaking are the earliest expressions of affirmation and negation respectively. Darwin argued: "With infants, the first act of denial consists in refusing food; and I repeatedly noticed with my own infants, that they did so by withdrawing their heads laterally from the breast, or from anything offered them in a spoon. In accepting food and taking it into their mouths, they incline their heads forwards ... [moreover] ... when the voice is exerted with closed teeth or lips, it produces the sound of the letter *n* or *m*. Hence we may account for the use of the particle *ne* to signify negation, and possibly also of the Greek *µn* in the same sense." In later research, this communicative function of negation was referred to as "rejection" or "refusal".

Unlike Darwin, @mcneill1968 proposed a five-stage account for the conceptual development of negation that did not start with rejections. They studied the development of three Japanese negative morphemes (*nai*, *iya*, *iiya*) in the speech of a 27-month-old Japanese speaking girl called Izanami. According to @mcneill1968, in Japanese, *nai* expresses falsity of statements (e.g. "*no* [that's not an apple]), *iya* expresses desires (e.g. "*no* [I don't want an apple]"), and *iiya* expresses contrast (e.g. *no* [I didn't have an apple. I had a pear]). Therefore their appearance in the speech of a child correspondingly reflects the developmental stages for the respective communicative functions. They reported that in the first stage, Izanami used a simple negation like *nai* to express non-existence of events and objects. They also mentioned the early use of *shira-nai* ("I don't know") but did not incorporate it into their theoretical account. In the second stage, Izanami used negation to mark incorrectness of statements - similar to saying "false". Such uses of negation were labeled as "denials" in later research. In stage three, negation was also used to express disapproval or rejection - similar to saying "I don't want that". In the fourth stage, Izanami used negation to express contrasts - similar to saying "not this but something else". Finally in the last stage, Izanami had an abstract concept of negation. These stages took about five months and started with expressing external states (non-existence of objects) before internal desires (rejection). 

@bloom1970language considered three communicative functions for early negation: non-existence, rejection, and denial. She studied three children, two from 19 months and another from 21 months of age. She argued that in all three children, negation was produced in the following order: non-existence, rejection, and denial. Table \@ref(tab:bloom) provides a few examples for each category. Many of these examples do not immediately stand out as instances of their category. This is partly because many early examples are minimal and underspecified constructions that rely heavily on context for their interpretation. It is therefore hard to assess the intention behind the use of negation in such cases.

|Non-existence|Rejection|Denial|
|-------------|---------|------|
|no more choochoo train|no train|no Daddy hungry|
|no more noise|no want this|no more birdie|
|no children|no bear book|no ready|
|no it won't fit|no go outside|no tire|
|Kathryn no like celery|no dirty soap|no dirty|
Table: (\#tab:bloom) Examples of non-existence, rejection, and denial negation in the speech of Eric, Kathryn, and Gia from @bloom1970language

\textcolor{blue}{ZL: "for about 90 minutes"; everyday?}

@pea1978 studied six children between the ages of 8-24 months. Children were recorded monthly in their homes for about 90 minutes. All negative utterances (e.g. containing *no*, *not*, *all gone*, *gone*, *away*, *stop*) and gestures (e..g headshakes and headnods) were annotated and analyzed. @pea1978 reported that children first started by using negation to express internal states (i.e. rejection), then external states (i.e. disappearance), and finally they used negation to connect language and the external world, i.e. truth-functional negation or denials). This was in direct contradiction to @mcneill1968 who proposed that children start with expressing external states (non-existence) before internal states (rejection).

@de1979form studied the communicative functions of negation in the speech of Adam (27-31 months), Eve (18-22 months), and their own child Nicholas (23-29 months). The first two children were recorded for an hour every two or three weeks [@Brown1973]. They annotated children's examples of negation for six communicative functions: non-existence, disappearance, non-occurrence, cessation, rejection, and denial. Disappearance referred to cases where an object became hidden and cessation referred to the use of negation when a movement or action stopped (e.g. "no walk" when a toy stopped walking). They found rejections and denials to be the most frequent (and most reliable-to-annotate) functions of negation. Both functions were present from the earliest samples of children's speech and the authors concluded that there are individual differences in the functions of negation in child speech that mirror child-directed speech.

\textcolor{blue}{(1) wh "novel forms"?}


@choi1988semantic looked at the speech of 11 children (2 English, 4 Korean and 5 French speaking) between 19 to 40 months of age. She reported 9 communicative functions for children's negation shown in Table \@ref(tab:choi). She matched each communicative function with linguistic forms and constructions that commonly convey it and proposed that these forms and functions develop in three phases. First, children used "*no*" alone to express the four functions of nonexistence, prohibition, rejection, and failure. In the second phase, *no* was used to express denial, inability, and epistemic negation. Novel forms such as "*not*+NP" (e.g "*not a bee*"), *can't* (e.g. "*I can't put back*"), and *I don't know* were also used to express these functions. New forms emerged to distinguish the functions in the previous phase such as rejection as well (e.g. "*I don't want to*"). In the third phase, normative negation and inferential negation emerged in children's speech with modal auxiliaries like *can't*. Negative forms for prohibition also emerged with the structure "*don't*+Verb".  

|Function|Definition|Forms|Example|
|--------|----------|----|-------|
|Non-existence|expressing absence of entities|*no*+V|"*no more*" (after emptying a bag)|
|Failure|expressing absence of an event|*it won't*|"*not work*" (puzzle piece not fitting)|
|Prohibition|negating actions of others|*don't* + V||
|Rejection|negating the child's own actions|*I don't want (to)*||
|Denial|negating others' propositions|AUX + *not*|"*no that's a pony*" (in response to "Is this a car?")|
|Inability|expressing physical inability||"*can't!*" (taking two lego pieces apart)|
|Epistemic|lack of knowledge|*I don't know*|"*I don't know*" (in response to "what color is this?")|
|Normative|expressing expected norms|(you) *can't*|"*Him can't go on a boat*"|
|Inferential|child's inference about the listener|AUX + *not*|"*I not broken this*" (seeing a broken crayon)|
Table: (\#tab:choi) Examples of communicative functions and their forms in @choi1988semantic.

\textcolor{blue}{ZL: "for an hour" in total? Why leaving out "normative" and "inferential"?}

\textcolor{blue}{ZL: to put into quotes, or to not put into quotes? When to put into quotes? Formality consistency throughout manuscript}

@cameron2007part recorded a single English speaking child five times a week for an hour between the ages of 27 to 39 months. They classified his negative utterances into seven communicative functions by using categories from @choi1988semantic and leaving out "normative" and "inferential" negation. They found examples of all seven functions in Brian's early speech. Starting at 27 months, single-word discourse-level *no* was used to convey most functions but gradually other forms using *not*, *don't*, *can't*, or *won't* emerged and replaced *no* in usage. For example with inability and prohibition, Brian mostly used *no* and *not* at 27 months but switched to *can't* to express inability, and *don't* to express prohibition at 39 months. @cameron2007part argued that at 27 months, Brian had a broad conceptualization of negation and likely represented it as a "unitary category in conceptual space".

\textcolor{blue}{ZL: functions in quotes}

In a recent study, @nordmeyer2018individual looked at twice-a-month recordings of five children between the 12-36 months of age (1-3 years) in the Providence corpus [@demuth2006word] and classified children's negative utterances into seven functional categories: "disappearance", "prohibition", "self-prohibition", "rejection" (refusal), "failure", "denial", and "unfulfilled expectations". Self-prohibition referred to cases where children addressed a prohibition to themselves (e.g. saying "no" to themselves when reaching for a forbidden object) and "unfulfilled expectations" referred to cases that expressed surprise when an object was not in an expected place, similar to some cases of non-existence in previous research. They found that refusals (rejections) and denials are the most common functions in children's productions and that children vary with respect to which function is produced first. In line with @de1979form, they concluded that the developmental trajectory of different communicative functions of negation may not be as consistent across individuals as some previous research had suggested.

|Study|Number of Children|Age Range (Months)|Proposed Functional Stages|
|-----|------|--------|--------------------------|
|@mcneill1968|1|27-32 Months|non-existence > denial (non-contrastive) > rejection > denial (contrastive) |
|@bloom1970language|3|19-28 Months|non-existence > rejection > denial |
|@pea1978|6|8-24|rejection > non-existence > denial|
|@de1979form|3|18-31| rejection, denial (variable)|
|@choi1988semantic|11|19-40| nonexistence, prohibition, rejection, failure > denial, inability, epistemic > normative, inferential|
|@cameron2007part|1|27-39|non-existence, failure, prohibition, rejection, denial, inability, epistemic|
|@nordmeyer2018individual|5|12-36| denial, rejection, prohibition, failure, disappearance (variable)|
Table: (\#tab:summary) Summary of previous studies on the development of negation's communicative functions.

Table \@ref(tab:summary) provides a summary of previous research on the communicative functions of negation in children's speech. As the summary shows, there is currently no consensus on which functional categories should be included or in which order they are produced. Here we are going to discuss three possible reasons for this lack of consensus. First, @de1979form and @nordmeyer2018individual have emphasized that there is considerable variability among children and their parents in their use of negation. Given that previous studies have typically considered only a few children (3-4 on average), they could have reached conclusions that are true of their sample but not of the population of English-speaking children. Second, previous studies have used monthly or fortnightly recordings of children's speech for about 60-90 minutes per recording session. Given that children produce many hours of speech daily, such sparse sampling may have created accidental gaps for certain communicative functions and consequently made it as if functions appear in ordered stages. The only study with relatively dense recording is @cameron2007part which reports the presence of all communicative functions in the child's speech from early on. The only caveat to this study is that recordings start at a later age than many other studies.

Third, previous research shows that defining and detecting the communicative functions of negation is not a trivial task. Different studies have sometimes used different basic categories and different definitions or criteria for classifying negative utterances. Therefore, what counts as an instance of rejection or non-existence may vary among studies and contribute to the reported variability. Most importantly, annotations focus on many underspecified utterances such as "*no car*" or "*no more*" which are highly ambiguous and can count as an instance of different communicative functions. Does *no car* mean "there is no car here" or "I don't want a toy car"? Researchers often have to rely on the context but the context is not fully represented in many child language corpora used for annotations. More importantly, this approach is not scalable to larger numbers of children and bigger corpora since manual annotations take considerable amount of time, energy, and training. In the next section, we discuss how the current study addresses these three issues.

# Current Study

We build on previous research and address the methodological issues discussed in previous section in two ways. First, in this study we use large corpora of parent-child interactions, aggregating speech samples from X children between the ages of 1-6 years (12-72 months). If the lack of consensus in previous research was mainly due to the small number of children studied, increasing this number should address the issue. Aggregating speech samples across children would also provide denser samples at each time interval and reduce the possibility of accidental gaps in a supposed stage. The reasoning behind this approach is that despite individual variation, if there are major developmental stages in children's production of negation that hold on average across children, these stages should be detectable in such large aggregate corpus of child speech. 

Second, in this study we shift the focus from detecting and classifying negative communicative functions such as rejection to detecting and classifying negative constructions that typically communicate them. Here by negative constructions, we refer to syntactic constructions modified by any one of the three negative morphemes in English: *no*, *not*, *n't*. Table \@ref(tab:constructions) summarizes the constructions and communicative functions used in this study. 

This approach has several advantages. To begin with, negative constructions are more concrete and easier to define and classify. This way we can avoid inconsistent definitions and criteria for classification across different studies. For example, utterances that combine negation with the main verb *want* (e.g. "*I don't want that*") constitute a construction that typically conveys rejection. In addition, due to their concrete definitions, constructions can be detected and classified automatically in large corpora. While it is difficult to manually annotate for examples of rejection across thousands of utterances, it is relatively easier to automatically detect utterances containing the verb *want* modified by negative morphemes. <!--that use the "NEG + *want*" construction.--> This approach is similar in spirit to that of @choi1988semantic who manually annotated for both communicative functions and their common linguistic forms (Table \@ref(tab:summary)). 

\textcolor{blue}{(1) "produce shorter forms before longer ones"; Possible Citation?}

\textcolor{blue}{(2) I did not understand "will probably estimate an upper bound on when..."}

\textcolor{blue}{(3) I'm a little hesitant to call it "response particle"; there's debate over whether particle is a thing; I'd be leaning towards "discourse response marker"}

One downside of focusing on negative constructions is that it may systematically underestimate children's knowledge of negation. Due to early limited productive capacities, children produce shorter forms before longer ones. Therefore, they can convey a communicative function like rejection using a simple *no* before they can produce the full construction "*I don't want that*". Focusing on children's production of explicit constructions, we will probably estimate an upper bound on when children can convey a communicative function. To make up for this, besides investigating negative constructions at the sentence level, we also investigate children and parents' use of *no* as a response particle at the discourse level. Negative discourse particles like *no* can be used in isolation to negate the content of a previous utterance. For example, if a mother asks "do you want some milk?" and the child responds with "no", the negative particle anaphorically targets the proposition "I want some milk" and negates it: "I don't want milk". By using negative discourse particles like *no*, children can convey complex negative content without actually producing them in words. This approach is useful early in their development when they have limited productive capacities. In our analyses, we also look at children and parents' use of negative discourse particles. More specifically, we examine the constructions in the immediate previous utterance in the discourse that are negated by these particles. The analyses of these constructions in the preceding utterance can capture communicative functions that the response particle *no* conveys before children are capable of producing their full syntactic forms. 


\begin{table*}[h]
\small
\centering
\begin{tabular}{rrr}
\hline
\textbf{Function} & \textbf{Negative morpheme combines with} & \textbf{Negative Examples} \\
\hline
Rejection & *like*/*want* & *I not like it*; *not want it* \\
Non-existence & *there*-expletive & *there is no soup*  \\
Prohibition & imperative subjectless *do* & *do not spill milk* \\
Inability & *can* & *I cannot zip it*  \\
Labeling (Denial) & nominal/adjectival predicates & *that's not a crocodile*; *it's no interesting  \\
Epistemic & *know*/*think*/*remember*  & *I not know/think/remember*  \\
Possession & *have*/possesive pronouns & *not have the toy*; *not mine*  \\
\hline
\end{tabular}
\caption{English negative communicative functions and constructions used in this study.}
\end{table*}
Table: (\#tab:constructions) Negative constructions used in this study that typically convey communicative functions studied in previous functional accounts of negation development
   

## Data and preprocessing 

For child speech data in English, we turned to the CHILDES database [@macwhinney2000childes]\footnote{Code and data are in quarantine at \url{https://github.com/zoeyliu18/Negative_Constructions.}} and selected English speaking children with typical development within the age range of 12-72 months. Parents' and children's utterances were extracted via the childes-db [@sanchez2019childes] interface using the programming language R. In order to obtain (morpho)syntactic representations for parents' and children's utterances, we used the dependency grammar framework [@dg]. Part-of-speech (POS) tags for each token within an utterance were automatically derived using Stanza [@qi-etal-2020-stanza], an open-source natural language processing library; dependency relations for all utterances were acquired also in an automatic fashion using DiaParser [@diaparser], a dependency parsing system that has been demonstrated to achieve excellent performance for at least written texts in English.

\textcolor{blue}{(1) In the following paragraph, there's duplicated content with the previous section. I'm wondering if we should remove it here.}

\textcolor{blue}{(2) I changed "test children's knowledge" to "test children's production"}

\textcolor{blue}{(3) I like the last sentence of the following paragrah; Perhaps we could move it to the end of the last paragrah in the previous section; and maybe add the word "possibly", since it's not completely sure children understand them.}

We focus on seven negative constructions shown in Table 1 that tend to convey the communicative functions of rejection, non-existence, prohibition, inability, labeling, epistemic state, and possession. We test children's production of these constructions at two levels: sentence level and discourse level. Negation is marked in two fundamentally different ways in English and many other languages. First, at sentence level, morphemes such as *no*, *not*, or the reduced form *n't* combine with other lexical items to form a negative sentence. For example in sentence level rejection, *n't* can combine with *want* to form "*I don't want to go*". Second, negative response particles such as *no* can be used anaphorically to negate a previous utterance in discourse. For example in discourse level rejection, when a parent asks "*Do you want to go?*", a child can respond with *No!*. Here, the negative discourse particle stands for the proposition "I don't want to go". Children's earliest negative productions are dominated by discourse level negation, presumably because it is shorter and easier to produce when children are limited in their productive capacity. Nevertheless, successful communication with discourse level negation can indicate the children understand the propositions conveyed it.

At the sentence level, we characterized the syntactic features of the negative utterances associated with each communicative function, then classified utterances based on these features in a rule-based fashion with the help of POS information and syntactic dependencies. To decouple the development of the syntactic construction from the development of negation in that construction, we also examined the production of positive counterparts to each negative construction. The positive counterpart of our negative constructions share the same syntactic features (e.g. same head verb) but they have no negative morphemes. These positive constructions do not express the same communicative function as their negative counterparts. Our main purpose for including the positive counterparts is to factor in the development of the syntactic construction without negation.

\textcolor{blue}{ZL: cases like *no no no*}

At the discourse level, we need to analyze the negative constructions that the discourse particle *no* stands for. To achieve this, we selected utterances that started with negative discourse particles like "no no I like it". These instances were tagged with the dependency relation "discourse" by our dependency parser. For each negative utterance identified this way, we extracted the previous utterance (the antecedent) in the discourse context. For child speech, we included interactions (negative utterances + their antecedents) where antecedents were produced by either the parents or the children themselves. For parent speech, we only included interactions where the antecedent was produced by children. We then applied the same analyses performed to sentence level constructions to these antecedent utterances. The assumption here is that the negative discourse particles are implicitly negating the content of their discourse antecedents.  

\textcolor{blue}{(1) changed "moving ratio" to "cumulative ratio"}

\textcolor{blue}{(2) log ratio to ratio}

\textcolor{blue}{(3) equation (2) changed; double check}

\textcolor{blue}{(4) in some plots, the cumulative ratio is supposed to start below ratio, unless I'm not understanding the original issue}

## Measures

We took age as a proxy for children's development and divided the 12-72 months range into monthly bins. We used the following two metrics for each age bin and communicative function. First, we defined the ratio $R_{c,i}$ for construction $c$ and age bin $i$ as the number of utterances in construction $c$ and age bin $i$ divided by the total number of utterances produced at age bin $i$. For example at age 30 months, children produced a total of 81,302 utterances, out of which 391 were classified as rejections. Therefore the ratio of rejection at 30 months is 391/81,302 = 0.005. 

$R_{c, i} = \frac{\#U_{c,i}}{\#U_{i}}$

Second, we borrowed the measure of "cumulative (moving) ratio" from the analysis of time series data [@wei2006time]. We defined the cumulative ratio $CR_{c,i}$ for a construction $c$ at age bin $i$, as the sum of the number of utterances produced with construction $c$ from the first age bin to age bin $i$, divided by the sum of all utterances produced between the first age bin and age bin $i$. For example up to age 30 months, children in our corpus produced 721,748 total utterances, out of which 2,166 were instances of rejection. Therefore, the cumulative ratio of rejection at age 30 months is 2,166/721,748 = 0.003. The cumulative ratio has the advantage that at each age bin, it takes into account the productions in previous age bins. Assuming that children accumulate linguistic knowledge throughout their development, this measure provides a more realistic and stable measure of children's productive capacity at each age.

$CR_{c, i} = \frac{\sum_{n=1}^{i} \#U_{c,n}}{\sum_{n=1}^{i} \#U_{n}}$


The two ratios mentioned above were calculated for negative constructions and their positive counterparts at sentence and discourse levels for children as well as parents. In this study we use parents' speech as a benchmark for children's development. Therefore, our figures show children's productions side by side the production of parents at the corresponding age of children. In what follows, we describe in detail the results for each communicative function and its associated negative constructions.

```{r function}

entropy <- function(data){
  start = 0
  for (i in 1:nrow(data)){
    p = as.vector(data$Total_ratio)[i] 
    start = start - p * log2(p)
  }
  start = start / nrow(data)
  return(start)
}

```



```{r negative_cumulative_function}

negative_cumulative <- function(data, descriptive){
  
  age_list <- as.vector(data$Age)
  freq_list <- rep(0, length(age_list))
  n_speaker_list <- rep(0, length(age_list))
  n_utterances_list <- rep(0, length(age_list))
  
  data$Age <- as.numeric(as.vector(data$Age))
  
  for (i in 1:length(age_list)){
    age = as.numeric(age_list[i])
    select <- data.frame(subset(data, Age <= age)) 
    freq = sum(as.numeric(as.vector(select$Freq)))
    n_speaker = sum(as.numeric(as.vector(select$N_speaker)))
    n_utterances = sum(subset(descriptive, as.numeric(Age) <= age)$N_utterance)
    freq_list[i] = freq
    n_speaker_list[i] = n_speaker
    n_utterances_list[i] = n_utterances
    
    }

  data$Age <- as.character(data$Age)
  
  cumulative_ave <- data.frame(as.character(age_list))
  names(cumulative_ave) <- c('Age')
  cumulative_ave$Freq <- freq_list
  cumulative_ave$Role <- rep(unique(data$Role), length(age_list))
  cumulative_ave$Head <- rep(unique(data$Head), length(age_list))
  cumulative_ave$N_speaker <- n_speaker_list
  cumulative_ave$N_utterance <- n_utterances_list
  cumulative_ave$Total_ratio <- cumulative_ave$Freq / cumulative_ave$N_utterance
  cumulative_ave$Ratio <- rep(0, length(age_list))
  cumulative_ave$Polarity <- rep(unique(data$Polarity), length(age_list))
  cumulative_ave$Measure <- rep('negative construction cumulative ratio', length(age_list))
  cumulative_ave$Which <- rep('cumulative ratio', length(age_list))
  cumulative_ave$Function <- rep(unique(data$Function), length(age_list))
  temp <- rbind(data, cumulative_ave)
  data <- temp
  
  return(data)

}

```

```{r positive_cumulative_function}

positive_cumulative <- function(data, descriptive){
  
  age_list <- as.vector(data$Age)
  freq_list <- rep(0, length(age_list))
  n_speaker_list <- rep(0, length(age_list))
  n_utterances_list <- rep(0, length(age_list))
  
  data$Age <- as.numeric(as.vector(data$Age))
  
  for (i in 1:length(age_list)){
    age = as.numeric(age_list[i])
    select <- data.frame(subset(data, Age <= age)) 
    freq = sum(as.numeric(as.vector(select$Freq)))
    n_speaker = sum(as.numeric(as.vector(select$N_speaker)))
    n_utterances = sum(as.numeric(as.vector((subset(descriptive, Age <= age))$N_utterance)))
    freq_list[i] = freq
    n_speaker_list[i] = n_speaker
    n_utterances_list[i] = n_utterances
    
    }
  
  data$Age <- as.character(data$Age)
  
  cumulative_ave <- data.frame(as.character(age_list))
  names(cumulative_ave) <- c('Age')
  cumulative_ave$Freq <- freq_list
  cumulative_ave$Role <- rep(unique(data$Role), length(age_list))
  cumulative_ave$Head <- rep(unique(data$Head), length(age_list))
  cumulative_ave$N_speaker <- n_speaker_list
  cumulative_ave$N_utterance <- n_utterances_list
  cumulative_ave$Total_ratio <- cumulative_ave$Freq / cumulative_ave$N_utterance
  cumulative_ave$Ratio <- rep(0, length(age_list))
  cumulative_ave$Polarity <- rep(unique(data$Polarity), length(age_list))
  cumulative_ave$Measure <- rep('positive construction cumulative ratio', length(age_list))
  cumulative_ave$Which <- rep('cumulative ratio', length(age_list))
  cumulative_ave$Function <- rep(unique(data$Function), length(age_list))
  temp <- rbind(data, cumulative_ave)
  data <- temp
  
  return(data)

}

```

```{r negative_ul_cumulative_function}

negative_ul_cumulative <- function(data, descriptive){
  
  sent_len_list <- as.vector(data$Sent_len)
  freq_list <- rep(0, length(sent_len_list))
  n_speaker_list <- rep(0, length(sent_len_list))
  n_utterances_list <- rep(0, length(sent_len_list))
  
  data$Sent_len <- as.numeric(as.vector(data$Sent_len))
  
  for (i in 1:length(sent_len_list)){
    sent_len = as.numeric(sent_len_list[i])
    select <- data.frame(subset(data, Sent_len <= sent_len)) 
    freq = sum(as.numeric(as.vector(select$Freq)))
    n_speaker = sum(as.numeric(as.vector(select$N_speaker)))
    n_utterances = sum(as.numeric(as.vector((subset(descriptive, Sent_len <= sent_len))$N_utterance)))
    freq_list[i] = freq
    n_speaker_list[i] = n_speaker
    n_utterances_list[i] = n_utterances
    
    }
  
  data$Sent_len <- as.character(data$Sent_len)
  
  cumulative_ave <- data.frame(as.character(sent_len_list))
  names(cumulative_ave) <- c('Sent_len')
  cumulative_ave$Freq <- freq_list
  cumulative_ave$Role <- rep(unique(data$Role), length(sent_len_list))
  cumulative_ave$Head <- rep(unique(data$Head), length(sent_len_list))
  cumulative_ave$N_speaker <- n_speaker_list
  cumulative_ave$N_utterance <- n_utterances_list
  cumulative_ave$Total_ratio <- cumulative_ave$Freq / cumulative_ave$N_utterance
  cumulative_ave$Ratio <- rep(0, length(sent_len_list))
  cumulative_ave$Polarity <- rep(unique(data$Polarity), length(sent_len_list))
  cumulative_ave$Measure <- rep('negative construction cumulative ratio', length(sent_len_list))
  cumulative_ave$Which <- rep('cumulative ratio', length(sent_len_list))
  cumulative_ave$Function <- rep(unique(data$Function), length(sent_len_list))
  temp <- rbind(data, cumulative_ave)
  data <- temp
  
  return(data)

}

```

```{r positive_ul_cumulative_function}
positive_ul_cumulative <- function(data, descriptive){
  
  sent_len_list <- as.vector(data$Sent_len)
  freq_list <- rep(0, length(sent_len_list))
  n_speaker_list <- rep(0, length(sent_len_list))
  n_utterances_list <- rep(0, length(sent_len_list))
  
  data$Sent_len <- as.numeric(as.vector(data$Sent_len))
  
  for (i in 1:length(sent_len_list)){
    sent_len = as.numeric(sent_len_list[i])
    select <- data.frame(subset(data, Sent_len <= sent_len)) 
    freq = sum(as.numeric(as.vector(select$Freq)))
    n_speaker = sum(as.numeric(as.vector(select$N_speaker)))
    n_utterances = sum(as.numeric(as.vector((subset(descriptive, Sent_len <= sent_len))$N_utterance)))
    freq_list[i] = freq
    n_speaker_list[i] = n_speaker
    n_utterances_list[i] = n_utterances
    
    }
  
  data$Sent_len <- as.character(data$Sent_len)
  
  cumulative_ave <- data.frame(as.character(sent_len_list))
  names(cumulative_ave) <- c('Sent_len')
  cumulative_ave$Freq <- freq_list
  cumulative_ave$Role <- rep(unique(data$Role), length(sent_len_list))
  cumulative_ave$Head <- rep(unique(data$Head), length(sent_len_list))
  cumulative_ave$N_speaker <- n_speaker_list
  cumulative_ave$N_utterance <- n_utterances_list
  cumulative_ave$Total_ratio <- cumulative_ave$Freq / cumulative_ave$N_utterance
  cumulative_ave$Ratio <- rep(0, length(sent_len_list))
  cumulative_ave$Polarity <- rep(unique(data$Polarity), length(sent_len_list))
  cumulative_ave$Measure <- rep('positive construction cumulative ratio', length(sent_len_list))
  cumulative_ave$Which <- rep('cumulative ratio', length(sent_len_list))
  cumulative_ave$Function <- rep(unique(data$Function), length(sent_len_list))
  temp <- rbind(data, cumulative_ave)
  data <- temp
  
  return(data)

}

```

```{r mlu_function}

mlu <- function(data){
  
  compose = as.vector(unique(data$Age))
  values = rep(0, length(compose))
  
  for (i in 1:length(compose)){
    age = as.numeric(compose[i])
    select <- data.frame(subset(data, Age <= age))
    mlu_value = sum(as.numeric(select$Sent_len)) / nrow(select)
    values[i] = mlu_value
  }
  
  compose = data.frame(compose)
  names(compose) <- c('Age')
  compose$MLU <- values
  
  return(compose)
  
}  

```

```{r descriptive, include=FALSE}

child_descriptive <- subset(read.csv('data/child_descriptive.txt', header = T, sep = '\t'), Age >= 12 & Age <= 72)
parent_descriptive <- subset(read.csv('data/parent_descriptive.txt', header = T, sep = '\t'), Age >= 12 & Age <= 72)

child_ul_descriptive <- read.csv('data/child_ul_descriptive.txt', header = T, sep = '\t')
parent_ul_descriptive <- read.csv('data/parent_ul_descriptive.txt', header = T, sep = '\t')

child_individual_descriptive <- subset(read.csv('data/individual_child_descriptive.txt', header = T, sep = '\t'), Age >= 12 & Age <= 72)
parent_individual_descriptive <- subset(read.csv('data/individual_parent_descriptive.txt', header = T, sep = '\t'), Age >= 12 & Age <= 72)


```

## Negative Constructions

### Rejection

```{r emotiondata, include=FALSE}

emotion <-read.csv('data/emotion.txt', header = T, sep = '\t')
# emotion <- subset(emotion, Subj == 'I' | Subj == 'NONE')
emotion$Role[which(emotion$Role == "Father")] <- 'Parent'
emotion$Role[which(emotion$Role == "Mother")] <- 'Parent'
emotion$Role[which(emotion$Role == "Target_Child")] <- 'Child'

emotion_neg = subset(emotion, Polarity == 'negative')
emotion_pos = subset(emotion, Polarity == 'positive')

child_emotion_neg <- subset(emotion_neg, Role %in% c('Child'))
parent_emotion_neg <- subset(emotion_neg, Role %in% c('Parent'))


child_like_neg <- subset(child_emotion_neg, Head %in% c('like'))
child_want_neg <- subset(child_emotion_neg, Head %in% c('want'))
parent_like_neg <- subset(parent_emotion_neg, Head %in% c('like'))
parent_want_neg <- subset(parent_emotion_neg, Head %in% c('want'))

child_like_neg_mlu <- mlu(child_like_neg)
child_want_neg_mlu <- mlu(child_want_neg)
parent_like_neg_mlu <- mlu(parent_like_neg)
parent_want_neg_mlu <- mlu(parent_want_neg)

child_like_neg <- data.frame(table(child_like_neg$Age))
names(child_like_neg) <- c('Age', 'Freq')
child_like_neg$Role <- rep('Child', nrow(child_like_neg))
child_like_neg$Head <- rep('like', nrow(child_like_neg))
temp <- merge(child_like_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_like_neg <- temp
child_like_neg$Total_ratio <- child_like_neg$Freq / child_like_neg$N_utterance
child_like_neg$Ratio <- child_like_neg$Freq / sum(child_like_neg$Freq)
child_like_neg$Polarity <- rep('negative', nrow(child_like_neg))
child_like_neg$Measure <- rep('negative construction ratio', nrow(child_like_neg))
child_like_neg$Which <- rep('ratio', nrow(child_like_neg))
child_like_neg$Function <- rep('Rejection', nrow(child_like_neg))
child_like_neg <- negative_cumulative(child_like_neg, child_descriptive)

child_want_neg <- data.frame(table(child_want_neg$Age))
names(child_want_neg) <- c('Age', 'Freq')
child_want_neg$Role <- rep('Child', nrow(child_want_neg))
child_want_neg$Head <- rep('want', nrow(child_want_neg))
temp <- merge(child_want_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_want_neg <- temp
child_want_neg$Total_ratio <- child_want_neg$Freq / child_want_neg$N_utterance
child_want_neg$Ratio <- child_want_neg$Freq / sum(child_want_neg$Freq)
child_want_neg$Polarity <- rep('negative', nrow(child_want_neg))
child_want_neg$Measure <- rep('negative construction ratio', nrow(child_want_neg))
child_want_neg$Which <- rep('ratio', nrow(child_want_neg))
child_want_neg$Function <- rep('Rejection', nrow(child_want_neg))
child_want_neg <- negative_cumulative(child_want_neg, child_descriptive)

parent_like_neg <- data.frame(table(parent_like_neg$Age))
names(parent_like_neg) <- c('Age', 'Freq')
parent_like_neg$Role <- rep('Parent', nrow(parent_like_neg))
parent_like_neg$Head <- rep('like', nrow(parent_like_neg))
temp <- merge(parent_like_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_like_neg <- temp
parent_like_neg$Total_ratio <- parent_like_neg$Freq / parent_like_neg$N_utterance
parent_like_neg$Ratio <- parent_like_neg$Freq / sum(parent_like_neg$Freq)
parent_like_neg$Polarity <- rep('negative', nrow(parent_like_neg))
parent_like_neg$Measure <- rep('negative construction ratio', nrow(parent_like_neg))
parent_like_neg$Which <- rep('ratio', nrow(parent_like_neg))
parent_like_neg$Function <- rep('Rejection', nrow(parent_like_neg))
parent_like_neg <- negative_cumulative(parent_like_neg, parent_descriptive)

parent_want_neg <- data.frame(table(parent_want_neg$Age))
names(parent_want_neg) <- c('Age', 'Freq')
parent_want_neg$Role <- rep('Parent', nrow(parent_want_neg))
parent_want_neg$Head <- rep('want', nrow(parent_want_neg))
temp <- merge(parent_want_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_want_neg <- temp
parent_want_neg$Total_ratio <- parent_want_neg$Freq / parent_want_neg$N_utterance
parent_want_neg$Ratio <- parent_want_neg$Freq / sum(parent_want_neg$Freq)
parent_want_neg$Polarity <- rep('negative', nrow(parent_want_neg))
parent_want_neg$Measure <- rep('negative construction ratio', nrow(parent_want_neg))
parent_want_neg$Which <- rep('ratio', nrow(parent_want_neg))
parent_want_neg$Function <- rep('Rejection', nrow(parent_want_neg))
parent_want_neg <- negative_cumulative(parent_want_neg, parent_descriptive)


child_emotion_pos <- subset(emotion_pos, Role %in% c('Child'))
parent_emotion_pos <- subset(emotion_pos, Role %in% c('Parent'))


child_like_pos <- subset(child_emotion_pos, Head %in% c('like'))
child_want_pos <- subset(child_emotion_pos, Head %in% c('want'))
parent_like_pos <- subset(parent_emotion_pos, Head %in% c('like'))
parent_want_pos <- subset(parent_emotion_pos, Head %in% c('want'))

child_like_pos_mlu <- mlu(child_like_pos)
child_want_pos_mlu <- mlu(child_want_pos)
parent_like_pos_mlu <- mlu(parent_like_pos)
parent_want_pos_mlu <- mlu(parent_want_pos)

child_like_pos <- data.frame(table(child_like_pos$Age))
names(child_like_pos) <- c('Age', 'Freq')
child_like_pos$Role <- rep('Child', nrow(child_like_pos))
child_like_pos$Head <- rep('like', nrow(child_like_pos))
temp <- merge(child_like_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_like_pos <- temp
child_like_pos$Total_ratio <- child_like_pos$Freq / child_like_pos$N_utterance
child_like_pos$Ratio <- child_like_pos$Freq / sum(child_like_pos$Freq)
child_like_pos$Polarity <- rep('positive', nrow(child_like_pos))
child_like_pos$Measure <- rep('positive construction ratio', nrow(child_like_pos))
child_like_pos$Which <- rep('ratio', nrow(child_like_pos))
child_like_pos$Function <- rep('Rejection', nrow(child_like_pos))
child_like_pos <- positive_cumulative(child_like_pos, child_descriptive)


child_want_pos <- data.frame(table(child_want_pos$Age))
names(child_want_pos) <- c('Age', 'Freq')
child_want_pos$Role <- rep('Child', nrow(child_want_pos))
child_want_pos$Head <- rep('want', nrow(child_want_pos))
temp <- merge(child_want_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_want_pos <- temp
child_want_pos$Total_ratio <- child_want_pos$Freq / child_want_pos$N_utterance
child_want_pos$Ratio <- child_want_pos$Freq / sum(child_want_pos$Freq)
child_want_pos$Polarity <- rep('positive', nrow(child_want_pos))
child_want_pos$Measure <- rep('positive construction ratio', nrow(child_want_pos))
child_want_pos$Which <- rep('ratio', nrow(child_want_pos))
child_want_pos$Function <- rep('Rejection', nrow(child_want_pos))
child_want_pos <- positive_cumulative(child_want_pos, child_descriptive)

parent_like_pos <- data.frame(table(parent_like_pos$Age))
names(parent_like_pos) <- c('Age', 'Freq')
parent_like_pos$Role <- rep('Parent', nrow(parent_like_pos))
parent_like_pos$Head <- rep('like', nrow(parent_like_pos))
temp <- merge(parent_like_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_like_pos <- temp
parent_like_pos$Total_ratio <- parent_like_pos$Freq / parent_like_pos$N_utterance
parent_like_pos$Ratio <- parent_like_pos$Freq / sum(parent_like_pos$Freq)
parent_like_pos$Polarity <- rep('positive', nrow(parent_like_pos))
parent_like_pos$Measure <- rep('positive construction ratio', nrow(parent_like_pos))
parent_like_pos$Which <- rep('ratio', nrow(parent_like_pos))
parent_like_pos$Function <- rep('Rejection', nrow(parent_like_pos))
parent_like_pos <- positive_cumulative(parent_like_pos, parent_descriptive)

parent_want_pos <- data.frame(table(parent_want_pos$Age))
names(parent_want_pos) <- c('Age', 'Freq')
parent_want_pos$Role <- rep('Parent', nrow(parent_want_pos))
parent_want_pos$Head <- rep('want', nrow(parent_want_pos))
temp <- merge(parent_want_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_want_pos <- temp
parent_want_pos$Total_ratio <- parent_want_pos$Freq / parent_want_pos$N_utterance
parent_want_pos$Ratio <- parent_want_pos$Freq / sum(parent_want_pos$Freq)
parent_want_pos$Polarity <- rep('positive', nrow(parent_want_pos))
parent_want_pos$Measure <- rep('positive construction ratio', nrow(parent_want_pos))
parent_want_pos$Which <- rep('ratio', nrow(parent_want_pos))
parent_want_pos$Function <- rep('Rejection', nrow(parent_want_pos))
parent_want_pos <- positive_cumulative(parent_want_pos, parent_descriptive)

emotion_data <- rbind(child_like_neg, parent_like_neg, child_want_neg, parent_want_neg, child_like_pos, parent_like_pos, child_want_pos, parent_want_pos)

emotion_data$Measure <- factor(emotion_data$Measure, levels = c('negative construction ratio', 'negative construction cumulative ratio', 'positive construction ratio', 'positive construction cumulative ratio'))

emotion_data_child <- subset(emotion_data, Role == 'Child')
emotion_data_parent <- subset(emotion_data, Role == 'Parent')

```

```{r emotionuldata, include=FALSE}

child_ul_like_neg <- subset(child_emotion_neg, Head %in% c('like'))
child_ul_want_neg <- subset(child_emotion_neg, Head %in% c('want'))
parent_ul_like_neg <- subset(parent_emotion_neg, Head %in% c('like'))
parent_ul_want_neg <- subset(parent_emotion_neg, Head %in% c('want'))

child_ul_like_neg <- data.frame(table(child_ul_like_neg$Sent_len))
names(child_ul_like_neg) <- c('Sent_len', 'Freq')
child_ul_like_neg$Role <- rep('Child', nrow(child_ul_like_neg))
child_ul_like_neg$Head <- rep('like', nrow(child_ul_like_neg))
temp <- merge(child_ul_like_neg, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_like_neg <- temp
child_ul_like_neg$Total_ratio <- child_ul_like_neg$Freq / child_ul_like_neg$N_utterance
child_ul_like_neg$Ratio <- child_ul_like_neg$Freq / sum(child_ul_like_neg$Freq)
child_ul_like_neg$Polarity <- rep('negative', nrow(child_ul_like_neg))
child_ul_like_neg$Measure <- rep('negative construction ratio', nrow(child_ul_like_neg))
child_ul_like_neg$Which <- rep('ratio', nrow(child_ul_like_neg))
child_ul_like_neg$Function <- rep('Rejection', nrow(child_ul_like_neg))
child_ul_like_neg <- negative_ul_cumulative(child_ul_like_neg, child_ul_descriptive)

child_ul_want_neg <- data.frame(table(child_ul_want_neg$Sent_len))
names(child_ul_want_neg) <- c('Sent_len', 'Freq')
child_ul_want_neg$Role <- rep('Child', nrow(child_ul_want_neg))
child_ul_want_neg$Head <- rep('want', nrow(child_ul_want_neg))
temp <- merge(child_ul_want_neg, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_want_neg <- temp
child_ul_want_neg$Total_ratio <- child_ul_want_neg$Freq / child_ul_want_neg$N_utterance
child_ul_want_neg$Ratio <- child_ul_want_neg$Freq / sum(child_ul_want_neg$Freq)
child_ul_want_neg$Polarity <- rep('negative', nrow(child_ul_want_neg))
child_ul_want_neg$Measure <- rep('negative construction ratio', nrow(child_ul_want_neg))
child_ul_want_neg$Which <- rep('ratio', nrow(child_ul_want_neg))
child_ul_want_neg$Function <- rep('Rejection', nrow(child_ul_want_neg))
child_ul_want_neg <- negative_ul_cumulative(child_ul_want_neg, child_ul_descriptive)

parent_ul_like_neg <- data.frame(table(parent_ul_like_neg$Sent_len))
names(parent_ul_like_neg) <- c('Sent_len', 'Freq')
parent_ul_like_neg$Role <- rep('Parent', nrow(parent_ul_like_neg))
parent_ul_like_neg$Head <- rep('like', nrow(parent_ul_like_neg))
temp <- merge(parent_ul_like_neg, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_like_neg <- temp
parent_ul_like_neg$Total_ratio <- parent_ul_like_neg$Freq / parent_ul_like_neg$N_utterance
parent_ul_like_neg$Ratio <- parent_ul_like_neg$Freq / sum(parent_ul_like_neg$Freq)
parent_ul_like_neg$Polarity <- rep('negative', nrow(parent_ul_like_neg))
parent_ul_like_neg$Measure <- rep('negative construction ratio', nrow(parent_ul_like_neg))
parent_ul_like_neg$Which <- rep('ratio', nrow(parent_ul_like_neg))
parent_ul_like_neg$Function <- rep('Rejection', nrow(parent_ul_like_neg))
parent_ul_like_neg <- negative_ul_cumulative(parent_ul_like_neg, parent_ul_descriptive)

parent_ul_want_neg <- data.frame(table(parent_ul_want_neg$Sent_len))
names(parent_ul_want_neg) <- c('Sent_len', 'Freq')
parent_ul_want_neg$Role <- rep('Parent', nrow(parent_ul_want_neg))
parent_ul_want_neg$Head <- rep('want', nrow(parent_ul_want_neg))
temp <- merge(parent_ul_want_neg, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_want_neg <- temp
parent_ul_want_neg$Total_ratio <- parent_ul_want_neg$Freq / parent_ul_want_neg$N_utterance
parent_ul_want_neg$Ratio <- parent_ul_want_neg$Freq / sum(parent_ul_want_neg$Freq)
parent_ul_want_neg$Polarity <- rep('negative', nrow(parent_ul_want_neg))
parent_ul_want_neg$Measure <- rep('negative construction ratio', nrow(parent_ul_want_neg))
parent_ul_want_neg$Which <- rep('ratio', nrow(parent_ul_want_neg))
parent_ul_want_neg$Function <- rep('Rejection', nrow(parent_ul_want_neg))
parent_ul_want_neg <- negative_ul_cumulative(parent_ul_want_neg, parent_ul_descriptive)


child_ul_like_pos <- subset(child_emotion_pos, Head %in% c('like'))
child_ul_want_pos <- subset(child_emotion_pos, Head %in% c('want'))
parent_ul_like_pos <- subset(parent_emotion_pos, Head %in% c('like'))
parent_ul_want_pos <- subset(parent_emotion_pos, Head %in% c('want'))

child_ul_like_pos <- data.frame(table(child_ul_like_pos$Sent_len))
names(child_ul_like_pos) <- c('Sent_len', 'Freq')
child_ul_like_pos$Role <- rep('Child', nrow(child_ul_like_pos))
child_ul_like_pos$Head <- rep('like', nrow(child_ul_like_pos))
temp <- merge(child_ul_like_pos, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_like_pos <- temp
child_ul_like_pos$Total_ratio <- child_ul_like_pos$Freq / child_ul_like_pos$N_utterance
child_ul_like_pos$Ratio <- child_ul_like_pos$Freq / sum(child_ul_like_pos$Freq)
child_ul_like_pos$Polarity <- rep('positive', nrow(child_ul_like_pos))
child_ul_like_pos$Measure <- rep('positive construction ratio', nrow(child_ul_like_pos))
child_ul_like_pos$Which <- rep('ratio', nrow(child_ul_like_pos))
child_ul_like_pos$Function <- rep('Rejection', nrow(child_ul_like_pos))
child_ul_like_pos <- positive_ul_cumulative(child_ul_like_pos, child_ul_descriptive)


child_ul_want_pos <- data.frame(table(child_ul_want_pos$Sent_len))
names(child_ul_want_pos) <- c('Sent_len', 'Freq')
child_ul_want_pos$Role <- rep('Child', nrow(child_ul_want_pos))
child_ul_want_pos$Head <- rep('want', nrow(child_ul_want_pos))
temp <- merge(child_ul_want_pos, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_want_pos <- temp
child_ul_want_pos$Total_ratio <- child_ul_want_pos$Freq / child_ul_want_pos$N_utterance
child_ul_want_pos$Ratio <- child_ul_want_pos$Freq / sum(child_ul_want_pos$Freq)
child_ul_want_pos$Polarity <- rep('positive', nrow(child_ul_want_pos))
child_ul_want_pos$Measure <- rep('positive construction ratio', nrow(child_ul_want_pos))
child_ul_want_pos$Which <- rep('ratio', nrow(child_ul_want_pos))
child_ul_want_pos$Function <- rep('Rejection', nrow(child_ul_want_pos))
child_ul_want_pos <- positive_ul_cumulative(child_ul_want_pos, child_ul_descriptive)

parent_ul_like_pos <- data.frame(table(parent_ul_like_pos$Sent_len))
names(parent_ul_like_pos) <- c('Sent_len', 'Freq')
parent_ul_like_pos$Role <- rep('Parent', nrow(parent_ul_like_pos))
parent_ul_like_pos$Head <- rep('like', nrow(parent_ul_like_pos))
temp <- merge(parent_ul_like_pos, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_like_pos <- temp
parent_ul_like_pos$Total_ratio <- parent_ul_like_pos$Freq / parent_ul_like_pos$N_utterance
parent_ul_like_pos$Ratio <- parent_ul_like_pos$Freq / sum(parent_ul_like_pos$Freq)
parent_ul_like_pos$Polarity <- rep('positive', nrow(parent_ul_like_pos))
parent_ul_like_pos$Measure <- rep('positive construction ratio', nrow(parent_ul_like_pos))
parent_ul_like_pos$Which <- rep('ratio', nrow(parent_ul_like_pos))
parent_ul_like_pos$Function <- rep('Rejection', nrow(parent_ul_like_pos))
parent_ul_like_pos <- positive_ul_cumulative(parent_ul_like_pos, parent_ul_descriptive)

parent_ul_want_pos <- data.frame(table(parent_ul_want_pos$Sent_len))
names(parent_ul_want_pos) <- c('Sent_len', 'Freq')
parent_ul_want_pos$Role <- rep('Parent', nrow(parent_ul_want_pos))
parent_ul_want_pos$Head <- rep('want', nrow(parent_ul_want_pos))
temp <- merge(parent_ul_want_pos, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_want_pos <- temp
parent_ul_want_pos$Total_ratio <- parent_ul_want_pos$Freq / parent_ul_want_pos$N_utterance
parent_ul_want_pos$Ratio <- parent_ul_want_pos$Freq / sum(parent_ul_want_pos$Freq)
parent_ul_want_pos$Polarity <- rep('positive', nrow(parent_ul_want_pos))
parent_ul_want_pos$Measure <- rep('positive construction ratio', nrow(parent_ul_want_pos))
parent_ul_want_pos$Which <- rep('ratio', nrow(parent_ul_want_pos))
parent_ul_want_pos$Function <- rep('Rejection', nrow(parent_ul_want_pos))
parent_ul_want_pos <- positive_ul_cumulative(parent_ul_want_pos, parent_ul_descriptive)

emotion_ul_data <- rbind(child_ul_like_neg, parent_ul_like_neg, child_ul_want_neg, parent_ul_want_neg, child_ul_like_pos, parent_ul_like_pos, child_ul_want_pos, parent_ul_want_pos)

emotion_ul_data$Measure <- factor(emotion_ul_data$Measure, levels = c('negative construction ratio', 'negative construction cumulative ratio', 'positive construction ratio', 'positive construction cumulative ratio'))

emotion_ul_data_child <- subset(emotion_ul_data, Role == 'Child')
emotion_ul_data_parent <- subset(emotion_ul_data, Role == 'Parent')

```

```{r emotiondiscoursedata, include=FALSE}

discourse_emotion <-read.csv('data/emotion_discourse.txt', header = T, sep = '\t')
discourse_emotion$Role[which(discourse_emotion$Role == "Father")] <- 'Parent'
discourse_emotion$Role[which(discourse_emotion$Role == "Mother")] <- 'Parent'
discourse_emotion$Role[which(discourse_emotion$Role == "Target_Child")] <- 'Child'

discourse_emotion_neg = subset(discourse_emotion, Polarity == 'negative')
discourse_emotion_pos = subset(discourse_emotion, Polarity == 'positive')

discourse_child_emotion_neg <- subset(discourse_emotion_neg, Role %in% c('Child'))
discourse_parent_emotion_neg <- subset(discourse_emotion_neg, Role %in% c('Parent'))

discourse_child_emotion_neg <- data.frame(table(discourse_child_emotion_neg$Age))
names(discourse_child_emotion_neg) <- c('Age', 'Freq')
discourse_child_emotion_neg$Role <- rep('Child', nrow(discourse_child_emotion_neg))
discourse_child_emotion_neg$Head <- rep('both', nrow(discourse_child_emotion_neg))
temp <- merge(discourse_child_emotion_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_emotion_neg <- temp
discourse_child_emotion_neg$Total_ratio <- discourse_child_emotion_neg$Freq / discourse_child_emotion_neg$N_utterance
discourse_child_emotion_neg$Ratio <- discourse_child_emotion_neg$Freq / discourse_child_emotion_neg$N_utterance
discourse_child_emotion_neg$Polarity <- rep('negative', nrow(discourse_child_emotion_neg))
discourse_child_emotion_neg$Measure <- rep('negative construction ratio', nrow(discourse_child_emotion_neg))
discourse_child_emotion_neg$Which <- rep('ratio', nrow(discourse_child_emotion_neg))
discourse_child_emotion_neg$Function <- rep('Rejection', nrow(discourse_child_emotion_neg))
discourse_child_emotion_neg <- negative_cumulative(discourse_child_emotion_neg, child_descriptive)

discourse_parent_emotion_neg <- data.frame(table(discourse_parent_emotion_neg$Age))
names(discourse_parent_emotion_neg) <- c('Age', 'Freq')
discourse_parent_emotion_neg$Role <- rep('Parent', nrow(discourse_parent_emotion_neg))
discourse_parent_emotion_neg$Head <- rep('both', nrow(discourse_parent_emotion_neg))
temp <- merge(discourse_parent_emotion_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_emotion_neg <- temp
discourse_parent_emotion_neg$Total_ratio <- discourse_parent_emotion_neg$Freq / discourse_parent_emotion_neg$N_utterance
discourse_parent_emotion_neg$Ratio <- discourse_parent_emotion_neg$Freq / discourse_parent_emotion_neg$N_utterance
discourse_parent_emotion_neg$Polarity <- rep('negative', nrow(discourse_parent_emotion_neg))
discourse_parent_emotion_neg$Measure <- rep('negative construction ratio', nrow(discourse_parent_emotion_neg))
discourse_parent_emotion_neg$Which <- rep('ratio', nrow(discourse_parent_emotion_neg))
discourse_parent_emotion_neg$Function <- rep('Rejection', nrow(discourse_parent_emotion_neg))
discourse_parent_emotion_neg <- negative_cumulative(discourse_parent_emotion_neg, parent_descriptive)

discourse_child_emotion_pos <- subset(discourse_emotion_pos, Role %in% c('Child'))
discourse_parent_emotion_pos <- subset(discourse_emotion_pos, Role %in% c('Parent'))

discourse_child_emotion_pos <- data.frame(table(discourse_child_emotion_pos$Age))
names(discourse_child_emotion_pos) <- c('Age', 'Freq')
discourse_child_emotion_pos$Role <- rep('Child', nrow(discourse_child_emotion_pos))
discourse_child_emotion_pos$Head <- rep('both', nrow(discourse_child_emotion_pos))
temp <- merge(discourse_child_emotion_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_emotion_pos <- temp
discourse_child_emotion_pos$Total_ratio <- discourse_child_emotion_pos$Freq / discourse_child_emotion_pos$N_utterance
discourse_child_emotion_pos$Ratio <- discourse_child_emotion_pos$Freq / discourse_child_emotion_pos$N_utterance
discourse_child_emotion_pos$Polarity <- rep('positive', nrow(discourse_child_emotion_pos))
discourse_child_emotion_pos$Measure <- rep('positive construction ratio', nrow(discourse_child_emotion_pos))
discourse_child_emotion_pos$Which <- rep('ratio', nrow(discourse_child_emotion_pos))
discourse_child_emotion_pos$Function <- rep('Rejection', nrow(discourse_child_emotion_pos))
discourse_child_emotion_pos <- positive_cumulative(discourse_child_emotion_pos, child_descriptive)


discourse_parent_emotion_pos <- data.frame(table(discourse_parent_emotion_pos$Age))
names(discourse_parent_emotion_pos) <- c('Age', 'Freq')
discourse_parent_emotion_pos$Role <- rep('Parent', nrow(discourse_parent_emotion_pos))
discourse_parent_emotion_pos$Head <- rep('both', nrow(discourse_parent_emotion_pos))
temp <- merge(discourse_parent_emotion_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_emotion_pos <- temp
discourse_parent_emotion_pos$Total_ratio <- discourse_parent_emotion_pos$Freq / discourse_parent_emotion_pos$N_utterance
discourse_parent_emotion_pos$Ratio <- discourse_parent_emotion_pos$Freq / discourse_parent_emotion_pos$N_utterance
discourse_parent_emotion_pos$Polarity <- rep('positive', nrow(discourse_parent_emotion_pos))
discourse_parent_emotion_pos$Measure <- rep('positive construction ratio', nrow(discourse_parent_emotion_pos))
discourse_parent_emotion_pos$Which <- rep('ratio', nrow(discourse_parent_emotion_pos))
discourse_parent_emotion_pos$Function <- rep('Rejection', nrow(discourse_parent_emotion_pos))
discourse_parent_emotion_pos <- positive_cumulative(discourse_parent_emotion_pos, parent_descriptive)

discourse_emotion_data <- rbind(discourse_child_emotion_neg, discourse_parent_emotion_neg, discourse_child_emotion_pos, discourse_parent_emotion_pos)

discourse_emotion_data$Measure <- factor(discourse_emotion_data$Measure, levels = c('negative construction ratio', 'negative construction cumulative ratio', 'positive construction ratio', 'positive construction cumulative ratio'))

discourse_emotion_data_child <- subset(discourse_emotion_data, Role == 'Child')
discourse_emotion_data_parent <- subset(discourse_emotion_data, Role == 'Parent')

discourse_emotion_data_plot <- aggregate(Total_ratio~Age+Which+Role,data=discourse_emotion_data,sum)

names(discourse_emotion_data_plot) <- c('Age', 'Measure', 'Role', 'Total_ratio')

```

For instances of "rejection" and positive counterparts, we selected utterances in which the lemma of the head verb of the phrase is either *like* or *want*. For negative instances, the head verb is modified by one of the three negative morphemes *no*, *not* or *n't*, whereas cases including the same head verb but without negation were classified as positive. Table \@ref(tab:rejection) shows examples of negative utterances including those in which the speakers describe their own desires with or without an auxiliary verb (e.g. 1 and 2), as well as cases that express rhetorical inquiries of desires from one interlocutor to another (e.g. 3), and instances where the speaker is describing the desires of somebody else (e.g. 4). We classified a total of `r format(sum(subset(emotion_data,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")` negative utterances (child: `r format(sum(subset(emotion_data_child,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`; parent: `r format(sum(subset(emotion_data_parent,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`), and a total of `r format(sum(subset(emotion_data,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")` negative utterances (child: `r format(sum(subset(emotion_data_child,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`; parent: `r format(sum(subset(emotion_data_parent,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`).  

|Rejection (Negative)|Positive Counterpart|
|---------------------|----------------------|
| *I no like sea* | *she likes cheese* |
| *don't wanna go* | *I want it* |
| *don't you wanna try it* | *I wanna have that* |
| *Sarah doesn't like that either* | *she likes this one* |
Table: (\#tab:rejection) Examples of sentence-level rejection (negative) and positive counterparts in children's speech.


```{r emotion, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=4, set.cap.width=T, num.cols.cap=1, fig.cap='Ratios and cumulative ratios for the production of rejection at the sentence level for children between 12 to 72 months of age, and their parents.'}

emotion_data %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) + #"peru", 
#  geom_line(linetype = c('dotted', 'solid')) +
#  geom_line(aes(color = Polarity, linetype = 'dotted', size = 1)) + 
  facet_grid(Head ~ Role) +
#  facet_grid(vars(Head)) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") + 
#  ylim(-9.5, -2.5) +
  guides(linetype = guide_legend(nrow = 2))

```

```{r emotionbegin, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=4, set.cap.width=T, num.cols.cap=1, fig.cap='Ratios and cumulative ratios for the production of rejection at the sentence level for children between 12 to 24 months of age, and their parents'}

subset(emotion_data, Age<=24) %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) + #"peru", 
#  geom_line(linetype = c('dotted', 'solid')) +
#  geom_line(aes(color = Polarity, linetype = 'dotted', size = 1)) + 
  facet_grid(Head ~ Role) +
#  facet_grid(vars(Head)) +
  scale_x_continuous(breaks=seq(0, 24, 1)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") + 
  guides(linetype = guide_legend(nrow = 2))

```
  
<!--
```{r emotionul, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=4, set.cap.width=T, num.cols.cap=1, fig.cap='Rejection and its positive counterparts, indexed by utterance length.'}

emotion_ul_data %>% 
  ggplot(aes(as.numeric(as.character(Sent_len)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) +
  facet_grid(Head ~ Role) +
  scale_x_continuous(breaks=seq(0, 130, 10)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("utterance length") + 
  ylab("production ratio") + 
  guides(linetype = guide_legend(nrow = 2))

```
-->

Starting with our analysis at the sentence level, Figure \@ref(fig:emotion) shows the ratios and cumulative ratios of parents' and children's instances of rejection and positive counterparts on a logarithmic scale (y-axis) with age along the x-axis. Overall, we see a similar pattern of production for rejection whether the head verb is *want* or *like*. Comparing the cumulative ratios between parents and children, children's production of rejection gradually increases between the ages of 18 and 30 months. After about 30 months of age, children's production of these constructions stays at a relatively constant rate and close to parent levels. In all age bins, the production ratio for negative utterances is lower than that for their positive counterparts.

On the discourse level, we investigated discourse interactions (antecedent + negative utterance) in which the antecedent had one of the head verbs *like* or *want*, yet the head verb did not have to be modified by negative morphemes. Table \@ref(tab:disreject) shows a few examples. We found a total of `r format(sum(subset(discourse_emotion_data,Which=='ratio')$Freq), big.mark=",")` such utterances (child: `r format(sum(subset(discourse_emotion_data_child,Which=='ratio')$Freq), big.mark=",")`; parent: `r format(sum(subset(discourse_emotion_data_parent,Which=='ratio')$Freq), big.mark=",")`). As shown in Figure 2, children's production of negation as discourse response variables increases regularly from the age of 24 - 36 months\footnote{For each communicative function, at the discourse level we also examined cases of different subtypes (e.g. different head verbs) separately; though due to data sparsity issues, we collapsed these instances for our final analyses}. Overall negative morphemes are applied at the discourse level more frequently in child speech compared to parent speech.

|Antecedent|Utterance|
|------------|------------|
|Parent: *I want you to try it*|Child: *no no no*|
|Parent: *would you like to go*|Child: *no no*|
|Child: *I don't like that*|Parent: *no honey you have to try it*|
|Child: *I want it*|Parent: *no this is not for you*|
Table: (\#tab:disreject) Examples of discourse-level rejections and their antecedents in parents' and children's speech.


```{r emotiondiscourse, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap='Ratios and cumulative ratios for the production of rejection at the discourse level for children between 12 to 72 months of age, and their parents.',warning=FALSE}

discourse_emotion_data_plot %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c('solid', "dotted")) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(16, 3)) + 
  scale_color_manual(values = c("darkgreen", "grey")) +
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio")

```

```{r emotiondiscoursebegin, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap='Ratios and cumulative ratios for the production of rejection at the discourse level for children between 12 to 24 months of age, and their parents.',warning=FALSE}

subset(discourse_emotion_data_plot, Age<=24) %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c('solid', "dotted")) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(16, 3)) + 
  scale_color_manual(values = c("darkgreen", "grey")) +
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 24, 1)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio")

```
  
### Non-existence

```{r perceptiondata, include=FALSE}

perception <-read.csv('data/perception.txt', header = T, sep = '\t')
# perception <- subset(perception, Subj == 'I' | Subj == 'NONE')
perception$Role[which(perception$Role == "Father")] <- 'Parent'
perception$Role[which(perception$Role == "Mother")] <- 'Parent'
perception$Role[which(perception$Role == "Target_Child")] <- 'Child'

perception_neg = subset(perception, Polarity == 'negative')
perception_pos = subset(perception, Polarity == 'positive')

child_perception_neg <- subset(perception_neg, Role %in% c('Child'))
parent_perception_neg <- subset(perception_neg, Role %in% c('Parent'))

child_existence_neg <- subset(child_perception_neg, Function %in% c('existence'))
child_possession_have_neg <- subset(child_perception_neg, Function %in% c('possession') & Head %in% c('have'))
child_possession_pro_neg <- subset(child_perception_neg, Function %in% c('possession') & Head != 'have')
parent_existence_neg <- subset(parent_perception_neg, Function %in% c('existence'))
parent_possession_have_neg <- subset(parent_perception_neg, Function %in% c('possession') & Head %in% c('have'))
parent_possession_pro_neg <- subset(parent_perception_neg, Function %in% c('possession') & Head != 'have')

child_existence_neg_mlu <- mlu(child_existence_neg)
child_possession_have_neg_mlu <- mlu(child_possession_have_neg)
child_possession_pro_neg_mlu <- mlu(child_possession_pro_neg)
parent_existence_neg_mlu <- mlu(parent_existence_neg)
parent_possession_have_neg_mlu <- mlu(parent_possession_have_neg)
parent_possession_pro_neg_mlu <- mlu(parent_possession_pro_neg)

child_existence_neg <- data.frame(table(child_existence_neg$Age))
names(child_existence_neg) <- c('Age', 'Freq')
child_existence_neg$Role <- rep('Child', nrow(child_existence_neg))
child_existence_neg$Head <- rep('', nrow(child_existence_neg))
temp <- merge(child_existence_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_existence_neg <- temp
child_existence_neg$Total_ratio <- child_existence_neg$Freq / child_existence_neg$N_utterance
child_existence_neg$Ratio <- child_existence_neg$Freq / sum(child_existence_neg$Freq)
child_existence_neg$Polarity <- rep('negative', nrow(child_existence_neg))
child_existence_neg$Measure <- rep('negative construction ratio', nrow(child_existence_neg))
child_existence_neg$Which <- rep('ratio', nrow(child_existence_neg))
child_existence_neg$Function <- rep('Non-existence', nrow(child_existence_neg))
child_existence_neg <- negative_cumulative(child_existence_neg, child_descriptive)


child_possession_have_neg <- data.frame(table(child_possession_have_neg$Age))
names(child_possession_have_neg) <- c('Age', 'Freq')
child_possession_have_neg$Role <- rep('Child', nrow(child_possession_have_neg))
child_possession_have_neg$Head <- rep('have', nrow(child_possession_have_neg))
temp <- merge(child_possession_have_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_possession_have_neg <- temp
child_possession_have_neg$Total_ratio <- child_possession_have_neg$Freq / child_possession_have_neg$N_utterance
child_possession_have_neg$Ratio <- child_possession_have_neg$Freq / sum(child_possession_have_neg$Freq)
child_possession_have_neg$Polarity <- rep('negative', nrow(child_possession_have_neg))
child_possession_have_neg$Measure <- rep('negative construction ratio', nrow(child_possession_have_neg))
child_possession_have_neg$Which <- rep('ratio', nrow(child_possession_have_neg))
child_possession_have_neg$Function <- rep('Possession', nrow(child_possession_have_neg))
child_possession_have_neg <- negative_cumulative(child_possession_have_neg, child_descriptive)

child_possession_pro_neg <- data.frame(table(child_possession_pro_neg$Age))
names(child_possession_pro_neg) <- c('Age', 'Freq')
child_possession_pro_neg$Role <- rep('Child', nrow(child_possession_pro_neg))
child_possession_pro_neg$Head <- rep('pronoun', nrow(child_possession_pro_neg))
temp <- merge(child_possession_pro_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_possession_pro_neg <- temp
child_possession_pro_neg$Total_ratio <- child_possession_pro_neg$Freq / child_possession_pro_neg$N_utterance
child_possession_pro_neg$Ratio <- child_possession_pro_neg$Freq / sum(child_possession_pro_neg$Freq)
child_possession_pro_neg$Polarity <- rep('negative', nrow(child_possession_pro_neg))
child_possession_pro_neg$Measure <- rep('negative construction ratio', nrow(child_possession_pro_neg))
child_possession_pro_neg$Which <- rep('ratio', nrow(child_possession_pro_neg))
child_possession_pro_neg$Function <- rep('Possession', nrow(child_possession_pro_neg))
child_possession_pro_neg <- negative_cumulative(child_possession_pro_neg, child_descriptive)

parent_existence_neg <- data.frame(table(parent_existence_neg$Age))
names(parent_existence_neg) <- c('Age', 'Freq')
parent_existence_neg$Role <- rep('Parent', nrow(parent_existence_neg))
parent_existence_neg$Head <- rep('existence', nrow(parent_existence_neg))
temp <- merge(parent_existence_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_existence_neg <- temp
parent_existence_neg$Total_ratio <- parent_existence_neg$Freq / parent_existence_neg$N_utterance
parent_existence_neg$Ratio <- parent_existence_neg$Freq / sum(parent_existence_neg$Freq)
parent_existence_neg$Polarity <- rep('negative', nrow(parent_existence_neg))
parent_existence_neg$Measure <- rep('negative construction ratio', nrow(parent_existence_neg))
parent_existence_neg$Which <- rep('ratio', nrow(parent_existence_neg))
parent_existence_neg$Function <- rep('Non-existence', nrow(parent_existence_neg))
parent_existence_neg <- negative_cumulative(parent_existence_neg, parent_descriptive)

parent_possession_have_neg <- data.frame(table(parent_possession_have_neg$Age))
names(parent_possession_have_neg) <- c('Age', 'Freq')
parent_possession_have_neg$Role <- rep('Parent', nrow(parent_possession_have_neg))
parent_possession_have_neg$Head <- rep('have', nrow(parent_possession_have_neg))
temp <- merge(parent_possession_have_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_possession_have_neg <- temp
parent_possession_have_neg$Total_ratio <- parent_possession_have_neg$Freq / parent_possession_have_neg$N_utterance
parent_possession_have_neg$Ratio <- parent_possession_have_neg$Freq / sum(parent_possession_have_neg$Freq)
parent_possession_have_neg$Polarity <- rep('negative', nrow(parent_possession_have_neg))
parent_possession_have_neg$Measure <- rep('negative construction ratio', nrow(parent_possession_have_neg))
parent_possession_have_neg$Which <- rep('ratio', nrow(parent_possession_have_neg))
parent_possession_have_neg$Function <- rep('Possession', nrow(parent_possession_have_neg))
parent_possession_have_neg <- negative_cumulative(parent_possession_have_neg, parent_descriptive)

parent_possession_pro_neg <- data.frame(table(parent_possession_pro_neg$Age))
names(parent_possession_pro_neg) <- c('Age', 'Freq')
parent_possession_pro_neg$Role <- rep('Parent', nrow(parent_possession_pro_neg))
parent_possession_pro_neg$Head <- rep('pronoun', nrow(parent_possession_pro_neg))
temp <- merge(parent_possession_pro_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_possession_pro_neg <- temp
parent_possession_pro_neg$Total_ratio <- parent_possession_pro_neg$Freq / parent_possession_pro_neg$N_utterance
parent_possession_pro_neg$Ratio <- parent_possession_pro_neg$Freq / sum(parent_possession_pro_neg$Freq)
parent_possession_pro_neg$Polarity <- rep('negative', nrow(parent_possession_pro_neg))
parent_possession_pro_neg$Measure <- rep('negative construction ratio', nrow(parent_possession_pro_neg))
parent_possession_pro_neg$Which <- rep('ratio', nrow(parent_possession_pro_neg))
parent_possession_pro_neg$Function <- rep('Possession', nrow(parent_possession_pro_neg))
parent_possession_pro_neg <- negative_cumulative(parent_possession_pro_neg, parent_descriptive)

perception_pos = subset(perception, Polarity == 'positive')
perception_pos = subset(perception, Polarity == 'positive')

child_perception_pos <- subset(perception_pos, Role %in% c('Child'))
parent_perception_pos <- subset(perception_pos, Role %in% c('Parent'))

child_existence_pos <- subset(child_perception_pos, Function %in% c('existence'))
child_possession_have_pos <- subset(child_perception_pos, Function %in% c('possession') & Head %in% c('have'))
child_possession_pro_pos <- subset(child_perception_pos, Function %in% c('possession') & Head != 'have')
parent_existence_pos <- subset(parent_perception_pos, Function %in% c('existence'))
parent_possession_have_pos <- subset(parent_perception_pos, Function %in% c('possession') & Head %in% c('have'))
parent_possession_pro_pos <- subset(parent_perception_pos, Function %in% c('possession') & Head != 'have')

child_existence_pos_mlu <- mlu(child_existence_pos)
child_possession_have_pos_mlu <- mlu(child_possession_have_pos)
child_possession_pro_pos_mlu <- mlu(child_possession_pro_pos)
parent_existence_pos_mlu <- mlu(parent_existence_pos)
parent_possession_have_pos_mlu <- mlu(parent_possession_have_pos)
parent_possession_pro_pos_mlu <- mlu(parent_possession_pro_pos)

child_existence_pos <- data.frame(table(child_existence_pos$Age))
names(child_existence_pos) <- c('Age', 'Freq')
child_existence_pos$Role <- rep('Child', nrow(child_existence_pos))
child_existence_pos$Head <- rep('', nrow(child_existence_pos))
temp <- merge(child_existence_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_existence_pos <- temp
child_existence_pos$Total_ratio <- child_existence_pos$Freq / child_existence_pos$N_utterance
child_existence_pos$Ratio <- child_existence_pos$Freq / sum(child_existence_pos$Freq)
child_existence_pos$Polarity <- rep('positive', nrow(child_existence_pos))
child_existence_pos$Measure <- rep('positive construction ratio', nrow(child_existence_pos))
child_existence_pos$Which <- rep('ratio', nrow(child_existence_pos))
child_existence_pos$Function <- rep('Non-existence', nrow(child_existence_pos))
child_existence_pos <- positive_cumulative(child_existence_pos, child_descriptive)


child_possession_have_pos <- data.frame(table(child_possession_have_pos$Age))
names(child_possession_have_pos) <- c('Age', 'Freq')
child_possession_have_pos$Role <- rep('Child', nrow(child_possession_have_pos))
child_possession_have_pos$Head <- rep('have', nrow(child_possession_have_pos))
temp <- merge(child_possession_have_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_possession_have_pos <- temp
child_possession_have_pos$Total_ratio <- child_possession_have_pos$Freq / child_possession_have_pos$N_utterance
child_possession_have_pos$Ratio <- child_possession_have_pos$Freq / sum(child_possession_have_pos$Freq)
child_possession_have_pos$Polarity <- rep('positive', nrow(child_possession_have_pos))
child_possession_have_pos$Measure <- rep('positive construction ratio', nrow(child_possession_have_pos))
child_possession_have_pos$Which <- rep('ratio', nrow(child_possession_have_pos))
child_possession_have_pos$Function <- rep('Possession', nrow(child_possession_have_pos))
child_possession_have_pos <- positive_cumulative(child_possession_have_pos, child_descriptive)

child_possession_pro_pos <- data.frame(table(child_possession_pro_pos$Age))
names(child_possession_pro_pos) <- c('Age', 'Freq')
child_possession_pro_pos$Role <- rep('Child', nrow(child_possession_pro_pos))
child_possession_pro_pos$Head <- rep('pronoun', nrow(child_possession_pro_pos))
temp <- merge(child_possession_pro_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_possession_pro_pos <- temp
child_possession_pro_pos$Total_ratio <- child_possession_pro_pos$Freq / child_possession_pro_pos$N_utterance
child_possession_pro_pos$Ratio <- child_possession_pro_pos$Freq / sum(child_possession_pro_pos$Freq)
child_possession_pro_pos$Polarity <- rep('positive', nrow(child_possession_pro_pos))
child_possession_pro_pos$Measure <- rep('positive construction ratio', nrow(child_possession_pro_pos))
child_possession_pro_pos$Which <- rep('ratio', nrow(child_possession_pro_pos))
child_possession_pro_pos$Function <- rep('Possession', nrow(child_possession_pro_pos))
child_possession_pro_pos <- positive_cumulative(child_possession_pro_pos, child_descriptive)

parent_existence_pos <- data.frame(table(parent_existence_pos$Age))
names(parent_existence_pos) <- c('Age', 'Freq')
parent_existence_pos$Role <- rep('Parent', nrow(parent_existence_pos))
parent_existence_pos$Head <- rep('existence', nrow(parent_existence_pos))
temp <- merge(parent_existence_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_existence_pos <- temp
parent_existence_pos$Total_ratio <- parent_existence_pos$Freq / parent_existence_pos$N_utterance
parent_existence_pos$Ratio <- parent_existence_pos$Freq / sum(parent_existence_pos$Freq)
parent_existence_pos$Polarity <- rep('positive', nrow(parent_existence_pos))
parent_existence_pos$Measure <- rep('positive construction ratio', nrow(parent_existence_pos))
parent_existence_pos$Which <- rep('ratio', nrow(parent_existence_pos))
parent_existence_pos$Function <- rep('Non-existence', nrow(parent_existence_pos))
parent_existence_pos <- positive_cumulative(parent_existence_pos, parent_descriptive)

parent_possession_have_pos <- data.frame(table(parent_possession_have_pos$Age))
names(parent_possession_have_pos) <- c('Age', 'Freq')
parent_possession_have_pos$Role <- rep('Parent', nrow(parent_possession_have_pos))
parent_possession_have_pos$Head <- rep('have', nrow(parent_possession_have_pos))
temp <- merge(parent_possession_have_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_possession_have_pos <- temp
parent_possession_have_pos$Total_ratio <- parent_possession_have_pos$Freq / parent_possession_have_pos$N_utterance
parent_possession_have_pos$Ratio <- parent_possession_have_pos$Freq / sum(parent_possession_have_pos$Freq)
parent_possession_have_pos$Polarity <- rep('positive', nrow(parent_possession_have_pos))
parent_possession_have_pos$Measure <- rep('positive construction ratio', nrow(parent_possession_have_pos))
parent_possession_have_pos$Which <- rep('ratio', nrow(parent_possession_have_pos))
parent_possession_have_pos$Function <- rep('Possession', nrow(parent_possession_have_pos))
parent_possession_have_pos <- positive_cumulative(parent_possession_have_pos, parent_descriptive)

parent_possession_pro_pos <- data.frame(table(parent_possession_pro_pos$Age))
names(parent_possession_pro_pos) <- c('Age', 'Freq')
parent_possession_pro_pos$Role <- rep('Parent', nrow(parent_possession_pro_pos))
parent_possession_pro_pos$Head <- rep('pronoun', nrow(parent_possession_pro_pos))
temp <- merge(parent_possession_pro_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_possession_pro_pos <- temp
parent_possession_pro_pos$Total_ratio <- parent_possession_pro_pos$Freq / parent_possession_pro_pos$N_utterance
parent_possession_pro_pos$Ratio <- parent_possession_pro_pos$Freq / sum(parent_possession_pro_pos$Freq)
parent_possession_pro_pos$Polarity <- rep('positive', nrow(parent_possession_pro_pos))
parent_possession_pro_pos$Measure <- rep('positive construction ratio', nrow(parent_possession_pro_pos))
parent_possession_pro_pos$Which <- rep('ratio', nrow(parent_possession_pro_pos))
parent_possession_pro_pos$Function <- rep('Possession', nrow(parent_possession_pro_pos))
parent_possession_pro_pos <- positive_cumulative(parent_possession_pro_pos, parent_descriptive)


perception_data <- rbind(child_existence_neg, child_existence_pos, parent_existence_neg, parent_existence_pos, child_possession_have_neg, child_possession_have_pos, parent_possession_have_neg, parent_possession_have_pos, child_possession_pro_neg, child_possession_pro_pos, parent_possession_pro_neg, parent_possession_pro_pos)

perception_data$Measure <- factor(perception_data$Measure, levels = c('negative construction ratio', 'negative construction cumulative ratio', 'positive construction ratio', 'positive construction cumulative ratio'))

perception_data_child <- subset(perception_data, Role == 'Child')
perception_data_parent <- subset(perception_data, Role == 'Parent')

existence_data <- subset(perception_data, Function == 'Non-existence')
possession_data <- subset(perception_data, Function == 'Possession')

existence_data_child <- subset(existence_data, Role == 'Child')
existence_data_parent <- subset(existence_data, Role == 'Parent')

possession_data_child <- subset(possession_data, Role == 'Child')
possession_data_parent <- subset(possession_data, Role == 'Parent')

```

```{r perceptionuldata, include=FALSE}

child_ul_existence_neg <- subset(child_perception_neg, Function %in% c('existence'))
child_ul_possession_have_neg <- subset(child_perception_neg, Function %in% c('possession') & Head %in% c('have'))
child_ul_possession_pro_neg <- subset(child_perception_neg, Function %in% c('possession') & Head != 'have')
parent_ul_existence_neg <- subset(parent_perception_neg, Function %in% c('existence'))
parent_ul_possession_have_neg <- subset(parent_perception_neg, Function %in% c('possession') & Head %in% c('have'))
parent_ul_possession_pro_neg <- subset(parent_perception_neg, Function %in% c('possession') & Head != 'have')

child_ul_existence_neg <- data.frame(table(child_ul_existence_neg$Sent_len))
names(child_ul_existence_neg) <- c('Sent_len', 'Freq')
child_ul_existence_neg$Role <- rep('Child', nrow(child_ul_existence_neg))
child_ul_existence_neg$Head <- rep('', nrow(child_ul_existence_neg))
temp <- merge(child_ul_existence_neg, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_existence_neg <- temp
child_ul_existence_neg$Total_ratio <- child_ul_existence_neg$Freq / child_ul_existence_neg$N_utterance
child_ul_existence_neg$Ratio <- child_ul_existence_neg$Freq / sum(child_ul_existence_neg$Freq)
child_ul_existence_neg$Polarity <- rep('negative', nrow(child_ul_existence_neg))
child_ul_existence_neg$Measure <- rep('negative construction ratio', nrow(child_ul_existence_neg))
child_ul_existence_neg$Which <- rep('ratio', nrow(child_ul_existence_neg))
child_ul_existence_neg$Function <- rep('Non-existence', nrow(child_ul_existence_neg))
child_ul_existence_neg <- negative_ul_cumulative(child_ul_existence_neg, child_ul_descriptive)


child_ul_possession_have_neg <- data.frame(table(child_ul_possession_have_neg$Sent_len))
names(child_ul_possession_have_neg) <- c('Sent_len', 'Freq')
child_ul_possession_have_neg$Role <- rep('Child', nrow(child_ul_possession_have_neg))
child_ul_possession_have_neg$Head <- rep('have', nrow(child_ul_possession_have_neg))
temp <- merge(child_ul_possession_have_neg, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_possession_have_neg <- temp
child_ul_possession_have_neg$Total_ratio <- child_ul_possession_have_neg$Freq / child_ul_possession_have_neg$N_utterance
child_ul_possession_have_neg$Ratio <- child_ul_possession_have_neg$Freq / sum(child_ul_possession_have_neg$Freq)
child_ul_possession_have_neg$Polarity <- rep('negative', nrow(child_ul_possession_have_neg))
child_ul_possession_have_neg$Measure <- rep('negative construction ratio', nrow(child_ul_possession_have_neg))
child_ul_possession_have_neg$Which <- rep('ratio', nrow(child_ul_possession_have_neg))
child_ul_possession_have_neg$Function <- rep('Possession', nrow(child_ul_possession_have_neg))
child_ul_possession_have_neg <- negative_ul_cumulative(child_ul_possession_have_neg, child_ul_descriptive)

child_ul_possession_pro_neg <- data.frame(table(child_ul_possession_pro_neg$Sent_len))
names(child_ul_possession_pro_neg) <- c('Sent_len', 'Freq')
child_ul_possession_pro_neg$Role <- rep('Child', nrow(child_ul_possession_pro_neg))
child_ul_possession_pro_neg$Head <- rep('pronoun', nrow(child_ul_possession_pro_neg))
temp <- merge(child_ul_possession_pro_neg, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_possession_pro_neg <- temp
child_ul_possession_pro_neg$Total_ratio <- child_ul_possession_pro_neg$Freq / child_ul_possession_pro_neg$N_utterance
child_ul_possession_pro_neg$Ratio <- child_ul_possession_pro_neg$Freq / sum(child_ul_possession_pro_neg$Freq)
child_ul_possession_pro_neg$Polarity <- rep('negative', nrow(child_ul_possession_pro_neg))
child_ul_possession_pro_neg$Measure <- rep('negative construction ratio', nrow(child_ul_possession_pro_neg))
child_ul_possession_pro_neg$Which <- rep('ratio', nrow(child_ul_possession_pro_neg))
child_ul_possession_pro_neg$Function <- rep('Possession', nrow(child_ul_possession_pro_neg))
child_ul_possession_pro_neg <- negative_ul_cumulative(child_ul_possession_pro_neg, child_ul_descriptive)

parent_ul_existence_neg <- data.frame(table(parent_ul_existence_neg$Sent_len))
names(parent_ul_existence_neg) <- c('Sent_len', 'Freq')
parent_ul_existence_neg$Role <- rep('Parent', nrow(parent_ul_existence_neg))
parent_ul_existence_neg$Head <- rep('existence', nrow(parent_ul_existence_neg))
temp <- merge(parent_ul_existence_neg, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_existence_neg <- temp
parent_ul_existence_neg$Total_ratio <- parent_ul_existence_neg$Freq / parent_ul_existence_neg$N_utterance
parent_ul_existence_neg$Ratio <- parent_ul_existence_neg$Freq / sum(parent_ul_existence_neg$Freq)
parent_ul_existence_neg$Polarity <- rep('negative', nrow(parent_ul_existence_neg))
parent_ul_existence_neg$Measure <- rep('negative construction ratio', nrow(parent_ul_existence_neg))
parent_ul_existence_neg$Which <- rep('ratio', nrow(parent_ul_existence_neg))
parent_ul_existence_neg$Function <- rep('Non-existence', nrow(parent_ul_existence_neg))
parent_ul_existence_neg <- negative_ul_cumulative(parent_ul_existence_neg, parent_ul_descriptive)

parent_ul_possession_have_neg <- data.frame(table(parent_ul_possession_have_neg$Sent_len))
names(parent_ul_possession_have_neg) <- c('Sent_len', 'Freq')
parent_ul_possession_have_neg$Role <- rep('Parent', nrow(parent_ul_possession_have_neg))
parent_ul_possession_have_neg$Head <- rep('have', nrow(parent_ul_possession_have_neg))
temp <- merge(parent_ul_possession_have_neg, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_possession_have_neg <- temp
parent_ul_possession_have_neg$Total_ratio <- parent_ul_possession_have_neg$Freq / parent_ul_possession_have_neg$N_utterance
parent_ul_possession_have_neg$Ratio <- parent_ul_possession_have_neg$Freq / sum(parent_ul_possession_have_neg$Freq)
parent_ul_possession_have_neg$Polarity <- rep('negative', nrow(parent_ul_possession_have_neg))
parent_ul_possession_have_neg$Measure <- rep('negative construction ratio', nrow(parent_ul_possession_have_neg))
parent_ul_possession_have_neg$Which <- rep('ratio', nrow(parent_ul_possession_have_neg))
parent_ul_possession_have_neg$Function <- rep('Possession', nrow(parent_ul_possession_have_neg))
parent_ul_possession_have_neg <- negative_ul_cumulative(parent_ul_possession_have_neg, parent_ul_descriptive)

parent_ul_possession_pro_neg <- data.frame(table(parent_ul_possession_pro_neg$Sent_len))
names(parent_ul_possession_pro_neg) <- c('Sent_len', 'Freq')
parent_ul_possession_pro_neg$Role <- rep('Parent', nrow(parent_ul_possession_pro_neg))
parent_ul_possession_pro_neg$Head <- rep('pronoun', nrow(parent_ul_possession_pro_neg))
temp <- merge(parent_ul_possession_pro_neg, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_possession_pro_neg <- temp
parent_ul_possession_pro_neg$Total_ratio <- parent_ul_possession_pro_neg$Freq / parent_ul_possession_pro_neg$N_utterance
parent_ul_possession_pro_neg$Ratio <- parent_ul_possession_pro_neg$Freq / sum(parent_ul_possession_pro_neg$Freq)
parent_ul_possession_pro_neg$Polarity <- rep('negative', nrow(parent_ul_possession_pro_neg))
parent_ul_possession_pro_neg$Measure <- rep('negative construction ratio', nrow(parent_ul_possession_pro_neg))
parent_ul_possession_pro_neg$Which <- rep('ratio', nrow(parent_ul_possession_pro_neg))
parent_ul_possession_pro_neg$Function <- rep('Possession', nrow(parent_ul_possession_pro_neg))
parent_ul_possession_pro_neg <- negative_ul_cumulative(parent_ul_possession_pro_neg, parent_ul_descriptive)


child_ul_existence_pos <- subset(child_perception_pos, Function %in% c('existence'))
child_ul_possession_have_pos <- subset(child_perception_pos, Function %in% c('possession') & Head %in% c('have'))
child_ul_possession_pro_pos <- subset(child_perception_pos, Function %in% c('possession') & Head != 'have')
parent_ul_existence_pos <- subset(parent_perception_pos, Function %in% c('existence'))
parent_ul_possession_have_pos <- subset(parent_perception_pos, Function %in% c('possession') & Head %in% c('have'))
parent_ul_possession_pro_pos <- subset(parent_perception_pos, Function %in% c('possession') & Head != 'have')


child_ul_existence_pos <- data.frame(table(child_ul_existence_pos$Sent_len))
names(child_ul_existence_pos) <- c('Sent_len', 'Freq')
child_ul_existence_pos$Role <- rep('Child', nrow(child_ul_existence_pos))
child_ul_existence_pos$Head <- rep('', nrow(child_ul_existence_pos))
temp <- merge(child_ul_existence_pos, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_existence_pos <- temp
child_ul_existence_pos$Total_ratio <- child_ul_existence_pos$Freq / child_ul_existence_pos$N_utterance
child_ul_existence_pos$Ratio <- child_ul_existence_pos$Freq / sum(child_ul_existence_pos$Freq)
child_ul_existence_pos$Polarity <- rep('positive', nrow(child_ul_existence_pos))
child_ul_existence_pos$Measure <- rep('positive construction ratio', nrow(child_ul_existence_pos))
child_ul_existence_pos$Which <- rep('ratio', nrow(child_ul_existence_pos))
child_ul_existence_pos$Function <- rep('Non-existence', nrow(child_ul_existence_pos))
child_ul_existence_pos <- positive_ul_cumulative(child_ul_existence_pos, child_ul_descriptive)


child_ul_possession_have_pos <- data.frame(table(child_ul_possession_have_pos$Sent_len))
names(child_ul_possession_have_pos) <- c('Sent_len', 'Freq')
child_ul_possession_have_pos$Role <- rep('Child', nrow(child_ul_possession_have_pos))
child_ul_possession_have_pos$Head <- rep('have', nrow(child_ul_possession_have_pos))
temp <- merge(child_ul_possession_have_pos, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_possession_have_pos <- temp
child_ul_possession_have_pos$Total_ratio <- child_ul_possession_have_pos$Freq / child_ul_possession_have_pos$N_utterance
child_ul_possession_have_pos$Ratio <- child_ul_possession_have_pos$Freq / sum(child_ul_possession_have_pos$Freq)
child_ul_possession_have_pos$Polarity <- rep('positive', nrow(child_ul_possession_have_pos))
child_ul_possession_have_pos$Measure <- rep('positive construction ratio', nrow(child_ul_possession_have_pos))
child_ul_possession_have_pos$Which <- rep('ratio', nrow(child_ul_possession_have_pos))
child_ul_possession_have_pos$Function <- rep('Possession', nrow(child_ul_possession_have_pos))
child_ul_possession_have_pos <- positive_ul_cumulative(child_ul_possession_have_pos, child_ul_descriptive)

child_ul_possession_pro_pos <- data.frame(table(child_ul_possession_pro_pos$Sent_len))
names(child_ul_possession_pro_pos) <- c('Sent_len', 'Freq')
child_ul_possession_pro_pos$Role <- rep('Child', nrow(child_ul_possession_pro_pos))
child_ul_possession_pro_pos$Head <- rep('pronoun', nrow(child_ul_possession_pro_pos))
temp <- merge(child_ul_possession_pro_pos, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_possession_pro_pos <- temp
child_ul_possession_pro_pos$Total_ratio <- child_ul_possession_pro_pos$Freq / child_ul_possession_pro_pos$N_utterance
child_ul_possession_pro_pos$Ratio <- child_ul_possession_pro_pos$Freq / sum(child_ul_possession_pro_pos$Freq)
child_ul_possession_pro_pos$Polarity <- rep('positive', nrow(child_ul_possession_pro_pos))
child_ul_possession_pro_pos$Measure <- rep('positive construction ratio', nrow(child_ul_possession_pro_pos))
child_ul_possession_pro_pos$Which <- rep('ratio', nrow(child_ul_possession_pro_pos))
child_ul_possession_pro_pos$Function <- rep('Possession', nrow(child_ul_possession_pro_pos))
child_ul_possession_pro_pos <- positive_ul_cumulative(child_ul_possession_pro_pos, child_ul_descriptive)

parent_ul_existence_pos <- data.frame(table(parent_ul_existence_pos$Sent_len))
names(parent_ul_existence_pos) <- c('Sent_len', 'Freq')
parent_ul_existence_pos$Role <- rep('Parent', nrow(parent_ul_existence_pos))
parent_ul_existence_pos$Head <- rep('existence', nrow(parent_ul_existence_pos))
temp <- merge(parent_ul_existence_pos, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_existence_pos <- temp
parent_ul_existence_pos$Total_ratio <- parent_ul_existence_pos$Freq / parent_ul_existence_pos$N_utterance
parent_ul_existence_pos$Ratio <- parent_ul_existence_pos$Freq / sum(parent_ul_existence_pos$Freq)
parent_ul_existence_pos$Polarity <- rep('positive', nrow(parent_ul_existence_pos))
parent_ul_existence_pos$Measure <- rep('positive construction ratio', nrow(parent_ul_existence_pos))
parent_ul_existence_pos$Which <- rep('ratio', nrow(parent_ul_existence_pos))
parent_ul_existence_pos$Function <- rep('Non-existence', nrow(parent_ul_existence_pos))
parent_ul_existence_pos <- positive_ul_cumulative(parent_ul_existence_pos, parent_ul_descriptive)

parent_ul_possession_have_pos <- data.frame(table(parent_ul_possession_have_pos$Sent_len))
names(parent_ul_possession_have_pos) <- c('Sent_len', 'Freq')
parent_ul_possession_have_pos$Role <- rep('Parent', nrow(parent_ul_possession_have_pos))
parent_ul_possession_have_pos$Head <- rep('have', nrow(parent_ul_possession_have_pos))
temp <- merge(parent_ul_possession_have_pos, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_possession_have_pos <- temp
parent_ul_possession_have_pos$Total_ratio <- parent_ul_possession_have_pos$Freq / parent_ul_possession_have_pos$N_utterance
parent_ul_possession_have_pos$Ratio <- parent_ul_possession_have_pos$Freq / sum(parent_ul_possession_have_pos$Freq)
parent_ul_possession_have_pos$Polarity <- rep('positive', nrow(parent_ul_possession_have_pos))
parent_ul_possession_have_pos$Measure <- rep('positive construction ratio', nrow(parent_ul_possession_have_pos))
parent_ul_possession_have_pos$Which <- rep('ratio', nrow(parent_ul_possession_have_pos))
parent_ul_possession_have_pos$Function <- rep('Possession', nrow(parent_ul_possession_have_pos))
parent_ul_possession_have_pos <- positive_ul_cumulative(parent_ul_possession_have_pos, parent_ul_descriptive)

parent_ul_possession_pro_pos <- data.frame(table(parent_ul_possession_pro_pos$Sent_len))
names(parent_ul_possession_pro_pos) <- c('Sent_len', 'Freq')
parent_ul_possession_pro_pos$Role <- rep('Parent', nrow(parent_ul_possession_pro_pos))
parent_ul_possession_pro_pos$Head <- rep('pronoun', nrow(parent_ul_possession_pro_pos))
temp <- merge(parent_ul_possession_pro_pos, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_possession_pro_pos <- temp
parent_ul_possession_pro_pos$Total_ratio <- parent_ul_possession_pro_pos$Freq / parent_ul_possession_pro_pos$N_utterance
parent_ul_possession_pro_pos$Ratio <- parent_ul_possession_pro_pos$Freq / sum(parent_ul_possession_pro_pos$Freq)
parent_ul_possession_pro_pos$Polarity <- rep('positive', nrow(parent_ul_possession_pro_pos))
parent_ul_possession_pro_pos$Measure <- rep('positive construction ratio', nrow(parent_ul_possession_pro_pos))
parent_ul_possession_pro_pos$Which <- rep('ratio', nrow(parent_ul_possession_pro_pos))
parent_ul_possession_pro_pos$Function <- rep('Possession', nrow(parent_ul_possession_pro_pos))
parent_ul_possession_pro_pos <- positive_ul_cumulative(parent_ul_possession_pro_pos, parent_ul_descriptive)


perception_ul_data <- rbind(child_ul_existence_neg, child_ul_existence_pos, parent_ul_existence_neg, parent_ul_existence_pos, child_ul_possession_have_neg, child_ul_possession_have_pos, parent_ul_possession_have_neg, parent_ul_possession_have_pos, child_ul_possession_pro_neg, child_ul_possession_pro_pos, parent_ul_possession_pro_neg, parent_ul_possession_pro_pos)

perception_ul_data$Measure <- factor(perception_ul_data$Measure, levels = c('negative construction ratio', 'negative construction cumulative ratio', 'positive construction ratio', 'positive construction cumulative ratio'))

perception_ul_data_child <- subset(perception_ul_data, Role == 'Child')
perception_ul_data_parent <- subset(perception_ul_data, Role == 'Parent')

existence_ul_data <- subset(perception_ul_data, Function == 'Non-existence')
possession_ul_data <- subset(perception_ul_data, Function == 'Possession')

existence_ul_data_child <- subset(existence_ul_data, Role == 'Child')
existence_ul_data_parent <- subset(existence_ul_data, Role == 'Parent')

possession_ul_data_child <- subset(possession_ul_data, Role == 'Child')
possession_ul_data_parent <- subset(possession_ul_data, Role == 'Parent')

```

```{r discourseperceptiondata, include=FALSE}

discourse_perception <-read.csv('data/perception_discourse.txt', header = T, sep = '\t')
# perception <- subset(perception, Subj == 'I' | Subj == 'NONE')
discourse_perception$Role[which(discourse_perception$Role == "Father")] <- 'Parent'
discourse_perception$Role[which(discourse_perception$Role == "Mother")] <- 'Parent'
discourse_perception$Role[which(discourse_perception$Role == "Target_Child")] <- 'Child'

discourse_perception_neg = subset(discourse_perception, Polarity == 'negative')
discourse_perception_pos = subset(discourse_perception, Polarity == 'positive')

discourse_child_perception_neg <- subset(discourse_perception_neg, Role %in% c('Child'))
discourse_parent_perception_neg <- subset(discourse_perception_neg, Role %in% c('Parent'))

discourse_child_existence_neg <- subset(discourse_child_perception_neg, Function %in% c('existence'))
discourse_child_possession_neg <- subset(discourse_child_perception_neg, Function %in% c('possession'))
discourse_parent_existence_neg <- subset(discourse_parent_perception_neg, Function %in% c('existence'))
discourse_parent_possession_neg <- subset(discourse_parent_perception_neg, Function %in% c('possession'))

discourse_child_existence_neg <- data.frame(table(discourse_child_existence_neg$Age))
names(discourse_child_existence_neg) <- c('Age', 'Freq')
discourse_child_existence_neg$Role <- rep('Child', nrow(discourse_child_existence_neg))
discourse_child_existence_neg$Head <- rep('', nrow(discourse_child_existence_neg))
temp <- merge(discourse_child_existence_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_existence_neg <- temp
discourse_child_existence_neg$Total_ratio <- discourse_child_existence_neg$Freq / discourse_child_existence_neg$N_utterance
discourse_child_existence_neg$Ratio <- discourse_child_existence_neg$Freq / sum(discourse_child_existence_neg$Freq)
discourse_child_existence_neg$Polarity <- rep('negative', nrow(discourse_child_existence_neg))
discourse_child_existence_neg$Measure <- rep('negative construction ratio', nrow(discourse_child_existence_neg))
discourse_child_existence_neg$Which <- rep('ratio', nrow(discourse_child_existence_neg))
discourse_child_existence_neg$Function <- rep('Non-existence', nrow(discourse_child_existence_neg))
discourse_child_existence_neg <- negative_cumulative(discourse_child_existence_neg, child_descriptive)


discourse_child_possession_neg <- data.frame(table(discourse_child_possession_neg$Age))
names(discourse_child_possession_neg) <- c('Age', 'Freq')
discourse_child_possession_neg$Role <- rep('Child', nrow(discourse_child_possession_neg))
discourse_child_possession_neg$Head <- rep('have', nrow(discourse_child_possession_neg))
temp <- merge(discourse_child_possession_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_possession_neg <- temp
discourse_child_possession_neg$Total_ratio <- discourse_child_possession_neg$Freq / discourse_child_possession_neg$N_utterance
discourse_child_possession_neg$Ratio <- discourse_child_possession_neg$Freq / sum(discourse_child_possession_neg$Freq)
discourse_child_possession_neg$Polarity <- rep('negative', nrow(discourse_child_possession_neg))
discourse_child_possession_neg$Measure <- rep('negative construction ratio', nrow(discourse_child_possession_neg))
discourse_child_possession_neg$Which <- rep('ratio', nrow(discourse_child_possession_neg))
discourse_child_possession_neg$Function <- rep('Possession', nrow(discourse_child_possession_neg))
discourse_child_possession_neg <- negative_cumulative(discourse_child_possession_neg, child_descriptive)


discourse_parent_existence_neg <- data.frame(table(discourse_parent_existence_neg$Age))
names(discourse_parent_existence_neg) <- c('Age', 'Freq')
discourse_parent_existence_neg$Role <- rep('Parent', nrow(discourse_parent_existence_neg))
discourse_parent_existence_neg$Head <- rep('existence', nrow(discourse_parent_existence_neg))
temp <- merge(discourse_parent_existence_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_existence_neg <- temp
discourse_parent_existence_neg$Total_ratio <- discourse_parent_existence_neg$Freq / discourse_parent_existence_neg$N_utterance
discourse_parent_existence_neg$Ratio <- discourse_parent_existence_neg$Freq / sum(discourse_parent_existence_neg$Freq)
discourse_parent_existence_neg$Polarity <- rep('negative', nrow(discourse_parent_existence_neg))
discourse_parent_existence_neg$Measure <- rep('negative construction ratio', nrow(discourse_parent_existence_neg))
discourse_parent_existence_neg$Which <- rep('ratio', nrow(discourse_parent_existence_neg))
discourse_parent_existence_neg$Function <- rep('Non-existence', nrow(discourse_parent_existence_neg))
discourse_parent_existence_neg <- negative_cumulative(discourse_parent_existence_neg, parent_descriptive)

discourse_parent_possession_neg <- data.frame(table(discourse_parent_possession_neg$Age))
names(discourse_parent_possession_neg) <- c('Age', 'Freq')
discourse_parent_possession_neg$Role <- rep('Parent', nrow(discourse_parent_possession_neg))
discourse_parent_possession_neg$Head <- rep('have', nrow(discourse_parent_possession_neg))
temp <- merge(discourse_parent_possession_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_possession_neg <- temp
discourse_parent_possession_neg$Total_ratio <- discourse_parent_possession_neg$Freq / discourse_parent_possession_neg$N_utterance
discourse_parent_possession_neg$Ratio <- discourse_parent_possession_neg$Freq / sum(discourse_parent_possession_neg$Freq)
discourse_parent_possession_neg$Polarity <- rep('negative', nrow(discourse_parent_possession_neg))
discourse_parent_possession_neg$Measure <- rep('negative construction ratio', nrow(discourse_parent_possession_neg))
discourse_parent_possession_neg$Which <- rep('ratio', nrow(discourse_parent_possession_neg))
discourse_parent_possession_neg$Function <- rep('Possession', nrow(discourse_parent_possession_neg))
discourse_parent_possession_neg <- negative_cumulative(discourse_parent_possession_neg, parent_descriptive)


discourse_child_perception_pos <- subset(discourse_perception_pos, Role %in% c('Child'))
discourse_parent_perception_pos <- subset(discourse_perception_pos, Role %in% c('Parent'))

discourse_child_existence_pos <- subset(discourse_child_perception_pos, Function %in% c('existence'))
#discourse_child_possession_pos <- subset(discourse_child_perception_pos, Function %in% c('possession'))

discourse_parent_existence_pos <- subset(discourse_parent_perception_pos, Function %in% c('existence'))
#discourse_parent_possession_pos <- subset(discourse_parent_perception_pos, Function %in% c('possession'))


discourse_child_existence_pos <- data.frame(table(discourse_child_existence_pos$Age))
names(discourse_child_existence_pos) <- c('Age', 'Freq')
discourse_child_existence_pos$Role <- rep('Child', nrow(discourse_child_existence_pos))
discourse_child_existence_pos$Head <- rep('', nrow(discourse_child_existence_pos))
temp <- merge(discourse_child_existence_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_existence_pos <- temp
discourse_child_existence_pos$Total_ratio <- discourse_child_existence_pos$Freq / discourse_child_existence_pos$N_utterance
discourse_child_existence_pos$Ratio <- discourse_child_existence_pos$Freq / sum(discourse_child_existence_pos$Freq)
discourse_child_existence_pos$Polarity <- rep('positive', nrow(discourse_child_existence_pos))
discourse_child_existence_pos$Measure <- rep('positive construction ratio', nrow(discourse_child_existence_pos))
discourse_child_existence_pos$Which <- rep('ratio', nrow(discourse_child_existence_pos))
discourse_child_existence_pos$Function <- rep('Non-existence', nrow(discourse_child_existence_pos))
discourse_child_existence_pos <- positive_cumulative(discourse_child_existence_pos, child_descriptive)


#discourse_child_possession_pos <- data.frame(table(discourse_child_possession_pos$Age))
#names(discourse_child_possession_pos) <- c('Age', 'Freq')
#discourse_child_possession_pos$Role <- rep('Child', nrow(discourse_child_possession_pos))
#discourse_child_possession_pos$Head <- rep('have', nrow(discourse_child_possession_pos))
#temp <- merge(discourse_child_possession_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
#discourse_child_possession_pos <- temp
#discourse_child_possession_pos$Total_ratio <- discourse_child_possession_pos$Freq / discourse_child_possession_pos$N_utterance
#discourse_child_possession_pos$Ratio <- discourse_child_possession_pos$Freq / sum(discourse_child_possession_pos$Freq)
#discourse_child_possession_pos$Polarity <- rep('positive', nrow(discourse_child_possession_pos))
#discourse_child_possession_pos$Measure <- rep('positive construction ratio', nrow(discourse_child_possession_pos))
#discourse_child_possession_pos$Which <- rep('ratio', nrow(discourse_child_possession_pos))
#discourse_child_possession_pos$Function <- rep('Possession', #nrow(discourse_child_possession_pos))
#discourse_child_possession_pos <- positive_cumulative(discourse_child_possession_pos, child_descriptive)

discourse_parent_existence_pos <- data.frame(table(discourse_parent_existence_pos$Age))
names(discourse_parent_existence_pos) <- c('Age', 'Freq')
discourse_parent_existence_pos$Role <- rep('Parent', nrow(discourse_parent_existence_pos))
discourse_parent_existence_pos$Head <- rep('existence', nrow(discourse_parent_existence_pos))
temp <- merge(discourse_parent_existence_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_existence_pos <- temp
discourse_parent_existence_pos$Total_ratio <- discourse_parent_existence_pos$Freq / discourse_parent_existence_pos$N_utterance
discourse_parent_existence_pos$Ratio <- discourse_parent_existence_pos$Freq / sum(discourse_parent_existence_pos$Freq)
discourse_parent_existence_pos$Polarity <- rep('positive', nrow(discourse_parent_existence_pos))
discourse_parent_existence_pos$Measure <- rep('positive construction ratio', nrow(discourse_parent_existence_pos))
discourse_parent_existence_pos$Which <- rep('ratio', nrow(discourse_parent_existence_pos))
discourse_parent_existence_pos$Function <- rep('Non-existence', nrow(discourse_parent_existence_pos))
discourse_parent_existence_pos <- positive_cumulative(discourse_parent_existence_pos, parent_descriptive)


#discourse_parent_possession_pos <- data.frame(table(discourse_parent_possession_pos$Age))
#names(discourse_parent_possession_pos) <- c('Age', 'Freq')
#discourse_parent_possession_pos$Role <- rep('Parent', nrow(discourse_parent_possession_pos))
#discourse_parent_possession_pos$Head <- rep('have', nrow(discourse_parent_possession_pos))
#temp <- merge(discourse_parent_possession_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
#discourse_parent_possession_pos <- temp
#discourse_parent_possession_pos$Total_ratio <- discourse_parent_possession_pos$Freq / discourse_parent_possession_pos$N_utterance
#discourse_parent_possession_pos$Ratio <- discourse_parent_possession_pos$Freq / sum(discourse_parent_possession_pos$Freq)
#discourse_parent_possession_pos$Polarity <- rep('positive', nrow(discourse_parent_possession_pos))
#discourse_parent_possession_pos$Measure <- rep('positive construction ratio', nrow(discourse_parent_possession_pos))
#discourse_parent_possession_pos$Which <- rep('ratio', nrow(discourse_parent_possession_pos))
#discourse_parent_possession_pos$Function <- rep('Possession', nrow(discourse_parent_possession_pos))
#discourse_parent_possession_pos <- positive_cumulative(discourse_parent_possession_pos, parent_descriptive)


discourse_perception_data <- rbind(discourse_child_existence_neg, discourse_child_existence_pos, discourse_parent_existence_neg, discourse_parent_existence_pos, discourse_child_possession_neg, discourse_parent_possession_neg)

discourse_perception_data$Measure <- factor(discourse_perception_data$Measure, c('negative construction ratio', 'negative construction cumulative ratio', 'positive construction ratio', 'positive construction cumulative ratio'))

discourse_perception_data_child <- subset(discourse_perception_data, Role == 'Child')
discourse_perception_data_parent <- subset(discourse_perception_data, Role == 'Parent')

discourse_existence_data <- subset(discourse_perception_data, Function == 'Non-existence')
discourse_possession_data <- subset(discourse_perception_data, Function == 'Possession')

discourse_existence_data_child <- subset(discourse_existence_data, Role == 'Child')
discourse_existence_data_parent <- subset(discourse_existence_data, Role == 'Parent')

discourse_possession_data_child <- subset(discourse_possession_data, Role == 'Child')
discourse_possession_data_parent <- subset(discourse_possession_data, Role == 'Parent')

discourse_existence_data_plot <- aggregate(Total_ratio~Age+Which+Role,data=discourse_existence_data,sum)

names(discourse_existence_data_plot) <- c('Age', 'Measure', 'Role', 'Total_ratio')

discourse_possession_data_plot <- aggregate(Total_ratio~Age+Which+Role,data=discourse_possession_data,sum)

names(discourse_possession_data_plot) <- c('Age', 'Measure', 'Role', 'Total_ratio')

```

For this function we searched for the English existential construction and extracted utterances that had *there*-expletives, followed by a copula, and a noun phrase (phrases headed by either nouns or pronouns). We classified utterances where the predicate was modified by negation as negative, and the rest as positive. This led to a total of `r format(sum(subset(existence_data, Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")` negative utterances  (child: `r format(sum(subset(existence_data_child, Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`; parent: `r format(sum(subset(existence_data_parent, Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`), and a total of `r format(sum(subset(existence_data,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")` positive utterances (child: `r format(sum(subset(existence_data_child,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`; parent: `r format(sum(subset(existence_data_parent,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`).

|Non-existence (Negative)| Existentials (Positive)|
|----------------|----------------|
|*there's no (more) water* | *there are books*|
|*there isn't it* | *there is it*|
Table: (\#tab:nonexist) Examples of sentence-level non-existence (negative) and positive counterparts in children's speech.

At the sentence level, children produced negative constructions to express non-existence less frequently than the positive counterparts. As Figure \@ref(fig:existence) shows, the cumulative ratio for the production of non-existence increases from 18 to 36 months. Around and after 36 months of age, children's productions reaches a stable cumulative ratio close to that of adults. Notice that there appears to be fluctuations of cumulative ratios between the age of 19 and 25 months in child production. A closer inspection of the data reveals that within that age range, the frequency of negative utterances at most ages is either one or zero. Therefore while the number of total utterances increases along the developmental trajectory, the cumulative ratio for negative utterances actually decreases.

```{r existence, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap='Ratios and cumulative ratios for the production of non-existence at the sentence level for children between 12 to 72 months of age, and their parents.'}

existence_data %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) + 
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") + 
  guides(linetype = guide_legend(nrow = 2))

```

```{r existencebegin, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap='Ratios and cumulative ratios for the production of non-existence at the sentence level for children between 12 to 24 months of age, and their parents.'}

subset(existence_data, Age<=24) %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) + 
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 24, 1)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") + 
  guides(linetype = guide_legend(nrow = 2))

```

<!--
```{r existenceul, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap='Non-existence and its positive counterparts, indexed by utterance length.'}

existence_ul_data %>% 
  ggplot(aes(as.numeric(as.character(Sent_len)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) + 
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 130, 10)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("utterance length") + 
  ylab("production ratio") + 
  guides(linetype = guide_legend(nrow = 2))

```
-->

For non-existence at the discourse level, we applied similar selection criteria and extracted negative utterances with existential constructions in their antecedents (Table \@ref(tab:disexist)). This led to a total of `r format(sum(subset(discourse_existence_data, Which=='ratio')$Freq), big.mark=",")` utterances  (child: `r format(sum(subset(discourse_existence_data_child, Which=='ratio')$Freq), big.mark=",")`; parent: `r format(sum(subset(discourse_existence_data_parent, Which=='ratio')$Freq), big.mark=",")`). As Figure \@ref(fig:exstencediscourse) shows, we could find an increase in children's responses with *no* to parents' existential utterances between the ages of 18 and 36 months. After 36 months, despite the fact that ratios show considerable fluctuations, the cumulative ratios of parents and children seem stable and similar. Therefore with non-existence, both sentence level and discourse level analyses point to substantial development in the age rage of 18-36 months.

|Antecedent|Utterance|
|------------|------------|
|Parent: *is there a bunny*|Child: *no no bunny*|
|Child: *there is my ball*|Parent: *no that's not yours*|
Table: (\#tab:disexist) Examples of discourse-level non-existence and their antecedents in parents' and children's speech.

```{r existencediscourse, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap='Ratios and cumulative ratios for the production of non-existence at the discourse level for children between 12 to 72 months of age, and their parents.',warning=FALSE}

discourse_existence_data_plot %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c('solid', 'dotted')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(16, 3)) +
  scale_color_manual(values = c("darkgreen", "grey")) + 
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") 

```

```{r existencediscoursebegin, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap='Ratios and cumulative ratios for the production of non-existence at the discourse level for children between 12 to 24 months of age, and their parents.',warning=FALSE}

subset(discourse_existence_data_plot, Age<=24) %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c('solid', 'dotted')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(16, 3)) +
  scale_color_manual(values = c("darkgreen", "grey")) + 
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 24, 1)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") 

```

### Prohibition

```{r motordata, include=FALSE}

motor <-read.csv('data/motor.txt', header = T, sep = '\t')
# motor <- subset(motor, Subj == 'I' | Subj == 'NONE')
motor$Role[which(motor$Role == "Father")] <- 'Parent'
motor$Role[which(motor$Role == "Mother")] <- 'Parent'
motor$Role[which(motor$Role == "Target_Child")] <- 'Child'

motor_neg = subset(motor, Polarity == 'negative')
motor_pos = subset(motor, Polarity == 'positive')

child_motor_neg <- subset(motor_neg, Role %in% c('Child'))
parent_motor_neg <- subset(motor_neg, Role %in% c('Parent'))

child_prohibition_neg <- subset(child_motor_neg, Function %in% c('prohibition'))
child_inability_neg <- subset(child_motor_neg, Function %in% c('inability') & Subj %in% c('I', 'i'))
parent_prohibition_neg <- subset(parent_motor_neg, Function %in% c('prohibition'))
parent_inability_neg <- subset(parent_motor_neg, Function %in% c('inability') & Subj %in% c('I', 'i'))

child_prohibition_neg_mlu <- mlu(child_prohibition_neg)
child_inability_neg_mlu <- mlu(child_inability_neg)
parent_prohibition_neg_mlu <- mlu(parent_prohibition_neg)
parent_inability_neg_mlu <- mlu(parent_inability_neg)

child_prohibition_neg <- data.frame(table(child_prohibition_neg$Age))
names(child_prohibition_neg) <- c('Age', 'Freq')
child_prohibition_neg$Role <- rep('Child', nrow(child_prohibition_neg))
child_prohibition_neg$Head <- rep('', nrow(child_prohibition_neg))
temp <- merge(child_prohibition_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_prohibition_neg <- temp
child_prohibition_neg$Total_ratio <- child_prohibition_neg$Freq / child_prohibition_neg$N_utterance
child_prohibition_neg$Ratio <- child_prohibition_neg$Freq / sum(child_prohibition_neg$Freq)
child_prohibition_neg$Polarity <- rep('negative', nrow(child_prohibition_neg))
child_prohibition_neg$Measure <- rep('negative construction ratio', nrow(child_prohibition_neg))
child_prohibition_neg$Which <- rep('ratio', nrow(child_prohibition_neg))
child_prohibition_neg$Function <- rep('Prohibition', nrow(child_prohibition_neg))
child_prohibition_neg <- negative_cumulative(child_prohibition_neg, child_descriptive)


child_inability_neg <- data.frame(table(child_inability_neg$Age))
names(child_inability_neg) <- c('Age', 'Freq')
child_inability_neg$Role <- rep('Child', nrow(child_inability_neg))
child_inability_neg$Head <- rep('', nrow(child_inability_neg))
temp <- merge(child_inability_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_inability_neg <- temp
child_inability_neg$Total_ratio <- child_inability_neg$Freq / child_inability_neg$N_utterance
child_inability_neg$Ratio <- child_inability_neg$Freq / sum(child_inability_neg$Freq)
child_inability_neg$Polarity <- rep('negative', nrow(child_inability_neg))
child_inability_neg$Measure <- rep('negative construction ratio', nrow(child_inability_neg))
child_inability_neg$Which <- rep('ratio', nrow(child_inability_neg))
child_inability_neg$Function <- rep('Inability', nrow(child_inability_neg))
child_inability_neg <- negative_cumulative(child_inability_neg, child_descriptive)


parent_prohibition_neg <- data.frame(table(parent_prohibition_neg$Age))
names(parent_prohibition_neg) <- c('Age', 'Freq')
parent_prohibition_neg$Role <- rep('Parent', nrow(parent_prohibition_neg))
parent_prohibition_neg$Head <- rep('', nrow(parent_prohibition_neg))
temp <- merge(parent_prohibition_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_prohibition_neg <- temp
parent_prohibition_neg$Total_ratio <- parent_prohibition_neg$Freq / parent_prohibition_neg$N_utterance
parent_prohibition_neg$Ratio <- parent_prohibition_neg$Freq / sum(parent_prohibition_neg$Freq)
parent_prohibition_neg$Polarity <- rep('negative', nrow(parent_prohibition_neg))
parent_prohibition_neg$Measure <- rep('negative construction ratio', nrow(parent_prohibition_neg))
parent_prohibition_neg$Which <- rep('ratio', nrow(parent_prohibition_neg))
parent_prohibition_neg$Function <- rep('Prohibition', nrow(parent_prohibition_neg))
parent_prohibition_neg <- negative_cumulative(parent_prohibition_neg, parent_descriptive)

parent_inability_neg <- data.frame(table(parent_inability_neg$Age))
names(parent_inability_neg) <- c('Age', 'Freq')
parent_inability_neg$Role <- rep('Parent', nrow(parent_inability_neg))
parent_inability_neg$Head <- rep('', nrow(parent_inability_neg))
temp <- merge(parent_inability_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_inability_neg <- temp
parent_inability_neg$Total_ratio <- parent_inability_neg$Freq / parent_inability_neg$N_utterance
parent_inability_neg$Ratio <- parent_inability_neg$Freq / sum(parent_inability_neg$Freq)
parent_inability_neg$Polarity <- rep('negative', nrow(parent_inability_neg))
parent_inability_neg$Measure <- rep('negative construction ratio', nrow(parent_inability_neg))
parent_inability_neg$Which <- rep('ratio', nrow(parent_inability_neg))
parent_inability_neg$Function <- rep('Inability', nrow(parent_inability_neg))
parent_inability_neg <- negative_cumulative(parent_inability_neg, parent_descriptive)


child_motor_pos <- subset(motor_pos, Role %in% c('Child'))
parent_motor_pos <- subset(motor_pos, Role %in% c('Parent'))

child_prohibition_pos <- subset(child_motor_pos, Function %in% c('prohibition'))
child_inability_pos <- subset(child_motor_pos, Function %in% c('inability') & Subj %in% c('I', 'i'))
parent_prohibition_pos <- subset(parent_motor_pos, Function %in% c('prohibition'))
parent_inability_pos <- subset(parent_motor_pos, Function %in% c('inability') & Subj %in% c('I', 'i'))

child_prohibition_pos_mlu <- mlu(child_prohibition_pos)
child_inability_pos_mlu <- mlu(child_inability_pos)
parent_prohibition_pos_mlu <- mlu(parent_prohibition_pos)
parent_inability_pos_mlu <- mlu(parent_inability_pos)

child_prohibition_pos <- data.frame(table(child_prohibition_pos$Age))
names(child_prohibition_pos) <- c('Age', 'Freq')
child_prohibition_pos$Role <- rep('Child', nrow(child_prohibition_pos))
child_prohibition_pos$Head <- rep('', nrow(child_prohibition_pos))
temp <- merge(child_prohibition_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_prohibition_pos <- temp
child_prohibition_pos$Total_ratio <- child_prohibition_pos$Freq / child_prohibition_pos$N_utterance
child_prohibition_pos$Ratio <- child_prohibition_pos$Freq / sum(child_prohibition_pos$Freq)
child_prohibition_pos$Polarity <- rep('positive', nrow(child_prohibition_pos))
child_prohibition_pos$Measure <- rep('positive construction ratio', nrow(child_prohibition_pos))
child_prohibition_pos$Which <- rep('ratio', nrow(child_prohibition_pos))
child_prohibition_pos$Function <- rep('Prohibition', nrow(child_prohibition_pos))
child_prohibition_pos <- positive_cumulative(child_prohibition_pos, child_descriptive)


child_inability_pos <- data.frame(table(child_inability_pos$Age))
names(child_inability_pos) <- c('Age', 'Freq')
child_inability_pos$Role <- rep('Child', nrow(child_inability_pos))
child_inability_pos$Head <- rep('', nrow(child_inability_pos))
temp <- merge(child_inability_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_inability_pos <- temp
child_inability_pos$Total_ratio <- child_inability_pos$Freq / child_inability_pos$N_utterance
child_inability_pos$Ratio <- child_inability_pos$Freq / sum(child_inability_pos$Freq)
child_inability_pos$Polarity <- rep('positive', nrow(child_inability_pos))
child_inability_pos$Measure <- rep('positive construction ratio', nrow(child_inability_pos))
child_inability_pos$Which <- rep('ratio', nrow(child_inability_pos))
child_inability_pos$Function <- rep('Inability', nrow(child_inability_pos))
child_inability_pos <- positive_cumulative(child_inability_pos, child_descriptive)


parent_prohibition_pos <- data.frame(table(parent_prohibition_pos$Age))
names(parent_prohibition_pos) <- c('Age', 'Freq')
parent_prohibition_pos$Role <- rep('Parent', nrow(parent_prohibition_pos))
parent_prohibition_pos$Head <- rep('', nrow(parent_prohibition_pos))
temp <- merge(parent_prohibition_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_prohibition_pos <- temp
parent_prohibition_pos$Total_ratio <- parent_prohibition_pos$Freq / parent_prohibition_pos$N_utterance
parent_prohibition_pos$Ratio <- parent_prohibition_pos$Freq / sum(parent_prohibition_pos$Freq)
parent_prohibition_pos$Polarity <- rep('positive', nrow(parent_prohibition_pos))
parent_prohibition_pos$Measure <- rep('positive construction ratio', nrow(parent_prohibition_pos))
parent_prohibition_pos$Which <- rep('ratio', nrow(parent_prohibition_pos))
parent_prohibition_pos$Function <- rep('Prohibition', nrow(parent_prohibition_pos))
parent_prohibition_pos <- positive_cumulative(parent_prohibition_pos, parent_descriptive)

parent_inability_pos <- data.frame(table(parent_inability_pos$Age))
names(parent_inability_pos) <- c('Age', 'Freq')
parent_inability_pos$Role <- rep('Parent', nrow(parent_inability_pos))
parent_inability_pos$Head <- rep('', nrow(parent_inability_pos))
temp <- merge(parent_inability_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_inability_pos <- temp
parent_inability_pos$Total_ratio <- parent_inability_pos$Freq / parent_inability_pos$N_utterance
parent_inability_pos$Ratio <- parent_inability_pos$Freq / sum(parent_inability_pos$Freq)
parent_inability_pos$Polarity <- rep('positive', nrow(parent_inability_pos))
parent_inability_pos$Measure <- rep('positive construction ratio', nrow(parent_inability_pos))
parent_inability_pos$Which <- rep('ratio', nrow(parent_inability_pos))
parent_inability_pos$Function <- rep('Inability', nrow(parent_inability_pos))
parent_inability_pos <- positive_cumulative(parent_inability_pos, parent_descriptive)


motor_data <- rbind(child_prohibition_neg, child_prohibition_pos, parent_prohibition_neg, parent_prohibition_pos, child_inability_neg, child_inability_pos, parent_inability_neg, parent_inability_pos)

motor_data$Measure <- factor(motor_data$Measure, levels = c('negative construction ratio', 'negative construction cumulative ratio', 'positive construction ratio', 'positive construction cumulative ratio'))


motor_data_child <- subset(motor_data, Role == 'Child')
motor_data_parent <- subset(motor_data, Role == 'Parent')

prohibition_data <- subset(motor_data, Function == 'Prohibition')
inability_data <- subset(motor_data, Function == 'Inability')

prohibition_data_child <- subset(prohibition_data, Role =='Child')
prohibition_data_parent <- subset(prohibition_data, Role =='Parent')

inability_data_child <- subset(inability_data, Role =='Child')
inability_data_parent <- subset(inability_data, Role =='Parent')

```

```{r motoruldata, include=FALSE}

child_ul_prohibition_neg <- subset(child_motor_neg, Function %in% c('prohibition'))
child_ul_inability_neg <- subset(child_motor_neg, Function %in% c('inability') & Subj %in% c('I', 'i'))
parent_ul_prohibition_neg <- subset(parent_motor_neg, Function %in% c('prohibition'))
parent_ul_inability_neg <- subset(parent_motor_neg, Function %in% c('inability') & Subj %in% c('I', 'i'))


child_ul_prohibition_neg <- data.frame(table(child_ul_prohibition_neg$Sent_len))
names(child_ul_prohibition_neg) <- c('Sent_len', 'Freq')
child_ul_prohibition_neg$Role <- rep('Child', nrow(child_ul_prohibition_neg))
child_ul_prohibition_neg$Head <- rep('', nrow(child_ul_prohibition_neg))
temp <- merge(child_ul_prohibition_neg, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_prohibition_neg <- temp
child_ul_prohibition_neg$Total_ratio <- child_ul_prohibition_neg$Freq / child_ul_prohibition_neg$N_utterance
child_ul_prohibition_neg$Ratio <- child_ul_prohibition_neg$Freq / sum(child_ul_prohibition_neg$Freq)
child_ul_prohibition_neg$Polarity <- rep('negative', nrow(child_ul_prohibition_neg))
child_ul_prohibition_neg$Measure <- rep('negative construction ratio', nrow(child_ul_prohibition_neg))
child_ul_prohibition_neg$Which <- rep('ratio', nrow(child_ul_prohibition_neg))
child_ul_prohibition_neg$Function <- rep('Prohibition', nrow(child_ul_prohibition_neg))
child_ul_prohibition_neg <- negative_ul_cumulative(child_ul_prohibition_neg, child_ul_descriptive)


child_ul_inability_neg <- data.frame(table(child_ul_inability_neg$Sent_len))
names(child_ul_inability_neg) <- c('Sent_len', 'Freq')
child_ul_inability_neg$Role <- rep('Child', nrow(child_ul_inability_neg))
child_ul_inability_neg$Head <- rep('', nrow(child_ul_inability_neg))
temp <- merge(child_ul_inability_neg, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_inability_neg <- temp
child_ul_inability_neg$Total_ratio <- child_ul_inability_neg$Freq / child_ul_inability_neg$N_utterance
child_ul_inability_neg$Ratio <- child_ul_inability_neg$Freq / sum(child_ul_inability_neg$Freq)
child_ul_inability_neg$Polarity <- rep('negative', nrow(child_ul_inability_neg))
child_ul_inability_neg$Measure <- rep('negative construction ratio', nrow(child_ul_inability_neg))
child_ul_inability_neg$Which <- rep('ratio', nrow(child_ul_inability_neg))
child_ul_inability_neg$Function <- rep('Inability', nrow(child_ul_inability_neg))
child_ul_inability_neg <- negative_ul_cumulative(child_ul_inability_neg, child_ul_descriptive)


parent_ul_prohibition_neg <- data.frame(table(parent_ul_prohibition_neg$Sent_len))
names(parent_ul_prohibition_neg) <- c('Sent_len', 'Freq')
parent_ul_prohibition_neg$Role <- rep('Parent', nrow(parent_ul_prohibition_neg))
parent_ul_prohibition_neg$Head <- rep('', nrow(parent_ul_prohibition_neg))
temp <- merge(parent_ul_prohibition_neg, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_prohibition_neg <- temp
parent_ul_prohibition_neg$Total_ratio <- parent_ul_prohibition_neg$Freq / parent_ul_prohibition_neg$N_utterance
parent_ul_prohibition_neg$Ratio <- parent_ul_prohibition_neg$Freq / sum(parent_ul_prohibition_neg$Freq)
parent_ul_prohibition_neg$Polarity <- rep('negative', nrow(parent_ul_prohibition_neg))
parent_ul_prohibition_neg$Measure <- rep('negative construction ratio', nrow(parent_ul_prohibition_neg))
parent_ul_prohibition_neg$Which <- rep('ratio', nrow(parent_ul_prohibition_neg))
parent_ul_prohibition_neg$Function <- rep('Prohibition', nrow(parent_ul_prohibition_neg))
parent_ul_prohibition_neg <- negative_ul_cumulative(parent_ul_prohibition_neg, parent_ul_descriptive)

parent_ul_inability_neg <- data.frame(table(parent_ul_inability_neg$Sent_len))
names(parent_ul_inability_neg) <- c('Sent_len', 'Freq')
parent_ul_inability_neg$Role <- rep('Parent', nrow(parent_ul_inability_neg))
parent_ul_inability_neg$Head <- rep('', nrow(parent_ul_inability_neg))
temp <- merge(parent_ul_inability_neg, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_inability_neg <- temp
parent_ul_inability_neg$Total_ratio <- parent_ul_inability_neg$Freq / parent_ul_inability_neg$N_utterance
parent_ul_inability_neg$Ratio <- parent_ul_inability_neg$Freq / sum(parent_ul_inability_neg$Freq)
parent_ul_inability_neg$Polarity <- rep('negative', nrow(parent_ul_inability_neg))
parent_ul_inability_neg$Measure <- rep('negative construction ratio', nrow(parent_ul_inability_neg))
parent_ul_inability_neg$Which <- rep('ratio', nrow(parent_ul_inability_neg))
parent_ul_inability_neg$Function <- rep('Inability', nrow(parent_ul_inability_neg))
parent_ul_inability_neg <- negative_ul_cumulative(parent_ul_inability_neg, parent_ul_descriptive)


child_ul_prohibition_pos <- subset(child_motor_pos, Function %in% c('prohibition'))
child_ul_inability_pos <- subset(child_motor_pos, Function %in% c('inability') & Subj %in% c('I', 'i'))
parent_ul_prohibition_pos <- subset(parent_motor_pos, Function %in% c('prohibition'))
parent_ul_inability_pos <- subset(parent_motor_pos, Function %in% c('inability') & Subj %in% c('I', 'i'))


child_ul_prohibition_pos <- data.frame(table(child_ul_prohibition_pos$Sent_len))
names(child_ul_prohibition_pos) <- c('Sent_len', 'Freq')
child_ul_prohibition_pos$Role <- rep('Child', nrow(child_ul_prohibition_pos))
child_ul_prohibition_pos$Head <- rep('', nrow(child_ul_prohibition_pos))
temp <- merge(child_ul_prohibition_pos, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_prohibition_pos <- temp
child_ul_prohibition_pos$Total_ratio <- child_ul_prohibition_pos$Freq / child_ul_prohibition_pos$N_utterance
child_ul_prohibition_pos$Ratio <- child_ul_prohibition_pos$Freq / sum(child_ul_prohibition_pos$Freq)
child_ul_prohibition_pos$Polarity <- rep('positive', nrow(child_ul_prohibition_pos))
child_ul_prohibition_pos$Measure <- rep('positive construction ratio', nrow(child_ul_prohibition_pos))
child_ul_prohibition_pos$Which <- rep('ratio', nrow(child_ul_prohibition_pos))
child_ul_prohibition_pos$Function <- rep('Prohibition', nrow(child_ul_prohibition_pos))
child_ul_prohibition_pos <- positive_ul_cumulative(child_ul_prohibition_pos, child_ul_descriptive)


child_ul_inability_pos <- data.frame(table(child_ul_inability_pos$Sent_len))
names(child_ul_inability_pos) <- c('Sent_len', 'Freq')
child_ul_inability_pos$Role <- rep('Child', nrow(child_ul_inability_pos))
child_ul_inability_pos$Head <- rep('', nrow(child_ul_inability_pos))
temp <- merge(child_ul_inability_pos, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_inability_pos <- temp
child_ul_inability_pos$Total_ratio <- child_ul_inability_pos$Freq / child_ul_inability_pos$N_utterance
child_ul_inability_pos$Ratio <- child_ul_inability_pos$Freq / sum(child_ul_inability_pos$Freq)
child_ul_inability_pos$Polarity <- rep('positive', nrow(child_ul_inability_pos))
child_ul_inability_pos$Measure <- rep('positive construction ratio', nrow(child_ul_inability_pos))
child_ul_inability_pos$Which <- rep('ratio', nrow(child_ul_inability_pos))
child_ul_inability_pos$Function <- rep('Inability', nrow(child_ul_inability_pos))
child_ul_inability_pos <- positive_ul_cumulative(child_ul_inability_pos, child_ul_descriptive)


parent_ul_prohibition_pos <- data.frame(table(parent_ul_prohibition_pos$Sent_len))
names(parent_ul_prohibition_pos) <- c('Sent_len', 'Freq')
parent_ul_prohibition_pos$Role <- rep('Parent', nrow(parent_ul_prohibition_pos))
parent_ul_prohibition_pos$Head <- rep('', nrow(parent_ul_prohibition_pos))
temp <- merge(parent_ul_prohibition_pos, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_prohibition_pos <- temp
parent_ul_prohibition_pos$Total_ratio <- parent_ul_prohibition_pos$Freq / parent_ul_prohibition_pos$N_utterance
parent_ul_prohibition_pos$Ratio <- parent_ul_prohibition_pos$Freq / sum(parent_ul_prohibition_pos$Freq)
parent_ul_prohibition_pos$Polarity <- rep('positive', nrow(parent_ul_prohibition_pos))
parent_ul_prohibition_pos$Measure <- rep('positive construction ratio', nrow(parent_ul_prohibition_pos))
parent_ul_prohibition_pos$Which <- rep('ratio', nrow(parent_ul_prohibition_pos))
parent_ul_prohibition_pos$Function <- rep('Prohibition', nrow(parent_ul_prohibition_pos))
parent_ul_prohibition_pos <- positive_ul_cumulative(parent_ul_prohibition_pos, parent_ul_descriptive)

parent_ul_inability_pos <- data.frame(table(parent_ul_inability_pos$Sent_len))
names(parent_ul_inability_pos) <- c('Sent_len', 'Freq')
parent_ul_inability_pos$Role <- rep('Parent', nrow(parent_ul_inability_pos))
parent_ul_inability_pos$Head <- rep('', nrow(parent_ul_inability_pos))
temp <- merge(parent_ul_inability_pos, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_inability_pos <- temp
parent_ul_inability_pos$Total_ratio <- parent_ul_inability_pos$Freq / parent_ul_inability_pos$N_utterance
parent_ul_inability_pos$Ratio <- parent_ul_inability_pos$Freq / sum(parent_ul_inability_pos$Freq)
parent_ul_inability_pos$Polarity <- rep('positive', nrow(parent_ul_inability_pos))
parent_ul_inability_pos$Measure <- rep('positive construction ratio', nrow(parent_ul_inability_pos))
parent_ul_inability_pos$Which <- rep('ratio', nrow(parent_ul_inability_pos))
parent_ul_inability_pos$Function <- rep('Inability', nrow(parent_ul_inability_pos))
parent_ul_inability_pos <- positive_ul_cumulative(parent_ul_inability_pos, parent_ul_descriptive)


motor_ul_data <- rbind(child_ul_prohibition_neg, child_ul_prohibition_pos, parent_ul_prohibition_neg, parent_ul_prohibition_pos, child_ul_inability_neg, child_ul_inability_pos, parent_ul_inability_neg, parent_ul_inability_pos)

motor_ul_data$Measure <- factor(motor_ul_data$Measure, levels = c('negative construction ratio', 'negative construction cumulative ratio', 'positive construction ratio', 'positive construction cumulative ratio'))


motor_ul_data_child <- subset(motor_ul_data, Role == 'Child')
motor_ul_data_parent <- subset(motor_ul_data, Role == 'Parent')

prohibition_ul_data <- subset(motor_ul_data, Function == 'Prohibition')
inability_ul_data <- subset(motor_ul_data, Function == 'Inability')

prohibition_ul_data_child <- subset(prohibition_ul_data, Role =='Child')
prohibition_ul_data_parent <- subset(prohibition_ul_data, Role =='Parent')

inability_ul_data_child <- subset(inability_ul_data, Role =='Child')
inability_ul_data_parent <- subset(inability_ul_data, Role =='Parent')

```

```{r motordiscoursedata, include=FALSE}

discourse_motor <-read.csv('data/motor_discourse.txt', header = T, sep = '\t')
discourse_motor$Role[which(discourse_motor$Role == "Father")] <- 'Parent'
discourse_motor$Role[which(discourse_motor$Role == "Mother")] <- 'Parent'
discourse_motor$Role[which(discourse_motor$Role == "Target_Child")] <- 'Child'

discourse_motor_neg = subset(discourse_motor, Polarity == 'negative')
discourse_motor_pos = subset(discourse_motor, Polarity == 'positive')

discourse_child_motor_neg <- subset(discourse_motor_neg, Role %in% c('Child'))
discourse_parent_motor_neg <- subset(discourse_motor_neg, Role %in% c('Parent'))

discourse_child_prohibition_neg <- subset(discourse_child_motor_neg, Function %in% c('prohibition'))
discourse_child_inability_neg <- subset(discourse_child_motor_neg, Function %in% c('inability') & Subj %in% c('I', 'i'))
discourse_parent_prohibition_neg <- subset(discourse_parent_motor_neg, Function %in% c('prohibition'))
discourse_parent_inability_neg <- subset(discourse_parent_motor_neg, Function %in% c('inability') & Subj %in% c('I', 'i'))


discourse_child_prohibition_neg <- data.frame(table(discourse_child_prohibition_neg$Age))
names(discourse_child_prohibition_neg) <- c('Age', 'Freq')
discourse_child_prohibition_neg$Role <- rep('Child', nrow(discourse_child_prohibition_neg))
discourse_child_prohibition_neg$Head <- rep('', nrow(discourse_child_prohibition_neg))
temp <- merge(discourse_child_prohibition_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_prohibition_neg <- temp
discourse_child_prohibition_neg$Total_ratio <- discourse_child_prohibition_neg$Freq / discourse_child_prohibition_neg$N_utterance
discourse_child_prohibition_neg$Ratio <- discourse_child_prohibition_neg$Freq / sum(discourse_child_prohibition_neg$Freq)
discourse_child_prohibition_neg$Polarity <- rep('negative', nrow(discourse_child_prohibition_neg))
discourse_child_prohibition_neg$Measure <- rep('negative construction ratio', nrow(discourse_child_prohibition_neg))
discourse_child_prohibition_neg$Which <- rep('ratio', nrow(discourse_child_prohibition_neg))
discourse_child_prohibition_neg$Function <- rep('Prohibition', nrow(discourse_child_prohibition_neg))
discourse_child_prohibition_neg <- negative_cumulative(discourse_child_prohibition_neg, child_descriptive)


discourse_child_inability_neg <- data.frame(table(discourse_child_inability_neg$Age))
names(discourse_child_inability_neg) <- c('Age', 'Freq')
discourse_child_inability_neg$Role <- rep('Child', nrow(discourse_child_inability_neg))
discourse_child_inability_neg$Head <- rep('', nrow(discourse_child_inability_neg))
temp <- merge(discourse_child_inability_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_inability_neg <- temp
discourse_child_inability_neg$Total_ratio <- discourse_child_inability_neg$Freq / discourse_child_inability_neg$N_utterance
discourse_child_inability_neg$Ratio <- discourse_child_inability_neg$Freq / sum(discourse_child_inability_neg$Freq)
discourse_child_inability_neg$Polarity <- rep('negative', nrow(discourse_child_inability_neg))
discourse_child_inability_neg$Measure <- rep('negative construction ratio', nrow(discourse_child_inability_neg))
discourse_child_inability_neg$Which <- rep('ratio', nrow(discourse_child_inability_neg))
discourse_child_inability_neg$Function <- rep('Inability', nrow(discourse_child_inability_neg))
discourse_child_inability_neg <- negative_cumulative(discourse_child_inability_neg, child_descriptive)


discourse_parent_prohibition_neg <- data.frame(table(discourse_parent_prohibition_neg$Age))
names(discourse_parent_prohibition_neg) <- c('Age', 'Freq')
discourse_parent_prohibition_neg$Role <- rep('Parent', nrow(discourse_parent_prohibition_neg))
discourse_parent_prohibition_neg$Head <- rep('', nrow(discourse_parent_prohibition_neg))
temp <- merge(discourse_parent_prohibition_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_prohibition_neg <- temp
discourse_parent_prohibition_neg$Total_ratio <- discourse_parent_prohibition_neg$Freq / discourse_parent_prohibition_neg$N_utterance
discourse_parent_prohibition_neg$Ratio <- discourse_parent_prohibition_neg$Freq / sum(discourse_parent_prohibition_neg$Freq)
discourse_parent_prohibition_neg$Polarity <- rep('negative', nrow(discourse_parent_prohibition_neg))
discourse_parent_prohibition_neg$Measure <- rep('negative construction ratio', nrow(discourse_parent_prohibition_neg))
discourse_parent_prohibition_neg$Which <- rep('ratio', nrow(discourse_parent_prohibition_neg))
discourse_parent_prohibition_neg$Function <- rep('Prohibition', nrow(discourse_parent_prohibition_neg))
discourse_parent_prohibition_neg <- negative_cumulative(discourse_parent_prohibition_neg, parent_descriptive)

discourse_parent_inability_neg <- data.frame(table(discourse_parent_inability_neg$Age))
names(discourse_parent_inability_neg) <- c('Age', 'Freq')
discourse_parent_inability_neg$Role <- rep('Parent', nrow(discourse_parent_inability_neg))
discourse_parent_inability_neg$Head <- rep('', nrow(discourse_parent_inability_neg))
temp <- merge(discourse_parent_inability_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_inability_neg <- temp
discourse_parent_inability_neg$Total_ratio <- discourse_parent_inability_neg$Freq / discourse_parent_inability_neg$N_utterance
discourse_parent_inability_neg$Ratio <- discourse_parent_inability_neg$Freq / sum(discourse_parent_inability_neg$Freq)
discourse_parent_inability_neg$Polarity <- rep('negative', nrow(discourse_parent_inability_neg))
discourse_parent_inability_neg$Measure <- rep('negative construction ratio', nrow(discourse_parent_inability_neg))
discourse_parent_inability_neg$Which <- rep('ratio', nrow(discourse_parent_inability_neg))
discourse_parent_inability_neg$Function <- rep('Inability', nrow(discourse_parent_inability_neg))
discourse_parent_inability_neg <- negative_cumulative(discourse_parent_inability_neg, parent_descriptive)


discourse_child_motor_pos <- subset(discourse_motor_pos, Role %in% c('Child'))
discourse_parent_motor_pos <- subset(discourse_motor_pos, Role %in% c('Parent'))

discourse_child_prohibition_pos <- subset(discourse_child_motor_pos, Function %in% c('prohibition'))
discourse_child_inability_pos <- subset(discourse_child_motor_pos, Function %in% c('inability') & Subj %in% c('I', 'i'))
discourse_parent_prohibition_pos <- subset(discourse_parent_motor_pos, Function %in% c('prohibition'))
discourse_parent_inability_pos <- subset(discourse_parent_motor_pos, Function %in% c('inability') & Subj %in% c('I', 'i'))

discourse_child_prohibition_pos <- data.frame(table(discourse_child_prohibition_pos$Age))
names(discourse_child_prohibition_pos) <- c('Age', 'Freq')
discourse_child_prohibition_pos$Role <- rep('Child', nrow(discourse_child_prohibition_pos))
discourse_child_prohibition_pos$Head <- rep('', nrow(discourse_child_prohibition_pos))
temp <- merge(discourse_child_prohibition_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_prohibition_pos <- temp
discourse_child_prohibition_pos$Total_ratio <- discourse_child_prohibition_pos$Freq / discourse_child_prohibition_pos$N_utterance
discourse_child_prohibition_pos$Ratio <- discourse_child_prohibition_pos$Freq / sum(discourse_child_prohibition_pos$Freq)
discourse_child_prohibition_pos$Polarity <- rep('positive', nrow(discourse_child_prohibition_pos))
discourse_child_prohibition_pos$Measure <- rep('positive construction ratio', nrow(discourse_child_prohibition_pos))
discourse_child_prohibition_pos$Which <- rep('ratio', nrow(discourse_child_prohibition_pos))
discourse_child_prohibition_pos$Function <- rep('Prohibition', nrow(discourse_child_prohibition_pos))
discourse_child_prohibition_pos <- positive_cumulative(discourse_child_prohibition_pos, child_descriptive)


discourse_child_inability_pos <- data.frame(table(discourse_child_inability_pos$Age))
names(discourse_child_inability_pos) <- c('Age', 'Freq')
discourse_child_inability_pos$Role <- rep('Child', nrow(discourse_child_inability_pos))
discourse_child_inability_pos$Head <- rep('', nrow(discourse_child_inability_pos))
temp <- merge(discourse_child_inability_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_inability_pos <- temp
discourse_child_inability_pos$Total_ratio <- discourse_child_inability_pos$Freq / discourse_child_inability_pos$N_utterance
discourse_child_inability_pos$Ratio <- discourse_child_inability_pos$Freq / sum(discourse_child_inability_pos$Freq)
discourse_child_inability_pos$Polarity <- rep('positive', nrow(discourse_child_inability_pos))
discourse_child_inability_pos$Measure <- rep('positive construction ratio', nrow(discourse_child_inability_pos))
discourse_child_inability_pos$Which <- rep('ratio', nrow(discourse_child_inability_pos))
discourse_child_inability_pos$Function <- rep('Inability', nrow(discourse_child_inability_pos))
discourse_child_inability_pos <- positive_cumulative(discourse_child_inability_pos, child_descriptive)


discourse_parent_prohibition_pos <- data.frame(table(discourse_parent_prohibition_pos$Age))
names(discourse_parent_prohibition_pos) <- c('Age', 'Freq')
discourse_parent_prohibition_pos$Role <- rep('Parent', nrow(discourse_parent_prohibition_pos))
discourse_parent_prohibition_pos$Head <- rep('', nrow(discourse_parent_prohibition_pos))
temp <- merge(discourse_parent_prohibition_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_prohibition_pos <- temp
discourse_parent_prohibition_pos$Total_ratio <- discourse_parent_prohibition_pos$Freq / discourse_parent_prohibition_pos$N_utterance
discourse_parent_prohibition_pos$Ratio <- discourse_parent_prohibition_pos$Freq / sum(discourse_parent_prohibition_pos$Freq)
discourse_parent_prohibition_pos$Polarity <- rep('positive', nrow(discourse_parent_prohibition_pos))
discourse_parent_prohibition_pos$Measure <- rep('positive construction ratio', nrow(discourse_parent_prohibition_pos))
discourse_parent_prohibition_pos$Which <- rep('ratio', nrow(discourse_parent_prohibition_pos))
discourse_parent_prohibition_pos$Function <- rep('Prohibition', nrow(discourse_parent_prohibition_pos))
discourse_parent_prohibition_pos <- positive_cumulative(discourse_parent_prohibition_pos, parent_descriptive)

discourse_parent_inability_pos <- data.frame(table(discourse_parent_inability_pos$Age))
names(discourse_parent_inability_pos) <- c('Age', 'Freq')
discourse_parent_inability_pos$Role <- rep('Parent', nrow(discourse_parent_inability_pos))
discourse_parent_inability_pos$Head <- rep('', nrow(discourse_parent_inability_pos))
temp <- merge(discourse_parent_inability_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_inability_pos <- temp
discourse_parent_inability_pos$Total_ratio <- discourse_parent_inability_pos$Freq / discourse_parent_inability_pos$N_utterance
discourse_parent_inability_pos$Ratio <- discourse_parent_inability_pos$Freq / sum(discourse_parent_inability_pos$Freq)
discourse_parent_inability_pos$Polarity <- rep('positive', nrow(discourse_parent_inability_pos))
discourse_parent_inability_pos$Measure <- rep('positive construction ratio', nrow(discourse_parent_inability_pos))
discourse_parent_inability_pos$Which <- rep('ratio', nrow(discourse_parent_inability_pos))
discourse_parent_inability_pos$Function <- rep('Inability', nrow(discourse_parent_inability_pos))
discourse_parent_inability_pos <- positive_cumulative(discourse_parent_inability_pos, parent_descriptive)

discourse_motor_data <- rbind(discourse_child_prohibition_neg, discourse_child_prohibition_pos, discourse_parent_prohibition_neg, discourse_parent_prohibition_pos, discourse_child_inability_neg, discourse_child_inability_pos, discourse_parent_inability_neg, discourse_parent_inability_pos)

discourse_motor_data$Measure <- factor(discourse_motor_data$Measure, levels = c('negative construction ratio', 'negative construction cumulative ratio', 'positive construction ratio', 'positive construction cumulative ratio'))


discourse_motor_data_child <- subset(discourse_motor_data, Role == 'Child')
discourse_motor_data_parent <- subset(discourse_motor_data, Role == 'Parent')

discourse_prohibition_data <- subset(discourse_motor_data, Function == 'Prohibition')
discourse_inability_data <- subset(discourse_motor_data, Function == 'Inability')

discourse_prohibition_data_child <- subset(prohibition_data, Role =='Child')
discourse_prohibition_data_parent <- subset(prohibition_data, Role =='Parent')

discourse_inability_data_child <- subset(inability_data, Role =='Child')
discourse_inability_data_parent <- subset(inability_data, Role =='Parent')

discourse_prohibition_data_plot <- aggregate(Total_ratio~Age+Which+Role,data=discourse_prohibition_data,sum)

names(discourse_prohibition_data_plot) <- c('Age', 'Measure', 'Role', 'Total_ratio')

discourse_inability_data_plot <- aggregate(Total_ratio~Age+Which+Role,data=discourse_inability_data,sum)

names(discourse_inability_data_plot) <- c('Age', 'Measure', 'Role', 'Total_ratio')

```

For constructions that typically convey prohibition, we extracted utterances that were annotated as imperatives in CHILDES. In particular, we selected instances where the head verbs do not take any subjects. As before, cases without any negative morphemes are considered as positive. For negative constructions, we chose structures where the negative morphemes are combined with the auxiliary verb *do* (*do*, *does*, *did*) and they together modify the head verbs of the sentences. In order to not have overlap with rejection, non-existence, epistemic negation and possession (see below), our search excluded utterances where the head verb had any of the following lemma forms: *like*, *want*, *know*, *think*, *remember*, *have*. This resulted in a total of `r format(sum(subset(prohibition_data,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")` negative utterances (child: `r format(sum(subset(prohibition_data_child,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`; parent: `r format(sum(subset(prohibition_data_parent,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`), and a total of `r format(sum(subset(prohibition_data,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")` negative utterances (child: `r format(sum(subset(prohibition_data_child,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`; parent: `r format(sum(subset(prohibition_data_parent,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`).

Figure \@ref(fig:prohibition) shows the ratios and cumulative ratios of prohibitions and their positive counterparts in parents' and children's speech at the sentence level. In both child and parent speech, negative constructions for prohibition are consistently produced less frequently than their positive counterparts. Children produce prohibitions (negative imperatives) more and more often between 24 and 36 months. In comparison, the cumulative ratio in parent speech gradually decreases at the beginning when children between 12 - 36 months. Yet overall, child production is remains consistently lower than parent production of prohibition. This might be due to the social nature of parent-child interactions, in which it is more likely for parents to explicitly command and direct children's actions than the other way round.

|Prohibition (Negative)| Imperatives (Positive)|
|----------------|----------------|
|*don't blame Charlotte* | *cook it*|
|*don't do that* | *try this*|
Table: (\#tab:prohibit) Examples of sentence-level prohibition (negative) and positive counterparts in children's speech.

```{r prohibition, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap='Ratios and cumulative ratios for the production of prohibition at the sentence level for children between 12 to 72 months of age, and their parents.'}

prohibition_data %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) +
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") + 
  guides(linetype = guide_legend(nrow = 2))

```

```{r prohibitionbegin, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap='Ratios and cumulative ratios for the production of prohibition at the sentence level for children between 12 to 24 months of age, and their parents.'}

subset(prohibition_data, Age<=24) %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) +
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 24, 1)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") + 
  guides(linetype = guide_legend(nrow = 2))

```

<!--
```{r prohibitionul, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap='Prohibition and its positive counterparts, indexed by utterance length.'}

prohibition_ul_data %>% 
  ggplot(aes(as.numeric(as.character(Sent_len)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) +
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 130, 10)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") + 
  guides(linetype = guide_legend(nrow = 2))

```
-->

At the discourse level, we selected *No*-utterances with antecedents that were subjectless imperatives headed by a verb, excluding the following lemma forms: *like*, *want*, *know*, *think*, *remember*, nor *have*. This resulted in a total of `r format(sum(subset(discourse_prohibition_data,Which=='ratio')$Freq), big.mark=",")` utterances (child: `r format(sum(subset(discourse_prohibition_data_child,Which=='ratio')$Freq), big.mark=",")`; parent: `r format(sum(subset(discourse_prohibition_data_parent,Which=='ratio')$Freq), big.mark=",")`). As shown in Figure \@ref(fig:prohibitiondiscourse), children's usage of negation as a response particle to express prohibition is comparable to their productions at the sentence level. Their negative productions increases within the age range of 24 to 36 months, and parent production decreases when the children are between 12 to 36 months.

|Antecedent|Utterance|
|------------|------------|
|Parent: *put away your toys*|Child: *no mommy I like these*|
Table: (\#tab:disprohib) Example antecedents imperatives and discourse level negation in parents' and children's productions 

```{r prohibitiondiscourse, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap='Ratios and cumulative ratios for the production of prohibition at the discourse level for children between 12 to 72 months of age, and their parents.',warning=FALSE}

discourse_prohibition_data_plot %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c('solid', 'dotted')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(16, 3)) +
  scale_color_manual(values = c("darkgreen", "grey")) + 
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") 

```

```{r prohibitiondiscoursebegin, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap='Ratios and cumulative ratios for the production of prohibition at the discourse level for children between 12 to 24 months of age, and their parents.',warning=FALSE}

subset(discourse_prohibition_data_plot, Age<=24) %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c('solid', 'dotted')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(16, 3)) +
  scale_color_manual(values = c("darkgreen", "grey")) + 
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 24, 1)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") 

```

### Inability 

For the function of inability, we analyzed instances with head verbs that are modified by the modal auxiliaries *can* and *could*. If the head verb was also modified by a negative morpheme, we classified it as negative. Otherwise, we considered it positive. Cases without a subject (e.g. "can't play") or with subjects that were not first person singular (e.g. "you can't do that", "this can't go in the box") were excluded. This is because such cases often yield readings other than "(in)ability". Depending on the larger context, they could be deontic (e.g. "you are not allowed to do that") or epistemic (e.g. "it is not possible for it to go in the box"). To avoid this ambiguity and focus more on constructions that convey an individual's ability, we restricted our analyses only to cases with the first person singular subject *I*. This led to `r format(sum(subset(inability_data,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")` negative utterances (child: `r format(sum(subset(inability_data_child,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`; parent: `r format(sum(subset(inability_data_parent,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`), and `r format(sum(subset(inability_data,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")` positive utterances (child: `r format(sum(subset(inability_data_child,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`; parent: `r format(sum(subset(inability_data_parent,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`). Table \@ref(tab:inab) shows a few example of the cases we considered.

|Inability (Negative)| Ability (Positive)|
|----------------|----------------|
|*I can't see* | *you could do it*|
|*She can't go* | *mommy could help me*|
Table: (\#tab:inab) Examples of sentence-level inability (negative) and positive counterparts in children's speech.

Figure \@ref(fig:inability) shows ratios and cumulative ratios of parents and children's productions of inability constructions as defined above. Similar to previous constructions, positive instances are generally more frequent than negative ones. Children produce inability negation more and more frequently between 18-36 months. After 36 months, their productions are stable and close to parent ratios. 

```{r inability, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap="Ratios and cumulative ratios for the production of inability at the sentence level for children between 12 to 72 months of age, and their parents."}

inability_data %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) +
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") + 
  guides(linetype = guide_legend(nrow = 2))

```


```{r inabilitybegin, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap="Ratios and cumulative ratios for the production of inability at the sentence level for children between 12 to 24 months of age, and their parents."}

subset(inability_data, Age<=24) %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) +
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 24, 1)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") + 
  guides(linetype = guide_legend(nrow = 2))

```

At the discourse level, we selected utterances with the negative particle *no* in response to antecedents that had a similar structure to the inability construction defined above. This yielded a total of `r format(sum(subset(discourse_inability_data,Which=='ratio')$Freq), big.mark=",")` negative utterances (child: `r format(sum(subset(discourse_inability_data_child,Which=='ratio')$Freq), big.mark=",")`; parent: `r format(sum(subset(discourse_inability_data_parent,Which=='ratio')$Freq), big.mark=",")`). Figure \@ref(fig:inabilitydiscourse) shows the ratios and the cumulative ratios for parents' and children's production of discourse level inability construction. Considering cumulative ratios, children's productions gradually increase from 24 to 36 months and stabalizes after 36 months at a similar rate to that of parent's. <!-- these plots are really noisy! Maybe we should relax the exclusion criteria? What if we include questions -->

<!--
```{r inabilityul, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap='Inability and its positive counterparts, indexed by utterance length.'}

inability_ul_data %>% 
  ggplot(aes(as.numeric(as.character(Sent_len)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) +
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 130, 10)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") + 
  guides(linetype = guide_legend(nrow = 2))

```
-->

```{r inabilitydiscourse, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap='Ratios and cumulative ratios for the production of inability at the discourse level for children between 12 to 72 months of age, and their parents.',warning=FALSE}

discourse_inability_data_plot %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c('solid', 'dotted')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(16, 3)) +
  scale_color_manual(values = c("darkgreen", "grey")) + 
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio")

```



```{r inabilitydiscoursebegin, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap='Ratios and cumulative ratios for the production of inability at the discourse level for children between 12 to 24 months of age, and their parents.',warning=FALSE}

subset(discourse_inability_data_plot, Age<=24) %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c('solid', 'dotted')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(16, 3)) +
  scale_color_manual(values = c("darkgreen", "grey")) + 
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 24, 1)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio")

```


### Labeling

```{r learningdata, include=FALSE}

learning <-read.csv('data/learning.txt', header = T, sep = '\t')
# learning <- subset(learning, Subj == 'I' | Subj == 'NONE')
learning$Role[which(learning$Role == "Father")] <- 'Parent'
learning$Role[which(learning$Role == "Mother")] <- 'Parent'
learning$Role[which(learning$Role == "Target_Child")] <- 'Child'

learning_neg = subset(learning, Polarity == 'negative')
learning_pos = subset(learning, Polarity == 'positive')

child_learning_neg <- subset(learning_neg, Role %in% c('Child'))
parent_learning_neg <- subset(learning_neg, Role %in% c('Parent'))

child_learning_neg_mlu <- mlu(child_learning_neg)
parent_learning_neg_mlu <- mlu(parent_learning_neg)


child_learning_neg <- data.frame(table(child_learning_neg$Age))
names(child_learning_neg) <- c('Age', 'Freq')
child_learning_neg$Role <- rep('Child', nrow(child_learning_neg))
child_learning_neg$Head <- rep('', nrow(child_learning_neg))
temp <- merge(child_learning_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_learning_neg <- temp
child_learning_neg$Total_ratio <- child_learning_neg$Freq / child_learning_neg$N_utterance
child_learning_neg$Ratio <- child_learning_neg$Freq / sum(child_learning_neg$Freq)
child_learning_neg$Polarity <- rep('negative', nrow(child_learning_neg))
child_learning_neg$Measure <- rep('negative construction ratio', nrow(child_learning_neg))
child_learning_neg$Which <- rep('ratio', nrow(child_learning_neg))
child_learning_neg$Function <- rep('Labeling', nrow(child_learning_neg))
child_learning_neg <- negative_cumulative(child_learning_neg, child_descriptive)


parent_learning_neg <- data.frame(table(parent_learning_neg$Age))
names(parent_learning_neg) <- c('Age', 'Freq')
parent_learning_neg$Role <- rep('Parent', nrow(parent_learning_neg))
parent_learning_neg$Head <- rep('Learning', nrow(parent_learning_neg))
temp <- merge(parent_learning_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_learning_neg <- temp
parent_learning_neg$Total_ratio <- parent_learning_neg$Freq / parent_learning_neg$N_utterance
parent_learning_neg$Ratio <- parent_learning_neg$Freq / sum(parent_learning_neg$Freq)
parent_learning_neg$Polarity <- rep('negative', nrow(parent_learning_neg))
parent_learning_neg$Measure <- rep('negative construction ratio', nrow(parent_learning_neg))
parent_learning_neg$Which <- rep('ratio', nrow(parent_learning_neg))
parent_learning_neg$Function <- rep('Labeling', nrow(parent_learning_neg))
parent_learning_neg <- negative_cumulative(parent_learning_neg, parent_descriptive)


child_learning_pos <- subset(learning_pos, Role %in% c('Child'))
parent_learning_pos <- subset(learning_pos, Role %in% c('Parent'))

child_learning_pos_mlu <- mlu(child_learning_pos)
parent_learning_pos_mlu <- mlu(parent_learning_pos)


child_learning_pos <- data.frame(table(child_learning_pos$Age))
names(child_learning_pos) <- c('Age', 'Freq')
child_learning_pos$Role <- rep('Child', nrow(child_learning_pos))
child_learning_pos$Head <- rep('', nrow(child_learning_pos))
temp <- merge(child_learning_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_learning_pos <- temp
child_learning_pos$Total_ratio <- child_learning_pos$Freq / child_learning_pos$N_utterance
child_learning_pos$Ratio <- child_learning_pos$Freq / sum(child_learning_pos$Freq)
child_learning_pos$Polarity <- rep('positive', nrow(child_learning_pos))
child_learning_pos$Measure <- rep('positive construction ratio', nrow(child_learning_pos))
child_learning_pos$Which <- rep('ratio', nrow(child_learning_pos))
child_learning_pos$Function <- rep('Labeling', nrow(child_learning_pos))
child_learning_pos <- positive_cumulative(child_learning_pos, child_descriptive)


parent_learning_pos <- data.frame(table(parent_learning_pos$Age))
names(parent_learning_pos) <- c('Age', 'Freq')
parent_learning_pos$Role <- rep('Parent', nrow(parent_learning_pos))
parent_learning_pos$Head <- rep('Learning', nrow(parent_learning_pos))
temp <- merge(parent_learning_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_learning_pos <- temp
parent_learning_pos$Total_ratio <- parent_learning_pos$Freq / parent_learning_pos$N_utterance
parent_learning_pos$Ratio <- parent_learning_pos$Freq / sum(parent_learning_pos$Freq)
parent_learning_pos$Polarity <- rep('positive', nrow(parent_learning_pos))
parent_learning_pos$Measure <- rep('positive construction ratio', nrow(parent_learning_pos))
parent_learning_pos$Which <- rep('ratio', nrow(parent_learning_pos))
parent_learning_pos$Function <- rep('Labeling', nrow(parent_learning_pos))
parent_learning_pos <- positive_cumulative(parent_learning_pos, parent_descriptive)

learning_data <- rbind(child_learning_neg, child_learning_pos, parent_learning_neg, parent_learning_pos)

learning_data$Measure <- factor(learning_data$Measure, levels = c('negative construction ratio', 'negative construction cumulative ratio', 'positive construction ratio', 'positive construction cumulative ratio'))

learning_data_child <- subset(learning_data, Role == 'Child')
learning_data_parent <- subset(learning_data, Role == 'Parent')


```

```{r learninguldata, include=FALSE}

child_ul_learning_neg <- subset(learning_neg, Role %in% c('Child'))
parent_ul_learning_neg <- subset(learning_neg, Role %in% c('Parent'))

child_ul_learning_neg <- data.frame(table(child_ul_learning_neg$Sent_len))
names(child_ul_learning_neg) <- c('Sent_len', 'Freq')
child_ul_learning_neg$Role <- rep('Child', nrow(child_ul_learning_neg))
child_ul_learning_neg$Head <- rep('', nrow(child_ul_learning_neg))
temp <- merge(child_ul_learning_neg, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_learning_neg <- temp
child_ul_learning_neg$Total_ratio <- child_ul_learning_neg$Freq / child_ul_learning_neg$N_utterance
child_ul_learning_neg$Ratio <- child_ul_learning_neg$Freq / sum(child_ul_learning_neg$Freq)
child_ul_learning_neg$Polarity <- rep('negative', nrow(child_ul_learning_neg))
child_ul_learning_neg$Measure <- rep('negative construction ratio', nrow(child_ul_learning_neg))
child_ul_learning_neg$Which <- rep('ratio', nrow(child_ul_learning_neg))
child_ul_learning_neg$Function <- rep('Labeling', nrow(child_ul_learning_neg))
child_ul_learning_neg <- negative_ul_cumulative(child_ul_learning_neg, child_ul_descriptive)


parent_ul_learning_neg <- data.frame(table(parent_ul_learning_neg$Sent_len))
names(parent_ul_learning_neg) <- c('Sent_len', 'Freq')
parent_ul_learning_neg$Role <- rep('Parent', nrow(parent_ul_learning_neg))
parent_ul_learning_neg$Head <- rep('Learning', nrow(parent_ul_learning_neg))
temp <- merge(parent_ul_learning_neg, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_learning_neg <- temp
parent_ul_learning_neg$Total_ratio <- parent_ul_learning_neg$Freq / parent_ul_learning_neg$N_utterance
parent_ul_learning_neg$Ratio <- parent_ul_learning_neg$Freq / sum(parent_ul_learning_neg$Freq)
parent_ul_learning_neg$Polarity <- rep('negative', nrow(parent_ul_learning_neg))
parent_ul_learning_neg$Measure <- rep('negative construction ratio', nrow(parent_ul_learning_neg))
parent_ul_learning_neg$Which <- rep('ratio', nrow(parent_ul_learning_neg))
parent_ul_learning_neg$Function <- rep('Labeling', nrow(parent_ul_learning_neg))
parent_ul_learning_neg <- negative_ul_cumulative(parent_ul_learning_neg, parent_ul_descriptive)


child_ul_learning_pos <- subset(learning_pos, Role %in% c('Child'))
parent_ul_learning_pos <- subset(learning_pos, Role %in% c('Parent'))


child_ul_learning_pos <- data.frame(table(child_ul_learning_pos$Sent_len))
names(child_ul_learning_pos) <- c('Sent_len', 'Freq')
child_ul_learning_pos$Role <- rep('Child', nrow(child_ul_learning_pos))
child_ul_learning_pos$Head <- rep('', nrow(child_ul_learning_pos))
temp <- merge(child_ul_learning_pos, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_learning_pos <- temp
child_ul_learning_pos$Total_ratio <- child_ul_learning_pos$Freq / child_ul_learning_pos$N_utterance
child_ul_learning_pos$Ratio <- child_ul_learning_pos$Freq / sum(child_ul_learning_pos$Freq)
child_ul_learning_pos$Polarity <- rep('positive', nrow(child_ul_learning_pos))
child_ul_learning_pos$Measure <- rep('positive construction ratio', nrow(child_ul_learning_pos))
child_ul_learning_pos$Which <- rep('ratio', nrow(child_ul_learning_pos))
child_ul_learning_pos$Function <- rep('Labeling', nrow(child_ul_learning_pos))
child_ul_learning_pos <- positive_ul_cumulative(child_ul_learning_pos, child_ul_descriptive)


parent_ul_learning_pos <- data.frame(table(parent_ul_learning_pos$Sent_len))
names(parent_ul_learning_pos) <- c('Sent_len', 'Freq')
parent_ul_learning_pos$Role <- rep('Parent', nrow(parent_ul_learning_pos))
parent_ul_learning_pos$Head <- rep('Learning', nrow(parent_ul_learning_pos))
temp <- merge(parent_ul_learning_pos, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_learning_pos <- temp
parent_ul_learning_pos$Total_ratio <- parent_ul_learning_pos$Freq / parent_ul_learning_pos$N_utterance
parent_ul_learning_pos$Ratio <- parent_ul_learning_pos$Freq / sum(parent_ul_learning_pos$Freq)
parent_ul_learning_pos$Polarity <- rep('positive', nrow(parent_ul_learning_pos))
parent_ul_learning_pos$Measure <- rep('positive construction ratio', nrow(parent_ul_learning_pos))
parent_ul_learning_pos$Which <- rep('ratio', nrow(parent_ul_learning_pos))
parent_ul_learning_pos$Function <- rep('Labeling', nrow(parent_ul_learning_pos))
parent_ul_learning_pos <- positive_ul_cumulative(parent_ul_learning_pos, parent_ul_descriptive)

learning_ul_data <- rbind(child_ul_learning_neg, child_ul_learning_pos, parent_ul_learning_neg, parent_ul_learning_pos)

learning_ul_data$Measure <- factor(learning_ul_data$Measure, levels = c('negative construction ratio', 'negative construction cumulative ratio', 'positive construction ratio', 'positive construction cumulative ratio'))

learning_ul_data_child <- subset(learning_ul_data, Role == 'Child')
learning_ul_data_parent <- subset(learning_ul_data, Role == 'Parent')

```

```{r discourselearningdata, include=FALSE}

discourse_learning <-read.csv('data/learning_discourse.txt', header = T, sep = '\t')
discourse_learning$Role[which(discourse_learning$Role == "Father")] <- 'Parent'
discourse_learning$Role[which(discourse_learning$Role == "Mother")] <- 'Parent'
discourse_learning$Role[which(discourse_learning$Role == "Target_Child")] <- 'Child'

discourse_learning_neg = subset(discourse_learning, Polarity == 'negative')
discourse_learning_pos = subset(discourse_learning, Polarity == 'positive')

discourse_child_learning_neg <- subset(discourse_learning_neg, Role %in% c('Child'))
discourse_parent_learning_neg <- subset(discourse_learning_neg, Role %in% c('Parent'))

discourse_child_learning_neg <- data.frame(table(discourse_child_learning_neg$Age))
names(discourse_child_learning_neg) <- c('Age', 'Freq')
discourse_child_learning_neg$Role <- rep('Child', nrow(discourse_child_learning_neg))
discourse_child_learning_neg$Head <- rep('', nrow(discourse_child_learning_neg))
temp <- merge(discourse_child_learning_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_learning_neg <- temp
discourse_child_learning_neg$Total_ratio <- discourse_child_learning_neg$Freq / discourse_child_learning_neg$N_utterance
discourse_child_learning_neg$Ratio <- discourse_child_learning_neg$Freq / sum(discourse_child_learning_neg$Freq)
discourse_child_learning_neg$Polarity <- rep('negative', nrow(discourse_child_learning_neg))
discourse_child_learning_neg$Measure <- rep('negative construction ratio', nrow(discourse_child_learning_neg))
discourse_child_learning_neg$Which <- rep('ratio', nrow(discourse_child_learning_neg))
discourse_child_learning_neg$Function <- rep('Labeling', nrow(discourse_child_learning_neg))
discourse_child_learning_neg <- negative_cumulative(discourse_child_learning_neg, child_descriptive)


discourse_parent_learning_neg <- data.frame(table(discourse_parent_learning_neg$Age))
names(discourse_parent_learning_neg) <- c('Age', 'Freq')
discourse_parent_learning_neg$Role <- rep('Parent', nrow(discourse_parent_learning_neg))
discourse_parent_learning_neg$Head <- rep('Learning', nrow(discourse_parent_learning_neg))
temp <- merge(discourse_parent_learning_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_learning_neg <- temp
discourse_parent_learning_neg$Total_ratio <- discourse_parent_learning_neg$Freq / discourse_parent_learning_neg$N_utterance
discourse_parent_learning_neg$Ratio <- discourse_parent_learning_neg$Freq / sum(discourse_parent_learning_neg$Freq)
discourse_parent_learning_neg$Polarity <- rep('negative', nrow(discourse_parent_learning_neg))
discourse_parent_learning_neg$Measure <- rep('negative construction ratio', nrow(discourse_parent_learning_neg))
discourse_parent_learning_neg$Which <- rep('ratio', nrow(discourse_parent_learning_neg))
discourse_parent_learning_neg$Function <- rep('Labeling', nrow(discourse_parent_learning_neg))
discourse_parent_learning_neg <- negative_cumulative(discourse_parent_learning_neg, parent_descriptive)


discourse_child_learning_pos <- subset(discourse_learning_pos, Role %in% c('Child'))
discourse_parent_learning_pos <- subset(discourse_learning_pos, Role %in% c('Parent'))

discourse_child_learning_pos <- data.frame(table(discourse_child_learning_pos$Age))
names(discourse_child_learning_pos) <- c('Age', 'Freq')
discourse_child_learning_pos$Role <- rep('Child', nrow(discourse_child_learning_pos))
discourse_child_learning_pos$Head <- rep('', nrow(discourse_child_learning_pos))
temp <- merge(discourse_child_learning_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_learning_pos <- temp
discourse_child_learning_pos$Total_ratio <- discourse_child_learning_pos$Freq / discourse_child_learning_pos$N_utterance
discourse_child_learning_pos$Ratio <- discourse_child_learning_pos$Freq / sum(discourse_child_learning_pos$Freq)
discourse_child_learning_pos$Polarity <- rep('positive', nrow(discourse_child_learning_pos))
discourse_child_learning_pos$Measure <- rep('positive construction ratio', nrow(discourse_child_learning_pos))
discourse_child_learning_pos$Which <- rep('ratio', nrow(discourse_child_learning_pos))
discourse_child_learning_pos$Function <- rep('Labeling', nrow(discourse_child_learning_pos))
discourse_child_learning_pos <- positive_cumulative(discourse_child_learning_pos, child_descriptive)


discourse_parent_learning_pos <- data.frame(table(discourse_parent_learning_pos$Age))
names(discourse_parent_learning_pos) <- c('Age', 'Freq')
discourse_parent_learning_pos$Role <- rep('Parent', nrow(discourse_parent_learning_pos))
discourse_parent_learning_pos$Head <- rep('Learning', nrow(discourse_parent_learning_pos))
temp <- merge(discourse_parent_learning_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_learning_pos <- temp
discourse_parent_learning_pos$Total_ratio <- discourse_parent_learning_pos$Freq / discourse_parent_learning_pos$N_utterance
discourse_parent_learning_pos$Ratio <- discourse_parent_learning_pos$Freq / sum(discourse_parent_learning_pos$Freq)
discourse_parent_learning_pos$Polarity <- rep('positive', nrow(discourse_parent_learning_pos))
discourse_parent_learning_pos$Measure <- rep('positive construction ratio', nrow(discourse_parent_learning_pos))
discourse_parent_learning_pos$Which <- rep('ratio', nrow(discourse_parent_learning_pos))
discourse_parent_learning_pos$Function <- rep('Labeling', nrow(discourse_parent_learning_pos))
discourse_parent_learning_pos <- positive_cumulative(discourse_parent_learning_pos, parent_descriptive)

discourse_learning_data <- rbind(discourse_child_learning_neg, discourse_child_learning_pos, discourse_parent_learning_neg, discourse_parent_learning_pos)

discourse_learning_data$Measure <- factor(discourse_learning_data$Measure, levels = c('negative construction ratio', 'negative construction cumulative ratio', 'positive construction ratio', 'positive construction cumulative ratio'))

discourse_learning_data_child <- subset(discourse_learning_data, Role == 'Child')
discourse_learning_data_parent <- subset(discourse_learning_data, Role == 'Parent')

discourse_learning_data_plot <- aggregate(Total_ratio~Age+Which+Role,data=discourse_learning_data,sum)

names(discourse_learning_data_plot) <- c('Age', 'Measure', 'Role', 'Total_ratio')


```

<!--
Denial usually involves a subject-predicate structure, with the predicate providing a nominal label or an attribute for an entity. We call such cases of "denial" as labeling.
-->


To capture the function of labeling at the sentence level, we concentrated on copula structures in which the predicate is a nominal or an adjectival phrase. Specifically, the nominal predicates exclude possessive pronouns in order to not overlap with the communicative function of possession (see below). We considered instances where the predicate is modified by negative morphemes as negative, and others as positive. To also avoid overlap with cases of non-existence, none of the utterances contained expletives (e.g. "there is no book"). This resulted in a total of `r format(sum(subset(learning_data,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")` negative utterances (Child: `r format(sum(subset(learning_data_child,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`; Parent: `r format(sum(subset(learning_data_parent,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`), and `r format(sum(subset(learning_data,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")` positive utterances (Child: `r format(sum(subset(learning_data_child,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`; Parent: `r format(sum(subset(learning_data_parent,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`).

|Labeling (Negative)| Labeling (Positive)|
|----------------|----------------|
|*that's not a farmer* | *this is a book*|
|*this is not the book*|*this is nice*|
|*I'm not a heavy baby Mum*|*it's a nice bowl*|
|*It's no good*|*she's pretty*|
Table: (\#tab:label) Examples of sentence-level labeling (negative) and positive counterparts in children's speech.

Figure \@ref(fig:learning) shows ratios and cumulative ratios for parent's and children's production of the labeling construction at the sentence level. In both parents and children, the frequency of positive counterparts is consistently higher than that of negative labeling instances. Children's productions of negative labeling increased between 18-36 months, and remained stable and close to the parent ratios after 36 months.

```{r learning, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap="Ratios and cumulative ratios for the production of (negative) labeling at the sentence level for children between 12 to 72 months of age, and their parents."}

learning_data %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) +
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") + 
  guides(linetype = guide_legend(nrow = 2))

```


```{r learningbegin, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap="Ratios and cumulative ratios for the production of (negative) labeling at the sentence level for children between 12 to 24 months of age, and their parents."}

subset(learning_data, Age<=24) %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) +
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 24, 1)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") + 
  guides(linetype = guide_legend(nrow = 2))

```

<!--
```{r learningul, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap='Labeling and its positive counterparts, indexed by utterance length.'}

learning_ul_data %>% 
  ggplot(aes(as.numeric(as.character(Sent_len)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) +
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 130, 10)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") + 
  guides(linetype = guide_legend(nrow = 2))

```
-->

At the discourse level, we selected antecedent utterances with copula structures that combined with a nominal or an adjectival predicate. Table \@ref(tab:dislabel) shows a few examples. We found `r format(sum(subset(discourse_learning_data,Which=='ratio')$Freq), big.mark=",")` utterances (Child: `r format(sum(subset(discourse_learning_data_child,Which=='ratio')$Freq), big.mark=",")`; Parent: `r format(sum(subset(discourse_learning_data_parent,Which=='ratio')$Freq), big.mark=",")`). Figure \@ref(fig:learningdiscourse) shows the log ratios and cumulative ratios for labeling instances at the discourse level. Children used negation to respond to labeling utterances more frequently between 18 to 30 months. After 30 months, children's productions of negative labeling continues to increase but remains close to parents' level more generally. 

|Antecedent|Utterance|
|------------|------------|
|Parent: *is this one good*|Child: *no it's not*|
|Parent: *are you a captain*|Child: *no I'm not*|
|Child: *that's the one*|Parent: *no it's the green one*|
|Child: *this is the key*|Parent: *no no*|
Table: (\#tab:dislabel) Examples of discourse-level labeling (negative) and their antecedents in parents' and children's speech.

```{r learningdiscourse, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap="Ratios and cumulative ratios for the production of (negative) labeling at the discourse level for children between 12 to 72 months of age, and their parents.",warning=FALSE}

discourse_learning_data_plot %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c('solid', 'dotted')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(16, 3)) +
  scale_color_manual(values = c("darkgreen", "grey")) +
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") 

```

```{r learningdiscoursebegin, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap="Ratios and cumulative ratios for the production of (negative) labeling at the discourse level for children between 12 to 24 months of age, and their parents.",warning=FALSE}

subset(discourse_learning_data_plot, Age<=24) %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c('solid', 'dotted')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(16, 3)) +
  scale_color_manual(values = c("darkgreen", "grey")) +
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 24, 1)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") 

```

### Epistemic Negation

```{r epistemicdata, include=FALSE}

epistemic <-read.csv('data/epistemic.txt', header = T, sep = '\t')
# epistemic <- subset(epistemic, Subj == 'I' | Subj == 'NONE')
epistemic$Role[which(epistemic$Role == "Father")] <- 'Parent'
epistemic$Role[which(epistemic$Role == "Mother")] <- 'Parent'
epistemic$Role[which(epistemic$Role == "Target_Child")] <- 'Child'

epistemic_neg = subset(epistemic, Polarity == 'negative')
epistemic_pos = subset(epistemic, Polarity == 'positive')

child_epistemic_neg <- subset(epistemic_neg, Role %in% c('Child'))
parent_epistemic_neg <- subset(epistemic_neg, Role %in% c('Parent'))

child_know_neg <- subset(child_epistemic_neg, Head %in% c('know'))
child_remember_neg <- subset(child_epistemic_neg, Head %in% c('remember'))
child_think_neg <- subset(child_epistemic_neg, Head %in% c('think'))
parent_know_neg <- subset(parent_epistemic_neg, Head %in% c('know'))
parent_remember_neg <- subset(parent_epistemic_neg, Head %in% c('remember'))
parent_think_neg <- subset(parent_epistemic_neg, Head %in% c('think'))


child_know_neg_mlu <- mlu(child_know_neg)
child_remember_neg_mlu <- mlu(child_remember_neg)
child_think_neg_mlu <- mlu(child_think_neg)
parent_know_neg_mlu <- mlu(parent_know_neg)
parent_remember_neg_mlu <- mlu(parent_remember_neg)
parent_think_neg_mlu <- mlu(parent_think_neg)


child_know_neg <- data.frame(table(child_know_neg$Age))
names(child_know_neg) <- c('Age', 'Freq')
child_know_neg$Role <- rep('Child', nrow(child_know_neg))
child_know_neg$Head <- rep('know', nrow(child_know_neg))
temp <- merge(child_know_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_know_neg <- temp
child_know_neg$Total_ratio <- child_know_neg$Freq / child_know_neg$N_utterance
child_know_neg$Ratio <- child_know_neg$Freq / sum(child_know_neg$Freq)
child_know_neg$Polarity <- rep('negative', nrow(child_know_neg))
child_know_neg$Measure <- rep('negative construction ratio', nrow(child_know_neg))
child_know_neg$Which <- rep('ratio', nrow(child_know_neg))
child_know_neg$Function <- rep('Epistemic', nrow(child_know_neg))
child_know_neg <- negative_cumulative(child_know_neg, child_descriptive)


child_remember_neg <- data.frame(table(child_remember_neg$Age))
names(child_remember_neg) <- c('Age', 'Freq')
child_remember_neg$Role <- rep('Child', nrow(child_remember_neg))
child_remember_neg$Head <- rep('remember', nrow(child_remember_neg))
temp <- merge(child_remember_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_remember_neg <- temp
child_remember_neg$Total_ratio <- child_remember_neg$Freq / child_remember_neg$N_utterance
child_remember_neg$Ratio <- child_remember_neg$Freq / sum(child_remember_neg$Freq)
child_remember_neg$Polarity <- rep('negative', nrow(child_remember_neg))
child_remember_neg$Measure <- rep('negative construction ratio', nrow(child_remember_neg))
child_remember_neg$Which <- rep('ratio', nrow(child_remember_neg))
child_remember_neg$Function <- rep('Epistemic', nrow(child_remember_neg))
child_remember_neg <- negative_cumulative(child_remember_neg, child_descriptive)

child_think_neg <- data.frame(table(child_think_neg$Age))
names(child_think_neg) <- c('Age', 'Freq')
child_think_neg$Role <- rep('Child', nrow(child_think_neg))
child_think_neg$Head <- rep('think', nrow(child_think_neg))
temp <- merge(child_think_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_think_neg <- temp
child_think_neg$Total_ratio <- child_think_neg$Freq / child_think_neg$N_utterance
child_think_neg$Ratio <- child_think_neg$Freq / sum(child_think_neg$Freq)
child_think_neg$Polarity <- rep('negative', nrow(child_think_neg))
child_think_neg$Measure <- rep('negative construction ratio', nrow(child_think_neg))
child_think_neg$Which <- rep('ratio', nrow(child_think_neg))
child_think_neg$Function <- rep('Epistemic', nrow(child_think_neg))
child_think_neg <- negative_cumulative(child_think_neg, child_descriptive)

parent_know_neg <- data.frame(table(parent_know_neg$Age))
names(parent_know_neg) <- c('Age', 'Freq')
parent_know_neg$Role <- rep('Parent', nrow(parent_know_neg))
parent_know_neg$Head <- rep('know', nrow(parent_know_neg))
temp <- merge(parent_know_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_know_neg <- temp
parent_know_neg$Total_ratio <- parent_know_neg$Freq / parent_know_neg$N_utterance
parent_know_neg$Ratio <- parent_know_neg$Freq / sum(parent_know_neg$Freq)
parent_know_neg$Polarity <- rep('negative', nrow(parent_know_neg))
parent_know_neg$Measure <- rep('negative construction ratio', nrow(parent_know_neg))
parent_know_neg$Which <- rep('ratio', nrow(parent_know_neg))
parent_know_neg$Function <- rep('Epistemic', nrow(parent_know_neg))
parent_know_neg <- negative_cumulative(parent_know_neg, parent_descriptive)

parent_remember_neg <- data.frame(table(parent_remember_neg$Age))
names(parent_remember_neg) <- c('Age', 'Freq')
parent_remember_neg$Role <- rep('Parent', nrow(parent_remember_neg))
parent_remember_neg$Head <- rep('remember', nrow(parent_remember_neg))
temp <- merge(parent_remember_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_remember_neg <- temp
parent_remember_neg$Total_ratio <- parent_remember_neg$Freq / parent_remember_neg$N_utterance
parent_remember_neg$Ratio <- parent_remember_neg$Freq / sum(parent_remember_neg$Freq)
parent_remember_neg$Polarity <- rep('negative', nrow(parent_remember_neg))
parent_remember_neg$Measure <- rep('negative construction ratio', nrow(parent_remember_neg))
parent_remember_neg$Which <- rep('ratio', nrow(parent_remember_neg))
parent_remember_neg$Function <- rep('Epistemic', nrow(parent_remember_neg))
parent_remember_neg <- negative_cumulative(parent_remember_neg, parent_descriptive)

parent_think_neg <- data.frame(table(parent_think_neg$Age))
names(parent_think_neg) <- c('Age', 'Freq')
parent_think_neg$Role <- rep('Parent', nrow(parent_think_neg))
parent_think_neg$Head <- rep('think', nrow(parent_think_neg))
temp <- merge(parent_think_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_think_neg <- temp
parent_think_neg$Total_ratio <- parent_think_neg$Freq / parent_think_neg$N_utterance
parent_think_neg$Ratio <- parent_think_neg$Freq / sum(parent_think_neg$Freq)
parent_think_neg$Polarity <- rep('negative', nrow(parent_think_neg))
parent_think_neg$Measure <- rep('negative construction ratio', nrow(parent_think_neg))
parent_think_neg$Which <- rep('ratio', nrow(parent_think_neg))
parent_think_neg$Function <- rep('Epistemic', nrow(parent_think_neg))
parent_think_neg <- negative_cumulative(parent_think_neg, parent_descriptive)


child_epistemic_pos <- subset(epistemic_pos, Role %in% c('Child'))
parent_epistemic_pos <- subset(epistemic_pos, Role %in% c('Parent'))

child_know_pos <- subset(child_epistemic_pos, Head %in% c('know'))
child_remember_pos <- subset(child_epistemic_pos, Head %in% c('remember'))
child_think_pos <- subset(child_epistemic_pos, Head %in% c('think'))
parent_know_pos <- subset(parent_epistemic_pos, Head %in% c('know'))
parent_remember_pos <- subset(parent_epistemic_pos, Head %in% c('remember'))
parent_think_pos <- subset(parent_epistemic_pos, Head %in% c('think'))


child_know_pos_mlu <- mlu(child_know_pos)
child_remember_pos_mlu <- mlu(child_remember_pos)
child_think_pos_mlu <- mlu(child_think_pos)
parent_know_pos_mlu <- mlu(parent_know_pos)
parent_remember_pos_mlu <- mlu(parent_remember_pos)
parent_think_pos_mlu <- mlu(parent_think_pos)


child_know_pos <- data.frame(table(child_know_pos$Age))
names(child_know_pos) <- c('Age', 'Freq')
child_know_pos$Role <- rep('Child', nrow(child_know_pos))
child_know_pos$Head <- rep('know', nrow(child_know_pos))
temp <- merge(child_know_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_know_pos <- temp
child_know_pos$Total_ratio <- child_know_pos$Freq / child_know_pos$N_utterance
child_know_pos$Ratio <- child_know_pos$Freq / sum(child_know_pos$Freq)
child_know_pos$Polarity <- rep('positive', nrow(child_know_pos))
child_know_pos$Measure <- rep('positive construction ratio', nrow(child_know_pos))
child_know_pos$Which <- rep('ratio', nrow(child_know_pos))
child_know_pos$Function <- rep('Epistemic', nrow(child_know_pos))
child_know_pos <- positive_cumulative(child_know_pos, child_descriptive)


child_remember_pos <- data.frame(table(child_remember_pos$Age))
names(child_remember_pos) <- c('Age', 'Freq')
child_remember_pos$Role <- rep('Child', nrow(child_remember_pos))
child_remember_pos$Head <- rep('remember', nrow(child_remember_pos))
temp <- merge(child_remember_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_remember_pos <- temp
child_remember_pos$Total_ratio <- child_remember_pos$Freq / child_remember_pos$N_utterance
child_remember_pos$Ratio <- child_remember_pos$Freq / sum(child_remember_pos$Freq)
child_remember_pos$Polarity <- rep('positive', nrow(child_remember_pos))
child_remember_pos$Measure <- rep('positive construction ratio', nrow(child_remember_pos))
child_remember_pos$Which <- rep('ratio', nrow(child_remember_pos))
child_remember_pos$Function <- rep('Epistemic', nrow(child_remember_pos))
child_remember_pos <- positive_cumulative(child_remember_pos, child_descriptive)

child_think_pos <- data.frame(table(child_think_pos$Age))
names(child_think_pos) <- c('Age', 'Freq')
child_think_pos$Role <- rep('Child', nrow(child_think_pos))
child_think_pos$Head <- rep('think', nrow(child_think_pos))
temp <- merge(child_think_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_think_pos <- temp
child_think_pos$Total_ratio <- child_think_pos$Freq / child_think_pos$N_utterance
child_think_pos$Ratio <- child_think_pos$Freq / sum(child_think_pos$Freq)
child_think_pos$Polarity <- rep('positive', nrow(child_think_pos))
child_think_pos$Measure <- rep('positive construction ratio', nrow(child_think_pos))
child_think_pos$Which <- rep('ratio', nrow(child_think_pos))
child_think_pos$Function <- rep('Epistemic', nrow(child_think_pos))
child_think_pos <- positive_cumulative(child_think_pos, child_descriptive)

parent_know_pos <- data.frame(table(parent_know_pos$Age))
names(parent_know_pos) <- c('Age', 'Freq')
parent_know_pos$Role <- rep('Parent', nrow(parent_know_pos))
parent_know_pos$Head <- rep('know', nrow(parent_know_pos))
temp <- merge(parent_know_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_know_pos <- temp
parent_know_pos$Total_ratio <- parent_know_pos$Freq / parent_know_pos$N_utterance
parent_know_pos$Ratio <- parent_know_pos$Freq / sum(parent_know_pos$Freq)
parent_know_pos$Polarity <- rep('positive', nrow(parent_know_pos))
parent_know_pos$Measure <- rep('positive construction ratio', nrow(parent_know_pos))
parent_know_pos$Which <- rep('ratio', nrow(parent_know_pos))
parent_know_pos$Function <- rep('Epistemic', nrow(parent_know_pos))
parent_know_pos <- positive_cumulative(parent_know_pos, parent_descriptive)

parent_remember_pos <- data.frame(table(parent_remember_pos$Age))
names(parent_remember_pos) <- c('Age', 'Freq')
parent_remember_pos$Role <- rep('Parent', nrow(parent_remember_pos))
parent_remember_pos$Head <- rep('remember', nrow(parent_remember_pos))
temp <- merge(parent_remember_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_remember_pos <- temp
parent_remember_pos$Total_ratio <- parent_remember_pos$Freq / parent_remember_pos$N_utterance
parent_remember_pos$Ratio <- parent_remember_pos$Freq / sum(parent_remember_pos$Freq)
parent_remember_pos$Polarity <- rep('positive', nrow(parent_remember_pos))
parent_remember_pos$Measure <- rep('positive construction ratio', nrow(parent_remember_pos))
parent_remember_pos$Which <- rep('ratio', nrow(parent_remember_pos))
parent_remember_pos$Function <- rep('Epistemic', nrow(parent_remember_pos))
parent_remember_pos <- positive_cumulative(parent_remember_pos, parent_descriptive)

parent_think_pos <- data.frame(table(parent_think_pos$Age))
names(parent_think_pos) <- c('Age', 'Freq')
parent_think_pos$Role <- rep('Parent', nrow(parent_think_pos))
parent_think_pos$Head <- rep('think', nrow(parent_think_pos))
temp <- merge(parent_think_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_think_pos <- temp
parent_think_pos$Total_ratio <- parent_think_pos$Freq / parent_think_pos$N_utterance
parent_think_pos$Ratio <- parent_think_pos$Freq / sum(parent_think_pos$Freq)
parent_think_pos$Polarity <- rep('positive', nrow(parent_think_pos))
parent_think_pos$Measure <- rep('positive construction ratio', nrow(parent_think_pos))
parent_think_pos$Which <- rep('ratio', nrow(parent_think_pos))
parent_think_pos$Function <- rep('Epistemic', nrow(parent_think_pos))
parent_think_pos <- positive_cumulative(parent_think_pos, parent_descriptive)

epistemic_data <- rbind(child_know_neg, child_know_pos, parent_know_neg, parent_know_pos, child_remember_neg, child_remember_pos, parent_remember_neg, parent_remember_pos, child_think_neg, child_think_pos, parent_think_neg, parent_think_pos)

epistemic_data$Measure <- factor(epistemic_data$Measure, levels = c('negative construction ratio', 'negative construction cumulative ratio', 'positive construction ratio', 'positive construction cumulative ratio'))

epistemic_data_child <- subset(epistemic_data, Role == 'Child')
epistemic_data_parent <- subset(epistemic_data, Role == 'Parent')

```

```{r epistemiculdata, include=FALSE}

child_ul_know_neg <- subset(child_epistemic_neg, Head %in% c('know'))
child_ul_remember_neg <- subset(child_epistemic_neg, Head %in% c('remember'))
child_ul_think_neg <- subset(child_epistemic_neg, Head %in% c('think'))
parent_ul_know_neg <- subset(parent_epistemic_neg, Head %in% c('know'))
parent_ul_remember_neg <- subset(parent_epistemic_neg, Head %in% c('remember'))
parent_ul_think_neg <- subset(parent_epistemic_neg, Head %in% c('think'))

child_ul_know_neg <- data.frame(table(child_ul_know_neg$Sent_len))
names(child_ul_know_neg) <- c('Sent_len', 'Freq')
child_ul_know_neg$Role <- rep('Child', nrow(child_ul_know_neg))
child_ul_know_neg$Head <- rep('know', nrow(child_ul_know_neg))
temp <- merge(child_ul_know_neg, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_know_neg <- temp
child_ul_know_neg$Total_ratio <- child_ul_know_neg$Freq / child_ul_know_neg$N_utterance
child_ul_know_neg$Ratio <- child_ul_know_neg$Freq / sum(child_ul_know_neg$Freq)
child_ul_know_neg$Polarity <- rep('negative', nrow(child_ul_know_neg))
child_ul_know_neg$Measure <- rep('negative construction ratio', nrow(child_ul_know_neg))
child_ul_know_neg$Which <- rep('ratio', nrow(child_ul_know_neg))
child_ul_know_neg$Function <- rep('Epistemic', nrow(child_ul_know_neg))
child_ul_know_neg <- negative_ul_cumulative(child_ul_know_neg, child_ul_descriptive)

child_ul_remember_neg <- data.frame(table(child_ul_remember_neg$Sent_len))
names(child_ul_remember_neg) <- c('Sent_len', 'Freq')
child_ul_remember_neg$Role <- rep('Child', nrow(child_ul_remember_neg))
child_ul_remember_neg$Head <- rep('remember', nrow(child_ul_remember_neg))
temp <- merge(child_ul_remember_neg, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_remember_neg <- temp
child_ul_remember_neg$Total_ratio <- child_ul_remember_neg$Freq / child_ul_remember_neg$N_utterance
child_ul_remember_neg$Ratio <- child_ul_remember_neg$Freq / sum(child_ul_remember_neg$Freq)
child_ul_remember_neg$Polarity <- rep('negative', nrow(child_ul_remember_neg))
child_ul_remember_neg$Measure <- rep('negative construction ratio', nrow(child_ul_remember_neg))
child_ul_remember_neg$Which <- rep('ratio', nrow(child_ul_remember_neg))
child_ul_remember_neg$Function <- rep('Epistemic', nrow(child_ul_remember_neg))
child_ul_remember_neg <- negative_ul_cumulative(child_ul_remember_neg, child_ul_descriptive)

child_ul_think_neg <- data.frame(table(child_ul_think_neg$Sent_len))
names(child_ul_think_neg) <- c('Sent_len', 'Freq')
child_ul_think_neg$Role <- rep('Child', nrow(child_ul_think_neg))
child_ul_think_neg$Head <- rep('think', nrow(child_ul_think_neg))
temp <- merge(child_ul_think_neg, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_think_neg <- temp
child_ul_think_neg$Total_ratio <- child_ul_think_neg$Freq / child_ul_think_neg$N_utterance
child_ul_think_neg$Ratio <- child_ul_think_neg$Freq / sum(child_ul_think_neg$Freq)
child_ul_think_neg$Polarity <- rep('negative', nrow(child_ul_think_neg))
child_ul_think_neg$Measure <- rep('negative construction ratio', nrow(child_ul_think_neg))
child_ul_think_neg$Which <- rep('ratio', nrow(child_ul_think_neg))
child_ul_think_neg$Function <- rep('Epistemic', nrow(child_ul_think_neg))
child_ul_think_neg <- negative_ul_cumulative(child_ul_think_neg, child_ul_descriptive)

parent_ul_know_neg <- data.frame(table(parent_ul_know_neg$Sent_len))
names(parent_ul_know_neg) <- c('Sent_len', 'Freq')
parent_ul_know_neg$Role <- rep('Parent', nrow(parent_ul_know_neg))
parent_ul_know_neg$Head <- rep('know', nrow(parent_ul_know_neg))
temp <- merge(parent_ul_know_neg, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_know_neg <- temp
parent_ul_know_neg$Total_ratio <- parent_ul_know_neg$Freq / parent_ul_know_neg$N_utterance
parent_ul_know_neg$Ratio <- parent_ul_know_neg$Freq / sum(parent_ul_know_neg$Freq)
parent_ul_know_neg$Polarity <- rep('negative', nrow(parent_ul_know_neg))
parent_ul_know_neg$Measure <- rep('negative construction ratio', nrow(parent_ul_know_neg))
parent_ul_know_neg$Which <- rep('ratio', nrow(parent_ul_know_neg))
parent_ul_know_neg$Function <- rep('Epistemic', nrow(parent_ul_know_neg))
parent_ul_know_neg <- negative_ul_cumulative(parent_ul_know_neg, parent_ul_descriptive)

parent_ul_remember_neg <- data.frame(table(parent_ul_remember_neg$Sent_len))
names(parent_ul_remember_neg) <- c('Sent_len', 'Freq')
parent_ul_remember_neg$Role <- rep('Parent', nrow(parent_ul_remember_neg))
parent_ul_remember_neg$Head <- rep('remember', nrow(parent_ul_remember_neg))
temp <- merge(parent_ul_remember_neg, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_remember_neg <- temp
parent_ul_remember_neg$Total_ratio <- parent_ul_remember_neg$Freq / parent_ul_remember_neg$N_utterance
parent_ul_remember_neg$Ratio <- parent_ul_remember_neg$Freq / sum(parent_ul_remember_neg$Freq)
parent_ul_remember_neg$Polarity <- rep('negative', nrow(parent_ul_remember_neg))
parent_ul_remember_neg$Measure <- rep('negative construction ratio', nrow(parent_ul_remember_neg))
parent_ul_remember_neg$Which <- rep('ratio', nrow(parent_ul_remember_neg))
parent_ul_remember_neg$Function <- rep('Epistemic', nrow(parent_ul_remember_neg))
parent_ul_remember_neg <- negative_ul_cumulative(parent_ul_remember_neg, parent_ul_descriptive)

parent_ul_think_neg <- data.frame(table(parent_ul_think_neg$Sent_len))
names(parent_ul_think_neg) <- c('Sent_len', 'Freq')
parent_ul_think_neg$Role <- rep('Parent', nrow(parent_ul_think_neg))
parent_ul_think_neg$Head <- rep('think', nrow(parent_ul_think_neg))
temp <- merge(parent_ul_think_neg, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_think_neg <- temp
parent_ul_think_neg$Total_ratio <- parent_ul_think_neg$Freq / parent_ul_think_neg$N_utterance
parent_ul_think_neg$Ratio <- parent_ul_think_neg$Freq / sum(parent_ul_think_neg$Freq)
parent_ul_think_neg$Polarity <- rep('negative', nrow(parent_ul_think_neg))
parent_ul_think_neg$Measure <- rep('negative construction ratio', nrow(parent_ul_think_neg))
parent_ul_think_neg$Which <- rep('ratio', nrow(parent_ul_think_neg))
parent_ul_think_neg$Function <- rep('Epistemic', nrow(parent_ul_think_neg))
parent_ul_think_neg <- negative_ul_cumulative(parent_ul_think_neg, parent_ul_descriptive)


child_ul_know_pos <- subset(child_epistemic_pos, Head %in% c('know'))
child_ul_remember_pos <- subset(child_epistemic_pos, Head %in% c('remember'))
child_ul_think_pos <- subset(child_epistemic_pos, Head %in% c('think'))
parent_ul_know_pos <- subset(parent_epistemic_pos, Head %in% c('know'))
parent_ul_remember_pos <- subset(parent_epistemic_pos, Head %in% c('remember'))
parent_ul_think_pos <- subset(parent_epistemic_pos, Head %in% c('think'))

child_ul_know_pos <- data.frame(table(child_ul_know_pos$Sent_len))
names(child_ul_know_pos) <- c('Sent_len', 'Freq')
child_ul_know_pos$Role <- rep('Child', nrow(child_ul_know_pos))
child_ul_know_pos$Head <- rep('know', nrow(child_ul_know_pos))
temp <- merge(child_ul_know_pos, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_know_pos <- temp
child_ul_know_pos$Total_ratio <- child_ul_know_pos$Freq / child_ul_know_pos$N_utterance
child_ul_know_pos$Ratio <- child_ul_know_pos$Freq / sum(child_ul_know_pos$Freq)
child_ul_know_pos$Polarity <- rep('positive', nrow(child_ul_know_pos))
child_ul_know_pos$Measure <- rep('positive construction ratio', nrow(child_ul_know_pos))
child_ul_know_pos$Which <- rep('ratio', nrow(child_ul_know_pos))
child_ul_know_pos$Function <- rep('Epistemic', nrow(child_ul_know_pos))
child_ul_know_pos <- positive_ul_cumulative(child_ul_know_pos, child_ul_descriptive)


child_ul_remember_pos <- data.frame(table(child_ul_remember_pos$Sent_len))
names(child_ul_remember_pos) <- c('Sent_len', 'Freq')
child_ul_remember_pos$Role <- rep('Child', nrow(child_ul_remember_pos))
child_ul_remember_pos$Head <- rep('remember', nrow(child_ul_remember_pos))
temp <- merge(child_ul_remember_pos, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_remember_pos <- temp
child_ul_remember_pos$Total_ratio <- child_ul_remember_pos$Freq / child_ul_remember_pos$N_utterance
child_ul_remember_pos$Ratio <- child_ul_remember_pos$Freq / sum(child_ul_remember_pos$Freq)
child_ul_remember_pos$Polarity <- rep('positive', nrow(child_ul_remember_pos))
child_ul_remember_pos$Measure <- rep('positive construction ratio', nrow(child_ul_remember_pos))
child_ul_remember_pos$Which <- rep('ratio', nrow(child_ul_remember_pos))
child_ul_remember_pos$Function <- rep('Epistemic', nrow(child_ul_remember_pos))
child_ul_remember_pos <- positive_ul_cumulative(child_ul_remember_pos, child_ul_descriptive)

child_ul_think_pos <- data.frame(table(child_ul_think_pos$Sent_len))
names(child_ul_think_pos) <- c('Sent_len', 'Freq')
child_ul_think_pos$Role <- rep('Child', nrow(child_ul_think_pos))
child_ul_think_pos$Head <- rep('think', nrow(child_ul_think_pos))
temp <- merge(child_ul_think_pos, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_think_pos <- temp
child_ul_think_pos$Total_ratio <- child_ul_think_pos$Freq / child_ul_think_pos$N_utterance
child_ul_think_pos$Ratio <- child_ul_think_pos$Freq / sum(child_ul_think_pos$Freq)
child_ul_think_pos$Polarity <- rep('positive', nrow(child_ul_think_pos))
child_ul_think_pos$Measure <- rep('positive construction ratio', nrow(child_ul_think_pos))
child_ul_think_pos$Which <- rep('ratio', nrow(child_ul_think_pos))
child_ul_think_pos$Function <- rep('Epistemic', nrow(child_ul_think_pos))
child_ul_think_pos <- positive_ul_cumulative(child_ul_think_pos, child_ul_descriptive)

parent_ul_know_pos <- data.frame(table(parent_ul_know_pos$Sent_len))
names(parent_ul_know_pos) <- c('Sent_len', 'Freq')
parent_ul_know_pos$Role <- rep('Parent', nrow(parent_ul_know_pos))
parent_ul_know_pos$Head <- rep('know', nrow(parent_ul_know_pos))
temp <- merge(parent_ul_know_pos, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_know_pos <- temp
parent_ul_know_pos$Total_ratio <- parent_ul_know_pos$Freq / parent_ul_know_pos$N_utterance
parent_ul_know_pos$Ratio <- parent_ul_know_pos$Freq / sum(parent_ul_know_pos$Freq)
parent_ul_know_pos$Polarity <- rep('positive', nrow(parent_ul_know_pos))
parent_ul_know_pos$Measure <- rep('positive construction ratio', nrow(parent_ul_know_pos))
parent_ul_know_pos$Which <- rep('ratio', nrow(parent_ul_know_pos))
parent_ul_know_pos$Function <- rep('Epistemic', nrow(parent_ul_know_pos))
parent_ul_know_pos <- positive_ul_cumulative(parent_ul_know_pos, parent_ul_descriptive)

parent_ul_remember_pos <- data.frame(table(parent_ul_remember_pos$Sent_len))
names(parent_ul_remember_pos) <- c('Sent_len', 'Freq')
parent_ul_remember_pos$Role <- rep('Parent', nrow(parent_ul_remember_pos))
parent_ul_remember_pos$Head <- rep('remember', nrow(parent_ul_remember_pos))
temp <- merge(parent_ul_remember_pos, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_remember_pos <- temp
parent_ul_remember_pos$Total_ratio <- parent_ul_remember_pos$Freq / parent_ul_remember_pos$N_utterance
parent_ul_remember_pos$Ratio <- parent_ul_remember_pos$Freq / sum(parent_ul_remember_pos$Freq)
parent_ul_remember_pos$Polarity <- rep('positive', nrow(parent_ul_remember_pos))
parent_ul_remember_pos$Measure <- rep('positive construction ratio', nrow(parent_ul_remember_pos))
parent_ul_remember_pos$Which <- rep('ratio', nrow(parent_ul_remember_pos))
parent_ul_remember_pos$Function <- rep('Epistemic', nrow(parent_ul_remember_pos))
parent_ul_remember_pos <- positive_ul_cumulative(parent_ul_remember_pos, parent_ul_descriptive)

parent_ul_think_pos <- data.frame(table(parent_ul_think_pos$Sent_len))
names(parent_ul_think_pos) <- c('Sent_len', 'Freq')
parent_ul_think_pos$Role <- rep('Parent', nrow(parent_ul_think_pos))
parent_ul_think_pos$Head <- rep('think', nrow(parent_ul_think_pos))
temp <- merge(parent_ul_think_pos, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_think_pos <- temp
parent_ul_think_pos$Total_ratio <- parent_ul_think_pos$Freq / parent_ul_think_pos$N_utterance
parent_ul_think_pos$Ratio <- parent_ul_think_pos$Freq / sum(parent_ul_think_pos$Freq)
parent_ul_think_pos$Polarity <- rep('positive', nrow(parent_ul_think_pos))
parent_ul_think_pos$Measure <- rep('positive construction ratio', nrow(parent_ul_think_pos))
parent_ul_think_pos$Which <- rep('ratio', nrow(parent_ul_think_pos))
parent_ul_think_pos$Function <- rep('Epistemic', nrow(parent_ul_think_pos))
parent_ul_think_pos <- positive_ul_cumulative(parent_ul_think_pos, parent_ul_descriptive)

epistemic_ul_data <- rbind(child_ul_know_neg, child_ul_know_pos, parent_ul_know_neg, parent_ul_know_pos, child_ul_remember_neg, child_ul_remember_pos, parent_ul_remember_neg, parent_ul_remember_pos, child_ul_think_neg, child_ul_think_pos, parent_ul_think_neg, parent_ul_think_pos)

epistemic_ul_data$Measure <- factor(epistemic_ul_data$Measure, levels = c('negative construction ratio', 'negative construction cumulative ratio', 'positive construction ratio', 'positive construction cumulative ratio'))

epistemic_ul_data_child <- subset(epistemic_ul_data, Role == 'Child')
epistemic_ul_data_parent <- subset(epistemic_ul_data, Role == 'Parent')

```

```{r epistemicdiscoursedata, include=FALSE}

discourse_epistemic <-read.csv('data/epistemic_discourse.txt', header = T, sep = '\t')
discourse_epistemic$Role[which(discourse_epistemic$Role == "Father")] <- 'Parent'
discourse_epistemic$Role[which(discourse_epistemic$Role == "Mother")] <- 'Parent'
discourse_epistemic$Role[which(discourse_epistemic$Role == "Target_Child")] <- 'Child'

discourse_epistemic_neg = subset(discourse_epistemic, Polarity == 'negative')
discourse_epistemic_pos = subset(discourse_epistemic, Polarity == 'positive')

discourse_child_epistemic_neg <- subset(discourse_epistemic_neg, Role %in% c('Child'))
discourse_parent_epistemic_neg <- subset(discourse_epistemic_neg, Role %in% c('Parent'))

discourse_child_epistemic_neg <- data.frame(table(discourse_child_epistemic_neg$Age))
names(discourse_child_epistemic_neg) <- c('Age', 'Freq')
discourse_child_epistemic_neg$Role <- rep('Child', nrow(discourse_child_epistemic_neg))
discourse_child_epistemic_neg$Head <- rep('all', nrow(discourse_child_epistemic_neg))
temp <- merge(discourse_child_epistemic_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_epistemic_neg <- temp
discourse_child_epistemic_neg$Total_ratio <- discourse_child_epistemic_neg$Freq / discourse_child_epistemic_neg$N_utterance
discourse_child_epistemic_neg$Ratio <- discourse_child_epistemic_neg$Freq / sum(discourse_child_epistemic_neg$Freq)
discourse_child_epistemic_neg$Polarity <- rep('negative', nrow(discourse_child_epistemic_neg))
discourse_child_epistemic_neg$Measure <- rep('negative construction ratio', nrow(discourse_child_epistemic_neg))
discourse_child_epistemic_neg$Which <- rep('ratio', nrow(discourse_child_epistemic_neg))
discourse_child_epistemic_neg$Function <- rep('Epistemic', nrow(discourse_child_epistemic_neg))
discourse_child_epistemic_neg <- negative_cumulative(discourse_child_epistemic_neg, child_descriptive)

discourse_parent_epistemic_neg <- data.frame(table(discourse_parent_epistemic_neg$Age))
names(discourse_parent_epistemic_neg) <- c('Age', 'Freq')
discourse_parent_epistemic_neg$Role <- rep('Parent', nrow(discourse_parent_epistemic_neg))
discourse_parent_epistemic_neg$Head <- rep('al', nrow(discourse_parent_epistemic_neg))
temp <- merge(discourse_parent_epistemic_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_epistemic_neg <- temp
discourse_parent_epistemic_neg$Total_ratio <- discourse_parent_epistemic_neg$Freq / discourse_parent_epistemic_neg$N_utterance
discourse_parent_epistemic_neg$Ratio <- discourse_parent_epistemic_neg$Freq / sum(discourse_parent_epistemic_neg$Freq)
discourse_parent_epistemic_neg$Polarity <- rep('negative', nrow(discourse_parent_epistemic_neg))
discourse_parent_epistemic_neg$Measure <- rep('negative construction ratio', nrow(discourse_parent_epistemic_neg))
discourse_parent_epistemic_neg$Which <- rep('ratio', nrow(discourse_parent_epistemic_neg))
discourse_parent_epistemic_neg$Function <- rep('Epistemic', nrow(discourse_parent_epistemic_neg))
discourse_parent_epistemic_neg <- negative_cumulative(discourse_parent_epistemic_neg, parent_descriptive)

discourse_child_epistemic_pos <- subset(discourse_epistemic_pos, Role %in% c('Child'))
discourse_parent_epistemic_pos <- subset(discourse_epistemic_pos, Role %in% c('Parent'))

discourse_child_epistemic_pos <- data.frame(table(discourse_child_epistemic_pos$Age))
names(discourse_child_epistemic_pos) <- c('Age', 'Freq')
discourse_child_epistemic_pos$Role <- rep('Child', nrow(discourse_child_epistemic_pos))
discourse_child_epistemic_pos$Head <- rep('all', nrow(discourse_child_epistemic_pos))
temp <- merge(discourse_child_epistemic_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_epistemic_pos <- temp
discourse_child_epistemic_pos$Total_ratio <- discourse_child_epistemic_pos$Freq / discourse_child_epistemic_pos$N_utterance
discourse_child_epistemic_pos$Ratio <- discourse_child_epistemic_pos$Freq / sum(discourse_child_epistemic_pos$Freq)
discourse_child_epistemic_pos$Polarity <- rep('positive', nrow(discourse_child_epistemic_pos))
discourse_child_epistemic_pos$Measure <- rep('positive construction ratio', nrow(discourse_child_epistemic_pos))
discourse_child_epistemic_pos$Which <- rep('ratio', nrow(discourse_child_epistemic_pos))
discourse_child_epistemic_pos$Function <- rep('Epistemic', nrow(discourse_child_epistemic_pos))
discourse_child_epistemic_pos <- positive_cumulative(discourse_child_epistemic_pos, child_descriptive)


discourse_parent_epistemic_pos <- data.frame(table(discourse_parent_epistemic_pos$Age))
names(discourse_parent_epistemic_pos) <- c('Age', 'Freq')
discourse_parent_epistemic_pos$Role <- rep('Parent', nrow(discourse_parent_epistemic_pos))
discourse_parent_epistemic_pos$Head <- rep('all', nrow(discourse_parent_epistemic_pos))
temp <- merge(discourse_parent_epistemic_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_epistemic_pos <- temp
discourse_parent_epistemic_pos$Total_ratio <- discourse_parent_epistemic_pos$Freq / discourse_parent_epistemic_pos$N_utterance
discourse_parent_epistemic_pos$Ratio <- discourse_parent_epistemic_pos$Freq / sum(discourse_parent_epistemic_pos$Freq)
discourse_parent_epistemic_pos$Polarity <- rep('positive', nrow(discourse_parent_epistemic_pos))
discourse_parent_epistemic_pos$Measure <- rep('positive construction ratio', nrow(discourse_parent_epistemic_pos))
discourse_parent_epistemic_pos$Which <- rep('ratio', nrow(discourse_parent_epistemic_pos))
discourse_parent_epistemic_pos$Function <- rep('Epistemic', nrow(discourse_parent_epistemic_pos))
discourse_parent_epistemic_pos <- positive_cumulative(discourse_parent_epistemic_pos, parent_descriptive)

discourse_epistemic_data <- rbind(discourse_child_epistemic_neg, discourse_parent_epistemic_neg, discourse_child_epistemic_pos, discourse_parent_epistemic_pos)

discourse_epistemic_data$Measure <- factor(discourse_epistemic_data$Measure, levels = c('negative construction ratio', 'negative construction cumulative ratio', 'positive construction ratio', 'positive construction cumulative ratio'))

discourse_epistemic_data_child <- subset(discourse_epistemic_data, Role == 'Child')
discourse_epistemic_data_parent <- subset(discourse_epistemic_data, Role == 'Parent')

discourse_epistemic_data_plot <- aggregate(Total_ratio~Age+Which+Role,data=discourse_epistemic_data,sum)

names(discourse_epistemic_data_plot) <- c('Age', 'Measure', 'Role', 'Total_ratio')

```

Previous studies have reported instances in which children combined negative morphemes with mental state verbs such as *know*, *think*, and *remember* to express "epistemic negation" [@choi1988semantic]. For defining epistemic constructions we also focused on these three verbs. For sentence level epistemic negation, we analyzed negative utterances where these verbs were modified by negative morphemes, possibly after combining with an auxiliary verb like *do*. Table \@ref(tab:epistem) shows a few examples. Instances where the speaker asked about or describes the negative epistemic state of another speaker were also included, leading to `r format(sum(subset(epistemic_data,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")` negative utterances in total (child: `r format(sum(subset(epistemic_data_child,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`; parent: `r format(sum(subset(epistemic_data_parent,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`). For the positive counterparts, we selected instances with the same head verbs except that these verbs were not modified by negation. This resulted in a total of `r format(sum(subset(epistemic_data,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")` negative utterances (child: `r format(sum(subset(epistemic_data_child,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`; parent: `r format(sum(subset(epistemic_data_parent,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`).

|Epistemic (Negative)| Epistemic (Positive)|
|----------------|----------------|
|*I not know* | *I knows*|
|*I didn't remember*| *she remembers*|
|*I don't think so*|*he thinks this one is good*|
|*She doesn't know this*|*She knows about this*|
Table: (\#tab:epistem) Examples of sentence-level epistemic negation and positive counterparts in children's speech.

Figure \@ref(fig:epistemic) shows log ratios and cumulative ratios of the epistemic construction as defined above in parents' and children's speech at the sentence level. Overall, positive epistemic utterances were more frequent than negative epistemic utterances, with the possible exception of *know* for children. The production of negative utterances headed by *know* was comparatively the highest among children, and became more frequent at an earlier age (17-18 months) compared to that of *remember* (~19 months) or *think* (~20 months). Across the three head verbs, children's productions with *know* and *remember* gradually approaches that of parents' around 30 - 36 months, whereas cases with the head verb *think* tend to be produced less frequently by children.

```{r epistemic, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=7, set.cap.width=T, num.cols.cap=1, fig.cap="Ratios and cumulative ratios for the production of epistemic negation at the sentence level for children between 12 to 72 months of age, and their parents."}

epistemic_data %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) +
  facet_grid(Head ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") + 
  guides(linetype = guide_legend(nrow = 2))

```


```{r epistemicbegin, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=7, set.cap.width=T, num.cols.cap=1, fig.cap="Ratios and cumulative ratios for the production of epistemic negation at the sentence level for children between 12 to 24 months of age, and their parents."}

subset(epistemic_data, Age<=24) %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) +
  facet_grid(Head ~ Role) +
  scale_x_continuous(breaks=seq(0, 24, 1)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") + 
  guides(linetype = guide_legend(nrow = 2))

```

<!--
```{r epistemicul, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=7, set.cap.width=T, num.cols.cap=1, fig.cap='Epistemic negation and its positive counterparts, indexed by utterance length.'}

epistemic_ul_data %>% 
  ggplot(aes(as.numeric(as.character(Sent_len)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) +
  facet_grid(Head ~ Role) +
  scale_x_continuous(breaks=seq(0, 130, 10)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") + 
  guides(linetype = guide_legend(nrow = 2))

```
-->

For epistemic negation at the discourse level, we examined interactions in which the antecedent utterances took any of the three head verbs *know*, *remember* and *think*, leading to a total of `r format(sum(subset(discourse_epistemic_data,Which=='ratio')$Freq), big.mark=",")` utterances (child: `r format(sum(subset(epistemic_data_child,Which=='ratio')$Freq), big.mark=",")`; parent: `r format(sum(subset(epistemic_data_parent,Which=='ratio')$Freq), big.mark=",")`). Figure \@ref(fig:epistemicdiscourse) shows log ratios and cumulative ratios for epistemic negation at the discourse level. Children's productions increase rapidly between 24-36 months and after 36 months, they produce this construction close to parent levels.

|Epistemic (Negative)| Epistemic (Positive)|
|----------------|----------------|
|*I not know* | *I knows*|
|*I didn't remember*| *she remembers*|
|*I don't think so*|*he thinks this one is good*|
|*She doesn't know this*|*She knows about this*|
Table: (\#tab:epistem) Examples of sentence-level epistemic negation and positive counterparts in children's speech.

```{r epistemicdiscourse, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap="Ratios and cumulative ratios for the production of epistemic negation at the discourse level for children between 12 to 72 months of age, and their parents.",warning=FALSE}

discourse_epistemic_data_plot %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c('solid', 'dotted')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(16, 3)) +
  scale_color_manual(values = c("darkgreen", "grey")) +
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") 

```


```{r epistemicdiscoursebegin, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap="Ratios and cumulative ratios for the production of epistemic negation at the discourse level for children between 12 to 24 months of age, and their parents.",warning=FALSE}

subset(discourse_epistemic_data_plot, Age<=24) %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c('solid', 'dotted')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(16, 3)) +
  scale_color_manual(values = c("darkgreen", "grey")) +
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 24, 1)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") 

```


### Possession

The last function we explored was "possession". At the syntactic level, for negative structures we selected cases where negative morphemes were combined with auxiliary verbs to modify a head verb with the lemma form *have* and a POS tag of VERB. We also included individual noun phrases with possessive pronouns as heads and modified by negative morphemes. Table \@ref(tab:possess) shows a few examples. Cases in which the syntactic head of the negative morphemes is a predicate of a copula verb (e.g. "this is not mine") were excluded to separate them from the function "labeling". The number of negative utterances that were subjected to analysis for this function is `r format(sum(subset(possession_data,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`  (child: `r format(sum(subset(possession_data_child,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`; parent: `r format(sum(subset(possession_data_parent,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`). Again the positive counterparts share similar structures except with no negation, leading to a total of `r format(sum(subset(possession_data,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`  (child: `r format(sum(subset(possession_data_child,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`; parent: `r format(sum(subset(possession_data_parent,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`). One thing to note here is that for the positive structures with the head verb *have*, we restricted to cases where the verb takes a direct object (with the dependency relation *obj*). This is to avoid potential parsing errors of instances such as *I have*, where the verb could ambiguously be an auxiliary.

|Posession (Negative)| Posession (Positive)|
|----------------|----------------|
|*I don't have it* | *you have that*|
|*you don't have my toy car* | *she has it*|
|*not mine*|*hers*|
|*not yours either*|*mine mine mine*|
Table: (\#tab:possess) Examples of sentence-level possession and positive counterparts in children's speech.

Figure \@ref(fig:possession) shows log ratios and cumulative ratios of the negative and positive possession construction at the sentence level. The production trajectory for possession in child speech appears to have notable differences depending on what the negative morpheme modifies. With *have* as the syntactic head, children increase their productions between 18-36 months, and stay close to parent levels of production after 36 months. However, for utterances headed by possessive pronouns, productions increase rapidly between 18-24 months and stays close to parent levels as early as 24 months of age.

```{r possession, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=5, set.cap.width=T, num.cols.cap=1, fig.cap="Ratios and cumulative ratios for the production of possession at the sentence level for children between 12 to 72 months of age, and their parents."}

possession_data %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) +
  facet_grid(Head ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") + 
  guides(linetype = guide_legend(nrow = 2))

```


```{r possessionbegin, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=5, set.cap.width=T, num.cols.cap=1, fig.cap="Ratios and cumulative ratios for the production of possession at the sentence level for children between 12 to 24 months of age, and their parents."}

subset(possession_data, Age<=24) %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) +
  facet_grid(Head ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") + 
  guides(linetype = guide_legend(nrow = 2))

```

<!--
```{r possessionul, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=5, set.cap.width=T, num.cols.cap=1, fig.cap='Possession and its positive counterparts, indexed by utterance length.'}

possession_ul_data %>% 
  ggplot(aes(as.numeric(as.character(Sent_len)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) +
  facet_grid(Head ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") + 
  guides(linetype = guide_legend(nrow = 2))

```
-->

At the discourse level, we selected antecedents to discourse level negative utterances (e.g. *no!*) which themselves had structures similar to both the negative and positive constructions at the syntactic level. Table \@ref(tab:dispossess) provides a few examples and Figure \@ref(fig:possessiondiscourse) shows log ratios and cumulative ratios of such utterances in parents' and children's speech. Overall, the production pattern for discourse level possession suggests that children produce such utterances frequently and at parents' level after 30 or 36 months of age.

|Antecedent|Utterance|
|------------|------------|
|Parent: *not yours*|Child: *no it's mine mine*|
|Parent: *do you still have that picture*|Child: *no*|
|Child: *I don't have the book*|Parent: *no no mommy please read it to me*|
|Child: *mommy has it*|Parent: *no mommy gave it back to your auntie*|
Table: (\#tab:dispossess) Examples of discourse-level possession and their antecedents in parents' and children's speech.

```{r possessiondiscourse, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap="Ratios and cumulative ratios for the production of possession at the discourse level for children between 12 to 72 months of age, and their parents.",warning=FALSE}

discourse_possession_data_plot %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c('solid', 'dotted')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16)) +
  scale_color_manual(values = c("darkgreen", "grey")) +
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") 

```

```{r possessiondiscoursebegin, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap="Ratios and cumulative ratios for the production of possession at the discourse level for children between 12 to 24 months of age, and their parents.",warning=FALSE}

subset(discourse_possession_data_plot, Age<=24) %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c('solid', 'dotted')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16)) +
  scale_color_manual(values = c("darkgreen", "grey")) +
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") 

```

### Discussion 

```{r alldata, include=FALSE}

all <- rbind(emotion_data, epistemic_data, prohibition_data, inability_data, learning_data, existence_data, possession_data)
together <- subset(all, Which == 'cumulative ratio')
child_all <- subset(together, Role %in% c('Target_Child', 'Child'))
parent_all <- subset(together, Role %in% c('Parent'))

child_neg_together <- aggregate(Freq ~ Age + Function, data = subset(child_all, Polarity == 'negative'), sum)
child_neg_together$Role <- rep('Child', nrow(child_neg_together))
child_neg_together$Total_ratio <- rep(0, nrow(child_neg_together))

for (i in 1:nrow(child_neg_together)){
  age = as.numeric(as.character(child_neg_together$Age[i]))
  data = subset(child_descriptive, Age <= age)
  child_neg_together$Total_ratio[i] = child_neg_together$Freq[i] / sum(data$N_utterance)

  }

parent_neg_together <- aggregate(Freq ~ Age + Function, data = subset(parent_all, Polarity == 'negative'), sum)
parent_neg_together$Role <- rep('Parent', nrow(parent_neg_together))
parent_neg_together$Total_ratio <- rep(0, nrow(parent_neg_together))

for (i in 1:nrow(parent_neg_together)){
  age = as.numeric(as.character(parent_neg_together$Age[i]))
  data = subset(parent_descriptive, Age <= age)
  parent_neg_together$Total_ratio[i] = parent_neg_together$Freq[i] / sum(data$N_utterance)

  }


neg_together_final <- rbind(child_neg_together, parent_neg_together)

child_pos_together <- aggregate(Freq ~ Age + Function, data = subset(child_all, Polarity == 'positive'), sum)
child_pos_together$Role <- rep('Child', nrow(child_pos_together))
child_pos_together$Total_ratio <- rep(0, nrow(child_pos_together))

for (i in 1:nrow(child_pos_together)){
  age = as.numeric(as.character(child_pos_together$Age[i]))
  data = subset(child_descriptive, Age <= age)
  child_pos_together$Total_ratio[i] = child_pos_together$Freq[i] / sum(data$N_utterance)

  }

parent_pos_together <- aggregate(Freq ~ Age + Function, data = subset(parent_all, Polarity == 'positive'), sum)
parent_pos_together$Role <- rep('Parent', nrow(parent_pos_together))
parent_pos_together$Total_ratio <- rep(0, nrow(parent_pos_together))

for (i in 1:nrow(parent_pos_together)){
  age = as.numeric(as.character(parent_pos_together$Age[i]))
  data = subset(parent_descriptive, Age <= age)
  parent_pos_together$Total_ratio[i] = parent_pos_together$Freq[i] / sum(data$N_utterance)

  }


pos_together_final <- rbind(child_pos_together, parent_pos_together)


```

Figure \@ref(fig:allneg) shows the log cumulative ratios of all our negative constructions at the sentence level. Looking at parents' productions (right panel), we see that for most constructions, parents produce them at constant rates across age bins. A notable exception to this trend is "prohibition", which starts close to the most frequent constructions at 12-18 months of age and ends up as the least frequently used construction around 42-72 months. One obvious reason for this trend is that when children are younger, parents may need to guide children's actions through prohibitions a lot more frequently than later in the child's life. Looking at children's productions (left panel), we see that the production of most constructions begins in the 12-24 age range. Two constructions, non-existence and prohibition, seem to show some delay. With non-existence, even though there are examples between 18-24 months, there is a discontinuity around 24 months instead of a slow and steady increase seen in other functions. This may be partly due to the samples available at that age range and with more data a clearer pattern may emerge. With prohibitions, we see a relatively smooth pattern. Children start to produce them later than other functions (between 24-30 months) and its rate of production stays below parents' levels. This pattern may be because prohibitions develop later than other functions, or it may have socio-pragmatic explanations. It is possible that parent-child interaction does not provide many contexts for children to prohibit parents. Nevertheless by 36 months of age, most constructions are produced close to parents' levels. Again prohibitions seem to be exceptional. 

```{r allneg, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=5, set.cap.width=T, num.cols.cap=1, fig.cap='Log cumulative ratios for all negative constructions at the syntactic level.', warning=FALSE}


neg_together_final %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Function, color = Function)) +
  geom_line(aes(linetype=Function), alpha = 1) +
  scale_color_brewer(palette = "Dark2") +
  geom_point(aes(color = Function, shape = Function), size = 1) +
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") + 
  guides(linetype = guide_legend(nrow = 2)) 

```

Figure \@ref(fig:allpos) shows the log cumulative ratios of all positive counterparts to our negative constructions at the sentence level. Looking at parents productions on the right panel, we see that for almost all constructions, parents productions are stable and constant. Again, the only exception is positive prohibitions (imperatives). Parents produce positive prohibitions much more frequently at the beginning and between 12-36 months of child's age, but their production rates decrease later. This pattern mirrors what we see in Figure \@ref(fig:allneg) with (negative) prohibitions, and suggests that parents use imperatives (positive or negative) with a higher frequency than "normal" at the beginning of children's development. Looking at children's positive productions on the left panel, we see that children start producing all positive counterparts to our negative constructions before 24 months of age. By 36 months, almost all positive constructions are being produced at a relatively constant rate close to parents' levels. An exception may be the epistemic construction which shows a gradual increase in frequency up until the 48-72 months (4-to-6 years) age period. Another noteworthy pattern is the relative high frequency of positive counterparts to prohibitions in the 12-24 months age period. Unlike (negative) prohibitions that were produced with some delay (compared to other constructions) around 24-30 months, positive imperatives are produced with high frequency even before 24 months of age. In other words, even though children do not frequently prohibit parents from doing things, they seem to be frequently ordering parents to do things for them; an observation that probably does not surprise any parent or caregiver! 

```{r allpos, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=5, set.cap.width=T, num.cols.cap=1, fig.cap='Log cumulative ratios for the positive counpterparts to all negative constructions at the syntactic level.', warning=FALSE}


pos_together_final %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Function, color = Function)) +
  geom_line(aes(linetype=Function), alpha = 1) +
  scale_color_brewer(palette = "Dark2") +
  geom_point(aes(color = Function, shape = Function), size = 1) +
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") + 
  guides(linetype = guide_legend(nrow = 2)) 

```

```{r alldiscoursedata, include=FALSE}

discourse_all <- rbind(discourse_emotion_data, discourse_epistemic_data, discourse_prohibition_data, discourse_inability_data, discourse_learning_data, discourse_existence_data, discourse_possession_data)
discourse_together <- subset(discourse_all, Which == 'cumulative ratio')
discourse_child_all <- subset(discourse_together, Role %in% c('Target_Child', 'Child'))
discourse_parent_all <- subset(discourse_together, Role %in% c('Parent'))

discourse_child_together <- aggregate(Freq ~ Age + Function, data = discourse_child_all, sum)
discourse_child_together$Role <- rep('Child', nrow(discourse_child_together))
discourse_child_together$Total_ratio <- rep(0, nrow(discourse_child_together))

for (i in 1:nrow(discourse_child_together)){
  age = as.numeric(as.character(discourse_child_together$Age[i]))
  data = subset(child_descriptive, Age <= age)
  discourse_child_together$Total_ratio[i] = discourse_child_together$Freq[i] / sum(data$N_utterance)

  }

discourse_parent_together <- aggregate(Freq ~ Age + Function, data = discourse_parent_all, sum)
discourse_parent_together$Role <- rep('Parent', nrow(discourse_parent_together))
discourse_parent_together$Total_ratio <- rep(0, nrow(discourse_parent_together))

for (i in 1:nrow(discourse_parent_together)){
  age = as.numeric(as.character(discourse_parent_together$Age[i]))
  data = subset(parent_descriptive, Age <= age)
  discourse_parent_together$Total_ratio[i] = discourse_parent_together$Freq[i] / sum(data$N_utterance)

  }


discourse_together_final <- rbind(discourse_child_together, discourse_parent_together)

```

Finally, Figure \@ref(fig:alldiscourse) shows the log cumulative ratios of all negative responses to a previous utterance that used the negative constructions or their positive counterparts. Starting with parents' productions on the right, we see again a relatively constant rate of producing negative responses to each construction. The main exception is again prohibitions. Parents' start with very frequent "*no!*"-responses to imperatives produced by children, but the frequency of these negative responses drops to a relatively low and stable level after children are 36 months of age. Looking at children's negative responses on the left panel, we see that productions begin for all functions before 30 months of age and by 36 months children are already producing negative responses at a relatively constant rate close to parents production levels. The most striking difference between our discourse level and sentence level results are the frequency of rejection and labeling constructions. At the discourse level, parents' and children say *no* to labeling and rejection much more frequently than other constructions, and they are produced earlier as well. 

```{r alldiscourse, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=5, set.cap.width=T, num.cols.cap=1, fig.cap='Cumulative ratios for all negative constructions at the discourse level.', warning=FALSE}

discourse_together_final %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Function, color = Function)) +
  geom_line(aes(linetype=Function), alpha = 1) +
  scale_color_brewer(palette = "Dark2") +
  geom_point(aes(color = Function, shape = Function), size = 1) +
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") + 
  guides(linetype = guide_legend(nrow = 2)) 

```

# Conclusion

Using automatic annotations of large-scale corpora of child-parent interactions, we presented production trajectories for seven negative constructions that tend to express rejection, non-existence, prohibition, inability, labeling, epistemic states, and possession (Table 1). The results suggest that the production of almost all these negative constructions (except for prohibition) emerges and gradually increases within the 18-36 months age range (Figure 8). Their production frequencies remain stable and regular after 36 months and relatively close to parents' levels of production. It is important to note that similar to prior studies, our conclusions are limited to negation in children's production. Systematic experiments testing children's comprehension of negative utterances with different communicative functions are necessary to better understand the origins and developmental trajectory of negation.

A different hypothesis is that from the start, negation is an abstract concept that can serve different communicative functions. The main task of the learner is to break the speech stream, detect negative morphemes like *no*, *not*, or *nt'*, and map them to this abstract meaning. She should then learn to use them appropriately in composition with other words to convey the right communicative function in context. There is either no substantial conceptual development for a logical concept such as negation, or this development is complete by the time the process of form-meaning mapping starts. This account predicts that conceptualy speaking, different communicative functions should be learnable and expressable early on and around the same time. Any delays in the comprehension or production of negative constructions and functions must be due to lack of experience with that construction or limitations in children's productive capacity. Therefore, it is possible for communicative functions of negation to not be comprehended or produced in fixed and ordered stages. Children may vary considerably on what constructions or functions they comprehend or produce earlier.

There are a few theoretical and methodological caveats, however.  Studies that hypothesize stages in the development of negation almost exclusively study children's productions. Our methods of data collection and analysis may also affect our ability to provide data for or against these hypotheses. 

Nevertheless, there seems to be some consensus among researchers that the crucial period for the development of negation is the period between 18 and 30 months of age. Some researchers suggest that by 36 months, children have an abstract concept of negation that is used to convey a variety of communicative functions [@mcneill1968; @pea1978; @cameron2007part]. 

Fourth, previous studies have almost exclusively focused on children's production of negation. A tacit assumption is that children's linguistic production provides a straightforward window into their conceptual development. However, children's linguistic comprehension may differ substantially from their production, and these in turn may differ from their conceptual representations. ... Therefore, developmental patterns 


<!-- 
+ Comprehension studies suggest the 18-30 age range for negation. Our results here provide converging evidence for this age range as an important period for the development of negation

+ Maybe also discuss the linguistic origin hypothesis. Labeling utterances are often used to introduce new linguistic labels by parents and in turn may facilitate word learning [@clark2010adult]
-->

For future work, we would like to explore several directions. First, to more thoroughly examine and potentially model the developmental trajectories of negation in child production, certain production-specific factors (e.g. length of utterance, ease of pronunciation) should be taken into account as well. In addition, we aim to investigate the production trajectory of positive counterparts to our negative structures (e.g. "I know" for "I don't know"). Comparisons of negative utterances in relation to their positive counterparts would allow us to further analyze the developmental paths of negation within specific constructions.

Lastly, our experiments have concentrated on larger syntactic structures at the utterance level, hence cases where negation is used as discourse markers to respond to previous utterance(s) were excluded. However, these instances also have important semantic and conceptual roles in the communication between children and parents (e.g. parent: *do you want some bread?*; child: *no no no*). Thus inclusions of negative structures at a more comprehensive level would be able to paint a more clear picture about the development of negation.

\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}

\endgroup

```{r intersect, include=FALSE}

intersect_all <- function(a,b,...){
  Reduce(intersect, list(a,b,...))
}


```
