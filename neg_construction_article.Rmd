---
title             : "English Negative Constructions and Communicative Functions in Early Child Language"
shorttitle        : "Negation and communicative functions"

author: 
  - name        : "Zoey Liu"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    address       : ""
    email         : ""
  - name          : "Masoud Jasbi"
    affiliation   : "2"

affiliation:
  - id            : "1"
    institution   : "Boston College"
  - id            : "2"
    institution   : "UC Davis"

authornote: |
  Add complete departmental affiliations for each author here. Each new line herein must be indented, like this line.

  Enter author note here.

abstract: |
  How does abstract linguistic negation develop in early child language? Previous research has suggested that abstract negation develops in stages and from more concrete communicative functions such as rejection, prohibition, or non-existence. The evidence for the emergence of these functions in stages is mixed, however, leaving the possibility that negation is an abstract concept from the beginning that can serve multiple specific functions depending on early communicative environment. Leveraging automatic annotations of large-scale child speech corpora in English, we examine the production trajectores of seven negative constructions that tend to convey communicative functions previously discussed in the literature. The results demonstrate the emergence and gradual increase of these constructions in child speech within the age range of 18-36 months. Production mostly remains stable, regular, and close to parents' levels after this age range. These findings are consistent with two hypotheses: first, that negation starts as an abstract concept that can serve multiple functions from the beginning; and second, that negation develops in stages from specific communicative functions but this development is early and quick, leaving our corpus methods incapable of detecting them from the available corpus data.

keywords: >
    negation; syntactic construction; communicative function; development; child language.
    
wordcount         : "X"

bibliography      : ["library.bib"]

floatsintext      : yes
figurelist        : no
tablelist         : no
footnotelist      : no
linenumbers       : yes
mask              : no
draft             : no

documentclass     : "apa6"
classoption       : "man"
output            : papaja::apa6_pdf
fig_caption: yes
---

```{r setup, include = FALSE, message=FALSE, warning=FALSE}
library("papaja")
library(data.table)
library(plyr)
library(devtools)
library(childesr)
library(tidyverse)
library(tm)
library(forcats)
library(gridExtra)
library(png)
library(grid)
library(ggplot2, warn.conflicts = FALSE, quietly=TRUE)
library(xtable)
library('RColorBrewer')
library(gridExtra)
library(tidyverse)
library(AICcmodavg)
library(broom)
library(corrr)
library(dplyr)
library(knitr)
library(kableExtra)
library(readr)
library(tidyr)
```

<!--
+ Discourse level negation does not make sense with prohibitions:
    - Prohibitions -- Parent: Eat your food! Child: No! (= I won't eat my food NOT Don't eat your food!)
+ How much lexical diversity is there in each construction? For example with epistemic negation, are children just saying "don't know" or are they saying different combinations of negation and "know"
+ Have at least 8 corpus example for each function (4 for sentence level and 4 for discourse level)
+ The cumulative ratio for many plots seems a bit weird? 
+ "This is not mine" is currently counted as labeling in this draft but I think we decided to count them as possession in the future
-->

# Introduction

Negation is an abstract concept that serves different communicative functions in everyday communication. A coffee shop can divide its menu into "coffee" and "not coffee" sections, with "not coffee" bringing together diverse items with no common label like tea and hot chocolate. It could be used in a sign like "no mask, no entry" to regulate people's behaviors. An employee could say "I don't like Mondays" to communicate their desires or dislikes. But how does abstract multi-functional negation emerge and develop in the human mind? Are early stages of negation in child language specific to one or a few functions? Or does negation emerge as an abstract and multifunctional concept from the beginning?

Previous literature has proposed that abstract negation develops from less abstract communicative functions in ordered stages [@pea1978]. For instance, @darwin1872expression hypothesized that the earliest manifestation of negation in infants is when they refuse or reject food from parents by withdrawing their heads laterally. Similarly, @pea1978 also proposed "rejection" as the first function of negation in child language. By contrast, @bloom1970language argued that the use of negation to express "non-existence" emerges before "rejection". For example, when an object that children expect to be present is not, children may say: "there is no window". Follow-up study by @choi1988semantic argued that "prohibition" emerges as early as rejections and non-existence. In cases of prohibition, children use negation to stop others or themselves from performing actions (e.g. "don't go"). A function similar to prohibition is "inability" (e.g. "I cannot zip it"), in that both involve conceptualizing actions and negating them. @choi1988semantic suggested that expressions of inability emerge after the functions in the first phase, namely non-existence, rejection, and prohibition.

Despite considerable research on early communicative functions of negation, their developmental trajectories in children's production have remained unclear. Recently, @nordmeyer2018individual looked at the speech of five children in the Providence corpus [@demuth2006word] and found a great deal of individual variation in how early a negative function is attested. They reported that the
developmental trajectory of negation in their study was not as consistent as previously claimed. This leaves the possibility that negation develops as an abstract concept that can serve multiple communicative functions early in the development based on the context of use in parent-child interactions. Therefore, across (a larger number of) children, distinct functions of negation could develop within the same age range and share common production trajectories. 

However, previous experiments have mainly relied on manual annotations of corpus data to determine the communicative function of a given negative utterance, which in turn has limited their work to only a handful of children per study.
Here we aim to go beyond existing work via utilizing a large collection of child speech corpora in English [@macwhinney2000childes] along with computational tools to automatically identify negative utterances that tend to convey the communicative functions discussed in prior research (Table 1). In particular, our study investigates three questions: (1) how does the developmental trajectory of the negative constructions for each function look like? (2) for utterances expressing the same function, does the developmental trajectory differ depending on particular lexical items that negation modifies (e.g. *like* or *want* for rejection)? (3) taking all functions into account, do they share similar developmental characteristics, or would there be function-specific differences?

Given the automatic fashion of our approach, we focus on larger/longer negative constructions at the single-sentence level. This is in opposition to short negative forms at the discourse-level such as cases consisting of one morpheme (e.g. "no!") or repetition of negative morphemes (e.g. "no no no"), which arguably could express multiple functions when not taking the discourse context into account and accordingly leave more room for ambiguous interpretation. Therefore the negative utterances in our study do not fully cover all negation instances from the corpora investigated, nor reflect all possible communicative functions that could be played by negation more broadly, but it could provide at least a conservative estimate of the age range during which negation is developed gradually in child production.

\begin{table*}[h]
\small
\centering
\begin{tabular}{rrrr}
  \hline
 \textbf{Function} & \textbf{Linguistic Composition} & \textbf{Examples} & \textbf{Positive counterpars} \\
  \hline
Rejection & with \textit{like} or \textit{want} & \textit{I not like it}; \textit{not want it}  & \textit{I like that}; \textit{You want this} \\
Non-existence & expletives & \textit{there is no soup} & \textit{there are books} \\
Prohibition & with imperative subjectless \textit{do} & \textit{do not spill milk} & \textit{eat it} \\
Inability & with modal \textit{can} & \textit{I cannot zip it} & \textit{She can try} \\
Labeling & modifying nominal or adjectival predicatives & \textit{that's not a crocodile}; \textit{it's no interesting} & \textit{that's a table}; \textit{it's cool} \\
Epistemic negation & with \textit{know}, \textit{think}, \textit{remember}  & \textit{I not know/think/remember} & \textit{He knows/thinks/remembers that} \\
Possession & with \textit{have}; or possesive pronouns & \textit{not have the toy}; \textit{not mine} & \textit{have the water}; \textit{theirs} \\
   \hline
\end{tabular}
\caption{Communicative functions of negation in early child language of English.}
\end{table*}


# Related Work

Starting a century and a half ago, @darwin1872expression thought that negation has roots in the expression of human emotions and desires. He hypothesized the earliest manifestation of negation and affirmation in infants is when they refuse food from parents, by withdrawing their heads laterally, or when they accept the food, by inclining their heads forward. He suggested that head shaking and nodding as common gestures for negation and affirmation pro developed from this early habit. Similarly, many researchers studying early functions of negative morphemes like *no* proposed that children use them to "reject" or "refuse" [@bloom1970language; @pea1978; @choi1988semantic]. For example, when they are asked "do you want juice?", they may say "no", "not want it", or "don't like it". @pea1978 proposed this negation function is the first to emerge in children's early speech.

@bloom1970language argued that the use of negation to expresses "non-existence" emerges before rejection or refusal. For example, when an object that children expect to be present is not present, children may say: "no window", "no fish in the bathroom", or "I do not pro underpants". Two close concepts to non-existence are "disappearance" and "non-occurrence" [@de1979form; @pea1978]. Disappearance refers to situations where an object disappears and children use negation to express it (e.g. "no food. all gone" or "no more noise"). Non-occurrence refers to cases when an expected action or event does not occur as in "not working" or "doggie not barking". Some researchers referred to these cases as "failures" and included examples like "no fit in da box" or "it don't fit" [@choi1988semantic; @cameron2007part]. Non-existence can also be expressed by negation of locative prepositional phrases (e.g. "no in there" or "daddy was not on the phone"). While rejection was hypothesized to interact with human emotions and desires, non-existence (broadly construed to include "disappearance" and "non-occurrence") likely interacts with human perception. @choi1988semantic proposed that children's early linguistic negation is used to express both rejection and non-existence.

Additionally, @choi1988semantic introduced "prohibition" and suggested that it emerges as early as rejection and non-existence. In cases of prohibition, children use negation to stop others from performing actions; for example "don't go" or "do not spill milk". A special case of prohibition is "self-prohibition". For example, a child may approach prohibited food but immediately say "no, don't eat" to stop themselves. A function similar to prohibition is "inability" (e.g. *I can't reach* / *I cannot zip it*), in that both involve conceptualizing actions and negating them, possibly interacting with early development of motor control. @choi1988semantic suggested that expression of inability emerges after the first phase, namely non-existence, rejection, and prohibition.

"Denial" is another function of negation that is argued to be late in development. @bloom1970language defined it as asserting that "an actual or supposed predication was not the case", for example "It's not sharp". Later researchers formulated it as "truth-functional negation" because it is used to negate the truth of a proposition [@pea1978; @cameron2007part]. However, this definition depends on the assumed logical system and its assumptions on what type of propositions receive truth values. A particular sub-function of denial is "labeling", which is realized as the negation of nominal or adjectival predicates such as "this is not a bunny" or "not red". These utterances are often used to introduce new linguistic labels by parents and in turn may facilitate word learning [@clark2010adult]. Conversely, labeling and word learning may aid the development of abstract negation.

Despite considerable research on early functions of negation, their developmental trajectories in children's productions pro remained unclear. Different studies pro claimed different order of acquisition [@pea1978]. In a recent study, @nordmeyer2018individual looked at the speech of five children in the Providence corpus [@demuth2006word] and found a great deal of individual differences in how early a negative function is attested. This is partly because previous studies pro had to rely on human annotation and identification of functions from corpus data, a time-consuming and difficult process that has limited previous studies to a handful of children and a relatively small sample of their speech.

# Experiments

## Data and preprocessing 

For child language data, we turned to the CHILDES database [@macwhinney2000childes]\footnote{Code and data are in quarantine at \url{https://github.com/zoeyliu18/Negative_Constructions.}} and selected English speaking children with typical development within the age range of 12 - 72 months. Parents' and children's utterances were extracted via the childes-db [@sanchez2019childes] interface using the programming language R. In order to obtain (morpho)syntactic representations for parents' and children's utterances, we used the dependency grammar framework [@dg]. Part-of-speech (POS) tags for each token within an utterance were automatically derived using Stanza [@qi-etal-2020-stanza], an open-source natural language processing library; dependency relations for all utterances were acquired also in an automatic fashion using DiaParser [@diaparser], a dependency parsing system that has been demonstrated to achieve excellent performance for at least written texts in English.

We focus on seven negative constructions shown in Table 1 that tend to convey the communicative functions of rejection, non-existence, prohibition, inability, labeling, epistemic state, and possession. We test children's knowledge of these constructions at two levels: sentence level and discourse level. Negation is marked in two fundamentally different ways in English and many other languages. First, at sentence level, morphemes such as *no*, *not*, or the reduced form *n't* combine with other lexical items to form a negative sentence. For example in sentence level rejection, *n't* can combine with *want* to form "*I don't want to go*". Second, negative response particles such as *no* can be used anaphorically to negate a previous utterance in discourse. For example in discourse level rejection, when a parent asks "*Do you want to go?*", a child can respond with *No!*. Here, the negative discourse particle stands for the proposition "I don't want to go". Children's earliest negative productions are dominated by discourse level negation, presumably because it is shorter and easier to produce when children are limited in their productive capacity. Nevertheless, successful communication with discourse level negation can indicate the children understand the propositions conveyed it.

At the sentence level, we characterized the syntactic features of the negative utterances associated with each communicative function, then classified utterances based on these features in a rule-based fashion with the help of POS information and syntactic dependencies. To decouple the development of the syntactic construction from the development of negation in that construction, we also examined the production of positive counterparts to each negative construction. The positive counterpart of our negative constructions share the same syntactic features (e.g. same head verb) but they have no negative morphemes. These positive constructions do not express the same communicative function as their negative counterparts. Our main purpose for including the positive counterparts is to factor in the development of the syntactic construction without negation.

At the discourse level, we need to analyze the negative constructions that the discourse particle *No* stands for. To achieve this, we selected utterances that started with negative discourse particles like "no no I like it". These instances were tagged with the dependency relation "discourse" by our dependency parser. For each negative utterance identified this way, we extracted the previous utterance (the antecedent) in the discourse context. For child speech, we included interactions (negative utterances + their antecedents) where antecedents were produced by either the parents or the children themselves. For parent speech, we only included interactions where the antecedent was produced by children. We then applied the same analyses we had performed to sentence level constructions to these antecedent utterances. The assumption here is that the negative discourse particles are implicitly negating the content of their discourse antecedents.  

## Measures

We took age as a proxy for children's development and divided the 12-72 months range into monthly bins. We used the following two metrics for each age bin and communicative function. First, we defined the ratio $R_{c,i}$ for construction $c$ and age bin $i$ as the number of utterances in construction $c$ and age bin $i$ divided by the total number of utterances produced at age bin $i$. For example at age 30 months, children produced a total of 81,302 utterances, out of which 391 were classified as rejections. Therefore the ratio of rejection at 30 months is 391/81,302 = 0.005. 

$R_{c, i} = \frac{\#U_{c,i}}{\#U_{i}}$

Second, we borrowed the measure of "moving (cumulative) ratio" from the analysis of time series data [@wei2006time]. We defined the cumulative ratio $MR_{c,i}$ for a construction $c$ at age bin $i$, as the sum of the number of utterances produced with construction $c$ from the first age bin to age bin $i$, divided by the sum of all utterances produced between the first age bin and age bin $i$. For example up to age 30 months, children in our corpus produced 721,748 total utterances, out of which 2,166 were instances of rejection. Therefore, the cumulative ratio of rejection at age 30 months is 2,166/721,748 = 0.003. The cumulative ratio has the advantage that at each age bin, it takes into account the productions in previous age bins. Assuming that children accumulate linguistic knowledge throughout their development, this measure provides a more realistic and stable measure of children's productive capacity at each age.

$CR_{c, i} = \frac{\#U_{c,1-t}}{\#U_{1-t}}$

The two ratios mentioned above were calculated for negative constructions and their positive counterparts at sentence and discourse levels for children as well as parents. In this study we use parents' speech as a benchmark for children's development. Therefore, our figures show children's productions side by side the production of parents at the corresponding age of children. In what follows, we describe in detail the results for each communicative function and its associated negative construction.

```{r function}

entropy <- function(data){
  start = 0
  for (i in 1:nrow(data)){
    p = as.vector(data$Total_ratio)[i] 
    start = start - p * log2(p)
  }
  start = start / nrow(data)
  return(start)
}

```

```{r negative_moving_function}

negative_moving <- function(data, descriptive){
  
  age_list <- as.vector(data$Age)
  freq_list <- rep(0, length(age_list))
  n_speaker_list <- rep(0, length(age_list))
  n_utterances_list <- rep(0, length(age_list))
  
  data$Age <- as.numeric(as.vector(data$Age))
  
  for (i in 1:length(age_list)){
    age = as.numeric(age_list[i])
    select <- data.frame(subset(data, Age <= age)) 
    freq = sum(as.numeric(as.vector(select$Freq)))
    n_speaker = sum(as.numeric(as.vector(select$N_speaker)))
    n_utterances = sum(as.numeric(as.vector((subset(descriptive, Age <= age))$N_utterance)))
    freq_list[i] = freq
    n_speaker_list[i] = n_speaker
    n_utterances_list[i] = n_utterances
    
    }
  
  data$Age <- as.character(data$Age)
  
  moving_ave <- data.frame(as.character(age_list))
  names(moving_ave) <- c('Age')
  moving_ave$Freq <- freq_list
  moving_ave$Role <- rep(unique(data$Role), length(age_list))
  moving_ave$Head <- rep(unique(data$Head), length(age_list))
  moving_ave$N_speaker <- n_speaker_list
  moving_ave$N_utterance <- n_utterances_list
  moving_ave$Total_ratio <- moving_ave$Freq / moving_ave$N_utterance
  moving_ave$Ratio <- rep(0, length(age_list))
  moving_ave$Polarity <- rep(unique(data$Polarity), length(age_list))
  moving_ave$Measure <- rep('negative construction moving ratio', length(age_list))
  moving_ave$Which <- rep('moving ratio', length(age_list))
  moving_ave$Function <- rep(unique(data$Function), length(age_list))
  temp <- rbind(data, moving_ave)
  data <- temp
  
  return(data)

}

```

```{r positive_moving_function}

positive_moving <- function(data, descriptive){
  
  age_list <- as.vector(data$Age)
  freq_list <- rep(0, length(age_list))
  n_speaker_list <- rep(0, length(age_list))
  n_utterances_list <- rep(0, length(age_list))
  
  data$Age <- as.numeric(as.vector(data$Age))
  
  for (i in 1:length(age_list)){
    age = as.numeric(age_list[i])
    select <- data.frame(subset(data, Age <= age)) 
    freq = sum(as.numeric(as.vector(select$Freq)))
    n_speaker = sum(as.numeric(as.vector(select$N_speaker)))
    n_utterances = sum(as.numeric(as.vector((subset(descriptive, Age <= age))$N_utterance)))
    freq_list[i] = freq
    n_speaker_list[i] = n_speaker
    n_utterances_list[i] = n_utterances
    
    }
  
  data$Age <- as.character(data$Age)
  
  moving_ave <- data.frame(as.character(age_list))
  names(moving_ave) <- c('Age')
  moving_ave$Freq <- freq_list
  moving_ave$Role <- rep(unique(data$Role), length(age_list))
  moving_ave$Head <- rep(unique(data$Head), length(age_list))
  moving_ave$N_speaker <- n_speaker_list
  moving_ave$N_utterance <- n_utterances_list
  moving_ave$Total_ratio <- moving_ave$Freq / moving_ave$N_utterance
  moving_ave$Ratio <- rep(0, length(age_list))
  moving_ave$Polarity <- rep(unique(data$Polarity), length(age_list))
  moving_ave$Measure <- rep('positive construction moving ratio', length(age_list))
  moving_ave$Which <- rep('moving ratio', length(age_list))
  moving_ave$Function <- rep(unique(data$Function), length(age_list))
  temp <- rbind(data, moving_ave)
  data <- temp
  
  return(data)

}

```

```{r negative_ul_moving_function}

negative_ul_moving <- function(data, descriptive){
  
  sent_len_list <- as.vector(data$Sent_len)
  freq_list <- rep(0, length(sent_len_list))
  n_speaker_list <- rep(0, length(sent_len_list))
  n_utterances_list <- rep(0, length(sent_len_list))
  
  data$Sent_len <- as.numeric(as.vector(data$Sent_len))
  
  for (i in 1:length(sent_len_list)){
    sent_len = as.numeric(sent_len_list[i])
    select <- data.frame(subset(data, Sent_len <= sent_len)) 
    freq = sum(as.numeric(as.vector(select$Freq)))
    n_speaker = sum(as.numeric(as.vector(select$N_speaker)))
    n_utterances = sum(as.numeric(as.vector((subset(descriptive, Sent_len <= sent_len))$N_utterance)))
    freq_list[i] = freq
    n_speaker_list[i] = n_speaker
    n_utterances_list[i] = n_utterances
    
    }
  
  data$Sent_len <- as.character(data$Sent_len)
  
  moving_ave <- data.frame(as.character(sent_len_list))
  names(moving_ave) <- c('Sent_len')
  moving_ave$Freq <- freq_list
  moving_ave$Role <- rep(unique(data$Role), length(sent_len_list))
  moving_ave$Head <- rep(unique(data$Head), length(sent_len_list))
  moving_ave$N_speaker <- n_speaker_list
  moving_ave$N_utterance <- n_utterances_list
  moving_ave$Total_ratio <- moving_ave$Freq / moving_ave$N_utterance
  moving_ave$Ratio <- rep(0, length(sent_len_list))
  moving_ave$Polarity <- rep(unique(data$Polarity), length(sent_len_list))
  moving_ave$Measure <- rep('negative construction moving ratio', length(sent_len_list))
  moving_ave$Which <- rep('moving ratio', length(sent_len_list))
  moving_ave$Function <- rep(unique(data$Function), length(sent_len_list))
  temp <- rbind(data, moving_ave)
  data <- temp
  
  return(data)

}

```

```{r positive_ul_moving_function}
positive_ul_moving <- function(data, descriptive){
  
  sent_len_list <- as.vector(data$Sent_len)
  freq_list <- rep(0, length(sent_len_list))
  n_speaker_list <- rep(0, length(sent_len_list))
  n_utterances_list <- rep(0, length(sent_len_list))
  
  data$Sent_len <- as.numeric(as.vector(data$Sent_len))
  
  for (i in 1:length(sent_len_list)){
    sent_len = as.numeric(sent_len_list[i])
    select <- data.frame(subset(data, Sent_len <= sent_len)) 
    freq = sum(as.numeric(as.vector(select$Freq)))
    n_speaker = sum(as.numeric(as.vector(select$N_speaker)))
    n_utterances = sum(as.numeric(as.vector((subset(descriptive, Sent_len <= sent_len))$N_utterance)))
    freq_list[i] = freq
    n_speaker_list[i] = n_speaker
    n_utterances_list[i] = n_utterances
    
    }
  
  data$Sent_len <- as.character(data$Sent_len)
  
  moving_ave <- data.frame(as.character(sent_len_list))
  names(moving_ave) <- c('Sent_len')
  moving_ave$Freq <- freq_list
  moving_ave$Role <- rep(unique(data$Role), length(sent_len_list))
  moving_ave$Head <- rep(unique(data$Head), length(sent_len_list))
  moving_ave$N_speaker <- n_speaker_list
  moving_ave$N_utterance <- n_utterances_list
  moving_ave$Total_ratio <- moving_ave$Freq / moving_ave$N_utterance
  moving_ave$Ratio <- rep(0, length(sent_len_list))
  moving_ave$Polarity <- rep(unique(data$Polarity), length(sent_len_list))
  moving_ave$Measure <- rep('positive construction moving ratio', length(sent_len_list))
  moving_ave$Which <- rep('moving ratio', length(sent_len_list))
  moving_ave$Function <- rep(unique(data$Function), length(sent_len_list))
  temp <- rbind(data, moving_ave)
  data <- temp
  
  return(data)

}

```

```{r mlu_function}

mlu <- function(data){
  
  compose = as.vector(unique(data$Age))
  values = rep(0, length(compose))
  
  for (i in 1:length(compose)){
    age = as.numeric(compose[i])
    select <- data.frame(subset(data, Age <= age))
    mlu_value = sum(as.numeric(select$Sent_len)) / nrow(select)
    values[i] = mlu_value
  }
  
  compose = data.frame(compose)
  names(compose) <- c('Age')
  compose$MLU <- values
  
  return(compose)
  
}  

```

```{r descriptive, include=FALSE}

child_descriptive <- subset(read.csv('data/child_descriptive.txt', header = T, sep = '\t'), Age >= 12 & Age <= 72)
parent_descriptive <- subset(read.csv('data/parent_descriptive.txt', header = T, sep = '\t'), Age >= 12 & Age <= 72)

child_ul_descriptive <- read.csv('data/child_ul_descriptive.txt', header = T, sep = '\t')
parent_ul_descriptive <- read.csv('data/parent_ul_descriptive.txt', header = T, sep = '\t')

child_individual_descriptive <- subset(read.csv('data/individual_child_descriptive.txt', header = T, sep = '\t'), Age >= 12 & Age <= 72)
parent_individual_descriptive <- subset(read.csv('data/individual_parent_descriptive.txt', header = T, sep = '\t'), Age >= 12 & Age <= 72)


```

## Negative Constructions

### Rejection

```{r emotiondata, include=FALSE}

emotion <-read.csv('data/emotion.txt', header = T, sep = '\t')
# emotion <- subset(emotion, Subj == 'I' | Subj == 'NONE')
emotion$Role[which(emotion$Role == "Father")] <- 'Parent'
emotion$Role[which(emotion$Role == "Mother")] <- 'Parent'
emotion$Role[which(emotion$Role == "Target_Child")] <- 'Child'

emotion_neg = subset(emotion, Polarity == 'negative')
emotion_pos = subset(emotion, Polarity == 'positive')

child_emotion_neg <- subset(emotion_neg, Role %in% c('Child'))
parent_emotion_neg <- subset(emotion_neg, Role %in% c('Parent'))


child_like_neg <- subset(child_emotion_neg, Head %in% c('like'))
child_want_neg <- subset(child_emotion_neg, Head %in% c('want'))
parent_like_neg <- subset(parent_emotion_neg, Head %in% c('like'))
parent_want_neg <- subset(parent_emotion_neg, Head %in% c('want'))

child_like_neg_mlu <- mlu(child_like_neg)
child_want_neg_mlu <- mlu(child_want_neg)
parent_like_neg_mlu <- mlu(parent_like_neg)
parent_want_neg_mlu <- mlu(parent_want_neg)

child_like_neg <- data.frame(table(child_like_neg$Age))
names(child_like_neg) <- c('Age', 'Freq')
child_like_neg$Role <- rep('Child', nrow(child_like_neg))
child_like_neg$Head <- rep('like', nrow(child_like_neg))
temp <- merge(child_like_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_like_neg <- temp
child_like_neg$Total_ratio <- child_like_neg$Freq / child_like_neg$N_utterance
child_like_neg$Ratio <- child_like_neg$Freq / sum(child_like_neg$Freq)
child_like_neg$Polarity <- rep('negative', nrow(child_like_neg))
child_like_neg$Measure <- rep('negative construction ratio', nrow(child_like_neg))
child_like_neg$Which <- rep('ratio', nrow(child_like_neg))
child_like_neg$Function <- rep('Rejection', nrow(child_like_neg))
child_like_neg <- negative_moving(child_like_neg, child_descriptive)

child_want_neg <- data.frame(table(child_want_neg$Age))
names(child_want_neg) <- c('Age', 'Freq')
child_want_neg$Role <- rep('Child', nrow(child_want_neg))
child_want_neg$Head <- rep('want', nrow(child_want_neg))
temp <- merge(child_want_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_want_neg <- temp
child_want_neg$Total_ratio <- child_want_neg$Freq / child_want_neg$N_utterance
child_want_neg$Ratio <- child_want_neg$Freq / sum(child_want_neg$Freq)
child_want_neg$Polarity <- rep('negative', nrow(child_want_neg))
child_want_neg$Measure <- rep('negative construction ratio', nrow(child_want_neg))
child_want_neg$Which <- rep('ratio', nrow(child_want_neg))
child_want_neg$Function <- rep('Rejection', nrow(child_want_neg))
child_want_neg <- negative_moving(child_want_neg, child_descriptive)

parent_like_neg <- data.frame(table(parent_like_neg$Age))
names(parent_like_neg) <- c('Age', 'Freq')
parent_like_neg$Role <- rep('Parent', nrow(parent_like_neg))
parent_like_neg$Head <- rep('like', nrow(parent_like_neg))
temp <- merge(parent_like_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_like_neg <- temp
parent_like_neg$Total_ratio <- parent_like_neg$Freq / parent_like_neg$N_utterance
parent_like_neg$Ratio <- parent_like_neg$Freq / sum(parent_like_neg$Freq)
parent_like_neg$Polarity <- rep('negative', nrow(parent_like_neg))
parent_like_neg$Measure <- rep('negative construction ratio', nrow(parent_like_neg))
parent_like_neg$Which <- rep('ratio', nrow(parent_like_neg))
parent_like_neg$Function <- rep('Rejection', nrow(parent_like_neg))
parent_like_neg <- negative_moving(parent_like_neg, parent_descriptive)

parent_want_neg <- data.frame(table(parent_want_neg$Age))
names(parent_want_neg) <- c('Age', 'Freq')
parent_want_neg$Role <- rep('Parent', nrow(parent_want_neg))
parent_want_neg$Head <- rep('want', nrow(parent_want_neg))
temp <- merge(parent_want_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_want_neg <- temp
parent_want_neg$Total_ratio <- parent_want_neg$Freq / parent_want_neg$N_utterance
parent_want_neg$Ratio <- parent_want_neg$Freq / sum(parent_want_neg$Freq)
parent_want_neg$Polarity <- rep('negative', nrow(parent_want_neg))
parent_want_neg$Measure <- rep('negative construction ratio', nrow(parent_want_neg))
parent_want_neg$Which <- rep('ratio', nrow(parent_want_neg))
parent_want_neg$Function <- rep('Rejection', nrow(parent_want_neg))
parent_want_neg <- negative_moving(parent_want_neg, parent_descriptive)


child_emotion_pos <- subset(emotion_pos, Role %in% c('Child'))
parent_emotion_pos <- subset(emotion_pos, Role %in% c('Parent'))


child_like_pos <- subset(child_emotion_pos, Head %in% c('like'))
child_want_pos <- subset(child_emotion_pos, Head %in% c('want'))
parent_like_pos <- subset(parent_emotion_pos, Head %in% c('like'))
parent_want_pos <- subset(parent_emotion_pos, Head %in% c('want'))

child_like_pos_mlu <- mlu(child_like_pos)
child_want_pos_mlu <- mlu(child_want_pos)
parent_like_pos_mlu <- mlu(parent_like_pos)
parent_want_pos_mlu <- mlu(parent_want_pos)

child_like_pos <- data.frame(table(child_like_pos$Age))
names(child_like_pos) <- c('Age', 'Freq')
child_like_pos$Role <- rep('Child', nrow(child_like_pos))
child_like_pos$Head <- rep('like', nrow(child_like_pos))
temp <- merge(child_like_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_like_pos <- temp
child_like_pos$Total_ratio <- child_like_pos$Freq / child_like_pos$N_utterance
child_like_pos$Ratio <- child_like_pos$Freq / sum(child_like_pos$Freq)
child_like_pos$Polarity <- rep('positive', nrow(child_like_pos))
child_like_pos$Measure <- rep('positive construction ratio', nrow(child_like_pos))
child_like_pos$Which <- rep('ratio', nrow(child_like_pos))
child_like_pos$Function <- rep('Rejection', nrow(child_like_pos))
child_like_pos <- positive_moving(child_like_pos, child_descriptive)


child_want_pos <- data.frame(table(child_want_pos$Age))
names(child_want_pos) <- c('Age', 'Freq')
child_want_pos$Role <- rep('Child', nrow(child_want_pos))
child_want_pos$Head <- rep('want', nrow(child_want_pos))
temp <- merge(child_want_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_want_pos <- temp
child_want_pos$Total_ratio <- child_want_pos$Freq / child_want_pos$N_utterance
child_want_pos$Ratio <- child_want_pos$Freq / sum(child_want_pos$Freq)
child_want_pos$Polarity <- rep('positive', nrow(child_want_pos))
child_want_pos$Measure <- rep('positive construction ratio', nrow(child_want_pos))
child_want_pos$Which <- rep('ratio', nrow(child_want_pos))
child_want_pos$Function <- rep('Rejection', nrow(child_want_pos))
child_want_pos <- positive_moving(child_want_pos, child_descriptive)

parent_like_pos <- data.frame(table(parent_like_pos$Age))
names(parent_like_pos) <- c('Age', 'Freq')
parent_like_pos$Role <- rep('Parent', nrow(parent_like_pos))
parent_like_pos$Head <- rep('like', nrow(parent_like_pos))
temp <- merge(parent_like_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_like_pos <- temp
parent_like_pos$Total_ratio <- parent_like_pos$Freq / parent_like_pos$N_utterance
parent_like_pos$Ratio <- parent_like_pos$Freq / sum(parent_like_pos$Freq)
parent_like_pos$Polarity <- rep('positive', nrow(parent_like_pos))
parent_like_pos$Measure <- rep('positive construction ratio', nrow(parent_like_pos))
parent_like_pos$Which <- rep('ratio', nrow(parent_like_pos))
parent_like_pos$Function <- rep('Rejection', nrow(parent_like_pos))
parent_like_pos <- positive_moving(parent_like_pos, parent_descriptive)

parent_want_pos <- data.frame(table(parent_want_pos$Age))
names(parent_want_pos) <- c('Age', 'Freq')
parent_want_pos$Role <- rep('Parent', nrow(parent_want_pos))
parent_want_pos$Head <- rep('want', nrow(parent_want_pos))
temp <- merge(parent_want_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_want_pos <- temp
parent_want_pos$Total_ratio <- parent_want_pos$Freq / parent_want_pos$N_utterance
parent_want_pos$Ratio <- parent_want_pos$Freq / sum(parent_want_pos$Freq)
parent_want_pos$Polarity <- rep('positive', nrow(parent_want_pos))
parent_want_pos$Measure <- rep('positive construction ratio', nrow(parent_want_pos))
parent_want_pos$Which <- rep('ratio', nrow(parent_want_pos))
parent_want_pos$Function <- rep('Rejection', nrow(parent_want_pos))
parent_want_pos <- positive_moving(parent_want_pos, parent_descriptive)

emotion_data <- rbind(child_like_neg, parent_like_neg, child_want_neg, parent_want_neg, child_like_pos, parent_like_pos, child_want_pos, parent_want_pos)

emotion_data$Measure <- factor(emotion_data$Measure, levels = c('negative construction ratio', 'negative construction moving ratio', 'positive construction ratio', 'positive construction moving ratio'))

emotion_data_child <- subset(emotion_data, Role == 'Child')
emotion_data_parent <- subset(emotion_data, Role == 'Parent')

```

```{r emotionuldata, include=FALSE}

child_ul_like_neg <- subset(child_emotion_neg, Head %in% c('like'))
child_ul_want_neg <- subset(child_emotion_neg, Head %in% c('want'))
parent_ul_like_neg <- subset(parent_emotion_neg, Head %in% c('like'))
parent_ul_want_neg <- subset(parent_emotion_neg, Head %in% c('want'))

child_ul_like_neg <- data.frame(table(child_ul_like_neg$Sent_len))
names(child_ul_like_neg) <- c('Sent_len', 'Freq')
child_ul_like_neg$Role <- rep('Child', nrow(child_ul_like_neg))
child_ul_like_neg$Head <- rep('like', nrow(child_ul_like_neg))
temp <- merge(child_ul_like_neg, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_like_neg <- temp
child_ul_like_neg$Total_ratio <- child_ul_like_neg$Freq / child_ul_like_neg$N_utterance
child_ul_like_neg$Ratio <- child_ul_like_neg$Freq / sum(child_ul_like_neg$Freq)
child_ul_like_neg$Polarity <- rep('negative', nrow(child_ul_like_neg))
child_ul_like_neg$Measure <- rep('negative construction ratio', nrow(child_ul_like_neg))
child_ul_like_neg$Which <- rep('ratio', nrow(child_ul_like_neg))
child_ul_like_neg$Function <- rep('Rejection', nrow(child_ul_like_neg))
child_ul_like_neg <- negative_ul_moving(child_ul_like_neg, child_ul_descriptive)

child_ul_want_neg <- data.frame(table(child_ul_want_neg$Sent_len))
names(child_ul_want_neg) <- c('Sent_len', 'Freq')
child_ul_want_neg$Role <- rep('Child', nrow(child_ul_want_neg))
child_ul_want_neg$Head <- rep('want', nrow(child_ul_want_neg))
temp <- merge(child_ul_want_neg, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_want_neg <- temp
child_ul_want_neg$Total_ratio <- child_ul_want_neg$Freq / child_ul_want_neg$N_utterance
child_ul_want_neg$Ratio <- child_ul_want_neg$Freq / sum(child_ul_want_neg$Freq)
child_ul_want_neg$Polarity <- rep('negative', nrow(child_ul_want_neg))
child_ul_want_neg$Measure <- rep('negative construction ratio', nrow(child_ul_want_neg))
child_ul_want_neg$Which <- rep('ratio', nrow(child_ul_want_neg))
child_ul_want_neg$Function <- rep('Rejection', nrow(child_ul_want_neg))
child_ul_want_neg <- negative_ul_moving(child_ul_want_neg, child_ul_descriptive)

parent_ul_like_neg <- data.frame(table(parent_ul_like_neg$Sent_len))
names(parent_ul_like_neg) <- c('Sent_len', 'Freq')
parent_ul_like_neg$Role <- rep('Parent', nrow(parent_ul_like_neg))
parent_ul_like_neg$Head <- rep('like', nrow(parent_ul_like_neg))
temp <- merge(parent_ul_like_neg, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_like_neg <- temp
parent_ul_like_neg$Total_ratio <- parent_ul_like_neg$Freq / parent_ul_like_neg$N_utterance
parent_ul_like_neg$Ratio <- parent_ul_like_neg$Freq / sum(parent_ul_like_neg$Freq)
parent_ul_like_neg$Polarity <- rep('negative', nrow(parent_ul_like_neg))
parent_ul_like_neg$Measure <- rep('negative construction ratio', nrow(parent_ul_like_neg))
parent_ul_like_neg$Which <- rep('ratio', nrow(parent_ul_like_neg))
parent_ul_like_neg$Function <- rep('Rejection', nrow(parent_ul_like_neg))
parent_ul_like_neg <- negative_ul_moving(parent_ul_like_neg, parent_ul_descriptive)

parent_ul_want_neg <- data.frame(table(parent_ul_want_neg$Sent_len))
names(parent_ul_want_neg) <- c('Sent_len', 'Freq')
parent_ul_want_neg$Role <- rep('Parent', nrow(parent_ul_want_neg))
parent_ul_want_neg$Head <- rep('want', nrow(parent_ul_want_neg))
temp <- merge(parent_ul_want_neg, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_want_neg <- temp
parent_ul_want_neg$Total_ratio <- parent_ul_want_neg$Freq / parent_ul_want_neg$N_utterance
parent_ul_want_neg$Ratio <- parent_ul_want_neg$Freq / sum(parent_ul_want_neg$Freq)
parent_ul_want_neg$Polarity <- rep('negative', nrow(parent_ul_want_neg))
parent_ul_want_neg$Measure <- rep('negative construction ratio', nrow(parent_ul_want_neg))
parent_ul_want_neg$Which <- rep('ratio', nrow(parent_ul_want_neg))
parent_ul_want_neg$Function <- rep('Rejection', nrow(parent_ul_want_neg))
parent_ul_want_neg <- negative_ul_moving(parent_ul_want_neg, parent_ul_descriptive)


child_ul_like_pos <- subset(child_emotion_pos, Head %in% c('like'))
child_ul_want_pos <- subset(child_emotion_pos, Head %in% c('want'))
parent_ul_like_pos <- subset(parent_emotion_pos, Head %in% c('like'))
parent_ul_want_pos <- subset(parent_emotion_pos, Head %in% c('want'))

child_ul_like_pos <- data.frame(table(child_ul_like_pos$Sent_len))
names(child_ul_like_pos) <- c('Sent_len', 'Freq')
child_ul_like_pos$Role <- rep('Child', nrow(child_ul_like_pos))
child_ul_like_pos$Head <- rep('like', nrow(child_ul_like_pos))
temp <- merge(child_ul_like_pos, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_like_pos <- temp
child_ul_like_pos$Total_ratio <- child_ul_like_pos$Freq / child_ul_like_pos$N_utterance
child_ul_like_pos$Ratio <- child_ul_like_pos$Freq / sum(child_ul_like_pos$Freq)
child_ul_like_pos$Polarity <- rep('positive', nrow(child_ul_like_pos))
child_ul_like_pos$Measure <- rep('positive construction ratio', nrow(child_ul_like_pos))
child_ul_like_pos$Which <- rep('ratio', nrow(child_ul_like_pos))
child_ul_like_pos$Function <- rep('Rejection', nrow(child_ul_like_pos))
child_ul_like_pos <- positive_ul_moving(child_ul_like_pos, child_ul_descriptive)


child_ul_want_pos <- data.frame(table(child_ul_want_pos$Sent_len))
names(child_ul_want_pos) <- c('Sent_len', 'Freq')
child_ul_want_pos$Role <- rep('Child', nrow(child_ul_want_pos))
child_ul_want_pos$Head <- rep('want', nrow(child_ul_want_pos))
temp <- merge(child_ul_want_pos, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_want_pos <- temp
child_ul_want_pos$Total_ratio <- child_ul_want_pos$Freq / child_ul_want_pos$N_utterance
child_ul_want_pos$Ratio <- child_ul_want_pos$Freq / sum(child_ul_want_pos$Freq)
child_ul_want_pos$Polarity <- rep('positive', nrow(child_ul_want_pos))
child_ul_want_pos$Measure <- rep('positive construction ratio', nrow(child_ul_want_pos))
child_ul_want_pos$Which <- rep('ratio', nrow(child_ul_want_pos))
child_ul_want_pos$Function <- rep('Rejection', nrow(child_ul_want_pos))
child_ul_want_pos <- positive_ul_moving(child_ul_want_pos, child_ul_descriptive)

parent_ul_like_pos <- data.frame(table(parent_ul_like_pos$Sent_len))
names(parent_ul_like_pos) <- c('Sent_len', 'Freq')
parent_ul_like_pos$Role <- rep('Parent', nrow(parent_ul_like_pos))
parent_ul_like_pos$Head <- rep('like', nrow(parent_ul_like_pos))
temp <- merge(parent_ul_like_pos, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_like_pos <- temp
parent_ul_like_pos$Total_ratio <- parent_ul_like_pos$Freq / parent_ul_like_pos$N_utterance
parent_ul_like_pos$Ratio <- parent_ul_like_pos$Freq / sum(parent_ul_like_pos$Freq)
parent_ul_like_pos$Polarity <- rep('positive', nrow(parent_ul_like_pos))
parent_ul_like_pos$Measure <- rep('positive construction ratio', nrow(parent_ul_like_pos))
parent_ul_like_pos$Which <- rep('ratio', nrow(parent_ul_like_pos))
parent_ul_like_pos$Function <- rep('Rejection', nrow(parent_ul_like_pos))
parent_ul_like_pos <- positive_ul_moving(parent_ul_like_pos, parent_ul_descriptive)

parent_ul_want_pos <- data.frame(table(parent_ul_want_pos$Sent_len))
names(parent_ul_want_pos) <- c('Sent_len', 'Freq')
parent_ul_want_pos$Role <- rep('Parent', nrow(parent_ul_want_pos))
parent_ul_want_pos$Head <- rep('want', nrow(parent_ul_want_pos))
temp <- merge(parent_ul_want_pos, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_want_pos <- temp
parent_ul_want_pos$Total_ratio <- parent_ul_want_pos$Freq / parent_ul_want_pos$N_utterance
parent_ul_want_pos$Ratio <- parent_ul_want_pos$Freq / sum(parent_ul_want_pos$Freq)
parent_ul_want_pos$Polarity <- rep('positive', nrow(parent_ul_want_pos))
parent_ul_want_pos$Measure <- rep('positive construction ratio', nrow(parent_ul_want_pos))
parent_ul_want_pos$Which <- rep('ratio', nrow(parent_ul_want_pos))
parent_ul_want_pos$Function <- rep('Rejection', nrow(parent_ul_want_pos))
parent_ul_want_pos <- positive_ul_moving(parent_ul_want_pos, parent_ul_descriptive)

emotion_ul_data <- rbind(child_ul_like_neg, parent_ul_like_neg, child_ul_want_neg, parent_ul_want_neg, child_ul_like_pos, parent_ul_like_pos, child_ul_want_pos, parent_ul_want_pos)

emotion_ul_data$Measure <- factor(emotion_ul_data$Measure, levels = c('negative construction ratio', 'negative construction moving ratio', 'positive construction ratio', 'positive construction moving ratio'))

emotion_ul_data_child <- subset(emotion_ul_data, Role == 'Child')
emotion_ul_data_parent <- subset(emotion_ul_data, Role == 'Parent')

```

```{r emotiondiscoursedata, include=FALSE}

discourse_emotion <-read.csv('data/emotion_discourse.txt', header = T, sep = '\t')
discourse_emotion$Role[which(discourse_emotion$Role == "Father")] <- 'Parent'
discourse_emotion$Role[which(discourse_emotion$Role == "Mother")] <- 'Parent'
discourse_emotion$Role[which(discourse_emotion$Role == "Target_Child")] <- 'Child'

discourse_emotion_neg = subset(discourse_emotion, Polarity == 'negative')
discourse_emotion_pos = subset(discourse_emotion, Polarity == 'positive')

discourse_child_emotion_neg <- subset(discourse_emotion_neg, Role %in% c('Child'))
discourse_parent_emotion_neg <- subset(discourse_emotion_neg, Role %in% c('Parent'))

discourse_child_emotion_neg <- data.frame(table(discourse_child_emotion_neg$Age))
names(discourse_child_emotion_neg) <- c('Age', 'Freq')
discourse_child_emotion_neg$Role <- rep('Child', nrow(discourse_child_emotion_neg))
discourse_child_emotion_neg$Head <- rep('both', nrow(discourse_child_emotion_neg))
temp <- merge(discourse_child_emotion_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_emotion_neg <- temp
discourse_child_emotion_neg$Total_ratio <- discourse_child_emotion_neg$Freq / discourse_child_emotion_neg$N_utterance
discourse_child_emotion_neg$Ratio <- discourse_child_emotion_neg$Freq / sum(discourse_child_emotion_neg$Freq)
discourse_child_emotion_neg$Polarity <- rep('negative', nrow(discourse_child_emotion_neg))
discourse_child_emotion_neg$Measure <- rep('negative construction ratio', nrow(discourse_child_emotion_neg))
discourse_child_emotion_neg$Which <- rep('ratio', nrow(discourse_child_emotion_neg))
discourse_child_emotion_neg$Function <- rep('Rejection', nrow(discourse_child_emotion_neg))
discourse_child_emotion_neg <- negative_moving(discourse_child_emotion_neg, child_descriptive)

discourse_parent_emotion_neg <- data.frame(table(discourse_parent_emotion_neg$Age))
names(discourse_parent_emotion_neg) <- c('Age', 'Freq')
discourse_parent_emotion_neg$Role <- rep('Parent', nrow(discourse_parent_emotion_neg))
discourse_parent_emotion_neg$Head <- rep('both', nrow(discourse_parent_emotion_neg))
temp <- merge(discourse_parent_emotion_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_emotion_neg <- temp
discourse_parent_emotion_neg$Total_ratio <- discourse_parent_emotion_neg$Freq / discourse_parent_emotion_neg$N_utterance
discourse_parent_emotion_neg$Ratio <- discourse_parent_emotion_neg$Freq / sum(discourse_parent_emotion_neg$Freq)
discourse_parent_emotion_neg$Polarity <- rep('negative', nrow(discourse_parent_emotion_neg))
discourse_parent_emotion_neg$Measure <- rep('negative construction ratio', nrow(discourse_parent_emotion_neg))
discourse_parent_emotion_neg$Which <- rep('ratio', nrow(discourse_parent_emotion_neg))
discourse_parent_emotion_neg$Function <- rep('Rejection', nrow(discourse_parent_emotion_neg))
discourse_parent_emotion_neg <- negative_moving(discourse_parent_emotion_neg, parent_descriptive)

discourse_child_emotion_pos <- subset(discourse_emotion_pos, Role %in% c('Child'))
discourse_parent_emotion_pos <- subset(discourse_emotion_pos, Role %in% c('Parent'))

discourse_child_emotion_pos <- data.frame(table(discourse_child_emotion_pos$Age))
names(discourse_child_emotion_pos) <- c('Age', 'Freq')
discourse_child_emotion_pos$Role <- rep('Child', nrow(discourse_child_emotion_pos))
discourse_child_emotion_pos$Head <- rep('both', nrow(discourse_child_emotion_pos))
temp <- merge(discourse_child_emotion_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_emotion_pos <- temp
discourse_child_emotion_pos$Total_ratio <- discourse_child_emotion_pos$Freq / discourse_child_emotion_pos$N_utterance
discourse_child_emotion_pos$Ratio <- discourse_child_emotion_pos$Freq / sum(discourse_child_emotion_pos$Freq)
discourse_child_emotion_pos$Polarity <- rep('positive', nrow(discourse_child_emotion_pos))
discourse_child_emotion_pos$Measure <- rep('positive construction ratio', nrow(discourse_child_emotion_pos))
discourse_child_emotion_pos$Which <- rep('ratio', nrow(discourse_child_emotion_pos))
discourse_child_emotion_pos$Function <- rep('Rejection', nrow(discourse_child_emotion_pos))
discourse_child_emotion_pos <- positive_moving(discourse_child_emotion_pos, child_descriptive)


discourse_parent_emotion_pos <- data.frame(table(discourse_parent_emotion_pos$Age))
names(discourse_parent_emotion_pos) <- c('Age', 'Freq')
discourse_parent_emotion_pos$Role <- rep('Parent', nrow(discourse_parent_emotion_pos))
discourse_parent_emotion_pos$Head <- rep('both', nrow(discourse_parent_emotion_pos))
temp <- merge(discourse_parent_emotion_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_emotion_pos <- temp
discourse_parent_emotion_pos$Total_ratio <- discourse_parent_emotion_pos$Freq / discourse_parent_emotion_pos$N_utterance
discourse_parent_emotion_pos$Ratio <- discourse_parent_emotion_pos$Freq / sum(discourse_parent_emotion_pos$Freq)
discourse_parent_emotion_pos$Polarity <- rep('positive', nrow(discourse_parent_emotion_pos))
discourse_parent_emotion_pos$Measure <- rep('positive construction ratio', nrow(discourse_parent_emotion_pos))
discourse_parent_emotion_pos$Which <- rep('ratio', nrow(discourse_parent_emotion_pos))
discourse_parent_emotion_pos$Function <- rep('Rejection', nrow(discourse_parent_emotion_pos))
discourse_parent_emotion_pos <- positive_moving(discourse_parent_emotion_pos, parent_descriptive)

discourse_emotion_data <- rbind(discourse_child_emotion_neg, discourse_parent_emotion_neg, discourse_child_emotion_pos, discourse_parent_emotion_pos)

discourse_emotion_data$Measure <- factor(discourse_emotion_data$Measure, levels = c('negative construction ratio', 'negative construction moving ratio', 'positive construction ratio', 'positive construction moving ratio'))

discourse_emotion_data_child <- subset(discourse_emotion_data, Role == 'Child')
discourse_emotion_data_parent <- subset(discourse_emotion_data, Role == 'Parent')

discourse_emotion_data_plot <- aggregate(Total_ratio~Age+Which+Role,data=discourse_emotion_data,sum)

names(discourse_emotion_data_plot) <- c('Age', 'Measure', 'Role', 'Total_ratio')

```

For instances of "rejection" and positive counterparts, we selected utterances in which the lemma of the head verb of the phrase is either *like* or *want*. For negative instances, the head verb is modified by one of the three negative morphemes *no*, *not* or *n't*, whereas cases including the same head verb but without negation were classified as positive. Table \@ref(tab:rejection) shows examples of negative utterances including those in which the speakers describe their own desires with or without an auxiliary verb (e.g. 1 and 2), as well as cases that express rhetorical inquiries of desires from one interlocutor to another (e.g. 3), and instances where the speaker is describing the desires of somebody else (e.g. 4). We classified a total of `r format(sum(subset(emotion_data,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")` negative utterances (child: `r format(sum(subset(emotion_data_child,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`; parent: `r format(sum(subset(emotion_data_parent,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`), and a total of `r format(sum(subset(emotion_data,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")` negative utterances (child: `r format(sum(subset(emotion_data_child,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`; parent: `r format(sum(subset(emotion_data_parent,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`).  

|Rejection (Negative)|Positive Counterpart|
|---------------------|----------------------|
| *I no like sea* | *she likes cheese* |
| *don't wanna go* | *I want it* |
| *don't you wanna try it* | *I wanna have that* |
| *Sarah doesn't like that either* | *she likes this one* |
Table: (\#tab:rejection) Examples of sentence level rejection (negative) and positive counterparts in children's speech

```{r emotion, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=4, set.cap.width=T, num.cols.cap=1, fig.cap='Rejection and its positive counterparts.'}

emotion_data %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(log(Total_ratio), 2), group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) + #"peru", 
#  geom_line(linetype = c('dotted', 'solid')) +
#  geom_line(aes(color = Polarity, linetype = 'dotted', size = 1)) + 
  facet_grid(Head ~ Role) +
#  facet_grid(vars(Head)) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)") + 
#  ylim(-9.5, -2.5) +
  guides(linetype = guide_legend(nrow = 2))

```
<!--
```{r emotionul, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=4, set.cap.width=T, num.cols.cap=1, fig.cap='Rejection and its positive counterparts, indexed by utterance length.'}

emotion_ul_data %>% 
  ggplot(aes(as.numeric(as.character(Sent_len)), round(log(Total_ratio), 2), group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) +
  facet_grid(Head ~ Role) +
  scale_x_continuous(breaks=seq(0, 130, 10)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("utterance length") + 
  ylab("log(ratio)") + 
  guides(linetype = guide_legend(nrow = 2))

```
-->

Starting with our analysis at the sentence level, Figure \@ref(fig:emotion) shows the ratios and cumulative ratios of parents' and children's instances of rejection and positive counterparts on a logarithmic scale (y-axis) with age along the x-axis. Overall, we see a similar pattern of production for rejection whether the head verb is *want* or *like*. Comparing the cumulative ratios between parents and children, children's production of rejection gradually increases between the ages of 18 and 30 months. After about 30 months of age, children's production of these constructions stays at a relatively constant rate and close to parent levels. In all age bins, the production ratio for negative utterances is lower than that for their positive counterparts.

On the discourse level, we investigated discourse interactions (antecedent + negative utterance) in which the antecedent had one of the head verbs *like* or *want*, yet the head verb did not have to be modified by negative morphemes. Table \@ref(tab:disreject) shows a few examples. We found a total of `r format(sum(subset(discourse_emotion_data,Which=='ratio')$Freq), big.mark=",")` such utterances (child: `r format(sum(subset(discourse_emotion_data_child,Which=='ratio')$Freq), big.mark=",")`; parent: `r format(sum(subset(discourse_emotion_data_parent,Which=='ratio')$Freq), big.mark=",")`). As shown in Figure 2, children's production of negation as discourse response variables increases regularly from the age of 24 - 36 months\footnote{For each communicative function, at the discourse level we also examined cases of different subtypes (e.g. different head verbs) separately; though due to data sparsity issues, we collapsed these instances for our final analyses}. Overall negative morphemes are applied at the discourse level more frequently in child speech compared to parent speech.

|Antecedent|Utterance|
|------------|------------|
|Parent: *I want you to try it*|Child: *no no no*|
|Parent: *would you like to go*|Child: *no no*|
|Child: *I don't like that*|Parent: *no honey you have to try it*|
Table: (\#tab:disreject) Example antecdents and discourse level rejections in parents' and children's productions 

```{r emotiondiscourse, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap='Ratios and cumulative ratios for the production of rejection at the discourse level for children between 1 to 6 years of age, and their parents.',warning=FALSE}

discourse_emotion_data_plot %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(log(Total_ratio), 2), group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c('solid', "dotted")) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(16, 3)) + 
  scale_color_manual(values = c("darkgreen", "grey")) +
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)") 

```

### Non-existence

```{r perceptiondata, include=FALSE}

perception <-read.csv('data/perception.txt', header = T, sep = '\t')
# perception <- subset(perception, Subj == 'I' | Subj == 'NONE')
perception$Role[which(perception$Role == "Father")] <- 'Parent'
perception$Role[which(perception$Role == "Mother")] <- 'Parent'
perception$Role[which(perception$Role == "Target_Child")] <- 'Child'

perception_neg = subset(perception, Polarity == 'negative')
perception_pos = subset(perception, Polarity == 'positive')

child_perception_neg <- subset(perception_neg, Role %in% c('Child'))
parent_perception_neg <- subset(perception_neg, Role %in% c('Parent'))

child_existence_neg <- subset(child_perception_neg, Function %in% c('existence'))
child_possession_have_neg <- subset(child_perception_neg, Function %in% c('possession') & Head %in% c('have'))
child_possession_pro_neg <- subset(child_perception_neg, Function %in% c('possession') & Head != 'have')
parent_existence_neg <- subset(parent_perception_neg, Function %in% c('existence'))
parent_possession_have_neg <- subset(parent_perception_neg, Function %in% c('possession') & Head %in% c('have'))
parent_possession_pro_neg <- subset(parent_perception_neg, Function %in% c('possession') & Head != 'have')

child_existence_neg_mlu <- mlu(child_existence_neg)
child_possession_have_neg_mlu <- mlu(child_possession_have_neg)
child_possession_pro_neg_mlu <- mlu(child_possession_pro_neg)
parent_existence_neg_mlu <- mlu(parent_existence_neg)
parent_possession_have_neg_mlu <- mlu(parent_possession_have_neg)
parent_possession_pro_neg_mlu <- mlu(parent_possession_pro_neg)

child_existence_neg <- data.frame(table(child_existence_neg$Age))
names(child_existence_neg) <- c('Age', 'Freq')
child_existence_neg$Role <- rep('Child', nrow(child_existence_neg))
child_existence_neg$Head <- rep('', nrow(child_existence_neg))
temp <- merge(child_existence_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_existence_neg <- temp
child_existence_neg$Total_ratio <- child_existence_neg$Freq / child_existence_neg$N_utterance
child_existence_neg$Ratio <- child_existence_neg$Freq / sum(child_existence_neg$Freq)
child_existence_neg$Polarity <- rep('negative', nrow(child_existence_neg))
child_existence_neg$Measure <- rep('negative construction ratio', nrow(child_existence_neg))
child_existence_neg$Which <- rep('ratio', nrow(child_existence_neg))
child_existence_neg$Function <- rep('Non-existence', nrow(child_existence_neg))
child_existence_neg <- negative_moving(child_existence_neg, child_descriptive)


child_possession_have_neg <- data.frame(table(child_possession_have_neg$Age))
names(child_possession_have_neg) <- c('Age', 'Freq')
child_possession_have_neg$Role <- rep('Child', nrow(child_possession_have_neg))
child_possession_have_neg$Head <- rep('have', nrow(child_possession_have_neg))
temp <- merge(child_possession_have_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_possession_have_neg <- temp
child_possession_have_neg$Total_ratio <- child_possession_have_neg$Freq / child_possession_have_neg$N_utterance
child_possession_have_neg$Ratio <- child_possession_have_neg$Freq / sum(child_possession_have_neg$Freq)
child_possession_have_neg$Polarity <- rep('negative', nrow(child_possession_have_neg))
child_possession_have_neg$Measure <- rep('negative construction ratio', nrow(child_possession_have_neg))
child_possession_have_neg$Which <- rep('ratio', nrow(child_possession_have_neg))
child_possession_have_neg$Function <- rep('Possession', nrow(child_possession_have_neg))
child_possession_have_neg <- negative_moving(child_possession_have_neg, child_descriptive)

child_possession_pro_neg <- data.frame(table(child_possession_pro_neg$Age))
names(child_possession_pro_neg) <- c('Age', 'Freq')
child_possession_pro_neg$Role <- rep('Child', nrow(child_possession_pro_neg))
child_possession_pro_neg$Head <- rep('pronoun', nrow(child_possession_pro_neg))
temp <- merge(child_possession_pro_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_possession_pro_neg <- temp
child_possession_pro_neg$Total_ratio <- child_possession_pro_neg$Freq / child_possession_pro_neg$N_utterance
child_possession_pro_neg$Ratio <- child_possession_pro_neg$Freq / sum(child_possession_pro_neg$Freq)
child_possession_pro_neg$Polarity <- rep('negative', nrow(child_possession_pro_neg))
child_possession_pro_neg$Measure <- rep('negative construction ratio', nrow(child_possession_pro_neg))
child_possession_pro_neg$Which <- rep('ratio', nrow(child_possession_pro_neg))
child_possession_pro_neg$Function <- rep('Possession', nrow(child_possession_pro_neg))
child_possession_pro_neg <- negative_moving(child_possession_pro_neg, child_descriptive)

parent_existence_neg <- data.frame(table(parent_existence_neg$Age))
names(parent_existence_neg) <- c('Age', 'Freq')
parent_existence_neg$Role <- rep('Parent', nrow(parent_existence_neg))
parent_existence_neg$Head <- rep('existence', nrow(parent_existence_neg))
temp <- merge(parent_existence_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_existence_neg <- temp
parent_existence_neg$Total_ratio <- parent_existence_neg$Freq / parent_existence_neg$N_utterance
parent_existence_neg$Ratio <- parent_existence_neg$Freq / sum(parent_existence_neg$Freq)
parent_existence_neg$Polarity <- rep('negative', nrow(parent_existence_neg))
parent_existence_neg$Measure <- rep('negative construction ratio', nrow(parent_existence_neg))
parent_existence_neg$Which <- rep('ratio', nrow(parent_existence_neg))
parent_existence_neg$Function <- rep('Non-existence', nrow(parent_existence_neg))
parent_existence_neg <- negative_moving(parent_existence_neg, parent_descriptive)

parent_possession_have_neg <- data.frame(table(parent_possession_have_neg$Age))
names(parent_possession_have_neg) <- c('Age', 'Freq')
parent_possession_have_neg$Role <- rep('Parent', nrow(parent_possession_have_neg))
parent_possession_have_neg$Head <- rep('have', nrow(parent_possession_have_neg))
temp <- merge(parent_possession_have_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_possession_have_neg <- temp
parent_possession_have_neg$Total_ratio <- parent_possession_have_neg$Freq / parent_possession_have_neg$N_utterance
parent_possession_have_neg$Ratio <- parent_possession_have_neg$Freq / sum(parent_possession_have_neg$Freq)
parent_possession_have_neg$Polarity <- rep('negative', nrow(parent_possession_have_neg))
parent_possession_have_neg$Measure <- rep('negative construction ratio', nrow(parent_possession_have_neg))
parent_possession_have_neg$Which <- rep('ratio', nrow(parent_possession_have_neg))
parent_possession_have_neg$Function <- rep('Possession', nrow(parent_possession_have_neg))
parent_possession_have_neg <- negative_moving(parent_possession_have_neg, parent_descriptive)

parent_possession_pro_neg <- data.frame(table(parent_possession_pro_neg$Age))
names(parent_possession_pro_neg) <- c('Age', 'Freq')
parent_possession_pro_neg$Role <- rep('Parent', nrow(parent_possession_pro_neg))
parent_possession_pro_neg$Head <- rep('pronoun', nrow(parent_possession_pro_neg))
temp <- merge(parent_possession_pro_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_possession_pro_neg <- temp
parent_possession_pro_neg$Total_ratio <- parent_possession_pro_neg$Freq / parent_possession_pro_neg$N_utterance
parent_possession_pro_neg$Ratio <- parent_possession_pro_neg$Freq / sum(parent_possession_pro_neg$Freq)
parent_possession_pro_neg$Polarity <- rep('negative', nrow(parent_possession_pro_neg))
parent_possession_pro_neg$Measure <- rep('negative construction ratio', nrow(parent_possession_pro_neg))
parent_possession_pro_neg$Which <- rep('ratio', nrow(parent_possession_pro_neg))
parent_possession_pro_neg$Function <- rep('Possession', nrow(parent_possession_pro_neg))
parent_possession_pro_neg <- negative_moving(parent_possession_pro_neg, parent_descriptive)

perception_pos = subset(perception, Polarity == 'positive')
perception_pos = subset(perception, Polarity == 'positive')

child_perception_pos <- subset(perception_pos, Role %in% c('Child'))
parent_perception_pos <- subset(perception_pos, Role %in% c('Parent'))

child_existence_pos <- subset(child_perception_pos, Function %in% c('existence'))
child_possession_have_pos <- subset(child_perception_pos, Function %in% c('possession') & Head %in% c('have'))
child_possession_pro_pos <- subset(child_perception_pos, Function %in% c('possession') & Head != 'have')
parent_existence_pos <- subset(parent_perception_pos, Function %in% c('existence'))
parent_possession_have_pos <- subset(parent_perception_pos, Function %in% c('possession') & Head %in% c('have'))
parent_possession_pro_pos <- subset(parent_perception_pos, Function %in% c('possession') & Head != 'have')

child_existence_pos_mlu <- mlu(child_existence_pos)
child_possession_have_pos_mlu <- mlu(child_possession_have_pos)
child_possession_pro_pos_mlu <- mlu(child_possession_pro_pos)
parent_existence_pos_mlu <- mlu(parent_existence_pos)
parent_possession_have_pos_mlu <- mlu(parent_possession_have_pos)
parent_possession_pro_pos_mlu <- mlu(parent_possession_pro_pos)

child_existence_pos <- data.frame(table(child_existence_pos$Age))
names(child_existence_pos) <- c('Age', 'Freq')
child_existence_pos$Role <- rep('Child', nrow(child_existence_pos))
child_existence_pos$Head <- rep('', nrow(child_existence_pos))
temp <- merge(child_existence_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_existence_pos <- temp
child_existence_pos$Total_ratio <- child_existence_pos$Freq / child_existence_pos$N_utterance
child_existence_pos$Ratio <- child_existence_pos$Freq / sum(child_existence_pos$Freq)
child_existence_pos$Polarity <- rep('positive', nrow(child_existence_pos))
child_existence_pos$Measure <- rep('positive construction ratio', nrow(child_existence_pos))
child_existence_pos$Which <- rep('ratio', nrow(child_existence_pos))
child_existence_pos$Function <- rep('Non-existence', nrow(child_existence_pos))
child_existence_pos <- positive_moving(child_existence_pos, child_descriptive)


child_possession_have_pos <- data.frame(table(child_possession_have_pos$Age))
names(child_possession_have_pos) <- c('Age', 'Freq')
child_possession_have_pos$Role <- rep('Child', nrow(child_possession_have_pos))
child_possession_have_pos$Head <- rep('have', nrow(child_possession_have_pos))
temp <- merge(child_possession_have_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_possession_have_pos <- temp
child_possession_have_pos$Total_ratio <- child_possession_have_pos$Freq / child_possession_have_pos$N_utterance
child_possession_have_pos$Ratio <- child_possession_have_pos$Freq / sum(child_possession_have_pos$Freq)
child_possession_have_pos$Polarity <- rep('positive', nrow(child_possession_have_pos))
child_possession_have_pos$Measure <- rep('positive construction ratio', nrow(child_possession_have_pos))
child_possession_have_pos$Which <- rep('ratio', nrow(child_possession_have_pos))
child_possession_have_pos$Function <- rep('Possession', nrow(child_possession_have_pos))
child_possession_have_pos <- positive_moving(child_possession_have_pos, child_descriptive)

child_possession_pro_pos <- data.frame(table(child_possession_pro_pos$Age))
names(child_possession_pro_pos) <- c('Age', 'Freq')
child_possession_pro_pos$Role <- rep('Child', nrow(child_possession_pro_pos))
child_possession_pro_pos$Head <- rep('pronoun', nrow(child_possession_pro_pos))
temp <- merge(child_possession_pro_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_possession_pro_pos <- temp
child_possession_pro_pos$Total_ratio <- child_possession_pro_pos$Freq / child_possession_pro_pos$N_utterance
child_possession_pro_pos$Ratio <- child_possession_pro_pos$Freq / sum(child_possession_pro_pos$Freq)
child_possession_pro_pos$Polarity <- rep('positive', nrow(child_possession_pro_pos))
child_possession_pro_pos$Measure <- rep('positive construction ratio', nrow(child_possession_pro_pos))
child_possession_pro_pos$Which <- rep('ratio', nrow(child_possession_pro_pos))
child_possession_pro_pos$Function <- rep('Possession', nrow(child_possession_pro_pos))
child_possession_pro_pos <- positive_moving(child_possession_pro_pos, child_descriptive)

parent_existence_pos <- data.frame(table(parent_existence_pos$Age))
names(parent_existence_pos) <- c('Age', 'Freq')
parent_existence_pos$Role <- rep('Parent', nrow(parent_existence_pos))
parent_existence_pos$Head <- rep('existence', nrow(parent_existence_pos))
temp <- merge(parent_existence_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_existence_pos <- temp
parent_existence_pos$Total_ratio <- parent_existence_pos$Freq / parent_existence_pos$N_utterance
parent_existence_pos$Ratio <- parent_existence_pos$Freq / sum(parent_existence_pos$Freq)
parent_existence_pos$Polarity <- rep('positive', nrow(parent_existence_pos))
parent_existence_pos$Measure <- rep('positive construction ratio', nrow(parent_existence_pos))
parent_existence_pos$Which <- rep('ratio', nrow(parent_existence_pos))
parent_existence_pos$Function <- rep('Non-existence', nrow(parent_existence_pos))
parent_existence_pos <- positive_moving(parent_existence_pos, parent_descriptive)

parent_possession_have_pos <- data.frame(table(parent_possession_have_pos$Age))
names(parent_possession_have_pos) <- c('Age', 'Freq')
parent_possession_have_pos$Role <- rep('Parent', nrow(parent_possession_have_pos))
parent_possession_have_pos$Head <- rep('have', nrow(parent_possession_have_pos))
temp <- merge(parent_possession_have_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_possession_have_pos <- temp
parent_possession_have_pos$Total_ratio <- parent_possession_have_pos$Freq / parent_possession_have_pos$N_utterance
parent_possession_have_pos$Ratio <- parent_possession_have_pos$Freq / sum(parent_possession_have_pos$Freq)
parent_possession_have_pos$Polarity <- rep('positive', nrow(parent_possession_have_pos))
parent_possession_have_pos$Measure <- rep('positive construction ratio', nrow(parent_possession_have_pos))
parent_possession_have_pos$Which <- rep('ratio', nrow(parent_possession_have_pos))
parent_possession_have_pos$Function <- rep('Possession', nrow(parent_possession_have_pos))
parent_possession_have_pos <- positive_moving(parent_possession_have_pos, parent_descriptive)

parent_possession_pro_pos <- data.frame(table(parent_possession_pro_pos$Age))
names(parent_possession_pro_pos) <- c('Age', 'Freq')
parent_possession_pro_pos$Role <- rep('Parent', nrow(parent_possession_pro_pos))
parent_possession_pro_pos$Head <- rep('pronoun', nrow(parent_possession_pro_pos))
temp <- merge(parent_possession_pro_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_possession_pro_pos <- temp
parent_possession_pro_pos$Total_ratio <- parent_possession_pro_pos$Freq / parent_possession_pro_pos$N_utterance
parent_possession_pro_pos$Ratio <- parent_possession_pro_pos$Freq / sum(parent_possession_pro_pos$Freq)
parent_possession_pro_pos$Polarity <- rep('positive', nrow(parent_possession_pro_pos))
parent_possession_pro_pos$Measure <- rep('positive construction ratio', nrow(parent_possession_pro_pos))
parent_possession_pro_pos$Which <- rep('ratio', nrow(parent_possession_pro_pos))
parent_possession_pro_pos$Function <- rep('Possession', nrow(parent_possession_pro_pos))
parent_possession_pro_pos <- positive_moving(parent_possession_pro_pos, parent_descriptive)


perception_data <- rbind(child_existence_neg, child_existence_pos, parent_existence_neg, parent_existence_pos, child_possession_have_neg, child_possession_have_pos, parent_possession_have_neg, parent_possession_have_pos, child_possession_pro_neg, child_possession_pro_pos, parent_possession_pro_neg, parent_possession_pro_pos)

perception_data$Measure <- factor(perception_data$Measure, levels = c('negative construction ratio', 'negative construction moving ratio', 'positive construction ratio', 'positive construction moving ratio'))

perception_data_child <- subset(perception_data, Role == 'Child')
perception_data_parent <- subset(perception_data, Role == 'Parent')

existence_data <- subset(perception_data, Function == 'Non-existence')
possession_data <- subset(perception_data, Function == 'Possession')

existence_data_child <- subset(existence_data, Role == 'Child')
existence_data_parent <- subset(existence_data, Role == 'Parent')

possession_data_child <- subset(possession_data, Role == 'Child')
possession_data_parent <- subset(possession_data, Role == 'Parent')

```

```{r perceptionuldata, include=FALSE}

child_ul_existence_neg <- subset(child_perception_neg, Function %in% c('existence'))
child_ul_possession_have_neg <- subset(child_perception_neg, Function %in% c('possession') & Head %in% c('have'))
child_ul_possession_pro_neg <- subset(child_perception_neg, Function %in% c('possession') & Head != 'have')
parent_ul_existence_neg <- subset(parent_perception_neg, Function %in% c('existence'))
parent_ul_possession_have_neg <- subset(parent_perception_neg, Function %in% c('possession') & Head %in% c('have'))
parent_ul_possession_pro_neg <- subset(parent_perception_neg, Function %in% c('possession') & Head != 'have')

child_ul_existence_neg <- data.frame(table(child_ul_existence_neg$Sent_len))
names(child_ul_existence_neg) <- c('Sent_len', 'Freq')
child_ul_existence_neg$Role <- rep('Child', nrow(child_ul_existence_neg))
child_ul_existence_neg$Head <- rep('', nrow(child_ul_existence_neg))
temp <- merge(child_ul_existence_neg, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_existence_neg <- temp
child_ul_existence_neg$Total_ratio <- child_ul_existence_neg$Freq / child_ul_existence_neg$N_utterance
child_ul_existence_neg$Ratio <- child_ul_existence_neg$Freq / sum(child_ul_existence_neg$Freq)
child_ul_existence_neg$Polarity <- rep('negative', nrow(child_ul_existence_neg))
child_ul_existence_neg$Measure <- rep('negative construction ratio', nrow(child_ul_existence_neg))
child_ul_existence_neg$Which <- rep('ratio', nrow(child_ul_existence_neg))
child_ul_existence_neg$Function <- rep('Non-existence', nrow(child_ul_existence_neg))
child_ul_existence_neg <- negative_ul_moving(child_ul_existence_neg, child_ul_descriptive)


child_ul_possession_have_neg <- data.frame(table(child_ul_possession_have_neg$Sent_len))
names(child_ul_possession_have_neg) <- c('Sent_len', 'Freq')
child_ul_possession_have_neg$Role <- rep('Child', nrow(child_ul_possession_have_neg))
child_ul_possession_have_neg$Head <- rep('have', nrow(child_ul_possession_have_neg))
temp <- merge(child_ul_possession_have_neg, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_possession_have_neg <- temp
child_ul_possession_have_neg$Total_ratio <- child_ul_possession_have_neg$Freq / child_ul_possession_have_neg$N_utterance
child_ul_possession_have_neg$Ratio <- child_ul_possession_have_neg$Freq / sum(child_ul_possession_have_neg$Freq)
child_ul_possession_have_neg$Polarity <- rep('negative', nrow(child_ul_possession_have_neg))
child_ul_possession_have_neg$Measure <- rep('negative construction ratio', nrow(child_ul_possession_have_neg))
child_ul_possession_have_neg$Which <- rep('ratio', nrow(child_ul_possession_have_neg))
child_ul_possession_have_neg$Function <- rep('Possession', nrow(child_ul_possession_have_neg))
child_ul_possession_have_neg <- negative_ul_moving(child_ul_possession_have_neg, child_ul_descriptive)

child_ul_possession_pro_neg <- data.frame(table(child_ul_possession_pro_neg$Sent_len))
names(child_ul_possession_pro_neg) <- c('Sent_len', 'Freq')
child_ul_possession_pro_neg$Role <- rep('Child', nrow(child_ul_possession_pro_neg))
child_ul_possession_pro_neg$Head <- rep('pronoun', nrow(child_ul_possession_pro_neg))
temp <- merge(child_ul_possession_pro_neg, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_possession_pro_neg <- temp
child_ul_possession_pro_neg$Total_ratio <- child_ul_possession_pro_neg$Freq / child_ul_possession_pro_neg$N_utterance
child_ul_possession_pro_neg$Ratio <- child_ul_possession_pro_neg$Freq / sum(child_ul_possession_pro_neg$Freq)
child_ul_possession_pro_neg$Polarity <- rep('negative', nrow(child_ul_possession_pro_neg))
child_ul_possession_pro_neg$Measure <- rep('negative construction ratio', nrow(child_ul_possession_pro_neg))
child_ul_possession_pro_neg$Which <- rep('ratio', nrow(child_ul_possession_pro_neg))
child_ul_possession_pro_neg$Function <- rep('Possession', nrow(child_ul_possession_pro_neg))
child_ul_possession_pro_neg <- negative_ul_moving(child_ul_possession_pro_neg, child_ul_descriptive)

parent_ul_existence_neg <- data.frame(table(parent_ul_existence_neg$Sent_len))
names(parent_ul_existence_neg) <- c('Sent_len', 'Freq')
parent_ul_existence_neg$Role <- rep('Parent', nrow(parent_ul_existence_neg))
parent_ul_existence_neg$Head <- rep('existence', nrow(parent_ul_existence_neg))
temp <- merge(parent_ul_existence_neg, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_existence_neg <- temp
parent_ul_existence_neg$Total_ratio <- parent_ul_existence_neg$Freq / parent_ul_existence_neg$N_utterance
parent_ul_existence_neg$Ratio <- parent_ul_existence_neg$Freq / sum(parent_ul_existence_neg$Freq)
parent_ul_existence_neg$Polarity <- rep('negative', nrow(parent_ul_existence_neg))
parent_ul_existence_neg$Measure <- rep('negative construction ratio', nrow(parent_ul_existence_neg))
parent_ul_existence_neg$Which <- rep('ratio', nrow(parent_ul_existence_neg))
parent_ul_existence_neg$Function <- rep('Non-existence', nrow(parent_ul_existence_neg))
parent_ul_existence_neg <- negative_ul_moving(parent_ul_existence_neg, parent_ul_descriptive)

parent_ul_possession_have_neg <- data.frame(table(parent_ul_possession_have_neg$Sent_len))
names(parent_ul_possession_have_neg) <- c('Sent_len', 'Freq')
parent_ul_possession_have_neg$Role <- rep('Parent', nrow(parent_ul_possession_have_neg))
parent_ul_possession_have_neg$Head <- rep('have', nrow(parent_ul_possession_have_neg))
temp <- merge(parent_ul_possession_have_neg, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_possession_have_neg <- temp
parent_ul_possession_have_neg$Total_ratio <- parent_ul_possession_have_neg$Freq / parent_ul_possession_have_neg$N_utterance
parent_ul_possession_have_neg$Ratio <- parent_ul_possession_have_neg$Freq / sum(parent_ul_possession_have_neg$Freq)
parent_ul_possession_have_neg$Polarity <- rep('negative', nrow(parent_ul_possession_have_neg))
parent_ul_possession_have_neg$Measure <- rep('negative construction ratio', nrow(parent_ul_possession_have_neg))
parent_ul_possession_have_neg$Which <- rep('ratio', nrow(parent_ul_possession_have_neg))
parent_ul_possession_have_neg$Function <- rep('Possession', nrow(parent_ul_possession_have_neg))
parent_ul_possession_have_neg <- negative_ul_moving(parent_ul_possession_have_neg, parent_ul_descriptive)

parent_ul_possession_pro_neg <- data.frame(table(parent_ul_possession_pro_neg$Sent_len))
names(parent_ul_possession_pro_neg) <- c('Sent_len', 'Freq')
parent_ul_possession_pro_neg$Role <- rep('Parent', nrow(parent_ul_possession_pro_neg))
parent_ul_possession_pro_neg$Head <- rep('pronoun', nrow(parent_ul_possession_pro_neg))
temp <- merge(parent_ul_possession_pro_neg, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_possession_pro_neg <- temp
parent_ul_possession_pro_neg$Total_ratio <- parent_ul_possession_pro_neg$Freq / parent_ul_possession_pro_neg$N_utterance
parent_ul_possession_pro_neg$Ratio <- parent_ul_possession_pro_neg$Freq / sum(parent_ul_possession_pro_neg$Freq)
parent_ul_possession_pro_neg$Polarity <- rep('negative', nrow(parent_ul_possession_pro_neg))
parent_ul_possession_pro_neg$Measure <- rep('negative construction ratio', nrow(parent_ul_possession_pro_neg))
parent_ul_possession_pro_neg$Which <- rep('ratio', nrow(parent_ul_possession_pro_neg))
parent_ul_possession_pro_neg$Function <- rep('Possession', nrow(parent_ul_possession_pro_neg))
parent_ul_possession_pro_neg <- negative_ul_moving(parent_ul_possession_pro_neg, parent_ul_descriptive)


child_ul_existence_pos <- subset(child_perception_pos, Function %in% c('existence'))
child_ul_possession_have_pos <- subset(child_perception_pos, Function %in% c('possession') & Head %in% c('have'))
child_ul_possession_pro_pos <- subset(child_perception_pos, Function %in% c('possession') & Head != 'have')
parent_ul_existence_pos <- subset(parent_perception_pos, Function %in% c('existence'))
parent_ul_possession_have_pos <- subset(parent_perception_pos, Function %in% c('possession') & Head %in% c('have'))
parent_ul_possession_pro_pos <- subset(parent_perception_pos, Function %in% c('possession') & Head != 'have')


child_ul_existence_pos <- data.frame(table(child_ul_existence_pos$Sent_len))
names(child_ul_existence_pos) <- c('Sent_len', 'Freq')
child_ul_existence_pos$Role <- rep('Child', nrow(child_ul_existence_pos))
child_ul_existence_pos$Head <- rep('', nrow(child_ul_existence_pos))
temp <- merge(child_ul_existence_pos, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_existence_pos <- temp
child_ul_existence_pos$Total_ratio <- child_ul_existence_pos$Freq / child_ul_existence_pos$N_utterance
child_ul_existence_pos$Ratio <- child_ul_existence_pos$Freq / sum(child_ul_existence_pos$Freq)
child_ul_existence_pos$Polarity <- rep('positive', nrow(child_ul_existence_pos))
child_ul_existence_pos$Measure <- rep('positive construction ratio', nrow(child_ul_existence_pos))
child_ul_existence_pos$Which <- rep('ratio', nrow(child_ul_existence_pos))
child_ul_existence_pos$Function <- rep('Non-existence', nrow(child_ul_existence_pos))
child_ul_existence_pos <- positive_ul_moving(child_ul_existence_pos, child_ul_descriptive)


child_ul_possession_have_pos <- data.frame(table(child_ul_possession_have_pos$Sent_len))
names(child_ul_possession_have_pos) <- c('Sent_len', 'Freq')
child_ul_possession_have_pos$Role <- rep('Child', nrow(child_ul_possession_have_pos))
child_ul_possession_have_pos$Head <- rep('have', nrow(child_ul_possession_have_pos))
temp <- merge(child_ul_possession_have_pos, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_possession_have_pos <- temp
child_ul_possession_have_pos$Total_ratio <- child_ul_possession_have_pos$Freq / child_ul_possession_have_pos$N_utterance
child_ul_possession_have_pos$Ratio <- child_ul_possession_have_pos$Freq / sum(child_ul_possession_have_pos$Freq)
child_ul_possession_have_pos$Polarity <- rep('positive', nrow(child_ul_possession_have_pos))
child_ul_possession_have_pos$Measure <- rep('positive construction ratio', nrow(child_ul_possession_have_pos))
child_ul_possession_have_pos$Which <- rep('ratio', nrow(child_ul_possession_have_pos))
child_ul_possession_have_pos$Function <- rep('Possession', nrow(child_ul_possession_have_pos))
child_ul_possession_have_pos <- positive_ul_moving(child_ul_possession_have_pos, child_ul_descriptive)

child_ul_possession_pro_pos <- data.frame(table(child_ul_possession_pro_pos$Sent_len))
names(child_ul_possession_pro_pos) <- c('Sent_len', 'Freq')
child_ul_possession_pro_pos$Role <- rep('Child', nrow(child_ul_possession_pro_pos))
child_ul_possession_pro_pos$Head <- rep('pronoun', nrow(child_ul_possession_pro_pos))
temp <- merge(child_ul_possession_pro_pos, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_possession_pro_pos <- temp
child_ul_possession_pro_pos$Total_ratio <- child_ul_possession_pro_pos$Freq / child_ul_possession_pro_pos$N_utterance
child_ul_possession_pro_pos$Ratio <- child_ul_possession_pro_pos$Freq / sum(child_ul_possession_pro_pos$Freq)
child_ul_possession_pro_pos$Polarity <- rep('positive', nrow(child_ul_possession_pro_pos))
child_ul_possession_pro_pos$Measure <- rep('positive construction ratio', nrow(child_ul_possession_pro_pos))
child_ul_possession_pro_pos$Which <- rep('ratio', nrow(child_ul_possession_pro_pos))
child_ul_possession_pro_pos$Function <- rep('Possession', nrow(child_ul_possession_pro_pos))
child_ul_possession_pro_pos <- positive_ul_moving(child_ul_possession_pro_pos, child_ul_descriptive)

parent_ul_existence_pos <- data.frame(table(parent_ul_existence_pos$Sent_len))
names(parent_ul_existence_pos) <- c('Sent_len', 'Freq')
parent_ul_existence_pos$Role <- rep('Parent', nrow(parent_ul_existence_pos))
parent_ul_existence_pos$Head <- rep('existence', nrow(parent_ul_existence_pos))
temp <- merge(parent_ul_existence_pos, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_existence_pos <- temp
parent_ul_existence_pos$Total_ratio <- parent_ul_existence_pos$Freq / parent_ul_existence_pos$N_utterance
parent_ul_existence_pos$Ratio <- parent_ul_existence_pos$Freq / sum(parent_ul_existence_pos$Freq)
parent_ul_existence_pos$Polarity <- rep('positive', nrow(parent_ul_existence_pos))
parent_ul_existence_pos$Measure <- rep('positive construction ratio', nrow(parent_ul_existence_pos))
parent_ul_existence_pos$Which <- rep('ratio', nrow(parent_ul_existence_pos))
parent_ul_existence_pos$Function <- rep('Non-existence', nrow(parent_ul_existence_pos))
parent_ul_existence_pos <- positive_ul_moving(parent_ul_existence_pos, parent_ul_descriptive)

parent_ul_possession_have_pos <- data.frame(table(parent_ul_possession_have_pos$Sent_len))
names(parent_ul_possession_have_pos) <- c('Sent_len', 'Freq')
parent_ul_possession_have_pos$Role <- rep('Parent', nrow(parent_ul_possession_have_pos))
parent_ul_possession_have_pos$Head <- rep('have', nrow(parent_ul_possession_have_pos))
temp <- merge(parent_ul_possession_have_pos, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_possession_have_pos <- temp
parent_ul_possession_have_pos$Total_ratio <- parent_ul_possession_have_pos$Freq / parent_ul_possession_have_pos$N_utterance
parent_ul_possession_have_pos$Ratio <- parent_ul_possession_have_pos$Freq / sum(parent_ul_possession_have_pos$Freq)
parent_ul_possession_have_pos$Polarity <- rep('positive', nrow(parent_ul_possession_have_pos))
parent_ul_possession_have_pos$Measure <- rep('positive construction ratio', nrow(parent_ul_possession_have_pos))
parent_ul_possession_have_pos$Which <- rep('ratio', nrow(parent_ul_possession_have_pos))
parent_ul_possession_have_pos$Function <- rep('Possession', nrow(parent_ul_possession_have_pos))
parent_ul_possession_have_pos <- positive_ul_moving(parent_ul_possession_have_pos, parent_ul_descriptive)

parent_ul_possession_pro_pos <- data.frame(table(parent_ul_possession_pro_pos$Sent_len))
names(parent_ul_possession_pro_pos) <- c('Sent_len', 'Freq')
parent_ul_possession_pro_pos$Role <- rep('Parent', nrow(parent_ul_possession_pro_pos))
parent_ul_possession_pro_pos$Head <- rep('pronoun', nrow(parent_ul_possession_pro_pos))
temp <- merge(parent_ul_possession_pro_pos, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_possession_pro_pos <- temp
parent_ul_possession_pro_pos$Total_ratio <- parent_ul_possession_pro_pos$Freq / parent_ul_possession_pro_pos$N_utterance
parent_ul_possession_pro_pos$Ratio <- parent_ul_possession_pro_pos$Freq / sum(parent_ul_possession_pro_pos$Freq)
parent_ul_possession_pro_pos$Polarity <- rep('positive', nrow(parent_ul_possession_pro_pos))
parent_ul_possession_pro_pos$Measure <- rep('positive construction ratio', nrow(parent_ul_possession_pro_pos))
parent_ul_possession_pro_pos$Which <- rep('ratio', nrow(parent_ul_possession_pro_pos))
parent_ul_possession_pro_pos$Function <- rep('Possession', nrow(parent_ul_possession_pro_pos))
parent_ul_possession_pro_pos <- positive_ul_moving(parent_ul_possession_pro_pos, parent_ul_descriptive)


perception_ul_data <- rbind(child_ul_existence_neg, child_ul_existence_pos, parent_ul_existence_neg, parent_ul_existence_pos, child_ul_possession_have_neg, child_ul_possession_have_pos, parent_ul_possession_have_neg, parent_ul_possession_have_pos, child_ul_possession_pro_neg, child_ul_possession_pro_pos, parent_ul_possession_pro_neg, parent_ul_possession_pro_pos)

perception_ul_data$Measure <- factor(perception_ul_data$Measure, levels = c('negative construction ratio', 'negative construction moving ratio', 'positive construction ratio', 'positive construction moving ratio'))

perception_ul_data_child <- subset(perception_ul_data, Role == 'Child')
perception_ul_data_parent <- subset(perception_ul_data, Role == 'Parent')

existence_ul_data <- subset(perception_ul_data, Function == 'Non-existence')
possession_ul_data <- subset(perception_ul_data, Function == 'Possession')

existence_ul_data_child <- subset(existence_ul_data, Role == 'Child')
existence_ul_data_parent <- subset(existence_ul_data, Role == 'Parent')

possession_ul_data_child <- subset(possession_ul_data, Role == 'Child')
possession_ul_data_parent <- subset(possession_ul_data, Role == 'Parent')

```

```{r discourseperceptiondata, include=FALSE}

discourse_perception <-read.csv('data/perception_discourse.txt', header = T, sep = '\t')
# perception <- subset(perception, Subj == 'I' | Subj == 'NONE')
discourse_perception$Role[which(discourse_perception$Role == "Father")] <- 'Parent'
discourse_perception$Role[which(discourse_perception$Role == "Mother")] <- 'Parent'
discourse_perception$Role[which(discourse_perception$Role == "Target_Child")] <- 'Child'

discourse_perception_neg = subset(discourse_perception, Polarity == 'negative')
discourse_perception_pos = subset(discourse_perception, Polarity == 'positive')

discourse_child_perception_neg <- subset(discourse_perception_neg, Role %in% c('Child'))
discourse_parent_perception_neg <- subset(discourse_perception_neg, Role %in% c('Parent'))

discourse_child_existence_neg <- subset(discourse_child_perception_neg, Function %in% c('existence'))
discourse_child_possession_neg <- subset(discourse_child_perception_neg, Function %in% c('possession'))
discourse_parent_existence_neg <- subset(discourse_parent_perception_neg, Function %in% c('existence'))
discourse_parent_possession_neg <- subset(discourse_parent_perception_neg, Function %in% c('possession'))

discourse_child_existence_neg <- data.frame(table(discourse_child_existence_neg$Age))
names(discourse_child_existence_neg) <- c('Age', 'Freq')
discourse_child_existence_neg$Role <- rep('Child', nrow(discourse_child_existence_neg))
discourse_child_existence_neg$Head <- rep('', nrow(discourse_child_existence_neg))
temp <- merge(discourse_child_existence_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_existence_neg <- temp
discourse_child_existence_neg$Total_ratio <- discourse_child_existence_neg$Freq / discourse_child_existence_neg$N_utterance
discourse_child_existence_neg$Ratio <- discourse_child_existence_neg$Freq / sum(discourse_child_existence_neg$Freq)
discourse_child_existence_neg$Polarity <- rep('negative', nrow(discourse_child_existence_neg))
discourse_child_existence_neg$Measure <- rep('negative construction ratio', nrow(discourse_child_existence_neg))
discourse_child_existence_neg$Which <- rep('ratio', nrow(discourse_child_existence_neg))
discourse_child_existence_neg$Function <- rep('Non-existence', nrow(discourse_child_existence_neg))
discourse_child_existence_neg <- negative_moving(discourse_child_existence_neg, child_descriptive)


discourse_child_possession_neg <- data.frame(table(discourse_child_possession_neg$Age))
names(discourse_child_possession_neg) <- c('Age', 'Freq')
discourse_child_possession_neg$Role <- rep('Child', nrow(discourse_child_possession_neg))
discourse_child_possession_neg$Head <- rep('have', nrow(discourse_child_possession_neg))
temp <- merge(discourse_child_possession_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_possession_neg <- temp
discourse_child_possession_neg$Total_ratio <- discourse_child_possession_neg$Freq / discourse_child_possession_neg$N_utterance
discourse_child_possession_neg$Ratio <- discourse_child_possession_neg$Freq / sum(discourse_child_possession_neg$Freq)
discourse_child_possession_neg$Polarity <- rep('negative', nrow(discourse_child_possession_neg))
discourse_child_possession_neg$Measure <- rep('negative construction ratio', nrow(discourse_child_possession_neg))
discourse_child_possession_neg$Which <- rep('ratio', nrow(discourse_child_possession_neg))
discourse_child_possession_neg$Function <- rep('Possession', nrow(discourse_child_possession_neg))
discourse_child_possession_neg <- negative_moving(discourse_child_possession_neg, child_descriptive)


discourse_parent_existence_neg <- data.frame(table(discourse_parent_existence_neg$Age))
names(discourse_parent_existence_neg) <- c('Age', 'Freq')
discourse_parent_existence_neg$Role <- rep('Parent', nrow(discourse_parent_existence_neg))
discourse_parent_existence_neg$Head <- rep('existence', nrow(discourse_parent_existence_neg))
temp <- merge(discourse_parent_existence_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_existence_neg <- temp
discourse_parent_existence_neg$Total_ratio <- discourse_parent_existence_neg$Freq / discourse_parent_existence_neg$N_utterance
discourse_parent_existence_neg$Ratio <- discourse_parent_existence_neg$Freq / sum(discourse_parent_existence_neg$Freq)
discourse_parent_existence_neg$Polarity <- rep('negative', nrow(discourse_parent_existence_neg))
discourse_parent_existence_neg$Measure <- rep('negative construction ratio', nrow(discourse_parent_existence_neg))
discourse_parent_existence_neg$Which <- rep('ratio', nrow(discourse_parent_existence_neg))
discourse_parent_existence_neg$Function <- rep('Non-existence', nrow(discourse_parent_existence_neg))
discourse_parent_existence_neg <- negative_moving(discourse_parent_existence_neg, parent_descriptive)

discourse_parent_possession_neg <- data.frame(table(discourse_parent_possession_neg$Age))
names(discourse_parent_possession_neg) <- c('Age', 'Freq')
discourse_parent_possession_neg$Role <- rep('Parent', nrow(discourse_parent_possession_neg))
discourse_parent_possession_neg$Head <- rep('have', nrow(discourse_parent_possession_neg))
temp <- merge(discourse_parent_possession_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_possession_neg <- temp
discourse_parent_possession_neg$Total_ratio <- discourse_parent_possession_neg$Freq / discourse_parent_possession_neg$N_utterance
discourse_parent_possession_neg$Ratio <- discourse_parent_possession_neg$Freq / sum(discourse_parent_possession_neg$Freq)
discourse_parent_possession_neg$Polarity <- rep('negative', nrow(discourse_parent_possession_neg))
discourse_parent_possession_neg$Measure <- rep('negative construction ratio', nrow(discourse_parent_possession_neg))
discourse_parent_possession_neg$Which <- rep('ratio', nrow(discourse_parent_possession_neg))
discourse_parent_possession_neg$Function <- rep('Possession', nrow(discourse_parent_possession_neg))
discourse_parent_possession_neg <- negative_moving(discourse_parent_possession_neg, parent_descriptive)


discourse_child_perception_pos <- subset(discourse_perception_pos, Role %in% c('Child'))
discourse_parent_perception_pos <- subset(discourse_perception_pos, Role %in% c('Parent'))

discourse_child_existence_pos <- subset(discourse_child_perception_pos, Function %in% c('existence'))
#discourse_child_possession_pos <- subset(discourse_child_perception_pos, Function %in% c('possession'))

discourse_parent_existence_pos <- subset(discourse_parent_perception_pos, Function %in% c('existence'))
#discourse_parent_possession_pos <- subset(discourse_parent_perception_pos, Function %in% c('possession'))


discourse_child_existence_pos <- data.frame(table(discourse_child_existence_pos$Age))
names(discourse_child_existence_pos) <- c('Age', 'Freq')
discourse_child_existence_pos$Role <- rep('Child', nrow(discourse_child_existence_pos))
discourse_child_existence_pos$Head <- rep('', nrow(discourse_child_existence_pos))
temp <- merge(discourse_child_existence_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_existence_pos <- temp
discourse_child_existence_pos$Total_ratio <- discourse_child_existence_pos$Freq / discourse_child_existence_pos$N_utterance
discourse_child_existence_pos$Ratio <- discourse_child_existence_pos$Freq / sum(discourse_child_existence_pos$Freq)
discourse_child_existence_pos$Polarity <- rep('positive', nrow(discourse_child_existence_pos))
discourse_child_existence_pos$Measure <- rep('positive construction ratio', nrow(discourse_child_existence_pos))
discourse_child_existence_pos$Which <- rep('ratio', nrow(discourse_child_existence_pos))
discourse_child_existence_pos$Function <- rep('Non-existence', nrow(discourse_child_existence_pos))
discourse_child_existence_pos <- positive_moving(discourse_child_existence_pos, child_descriptive)


#discourse_child_possession_pos <- data.frame(table(discourse_child_possession_pos$Age))
#names(discourse_child_possession_pos) <- c('Age', 'Freq')
#discourse_child_possession_pos$Role <- rep('Child', nrow(discourse_child_possession_pos))
#discourse_child_possession_pos$Head <- rep('have', nrow(discourse_child_possession_pos))
#temp <- merge(discourse_child_possession_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
#discourse_child_possession_pos <- temp
#discourse_child_possession_pos$Total_ratio <- discourse_child_possession_pos$Freq / discourse_child_possession_pos$N_utterance
#discourse_child_possession_pos$Ratio <- discourse_child_possession_pos$Freq / sum(discourse_child_possession_pos$Freq)
#discourse_child_possession_pos$Polarity <- rep('positive', nrow(discourse_child_possession_pos))
#discourse_child_possession_pos$Measure <- rep('positive construction ratio', nrow(discourse_child_possession_pos))
#discourse_child_possession_pos$Which <- rep('ratio', nrow(discourse_child_possession_pos))
#discourse_child_possession_pos$Function <- rep('Possession', #nrow(discourse_child_possession_pos))
#discourse_child_possession_pos <- positive_moving(discourse_child_possession_pos, child_descriptive)

discourse_parent_existence_pos <- data.frame(table(discourse_parent_existence_pos$Age))
names(discourse_parent_existence_pos) <- c('Age', 'Freq')
discourse_parent_existence_pos$Role <- rep('Parent', nrow(discourse_parent_existence_pos))
discourse_parent_existence_pos$Head <- rep('existence', nrow(discourse_parent_existence_pos))
temp <- merge(discourse_parent_existence_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_existence_pos <- temp
discourse_parent_existence_pos$Total_ratio <- discourse_parent_existence_pos$Freq / discourse_parent_existence_pos$N_utterance
discourse_parent_existence_pos$Ratio <- discourse_parent_existence_pos$Freq / sum(discourse_parent_existence_pos$Freq)
discourse_parent_existence_pos$Polarity <- rep('positive', nrow(discourse_parent_existence_pos))
discourse_parent_existence_pos$Measure <- rep('positive construction ratio', nrow(discourse_parent_existence_pos))
discourse_parent_existence_pos$Which <- rep('ratio', nrow(discourse_parent_existence_pos))
discourse_parent_existence_pos$Function <- rep('Non-existence', nrow(discourse_parent_existence_pos))
discourse_parent_existence_pos <- positive_moving(discourse_parent_existence_pos, parent_descriptive)


#discourse_parent_possession_pos <- data.frame(table(discourse_parent_possession_pos$Age))
#names(discourse_parent_possession_pos) <- c('Age', 'Freq')
#discourse_parent_possession_pos$Role <- rep('Parent', nrow(discourse_parent_possession_pos))
#discourse_parent_possession_pos$Head <- rep('have', nrow(discourse_parent_possession_pos))
#temp <- merge(discourse_parent_possession_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
#discourse_parent_possession_pos <- temp
#discourse_parent_possession_pos$Total_ratio <- discourse_parent_possession_pos$Freq / discourse_parent_possession_pos$N_utterance
#discourse_parent_possession_pos$Ratio <- discourse_parent_possession_pos$Freq / sum(discourse_parent_possession_pos$Freq)
#discourse_parent_possession_pos$Polarity <- rep('positive', nrow(discourse_parent_possession_pos))
#discourse_parent_possession_pos$Measure <- rep('positive construction ratio', nrow(discourse_parent_possession_pos))
#discourse_parent_possession_pos$Which <- rep('ratio', nrow(discourse_parent_possession_pos))
#discourse_parent_possession_pos$Function <- rep('Possession', nrow(discourse_parent_possession_pos))
#discourse_parent_possession_pos <- positive_moving(discourse_parent_possession_pos, parent_descriptive)


discourse_perception_data <- rbind(discourse_child_existence_neg, discourse_child_existence_pos, discourse_parent_existence_neg, discourse_parent_existence_pos, discourse_child_possession_neg, discourse_parent_possession_neg)

discourse_perception_data$Measure <- factor(discourse_perception_data$Measure, c('negative construction ratio', 'negative construction moving ratio', 'positive construction ratio', 'positive construction moving ratio'))

discourse_perception_data_child <- subset(discourse_perception_data, Role == 'Child')
discourse_perception_data_parent <- subset(discourse_perception_data, Role == 'Parent')

discourse_existence_data <- subset(discourse_perception_data, Function == 'Non-existence')
discourse_possession_data <- subset(discourse_perception_data, Function == 'Possession')

discourse_existence_data_child <- subset(discourse_existence_data, Role == 'Child')
discourse_existence_data_parent <- subset(discourse_existence_data, Role == 'Parent')

discourse_possession_data_child <- subset(discourse_possession_data, Role == 'Child')
discourse_possession_data_parent <- subset(discourse_possession_data, Role == 'Parent')

discourse_existence_data_plot <- aggregate(Total_ratio~Age+Which+Role,data=discourse_existence_data,sum)

names(discourse_existence_data_plot) <- c('Age', 'Measure', 'Role', 'Total_ratio')

discourse_possession_data_plot <- aggregate(Total_ratio~Age+Which+Role,data=discourse_possession_data,sum)

names(discourse_possession_data_plot) <- c('Age', 'Measure', 'Role', 'Total_ratio')

```

For this function we searched for the English existential construction and extracted utterances that had *there*-expletives, followed by a copula, and a noun phrase (phrases headed by either nouns or pronouns). We classified utterances where the predicate was modified by negation as negative, and the rest as positive. This led to a total of `r format(sum(subset(existence_data, Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")` negative utterances  (child: `r format(sum(subset(existence_data_child, Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`; parent: `r format(sum(subset(existence_data_parent, Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`), and a total of `r format(sum(subset(existence_data,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")` positive utterances (child: `r format(sum(subset(existence_data_child,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`; parent: `r format(sum(subset(existence_data_parent,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`).

|Non-existence (Negative)| Existentials (Positive)|
|----------------|----------------|
|*there's no (more) water* | *there are books*|
|*there isn't it* | *there is it*|
Table: (\#tab:nonexist) Examples of positive and negative existenial constructions in children's speech at the sentence level

At the sentence level, children produced negative constructions to express non-existence less frequently than the positive counterparts. As Figure \@ref(fig:existence) shows, the cumulative ratio for the production of non-existence increases from 18 to 36 months. Around and after 36 months of age, children's productions reaches a stable cumulative ratio close to that of adults. Notice that there appears to be fluctuations of cumulative ratios between the age of 19 and 25 months in child production. A closer inspection of the data reveals that within that age range, the frequency of negative utterances at most ages is either one or zero. Therefore while the number of total utterances increases along the developmental trajectory, the cumulative ratio for negative utterances actually decreases.

```{r existence, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap='Non-existence and its positive counterparts.'}

existence_data %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(log(Total_ratio), 2), group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) + 
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)") + 
  guides(linetype = guide_legend(nrow = 2))

```

<!--
```{r existenceul, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap='Non-existence and its positive counterparts, indexed by utterance length.'}

existence_ul_data %>% 
  ggplot(aes(as.numeric(as.character(Sent_len)), round(log(Total_ratio), 2), group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) + 
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 130, 10)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("utterance length") + 
  ylab("log(ratio)") + 
  guides(linetype = guide_legend(nrow = 2))

```
-->

For non-existence at the discourse level, we applied similar selection criteria and extracted negative utterances with existential constructions in their antecedents (Table \@ref(tab:disexist)). This led to a total of `r format(sum(subset(discourse_existence_data, Which=='ratio')$Freq), big.mark=",")` utterances  (child: `r format(sum(subset(discourse_existence_data_child, Which=='ratio')$Freq), big.mark=",")`; parent: `r format(sum(subset(discourse_existence_data_parent, Which=='ratio')$Freq), big.mark=",")`). As Figure \@ref(fig:exstencediscourse) shows, we could find an increase in children's responses with *no* to parents' existential utterances between the ages of 18 and 36 months. After 36 months, despite the fact that ratios show considerable fluctuations, the cumulative ratios of parents and children seem stable and similar. Therefore with non-existence, both sentence level and discourse level analyses point to substantial development in the age rage of 18-36 months.

|Antecedent|Utterance|
|------------|------------|
|Parent: *Is there a bunny*|Child: *no no bunny*|
Table: (\#tab:disexist) Example antecedents existentials and discourse level negation in parents' and children's productions 

```{r existencediscourse, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap='Discourse-level Non-existence.',warning=FALSE}

discourse_existence_data_plot %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(log(Total_ratio), 2), group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c('solid', 'dotted')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(16, 3)) +
  scale_color_manual(values = c("darkgreen", "grey")) + 
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)") 

```

### Prohibition

```{r motordata, include=FALSE}

motor <-read.csv('data/motor.txt', header = T, sep = '\t')
# motor <- subset(motor, Subj == 'I' | Subj == 'NONE')
motor$Role[which(motor$Role == "Father")] <- 'Parent'
motor$Role[which(motor$Role == "Mother")] <- 'Parent'
motor$Role[which(motor$Role == "Target_Child")] <- 'Child'

motor_neg = subset(motor, Polarity == 'negative')
motor_pos = subset(motor, Polarity == 'positive')

child_motor_neg <- subset(motor_neg, Role %in% c('Child'))
parent_motor_neg <- subset(motor_neg, Role %in% c('Parent'))

child_prohibition_neg <- subset(child_motor_neg, Function %in% c('prohibition'))
child_inability_neg <- subset(child_motor_neg, Function %in% c('inability') & Subj %in% c('I', 'i'))
parent_prohibition_neg <- subset(parent_motor_neg, Function %in% c('prohibition'))
parent_inability_neg <- subset(parent_motor_neg, Function %in% c('inability') & Subj %in% c('I', 'i'))

child_prohibition_neg_mlu <- mlu(child_prohibition_neg)
child_inability_neg_mlu <- mlu(child_inability_neg)
parent_prohibition_neg_mlu <- mlu(parent_prohibition_neg)
parent_inability_neg_mlu <- mlu(parent_inability_neg)

child_prohibition_neg <- data.frame(table(child_prohibition_neg$Age))
names(child_prohibition_neg) <- c('Age', 'Freq')
child_prohibition_neg$Role <- rep('Child', nrow(child_prohibition_neg))
child_prohibition_neg$Head <- rep('', nrow(child_prohibition_neg))
temp <- merge(child_prohibition_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_prohibition_neg <- temp
child_prohibition_neg$Total_ratio <- child_prohibition_neg$Freq / child_prohibition_neg$N_utterance
child_prohibition_neg$Ratio <- child_prohibition_neg$Freq / sum(child_prohibition_neg$Freq)
child_prohibition_neg$Polarity <- rep('negative', nrow(child_prohibition_neg))
child_prohibition_neg$Measure <- rep('negative construction ratio', nrow(child_prohibition_neg))
child_prohibition_neg$Which <- rep('ratio', nrow(child_prohibition_neg))
child_prohibition_neg$Function <- rep('Prohibition', nrow(child_prohibition_neg))
child_prohibition_neg <- negative_moving(child_prohibition_neg, child_descriptive)


child_inability_neg <- data.frame(table(child_inability_neg$Age))
names(child_inability_neg) <- c('Age', 'Freq')
child_inability_neg$Role <- rep('Child', nrow(child_inability_neg))
child_inability_neg$Head <- rep('', nrow(child_inability_neg))
temp <- merge(child_inability_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_inability_neg <- temp
child_inability_neg$Total_ratio <- child_inability_neg$Freq / child_inability_neg$N_utterance
child_inability_neg$Ratio <- child_inability_neg$Freq / sum(child_inability_neg$Freq)
child_inability_neg$Polarity <- rep('negative', nrow(child_inability_neg))
child_inability_neg$Measure <- rep('negative construction ratio', nrow(child_inability_neg))
child_inability_neg$Which <- rep('ratio', nrow(child_inability_neg))
child_inability_neg$Function <- rep('Inability', nrow(child_inability_neg))
child_inability_neg <- negative_moving(child_inability_neg, child_descriptive)


parent_prohibition_neg <- data.frame(table(parent_prohibition_neg$Age))
names(parent_prohibition_neg) <- c('Age', 'Freq')
parent_prohibition_neg$Role <- rep('Parent', nrow(parent_prohibition_neg))
parent_prohibition_neg$Head <- rep('', nrow(parent_prohibition_neg))
temp <- merge(parent_prohibition_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_prohibition_neg <- temp
parent_prohibition_neg$Total_ratio <- parent_prohibition_neg$Freq / parent_prohibition_neg$N_utterance
parent_prohibition_neg$Ratio <- parent_prohibition_neg$Freq / sum(parent_prohibition_neg$Freq)
parent_prohibition_neg$Polarity <- rep('negative', nrow(parent_prohibition_neg))
parent_prohibition_neg$Measure <- rep('negative construction ratio', nrow(parent_prohibition_neg))
parent_prohibition_neg$Which <- rep('ratio', nrow(parent_prohibition_neg))
parent_prohibition_neg$Function <- rep('Prohibition', nrow(parent_prohibition_neg))
parent_prohibition_neg <- negative_moving(parent_prohibition_neg, parent_descriptive)

parent_inability_neg <- data.frame(table(parent_inability_neg$Age))
names(parent_inability_neg) <- c('Age', 'Freq')
parent_inability_neg$Role <- rep('Parent', nrow(parent_inability_neg))
parent_inability_neg$Head <- rep('', nrow(parent_inability_neg))
temp <- merge(parent_inability_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_inability_neg <- temp
parent_inability_neg$Total_ratio <- parent_inability_neg$Freq / parent_inability_neg$N_utterance
parent_inability_neg$Ratio <- parent_inability_neg$Freq / sum(parent_inability_neg$Freq)
parent_inability_neg$Polarity <- rep('negative', nrow(parent_inability_neg))
parent_inability_neg$Measure <- rep('negative construction ratio', nrow(parent_inability_neg))
parent_inability_neg$Which <- rep('ratio', nrow(parent_inability_neg))
parent_inability_neg$Function <- rep('Inability', nrow(parent_inability_neg))
parent_inability_neg <- negative_moving(parent_inability_neg, parent_descriptive)


child_motor_pos <- subset(motor_pos, Role %in% c('Child'))
parent_motor_pos <- subset(motor_pos, Role %in% c('Parent'))

child_prohibition_pos <- subset(child_motor_pos, Function %in% c('prohibition'))
child_inability_pos <- subset(child_motor_pos, Function %in% c('inability') & Subj %in% c('I', 'i'))
parent_prohibition_pos <- subset(parent_motor_pos, Function %in% c('prohibition'))
parent_inability_pos <- subset(parent_motor_pos, Function %in% c('inability') & Subj %in% c('I', 'i'))

child_prohibition_pos_mlu <- mlu(child_prohibition_pos)
child_inability_pos_mlu <- mlu(child_inability_pos)
parent_prohibition_pos_mlu <- mlu(parent_prohibition_pos)
parent_inability_pos_mlu <- mlu(parent_inability_pos)

child_prohibition_pos <- data.frame(table(child_prohibition_pos$Age))
names(child_prohibition_pos) <- c('Age', 'Freq')
child_prohibition_pos$Role <- rep('Child', nrow(child_prohibition_pos))
child_prohibition_pos$Head <- rep('', nrow(child_prohibition_pos))
temp <- merge(child_prohibition_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_prohibition_pos <- temp
child_prohibition_pos$Total_ratio <- child_prohibition_pos$Freq / child_prohibition_pos$N_utterance
child_prohibition_pos$Ratio <- child_prohibition_pos$Freq / sum(child_prohibition_pos$Freq)
child_prohibition_pos$Polarity <- rep('positive', nrow(child_prohibition_pos))
child_prohibition_pos$Measure <- rep('positive construction ratio', nrow(child_prohibition_pos))
child_prohibition_pos$Which <- rep('ratio', nrow(child_prohibition_pos))
child_prohibition_pos$Function <- rep('Prohibition', nrow(child_prohibition_pos))
child_prohibition_pos <- positive_moving(child_prohibition_pos, child_descriptive)


child_inability_pos <- data.frame(table(child_inability_pos$Age))
names(child_inability_pos) <- c('Age', 'Freq')
child_inability_pos$Role <- rep('Child', nrow(child_inability_pos))
child_inability_pos$Head <- rep('', nrow(child_inability_pos))
temp <- merge(child_inability_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_inability_pos <- temp
child_inability_pos$Total_ratio <- child_inability_pos$Freq / child_inability_pos$N_utterance
child_inability_pos$Ratio <- child_inability_pos$Freq / sum(child_inability_pos$Freq)
child_inability_pos$Polarity <- rep('positive', nrow(child_inability_pos))
child_inability_pos$Measure <- rep('positive construction ratio', nrow(child_inability_pos))
child_inability_pos$Which <- rep('ratio', nrow(child_inability_pos))
child_inability_pos$Function <- rep('Inability', nrow(child_inability_pos))
child_inability_pos <- positive_moving(child_inability_pos, child_descriptive)


parent_prohibition_pos <- data.frame(table(parent_prohibition_pos$Age))
names(parent_prohibition_pos) <- c('Age', 'Freq')
parent_prohibition_pos$Role <- rep('Parent', nrow(parent_prohibition_pos))
parent_prohibition_pos$Head <- rep('', nrow(parent_prohibition_pos))
temp <- merge(parent_prohibition_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_prohibition_pos <- temp
parent_prohibition_pos$Total_ratio <- parent_prohibition_pos$Freq / parent_prohibition_pos$N_utterance
parent_prohibition_pos$Ratio <- parent_prohibition_pos$Freq / sum(parent_prohibition_pos$Freq)
parent_prohibition_pos$Polarity <- rep('positive', nrow(parent_prohibition_pos))
parent_prohibition_pos$Measure <- rep('positive construction ratio', nrow(parent_prohibition_pos))
parent_prohibition_pos$Which <- rep('ratio', nrow(parent_prohibition_pos))
parent_prohibition_pos$Function <- rep('Prohibition', nrow(parent_prohibition_pos))
parent_prohibition_pos <- positive_moving(parent_prohibition_pos, parent_descriptive)

parent_inability_pos <- data.frame(table(parent_inability_pos$Age))
names(parent_inability_pos) <- c('Age', 'Freq')
parent_inability_pos$Role <- rep('Parent', nrow(parent_inability_pos))
parent_inability_pos$Head <- rep('', nrow(parent_inability_pos))
temp <- merge(parent_inability_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_inability_pos <- temp
parent_inability_pos$Total_ratio <- parent_inability_pos$Freq / parent_inability_pos$N_utterance
parent_inability_pos$Ratio <- parent_inability_pos$Freq / sum(parent_inability_pos$Freq)
parent_inability_pos$Polarity <- rep('positive', nrow(parent_inability_pos))
parent_inability_pos$Measure <- rep('positive construction ratio', nrow(parent_inability_pos))
parent_inability_pos$Which <- rep('ratio', nrow(parent_inability_pos))
parent_inability_pos$Function <- rep('Inability', nrow(parent_inability_pos))
parent_inability_pos <- positive_moving(parent_inability_pos, parent_descriptive)


motor_data <- rbind(child_prohibition_neg, child_prohibition_pos, parent_prohibition_neg, parent_prohibition_pos, child_inability_neg, child_inability_pos, parent_inability_neg, parent_inability_pos)

motor_data$Measure <- factor(motor_data$Measure, levels = c('negative construction ratio', 'negative construction moving ratio', 'positive construction ratio', 'positive construction moving ratio'))


motor_data_child <- subset(motor_data, Role == 'Child')
motor_data_parent <- subset(motor_data, Role == 'Parent')

prohibition_data <- subset(motor_data, Function == 'Prohibition')
inability_data <- subset(motor_data, Function == 'Inability')

prohibition_data_child <- subset(prohibition_data, Role =='Child')
prohibition_data_parent <- subset(prohibition_data, Role =='Parent')

inability_data_child <- subset(inability_data, Role =='Child')
inability_data_parent <- subset(inability_data, Role =='Parent')

```

```{r motoruldata, include=FALSE}

child_ul_prohibition_neg <- subset(child_motor_neg, Function %in% c('prohibition'))
child_ul_inability_neg <- subset(child_motor_neg, Function %in% c('inability') & Subj %in% c('I', 'i'))
parent_ul_prohibition_neg <- subset(parent_motor_neg, Function %in% c('prohibition'))
parent_ul_inability_neg <- subset(parent_motor_neg, Function %in% c('inability') & Subj %in% c('I', 'i'))


child_ul_prohibition_neg <- data.frame(table(child_ul_prohibition_neg$Sent_len))
names(child_ul_prohibition_neg) <- c('Sent_len', 'Freq')
child_ul_prohibition_neg$Role <- rep('Child', nrow(child_ul_prohibition_neg))
child_ul_prohibition_neg$Head <- rep('', nrow(child_ul_prohibition_neg))
temp <- merge(child_ul_prohibition_neg, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_prohibition_neg <- temp
child_ul_prohibition_neg$Total_ratio <- child_ul_prohibition_neg$Freq / child_ul_prohibition_neg$N_utterance
child_ul_prohibition_neg$Ratio <- child_ul_prohibition_neg$Freq / sum(child_ul_prohibition_neg$Freq)
child_ul_prohibition_neg$Polarity <- rep('negative', nrow(child_ul_prohibition_neg))
child_ul_prohibition_neg$Measure <- rep('negative construction ratio', nrow(child_ul_prohibition_neg))
child_ul_prohibition_neg$Which <- rep('ratio', nrow(child_ul_prohibition_neg))
child_ul_prohibition_neg$Function <- rep('Prohibition', nrow(child_ul_prohibition_neg))
child_ul_prohibition_neg <- negative_ul_moving(child_ul_prohibition_neg, child_ul_descriptive)


child_ul_inability_neg <- data.frame(table(child_ul_inability_neg$Sent_len))
names(child_ul_inability_neg) <- c('Sent_len', 'Freq')
child_ul_inability_neg$Role <- rep('Child', nrow(child_ul_inability_neg))
child_ul_inability_neg$Head <- rep('', nrow(child_ul_inability_neg))
temp <- merge(child_ul_inability_neg, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_inability_neg <- temp
child_ul_inability_neg$Total_ratio <- child_ul_inability_neg$Freq / child_ul_inability_neg$N_utterance
child_ul_inability_neg$Ratio <- child_ul_inability_neg$Freq / sum(child_ul_inability_neg$Freq)
child_ul_inability_neg$Polarity <- rep('negative', nrow(child_ul_inability_neg))
child_ul_inability_neg$Measure <- rep('negative construction ratio', nrow(child_ul_inability_neg))
child_ul_inability_neg$Which <- rep('ratio', nrow(child_ul_inability_neg))
child_ul_inability_neg$Function <- rep('Inability', nrow(child_ul_inability_neg))
child_ul_inability_neg <- negative_ul_moving(child_ul_inability_neg, child_ul_descriptive)


parent_ul_prohibition_neg <- data.frame(table(parent_ul_prohibition_neg$Sent_len))
names(parent_ul_prohibition_neg) <- c('Sent_len', 'Freq')
parent_ul_prohibition_neg$Role <- rep('Parent', nrow(parent_ul_prohibition_neg))
parent_ul_prohibition_neg$Head <- rep('', nrow(parent_ul_prohibition_neg))
temp <- merge(parent_ul_prohibition_neg, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_prohibition_neg <- temp
parent_ul_prohibition_neg$Total_ratio <- parent_ul_prohibition_neg$Freq / parent_ul_prohibition_neg$N_utterance
parent_ul_prohibition_neg$Ratio <- parent_ul_prohibition_neg$Freq / sum(parent_ul_prohibition_neg$Freq)
parent_ul_prohibition_neg$Polarity <- rep('negative', nrow(parent_ul_prohibition_neg))
parent_ul_prohibition_neg$Measure <- rep('negative construction ratio', nrow(parent_ul_prohibition_neg))
parent_ul_prohibition_neg$Which <- rep('ratio', nrow(parent_ul_prohibition_neg))
parent_ul_prohibition_neg$Function <- rep('Prohibition', nrow(parent_ul_prohibition_neg))
parent_ul_prohibition_neg <- negative_ul_moving(parent_ul_prohibition_neg, parent_ul_descriptive)

parent_ul_inability_neg <- data.frame(table(parent_ul_inability_neg$Sent_len))
names(parent_ul_inability_neg) <- c('Sent_len', 'Freq')
parent_ul_inability_neg$Role <- rep('Parent', nrow(parent_ul_inability_neg))
parent_ul_inability_neg$Head <- rep('', nrow(parent_ul_inability_neg))
temp <- merge(parent_ul_inability_neg, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_inability_neg <- temp
parent_ul_inability_neg$Total_ratio <- parent_ul_inability_neg$Freq / parent_ul_inability_neg$N_utterance
parent_ul_inability_neg$Ratio <- parent_ul_inability_neg$Freq / sum(parent_ul_inability_neg$Freq)
parent_ul_inability_neg$Polarity <- rep('negative', nrow(parent_ul_inability_neg))
parent_ul_inability_neg$Measure <- rep('negative construction ratio', nrow(parent_ul_inability_neg))
parent_ul_inability_neg$Which <- rep('ratio', nrow(parent_ul_inability_neg))
parent_ul_inability_neg$Function <- rep('Inability', nrow(parent_ul_inability_neg))
parent_ul_inability_neg <- negative_ul_moving(parent_ul_inability_neg, parent_ul_descriptive)


child_ul_prohibition_pos <- subset(child_motor_pos, Function %in% c('prohibition'))
child_ul_inability_pos <- subset(child_motor_pos, Function %in% c('inability') & Subj %in% c('I', 'i'))
parent_ul_prohibition_pos <- subset(parent_motor_pos, Function %in% c('prohibition'))
parent_ul_inability_pos <- subset(parent_motor_pos, Function %in% c('inability') & Subj %in% c('I', 'i'))


child_ul_prohibition_pos <- data.frame(table(child_ul_prohibition_pos$Sent_len))
names(child_ul_prohibition_pos) <- c('Sent_len', 'Freq')
child_ul_prohibition_pos$Role <- rep('Child', nrow(child_ul_prohibition_pos))
child_ul_prohibition_pos$Head <- rep('', nrow(child_ul_prohibition_pos))
temp <- merge(child_ul_prohibition_pos, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_prohibition_pos <- temp
child_ul_prohibition_pos$Total_ratio <- child_ul_prohibition_pos$Freq / child_ul_prohibition_pos$N_utterance
child_ul_prohibition_pos$Ratio <- child_ul_prohibition_pos$Freq / sum(child_ul_prohibition_pos$Freq)
child_ul_prohibition_pos$Polarity <- rep('positive', nrow(child_ul_prohibition_pos))
child_ul_prohibition_pos$Measure <- rep('positive construction ratio', nrow(child_ul_prohibition_pos))
child_ul_prohibition_pos$Which <- rep('ratio', nrow(child_ul_prohibition_pos))
child_ul_prohibition_pos$Function <- rep('Prohibition', nrow(child_ul_prohibition_pos))
child_ul_prohibition_pos <- positive_ul_moving(child_ul_prohibition_pos, child_ul_descriptive)


child_ul_inability_pos <- data.frame(table(child_ul_inability_pos$Sent_len))
names(child_ul_inability_pos) <- c('Sent_len', 'Freq')
child_ul_inability_pos$Role <- rep('Child', nrow(child_ul_inability_pos))
child_ul_inability_pos$Head <- rep('', nrow(child_ul_inability_pos))
temp <- merge(child_ul_inability_pos, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_inability_pos <- temp
child_ul_inability_pos$Total_ratio <- child_ul_inability_pos$Freq / child_ul_inability_pos$N_utterance
child_ul_inability_pos$Ratio <- child_ul_inability_pos$Freq / sum(child_ul_inability_pos$Freq)
child_ul_inability_pos$Polarity <- rep('positive', nrow(child_ul_inability_pos))
child_ul_inability_pos$Measure <- rep('positive construction ratio', nrow(child_ul_inability_pos))
child_ul_inability_pos$Which <- rep('ratio', nrow(child_ul_inability_pos))
child_ul_inability_pos$Function <- rep('Inability', nrow(child_ul_inability_pos))
child_ul_inability_pos <- positive_ul_moving(child_ul_inability_pos, child_ul_descriptive)


parent_ul_prohibition_pos <- data.frame(table(parent_ul_prohibition_pos$Sent_len))
names(parent_ul_prohibition_pos) <- c('Sent_len', 'Freq')
parent_ul_prohibition_pos$Role <- rep('Parent', nrow(parent_ul_prohibition_pos))
parent_ul_prohibition_pos$Head <- rep('', nrow(parent_ul_prohibition_pos))
temp <- merge(parent_ul_prohibition_pos, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_prohibition_pos <- temp
parent_ul_prohibition_pos$Total_ratio <- parent_ul_prohibition_pos$Freq / parent_ul_prohibition_pos$N_utterance
parent_ul_prohibition_pos$Ratio <- parent_ul_prohibition_pos$Freq / sum(parent_ul_prohibition_pos$Freq)
parent_ul_prohibition_pos$Polarity <- rep('positive', nrow(parent_ul_prohibition_pos))
parent_ul_prohibition_pos$Measure <- rep('positive construction ratio', nrow(parent_ul_prohibition_pos))
parent_ul_prohibition_pos$Which <- rep('ratio', nrow(parent_ul_prohibition_pos))
parent_ul_prohibition_pos$Function <- rep('Prohibition', nrow(parent_ul_prohibition_pos))
parent_ul_prohibition_pos <- positive_ul_moving(parent_ul_prohibition_pos, parent_ul_descriptive)

parent_ul_inability_pos <- data.frame(table(parent_ul_inability_pos$Sent_len))
names(parent_ul_inability_pos) <- c('Sent_len', 'Freq')
parent_ul_inability_pos$Role <- rep('Parent', nrow(parent_ul_inability_pos))
parent_ul_inability_pos$Head <- rep('', nrow(parent_ul_inability_pos))
temp <- merge(parent_ul_inability_pos, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_inability_pos <- temp
parent_ul_inability_pos$Total_ratio <- parent_ul_inability_pos$Freq / parent_ul_inability_pos$N_utterance
parent_ul_inability_pos$Ratio <- parent_ul_inability_pos$Freq / sum(parent_ul_inability_pos$Freq)
parent_ul_inability_pos$Polarity <- rep('positive', nrow(parent_ul_inability_pos))
parent_ul_inability_pos$Measure <- rep('positive construction ratio', nrow(parent_ul_inability_pos))
parent_ul_inability_pos$Which <- rep('ratio', nrow(parent_ul_inability_pos))
parent_ul_inability_pos$Function <- rep('Inability', nrow(parent_ul_inability_pos))
parent_ul_inability_pos <- positive_ul_moving(parent_ul_inability_pos, parent_ul_descriptive)


motor_ul_data <- rbind(child_ul_prohibition_neg, child_ul_prohibition_pos, parent_ul_prohibition_neg, parent_ul_prohibition_pos, child_ul_inability_neg, child_ul_inability_pos, parent_ul_inability_neg, parent_ul_inability_pos)

motor_ul_data$Measure <- factor(motor_ul_data$Measure, levels = c('negative construction ratio', 'negative construction moving ratio', 'positive construction ratio', 'positive construction moving ratio'))


motor_ul_data_child <- subset(motor_ul_data, Role == 'Child')
motor_ul_data_parent <- subset(motor_ul_data, Role == 'Parent')

prohibition_ul_data <- subset(motor_ul_data, Function == 'Prohibition')
inability_ul_data <- subset(motor_ul_data, Function == 'Inability')

prohibition_ul_data_child <- subset(prohibition_ul_data, Role =='Child')
prohibition_ul_data_parent <- subset(prohibition_ul_data, Role =='Parent')

inability_ul_data_child <- subset(inability_ul_data, Role =='Child')
inability_ul_data_parent <- subset(inability_ul_data, Role =='Parent')

```

```{r motordiscoursedata, include=FALSE}

discourse_motor <-read.csv('data/motor_discourse.txt', header = T, sep = '\t')
discourse_motor$Role[which(discourse_motor$Role == "Father")] <- 'Parent'
discourse_motor$Role[which(discourse_motor$Role == "Mother")] <- 'Parent'
discourse_motor$Role[which(discourse_motor$Role == "Target_Child")] <- 'Child'

discourse_motor_neg = subset(discourse_motor, Polarity == 'negative')
discourse_motor_pos = subset(discourse_motor, Polarity == 'positive')

discourse_child_motor_neg <- subset(discourse_motor_neg, Role %in% c('Child'))
discourse_parent_motor_neg <- subset(discourse_motor_neg, Role %in% c('Parent'))

discourse_child_prohibition_neg <- subset(discourse_child_motor_neg, Function %in% c('prohibition'))
discourse_child_inability_neg <- subset(discourse_child_motor_neg, Function %in% c('inability') & Subj %in% c('I', 'i'))
discourse_parent_prohibition_neg <- subset(discourse_parent_motor_neg, Function %in% c('prohibition'))
discourse_parent_inability_neg <- subset(discourse_parent_motor_neg, Function %in% c('inability') & Subj %in% c('I', 'i'))


discourse_child_prohibition_neg <- data.frame(table(discourse_child_prohibition_neg$Age))
names(discourse_child_prohibition_neg) <- c('Age', 'Freq')
discourse_child_prohibition_neg$Role <- rep('Child', nrow(discourse_child_prohibition_neg))
discourse_child_prohibition_neg$Head <- rep('', nrow(discourse_child_prohibition_neg))
temp <- merge(discourse_child_prohibition_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_prohibition_neg <- temp
discourse_child_prohibition_neg$Total_ratio <- discourse_child_prohibition_neg$Freq / discourse_child_prohibition_neg$N_utterance
discourse_child_prohibition_neg$Ratio <- discourse_child_prohibition_neg$Freq / sum(discourse_child_prohibition_neg$Freq)
discourse_child_prohibition_neg$Polarity <- rep('negative', nrow(discourse_child_prohibition_neg))
discourse_child_prohibition_neg$Measure <- rep('negative construction ratio', nrow(discourse_child_prohibition_neg))
discourse_child_prohibition_neg$Which <- rep('ratio', nrow(discourse_child_prohibition_neg))
discourse_child_prohibition_neg$Function <- rep('Prohibition', nrow(discourse_child_prohibition_neg))
discourse_child_prohibition_neg <- negative_moving(discourse_child_prohibition_neg, child_descriptive)


discourse_child_inability_neg <- data.frame(table(discourse_child_inability_neg$Age))
names(discourse_child_inability_neg) <- c('Age', 'Freq')
discourse_child_inability_neg$Role <- rep('Child', nrow(discourse_child_inability_neg))
discourse_child_inability_neg$Head <- rep('', nrow(discourse_child_inability_neg))
temp <- merge(discourse_child_inability_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_inability_neg <- temp
discourse_child_inability_neg$Total_ratio <- discourse_child_inability_neg$Freq / discourse_child_inability_neg$N_utterance
discourse_child_inability_neg$Ratio <- discourse_child_inability_neg$Freq / sum(discourse_child_inability_neg$Freq)
discourse_child_inability_neg$Polarity <- rep('negative', nrow(discourse_child_inability_neg))
discourse_child_inability_neg$Measure <- rep('negative construction ratio', nrow(discourse_child_inability_neg))
discourse_child_inability_neg$Which <- rep('ratio', nrow(discourse_child_inability_neg))
discourse_child_inability_neg$Function <- rep('Inability', nrow(discourse_child_inability_neg))
discourse_child_inability_neg <- negative_moving(discourse_child_inability_neg, child_descriptive)


discourse_parent_prohibition_neg <- data.frame(table(discourse_parent_prohibition_neg$Age))
names(discourse_parent_prohibition_neg) <- c('Age', 'Freq')
discourse_parent_prohibition_neg$Role <- rep('Parent', nrow(discourse_parent_prohibition_neg))
discourse_parent_prohibition_neg$Head <- rep('', nrow(discourse_parent_prohibition_neg))
temp <- merge(discourse_parent_prohibition_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_prohibition_neg <- temp
discourse_parent_prohibition_neg$Total_ratio <- discourse_parent_prohibition_neg$Freq / discourse_parent_prohibition_neg$N_utterance
discourse_parent_prohibition_neg$Ratio <- discourse_parent_prohibition_neg$Freq / sum(discourse_parent_prohibition_neg$Freq)
discourse_parent_prohibition_neg$Polarity <- rep('negative', nrow(discourse_parent_prohibition_neg))
discourse_parent_prohibition_neg$Measure <- rep('negative construction ratio', nrow(discourse_parent_prohibition_neg))
discourse_parent_prohibition_neg$Which <- rep('ratio', nrow(discourse_parent_prohibition_neg))
discourse_parent_prohibition_neg$Function <- rep('Prohibition', nrow(discourse_parent_prohibition_neg))
discourse_parent_prohibition_neg <- negative_moving(discourse_parent_prohibition_neg, parent_descriptive)

discourse_parent_inability_neg <- data.frame(table(discourse_parent_inability_neg$Age))
names(discourse_parent_inability_neg) <- c('Age', 'Freq')
discourse_parent_inability_neg$Role <- rep('Parent', nrow(discourse_parent_inability_neg))
discourse_parent_inability_neg$Head <- rep('', nrow(discourse_parent_inability_neg))
temp <- merge(discourse_parent_inability_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_inability_neg <- temp
discourse_parent_inability_neg$Total_ratio <- discourse_parent_inability_neg$Freq / discourse_parent_inability_neg$N_utterance
discourse_parent_inability_neg$Ratio <- discourse_parent_inability_neg$Freq / sum(discourse_parent_inability_neg$Freq)
discourse_parent_inability_neg$Polarity <- rep('negative', nrow(discourse_parent_inability_neg))
discourse_parent_inability_neg$Measure <- rep('negative construction ratio', nrow(discourse_parent_inability_neg))
discourse_parent_inability_neg$Which <- rep('ratio', nrow(discourse_parent_inability_neg))
discourse_parent_inability_neg$Function <- rep('Inability', nrow(discourse_parent_inability_neg))
discourse_parent_inability_neg <- negative_moving(discourse_parent_inability_neg, parent_descriptive)


discourse_child_motor_pos <- subset(discourse_motor_pos, Role %in% c('Child'))
discourse_parent_motor_pos <- subset(discourse_motor_pos, Role %in% c('Parent'))

discourse_child_prohibition_pos <- subset(discourse_child_motor_pos, Function %in% c('prohibition'))
discourse_child_inability_pos <- subset(discourse_child_motor_pos, Function %in% c('inability') & Subj %in% c('I', 'i'))
discourse_parent_prohibition_pos <- subset(discourse_parent_motor_pos, Function %in% c('prohibition'))
discourse_parent_inability_pos <- subset(discourse_parent_motor_pos, Function %in% c('inability') & Subj %in% c('I', 'i'))

discourse_child_prohibition_pos <- data.frame(table(discourse_child_prohibition_pos$Age))
names(discourse_child_prohibition_pos) <- c('Age', 'Freq')
discourse_child_prohibition_pos$Role <- rep('Child', nrow(discourse_child_prohibition_pos))
discourse_child_prohibition_pos$Head <- rep('', nrow(discourse_child_prohibition_pos))
temp <- merge(discourse_child_prohibition_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_prohibition_pos <- temp
discourse_child_prohibition_pos$Total_ratio <- discourse_child_prohibition_pos$Freq / discourse_child_prohibition_pos$N_utterance
discourse_child_prohibition_pos$Ratio <- discourse_child_prohibition_pos$Freq / sum(discourse_child_prohibition_pos$Freq)
discourse_child_prohibition_pos$Polarity <- rep('positive', nrow(discourse_child_prohibition_pos))
discourse_child_prohibition_pos$Measure <- rep('positive construction ratio', nrow(discourse_child_prohibition_pos))
discourse_child_prohibition_pos$Which <- rep('ratio', nrow(discourse_child_prohibition_pos))
discourse_child_prohibition_pos$Function <- rep('Prohibition', nrow(discourse_child_prohibition_pos))
discourse_child_prohibition_pos <- positive_moving(discourse_child_prohibition_pos, child_descriptive)


discourse_child_inability_pos <- data.frame(table(discourse_child_inability_pos$Age))
names(discourse_child_inability_pos) <- c('Age', 'Freq')
discourse_child_inability_pos$Role <- rep('Child', nrow(discourse_child_inability_pos))
discourse_child_inability_pos$Head <- rep('', nrow(discourse_child_inability_pos))
temp <- merge(discourse_child_inability_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_inability_pos <- temp
discourse_child_inability_pos$Total_ratio <- discourse_child_inability_pos$Freq / discourse_child_inability_pos$N_utterance
discourse_child_inability_pos$Ratio <- discourse_child_inability_pos$Freq / sum(discourse_child_inability_pos$Freq)
discourse_child_inability_pos$Polarity <- rep('positive', nrow(discourse_child_inability_pos))
discourse_child_inability_pos$Measure <- rep('positive construction ratio', nrow(discourse_child_inability_pos))
discourse_child_inability_pos$Which <- rep('ratio', nrow(discourse_child_inability_pos))
discourse_child_inability_pos$Function <- rep('Inability', nrow(discourse_child_inability_pos))
discourse_child_inability_pos <- positive_moving(discourse_child_inability_pos, child_descriptive)


discourse_parent_prohibition_pos <- data.frame(table(discourse_parent_prohibition_pos$Age))
names(discourse_parent_prohibition_pos) <- c('Age', 'Freq')
discourse_parent_prohibition_pos$Role <- rep('Parent', nrow(discourse_parent_prohibition_pos))
discourse_parent_prohibition_pos$Head <- rep('', nrow(discourse_parent_prohibition_pos))
temp <- merge(discourse_parent_prohibition_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_prohibition_pos <- temp
discourse_parent_prohibition_pos$Total_ratio <- discourse_parent_prohibition_pos$Freq / discourse_parent_prohibition_pos$N_utterance
discourse_parent_prohibition_pos$Ratio <- discourse_parent_prohibition_pos$Freq / sum(discourse_parent_prohibition_pos$Freq)
discourse_parent_prohibition_pos$Polarity <- rep('positive', nrow(discourse_parent_prohibition_pos))
discourse_parent_prohibition_pos$Measure <- rep('positive construction ratio', nrow(discourse_parent_prohibition_pos))
discourse_parent_prohibition_pos$Which <- rep('ratio', nrow(discourse_parent_prohibition_pos))
discourse_parent_prohibition_pos$Function <- rep('Prohibition', nrow(discourse_parent_prohibition_pos))
discourse_parent_prohibition_pos <- positive_moving(discourse_parent_prohibition_pos, parent_descriptive)

discourse_parent_inability_pos <- data.frame(table(discourse_parent_inability_pos$Age))
names(discourse_parent_inability_pos) <- c('Age', 'Freq')
discourse_parent_inability_pos$Role <- rep('Parent', nrow(discourse_parent_inability_pos))
discourse_parent_inability_pos$Head <- rep('', nrow(discourse_parent_inability_pos))
temp <- merge(discourse_parent_inability_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_inability_pos <- temp
discourse_parent_inability_pos$Total_ratio <- discourse_parent_inability_pos$Freq / discourse_parent_inability_pos$N_utterance
discourse_parent_inability_pos$Ratio <- discourse_parent_inability_pos$Freq / sum(discourse_parent_inability_pos$Freq)
discourse_parent_inability_pos$Polarity <- rep('positive', nrow(discourse_parent_inability_pos))
discourse_parent_inability_pos$Measure <- rep('positive construction ratio', nrow(discourse_parent_inability_pos))
discourse_parent_inability_pos$Which <- rep('ratio', nrow(discourse_parent_inability_pos))
discourse_parent_inability_pos$Function <- rep('Inability', nrow(discourse_parent_inability_pos))
discourse_parent_inability_pos <- positive_moving(discourse_parent_inability_pos, parent_descriptive)

discourse_motor_data <- rbind(discourse_child_prohibition_neg, discourse_child_prohibition_pos, discourse_parent_prohibition_neg, discourse_parent_prohibition_pos, discourse_child_inability_neg, discourse_child_inability_pos, discourse_parent_inability_neg, discourse_parent_inability_pos)

discourse_motor_data$Measure <- factor(discourse_motor_data$Measure, levels = c('negative construction ratio', 'negative construction moving ratio', 'positive construction ratio', 'positive construction moving ratio'))


discourse_motor_data_child <- subset(discourse_motor_data, Role == 'Child')
discourse_motor_data_parent <- subset(discourse_motor_data, Role == 'Parent')

discourse_prohibition_data <- subset(discourse_motor_data, Function == 'Prohibition')
discourse_inability_data <- subset(discourse_motor_data, Function == 'Inability')

discourse_prohibition_data_child <- subset(prohibition_data, Role =='Child')
discourse_prohibition_data_parent <- subset(prohibition_data, Role =='Parent')

discourse_inability_data_child <- subset(inability_data, Role =='Child')
discourse_inability_data_parent <- subset(inability_data, Role =='Parent')

discourse_prohibition_data_plot <- aggregate(Total_ratio~Age+Which+Role,data=discourse_prohibition_data,sum)

names(discourse_prohibition_data_plot) <- c('Age', 'Measure', 'Role', 'Total_ratio')

discourse_inability_data_plot <- aggregate(Total_ratio~Age+Which+Role,data=discourse_inability_data,sum)

names(discourse_inability_data_plot) <- c('Age', 'Measure', 'Role', 'Total_ratio')

```

For constructions that typically convey prohibition, we extracted utterances that were annotated as imperatives in CHILDES. In particular, we selected instances where the head verbs do not take any subjects. As before, cases without any negative morphemes are considered as positive. For negative constructions, we chose structures where the negative morphemes are combined with the auxiliary verb *do* (*do*, *does*, *did*) and they together modify the head verbs of the sentences. In order to not have overlap with rejection, non-existence, epistemic negation and possession (see below), our search excluded utterances where the head verb had any of the following lemma forms: *like*, *want*, *know*, *think*, *remember*, *have*. This resulted in a total of `r format(sum(subset(prohibition_data,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")` negative utterances (child: `r format(sum(subset(prohibition_data_child,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`; parent: `r format(sum(subset(prohibition_data_parent,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`), and a total of `r format(sum(subset(prohibition_data,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")` negative utterances (child: `r format(sum(subset(prohibition_data_child,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`; parent: `r format(sum(subset(prohibition_data_parent,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`).

Figure \@ref(fig:prohibition) shows the ratios and cumulative ratios of prohibitions and their positive counterparts in parents' and children's speech at the sentence level. In both child and parent speech, negative constructions for prohibition are consistently produced less frequently than their positive counterparts. Children produce prohibitions (negative imperatives) more and more often between 24 and 36 months. In comparison, the cumulative ratio in parent speech gradually decreases at the beginning when children between 12 - 36 months. Yet overall, child production is remains consistently lower than parent production of prohibition. This might be due to the social nature of parent-child interactions, in which it is more likely for parents to explicitly command and direct children's actions than the other way round.

|Prohibition (Negative)| Imperatives (Positive)|
|----------------|----------------|
|*don't blame Charlotte* | *cook it*|
Table: (\#tab:prohibit) Examples of positive and negative imperatives in children's speech at the sentence level

```{r prohibition, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap='Prohibition and its positive counterparts.'}

prohibition_data %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(log(Total_ratio), 2), group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) +
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)") + 
  guides(linetype = guide_legend(nrow = 2))

```

<!--
```{r prohibitionul, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap='Prohibition and its positive counterparts, indexed by utterance length.'}

prohibition_ul_data %>% 
  ggplot(aes(as.numeric(as.character(Sent_len)), round(log(Total_ratio), 2), group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) +
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 130, 10)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)") + 
  guides(linetype = guide_legend(nrow = 2))

```
-->

At the discourse level, we selected *No*-utterances with antecedents that were subjectless imperatives headed by a verb, excluding the following lemma forms: *like*, *want*, *know*, *think*, *remember*, nor *have*. This resulted in a total of `r format(sum(subset(discourse_prohibition_data,Which=='ratio')$Freq), big.mark=",")` utterances (child: `r format(sum(subset(discourse_prohibition_data_child,Which=='ratio')$Freq), big.mark=",")`; parent: `r format(sum(subset(discourse_prohibition_data_parent,Which=='ratio')$Freq), big.mark=",")`). As shown in Figure \@ref(fig:prohibitiondiscourse), children's usage of negation as a response particle to express prohibition is comparable to their productions at the sentence level. Their negative productions increases within the age range of 24 to 36 months, and parent production decreases when the children are between 12 to 36 months.

|Antecedent|Utterance|
|------------|------------|
|Parent: *put away your toys*|Child: *no mommy I like these*|
Table: (\#tab:disprohib) Example antecedents imperatives and discourse level negation in parents' and children's productions 

```{r prohibitiondiscourse, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap='Discourse-level Prohibition.',warning=FALSE}

discourse_prohibition_data_plot %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(log(Total_ratio), 2), group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c('solid', 'dotted')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(16, 3)) +
  scale_color_manual(values = c("darkgreen", "grey")) + 
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)") 

```

### Inability 

For the function of inability, we analyzed instances with head verbs that are modified by the modal auxiliaries *can* and *could*. If the head verb was also modified by a negative morpheme, we classified it as negative. Otherwise, we considered it positive. Cases without a subject (e.g. "can't play") or with subjects that were not first person singular (e.g. "you can't do that", "this can't go in the box") were excluded. This is because such cases often yield readings other than "(in)ability". Depending on the larger context, they could be deontic (e.g. "you are not allowed to do that") or epistemic (e.g. "it is not possible for it to go in the box"). To avoid this ambiguity and focus more on constructions that convey an individual's ability, we restricted our analyses only to cases with the first person singular subject *I*. This led to `r format(sum(subset(inability_data,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")` negative utterances (child: `r format(sum(subset(inability_data_child,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`; parent: `r format(sum(subset(inability_data_parent,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`), and `r format(sum(subset(inability_data,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")` positive utterances (child: `r format(sum(subset(inability_data_child,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`; parent: `r format(sum(subset(inability_data_parent,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`). Table \@ref(tab:inab) shows a few example of the cases we considered.

|Inability (Negative)| Ability (Positive)|
|----------------|----------------|
|*I can't see* | *You could do it*|
Table: (\#tab:inab) Examples of constructions that convey ability and inability in children's speech at the sentence level

Figure \@ref(fig:inability) shows ratios and cumulative ratios of parents and children's productions of inability constructions as defined above. Similar to previous constructions, positive instances are generally more frequent than negative ones. Children produce inability negation more and more frequently between 18-36 months. After 36 months, their productions are stable and close to parent ratios. 

```{r inability, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap="Ratios and Cumulative Ratios for parents and children's productions of the inability construction and its positive counterpart."}

inability_data %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(log(Total_ratio), 2), group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) +
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)") + 
  guides(linetype = guide_legend(nrow = 2))

```

At the discourse level, we selected utterances with the negative particle *no* in response to antecedents that had a similar structure to the inability construction defined above. This yielded a total of `r format(sum(subset(discourse_inability_data,Which=='ratio')$Freq), big.mark=",")` negative utterances (child: `r format(sum(subset(discourse_inability_data_child,Which=='ratio')$Freq), big.mark=",")`; parent: `r format(sum(subset(discourse_inability_data_parent,Which=='ratio')$Freq), big.mark=",")`). Figure \@ref(fig:inabilitydiscourse) shows the ratios and the moving ratios for parents' and children's production of discourse level inability construction. Considering cumulative ratios, children's productions gradually increase from 24 to 36 months and stabalizes after 36 months at a similar rate to that of parent's. <!-- these plots are really noisy! Maybe we should relax the exclusion criteria? What if we include questions -->

<!--
```{r inabilityul, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap='Inability and its positive counterparts, indexed by utterance length.'}

inability_ul_data %>% 
  ggplot(aes(as.numeric(as.character(Sent_len)), round(log(Total_ratio), 2), group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) +
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 130, 10)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)") + 
  guides(linetype = guide_legend(nrow = 2))

```
-->

```{r inabilitydiscourse, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap='Discourse-level Inability.',warning=FALSE}

discourse_inability_data_plot %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(log(Total_ratio), 2), group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c('solid', 'dotted')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(16, 3)) +
  scale_color_manual(values = c("darkgreen", "grey")) + 
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)")

```

### Labeling

```{r learningdata, include=FALSE}

learning <-read.csv('data/learning.txt', header = T, sep = '\t')
# learning <- subset(learning, Subj == 'I' | Subj == 'NONE')
learning$Role[which(learning$Role == "Father")] <- 'Parent'
learning$Role[which(learning$Role == "Mother")] <- 'Parent'
learning$Role[which(learning$Role == "Target_Child")] <- 'Child'

learning_neg = subset(learning, Polarity == 'negative')
learning_pos = subset(learning, Polarity == 'positive')

child_learning_neg <- subset(learning_neg, Role %in% c('Child'))
parent_learning_neg <- subset(learning_neg, Role %in% c('Parent'))

child_learning_neg_mlu <- mlu(child_learning_neg)
parent_learning_neg_mlu <- mlu(parent_learning_neg)


child_learning_neg <- data.frame(table(child_learning_neg$Age))
names(child_learning_neg) <- c('Age', 'Freq')
child_learning_neg$Role <- rep('Child', nrow(child_learning_neg))
child_learning_neg$Head <- rep('', nrow(child_learning_neg))
temp <- merge(child_learning_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_learning_neg <- temp
child_learning_neg$Total_ratio <- child_learning_neg$Freq / child_learning_neg$N_utterance
child_learning_neg$Ratio <- child_learning_neg$Freq / sum(child_learning_neg$Freq)
child_learning_neg$Polarity <- rep('negative', nrow(child_learning_neg))
child_learning_neg$Measure <- rep('negative construction ratio', nrow(child_learning_neg))
child_learning_neg$Which <- rep('ratio', nrow(child_learning_neg))
child_learning_neg$Function <- rep('Labeling', nrow(child_learning_neg))
child_learning_neg <- negative_moving(child_learning_neg, child_descriptive)


parent_learning_neg <- data.frame(table(parent_learning_neg$Age))
names(parent_learning_neg) <- c('Age', 'Freq')
parent_learning_neg$Role <- rep('Parent', nrow(parent_learning_neg))
parent_learning_neg$Head <- rep('Learning', nrow(parent_learning_neg))
temp <- merge(parent_learning_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_learning_neg <- temp
parent_learning_neg$Total_ratio <- parent_learning_neg$Freq / parent_learning_neg$N_utterance
parent_learning_neg$Ratio <- parent_learning_neg$Freq / sum(parent_learning_neg$Freq)
parent_learning_neg$Polarity <- rep('negative', nrow(parent_learning_neg))
parent_learning_neg$Measure <- rep('negative construction ratio', nrow(parent_learning_neg))
parent_learning_neg$Which <- rep('ratio', nrow(parent_learning_neg))
parent_learning_neg$Function <- rep('Labeling', nrow(parent_learning_neg))
parent_learning_neg <- negative_moving(parent_learning_neg, parent_descriptive)


child_learning_pos <- subset(learning_pos, Role %in% c('Child'))
parent_learning_pos <- subset(learning_pos, Role %in% c('Parent'))

child_learning_pos_mlu <- mlu(child_learning_pos)
parent_learning_pos_mlu <- mlu(parent_learning_pos)


child_learning_pos <- data.frame(table(child_learning_pos$Age))
names(child_learning_pos) <- c('Age', 'Freq')
child_learning_pos$Role <- rep('Child', nrow(child_learning_pos))
child_learning_pos$Head <- rep('', nrow(child_learning_pos))
temp <- merge(child_learning_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_learning_pos <- temp
child_learning_pos$Total_ratio <- child_learning_pos$Freq / child_learning_pos$N_utterance
child_learning_pos$Ratio <- child_learning_pos$Freq / sum(child_learning_pos$Freq)
child_learning_pos$Polarity <- rep('positive', nrow(child_learning_pos))
child_learning_pos$Measure <- rep('positive construction ratio', nrow(child_learning_pos))
child_learning_pos$Which <- rep('ratio', nrow(child_learning_pos))
child_learning_pos$Function <- rep('Labeling', nrow(child_learning_pos))
child_learning_pos <- positive_moving(child_learning_pos, child_descriptive)


parent_learning_pos <- data.frame(table(parent_learning_pos$Age))
names(parent_learning_pos) <- c('Age', 'Freq')
parent_learning_pos$Role <- rep('Parent', nrow(parent_learning_pos))
parent_learning_pos$Head <- rep('Learning', nrow(parent_learning_pos))
temp <- merge(parent_learning_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_learning_pos <- temp
parent_learning_pos$Total_ratio <- parent_learning_pos$Freq / parent_learning_pos$N_utterance
parent_learning_pos$Ratio <- parent_learning_pos$Freq / sum(parent_learning_pos$Freq)
parent_learning_pos$Polarity <- rep('positive', nrow(parent_learning_pos))
parent_learning_pos$Measure <- rep('positive construction ratio', nrow(parent_learning_pos))
parent_learning_pos$Which <- rep('ratio', nrow(parent_learning_pos))
parent_learning_pos$Function <- rep('Labeling', nrow(parent_learning_pos))
parent_learning_pos <- positive_moving(parent_learning_pos, parent_descriptive)

learning_data <- rbind(child_learning_neg, child_learning_pos, parent_learning_neg, parent_learning_pos)

learning_data$Measure <- factor(learning_data$Measure, levels = c('negative construction ratio', 'negative construction moving ratio', 'positive construction ratio', 'positive construction moving ratio'))

learning_data_child <- subset(learning_data, Role == 'Child')
learning_data_parent <- subset(learning_data, Role == 'Parent')


```

```{r learninguldata, include=FALSE}

child_ul_learning_neg <- subset(learning_neg, Role %in% c('Child'))
parent_ul_learning_neg <- subset(learning_neg, Role %in% c('Parent'))

child_ul_learning_neg <- data.frame(table(child_ul_learning_neg$Sent_len))
names(child_ul_learning_neg) <- c('Sent_len', 'Freq')
child_ul_learning_neg$Role <- rep('Child', nrow(child_ul_learning_neg))
child_ul_learning_neg$Head <- rep('', nrow(child_ul_learning_neg))
temp <- merge(child_ul_learning_neg, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_learning_neg <- temp
child_ul_learning_neg$Total_ratio <- child_ul_learning_neg$Freq / child_ul_learning_neg$N_utterance
child_ul_learning_neg$Ratio <- child_ul_learning_neg$Freq / sum(child_ul_learning_neg$Freq)
child_ul_learning_neg$Polarity <- rep('negative', nrow(child_ul_learning_neg))
child_ul_learning_neg$Measure <- rep('negative construction ratio', nrow(child_ul_learning_neg))
child_ul_learning_neg$Which <- rep('ratio', nrow(child_ul_learning_neg))
child_ul_learning_neg$Function <- rep('Labeling', nrow(child_ul_learning_neg))
child_ul_learning_neg <- negative_ul_moving(child_ul_learning_neg, child_ul_descriptive)


parent_ul_learning_neg <- data.frame(table(parent_ul_learning_neg$Sent_len))
names(parent_ul_learning_neg) <- c('Sent_len', 'Freq')
parent_ul_learning_neg$Role <- rep('Parent', nrow(parent_ul_learning_neg))
parent_ul_learning_neg$Head <- rep('Learning', nrow(parent_ul_learning_neg))
temp <- merge(parent_ul_learning_neg, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_learning_neg <- temp
parent_ul_learning_neg$Total_ratio <- parent_ul_learning_neg$Freq / parent_ul_learning_neg$N_utterance
parent_ul_learning_neg$Ratio <- parent_ul_learning_neg$Freq / sum(parent_ul_learning_neg$Freq)
parent_ul_learning_neg$Polarity <- rep('negative', nrow(parent_ul_learning_neg))
parent_ul_learning_neg$Measure <- rep('negative construction ratio', nrow(parent_ul_learning_neg))
parent_ul_learning_neg$Which <- rep('ratio', nrow(parent_ul_learning_neg))
parent_ul_learning_neg$Function <- rep('Labeling', nrow(parent_ul_learning_neg))
parent_ul_learning_neg <- negative_ul_moving(parent_ul_learning_neg, parent_ul_descriptive)


child_ul_learning_pos <- subset(learning_pos, Role %in% c('Child'))
parent_ul_learning_pos <- subset(learning_pos, Role %in% c('Parent'))


child_ul_learning_pos <- data.frame(table(child_ul_learning_pos$Sent_len))
names(child_ul_learning_pos) <- c('Sent_len', 'Freq')
child_ul_learning_pos$Role <- rep('Child', nrow(child_ul_learning_pos))
child_ul_learning_pos$Head <- rep('', nrow(child_ul_learning_pos))
temp <- merge(child_ul_learning_pos, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_learning_pos <- temp
child_ul_learning_pos$Total_ratio <- child_ul_learning_pos$Freq / child_ul_learning_pos$N_utterance
child_ul_learning_pos$Ratio <- child_ul_learning_pos$Freq / sum(child_ul_learning_pos$Freq)
child_ul_learning_pos$Polarity <- rep('positive', nrow(child_ul_learning_pos))
child_ul_learning_pos$Measure <- rep('positive construction ratio', nrow(child_ul_learning_pos))
child_ul_learning_pos$Which <- rep('ratio', nrow(child_ul_learning_pos))
child_ul_learning_pos$Function <- rep('Labeling', nrow(child_ul_learning_pos))
child_ul_learning_pos <- positive_ul_moving(child_ul_learning_pos, child_ul_descriptive)


parent_ul_learning_pos <- data.frame(table(parent_ul_learning_pos$Sent_len))
names(parent_ul_learning_pos) <- c('Sent_len', 'Freq')
parent_ul_learning_pos$Role <- rep('Parent', nrow(parent_ul_learning_pos))
parent_ul_learning_pos$Head <- rep('Learning', nrow(parent_ul_learning_pos))
temp <- merge(parent_ul_learning_pos, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_learning_pos <- temp
parent_ul_learning_pos$Total_ratio <- parent_ul_learning_pos$Freq / parent_ul_learning_pos$N_utterance
parent_ul_learning_pos$Ratio <- parent_ul_learning_pos$Freq / sum(parent_ul_learning_pos$Freq)
parent_ul_learning_pos$Polarity <- rep('positive', nrow(parent_ul_learning_pos))
parent_ul_learning_pos$Measure <- rep('positive construction ratio', nrow(parent_ul_learning_pos))
parent_ul_learning_pos$Which <- rep('ratio', nrow(parent_ul_learning_pos))
parent_ul_learning_pos$Function <- rep('Labeling', nrow(parent_ul_learning_pos))
parent_ul_learning_pos <- positive_ul_moving(parent_ul_learning_pos, parent_ul_descriptive)

learning_ul_data <- rbind(child_ul_learning_neg, child_ul_learning_pos, parent_ul_learning_neg, parent_ul_learning_pos)

learning_ul_data$Measure <- factor(learning_ul_data$Measure, levels = c('negative construction ratio', 'negative construction moving ratio', 'positive construction ratio', 'positive construction moving ratio'))

learning_ul_data_child <- subset(learning_ul_data, Role == 'Child')
learning_ul_data_parent <- subset(learning_ul_data, Role == 'Parent')
```

```{r discourselearningdata, include=FALSE}

discourse_learning <-read.csv('data/learning_discourse.txt', header = T, sep = '\t')
discourse_learning$Role[which(discourse_learning$Role == "Father")] <- 'Parent'
discourse_learning$Role[which(discourse_learning$Role == "Mother")] <- 'Parent'
discourse_learning$Role[which(discourse_learning$Role == "Target_Child")] <- 'Child'

discourse_learning_neg = subset(discourse_learning, Polarity == 'negative')
discourse_learning_pos = subset(discourse_learning, Polarity == 'positive')

discourse_child_learning_neg <- subset(discourse_learning_neg, Role %in% c('Child'))
discourse_parent_learning_neg <- subset(discourse_learning_neg, Role %in% c('Parent'))

discourse_child_learning_neg <- data.frame(table(discourse_child_learning_neg$Age))
names(discourse_child_learning_neg) <- c('Age', 'Freq')
discourse_child_learning_neg$Role <- rep('Child', nrow(discourse_child_learning_neg))
discourse_child_learning_neg$Head <- rep('', nrow(discourse_child_learning_neg))
temp <- merge(discourse_child_learning_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_learning_neg <- temp
discourse_child_learning_neg$Total_ratio <- discourse_child_learning_neg$Freq / discourse_child_learning_neg$N_utterance
discourse_child_learning_neg$Ratio <- discourse_child_learning_neg$Freq / sum(discourse_child_learning_neg$Freq)
discourse_child_learning_neg$Polarity <- rep('negative', nrow(discourse_child_learning_neg))
discourse_child_learning_neg$Measure <- rep('negative construction ratio', nrow(discourse_child_learning_neg))
discourse_child_learning_neg$Which <- rep('ratio', nrow(discourse_child_learning_neg))
discourse_child_learning_neg$Function <- rep('Labeling', nrow(discourse_child_learning_neg))
discourse_child_learning_neg <- negative_moving(discourse_child_learning_neg, child_descriptive)


discourse_parent_learning_neg <- data.frame(table(discourse_parent_learning_neg$Age))
names(discourse_parent_learning_neg) <- c('Age', 'Freq')
discourse_parent_learning_neg$Role <- rep('Parent', nrow(discourse_parent_learning_neg))
discourse_parent_learning_neg$Head <- rep('Learning', nrow(discourse_parent_learning_neg))
temp <- merge(discourse_parent_learning_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_learning_neg <- temp
discourse_parent_learning_neg$Total_ratio <- discourse_parent_learning_neg$Freq / discourse_parent_learning_neg$N_utterance
discourse_parent_learning_neg$Ratio <- discourse_parent_learning_neg$Freq / sum(discourse_parent_learning_neg$Freq)
discourse_parent_learning_neg$Polarity <- rep('negative', nrow(discourse_parent_learning_neg))
discourse_parent_learning_neg$Measure <- rep('negative construction ratio', nrow(discourse_parent_learning_neg))
discourse_parent_learning_neg$Which <- rep('ratio', nrow(discourse_parent_learning_neg))
discourse_parent_learning_neg$Function <- rep('Labeling', nrow(discourse_parent_learning_neg))
discourse_parent_learning_neg <- negative_moving(discourse_parent_learning_neg, parent_descriptive)


discourse_child_learning_pos <- subset(discourse_learning_pos, Role %in% c('Child'))
discourse_parent_learning_pos <- subset(discourse_learning_pos, Role %in% c('Parent'))

discourse_child_learning_pos <- data.frame(table(discourse_child_learning_pos$Age))
names(discourse_child_learning_pos) <- c('Age', 'Freq')
discourse_child_learning_pos$Role <- rep('Child', nrow(discourse_child_learning_pos))
discourse_child_learning_pos$Head <- rep('', nrow(discourse_child_learning_pos))
temp <- merge(discourse_child_learning_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_learning_pos <- temp
discourse_child_learning_pos$Total_ratio <- discourse_child_learning_pos$Freq / discourse_child_learning_pos$N_utterance
discourse_child_learning_pos$Ratio <- discourse_child_learning_pos$Freq / sum(discourse_child_learning_pos$Freq)
discourse_child_learning_pos$Polarity <- rep('positive', nrow(discourse_child_learning_pos))
discourse_child_learning_pos$Measure <- rep('positive construction ratio', nrow(discourse_child_learning_pos))
discourse_child_learning_pos$Which <- rep('ratio', nrow(discourse_child_learning_pos))
discourse_child_learning_pos$Function <- rep('Labeling', nrow(discourse_child_learning_pos))
discourse_child_learning_pos <- positive_moving(discourse_child_learning_pos, child_descriptive)


discourse_parent_learning_pos <- data.frame(table(discourse_parent_learning_pos$Age))
names(discourse_parent_learning_pos) <- c('Age', 'Freq')
discourse_parent_learning_pos$Role <- rep('Parent', nrow(discourse_parent_learning_pos))
discourse_parent_learning_pos$Head <- rep('Learning', nrow(discourse_parent_learning_pos))
temp <- merge(discourse_parent_learning_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_learning_pos <- temp
discourse_parent_learning_pos$Total_ratio <- discourse_parent_learning_pos$Freq / discourse_parent_learning_pos$N_utterance
discourse_parent_learning_pos$Ratio <- discourse_parent_learning_pos$Freq / sum(discourse_parent_learning_pos$Freq)
discourse_parent_learning_pos$Polarity <- rep('positive', nrow(discourse_parent_learning_pos))
discourse_parent_learning_pos$Measure <- rep('positive construction ratio', nrow(discourse_parent_learning_pos))
discourse_parent_learning_pos$Which <- rep('ratio', nrow(discourse_parent_learning_pos))
discourse_parent_learning_pos$Function <- rep('Labeling', nrow(discourse_parent_learning_pos))
discourse_parent_learning_pos <- positive_moving(discourse_parent_learning_pos, parent_descriptive)

discourse_learning_data <- rbind(discourse_child_learning_neg, discourse_child_learning_pos, discourse_parent_learning_neg, discourse_parent_learning_pos)

discourse_learning_data$Measure <- factor(discourse_learning_data$Measure, levels = c('negative construction ratio', 'negative construction moving ratio', 'positive construction ratio', 'positive construction moving ratio'))

discourse_learning_data_child <- subset(discourse_learning_data, Role == 'Child')
discourse_learning_data_parent <- subset(discourse_learning_data, Role == 'Parent')

discourse_learning_data_plot <- aggregate(Total_ratio~Age+Which+Role,data=discourse_learning_data,sum)

names(discourse_learning_data_plot) <- c('Age', 'Measure', 'Role', 'Total_ratio')


```

To capture the function of labeling at the sentence level, we concentrated on copula structures in which the predicate is a nominal or an adjectival phrase. Specifically, the nominal predicates exclude possessive pronouns in order to not overlap with the communicative function of possession (see below). We considered instances where the predicate is modified by negative morphemes as negative, and others as positive. To also avoid overlap with cases of non-existence, none of the utterances contained expletives (e.g. "there is no book"). This resulted in a total of `r format(sum(subset(learning_data,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")` negative utterances (Child: `r format(sum(subset(learning_data_child,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`; Parent: `r format(sum(subset(learning_data_parent,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`), and `r format(sum(subset(learning_data,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")` positive utterances (Child: `r format(sum(subset(learning_data_child,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`; Parent: `r format(sum(subset(learning_data_parent,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`).

|Labeling (Negative)| Labeling (Positive)|
|----------------|----------------|
|*that's not a farmer* | *this is a book*|
|*I'm not a heavy baby Mum*|*it's a nice bowl*|
|*It's no good*|*she's pretty*|
Table: (\#tab:label) Examples of the labeling construction in children's speech at the sentence level

Figure \@ref(fig:learning) shows ratios and cumulative ratios for parent's and children's production of the labeling construction at the sentence level. In both parents and children, the frequency of positive counterparts is consistently higher than that of negative labeling instances. Children's productions of negative labeling increased between 18-36 months, and remained stable and close to the parent ratios after 36 months.

```{r learning, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap="Ratios and cumulative ratios for instances of (negative) labeling and its positive counterparts in parents' and children's speech."}

learning_data %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(log(Total_ratio), 2), group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) +
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)") + 
  guides(linetype = guide_legend(nrow = 2))

```

<!--
```{r learningul, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap='Labeling and its positive counterparts, indexed by utterance length.'}

learning_ul_data %>% 
  ggplot(aes(as.numeric(as.character(Sent_len)), round(log(Total_ratio), 2), group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) +
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 130, 10)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)") + 
  guides(linetype = guide_legend(nrow = 2))

```
-->

At the discourse level, we selected antecedent utterances with copula structures that combined with a nominal or an adjectival predicate. Table \@ref(tab:dislabel) shows a few examples. We found `r format(sum(subset(discourse_learning_data,Which=='ratio')$Freq), big.mark=",")` utterances (Child: `r format(sum(subset(discourse_learning_data_child,Which=='ratio')$Freq), big.mark=",")`; Parent: `r format(sum(subset(discourse_learning_data_parent,Which=='ratio')$Freq), big.mark=",")`). Figure \@ref(fig:learningdiscourse) shows the log ratios and cumulative ratios for labeling instances at the discourse level. Children used negation to respond to labeling utterances more frequently between 18 to 30 months. After 30 months, children's productions of negative labeling continues to increase but remains close to parents' level more generally. 

|Antecedent|Utterance|
|------------|------------|
|Child: *that's the one*|Parent: *no it's the green one*|
Table: (\#tab:dislabel) Example antecedent labeling and discourse level negation in parents' and children's productions 

```{r learningdiscourse, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap="Log ratios and cumulative ratios of discourse level labeling instances in parents' and children's productions.",warning=FALSE}

discourse_learning_data_plot %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(log(Total_ratio), 2), group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c('solid', 'dotted')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(16, 3)) +
  scale_color_manual(values = c("darkgreen", "grey")) +
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)") 

```

### Epistemic Negation

```{r epistemicdata, include=FALSE}

epistemic <-read.csv('data/epistemic.txt', header = T, sep = '\t')
# epistemic <- subset(epistemic, Subj == 'I' | Subj == 'NONE')
epistemic$Role[which(epistemic$Role == "Father")] <- 'Parent'
epistemic$Role[which(epistemic$Role == "Mother")] <- 'Parent'
epistemic$Role[which(epistemic$Role == "Target_Child")] <- 'Child'

epistemic_neg = subset(epistemic, Polarity == 'negative')
epistemic_pos = subset(epistemic, Polarity == 'positive')

child_epistemic_neg <- subset(epistemic_neg, Role %in% c('Child'))
parent_epistemic_neg <- subset(epistemic_neg, Role %in% c('Parent'))

child_know_neg <- subset(child_epistemic_neg, Head %in% c('know'))
child_remember_neg <- subset(child_epistemic_neg, Head %in% c('remember'))
child_think_neg <- subset(child_epistemic_neg, Head %in% c('think'))
parent_know_neg <- subset(parent_epistemic_neg, Head %in% c('know'))
parent_remember_neg <- subset(parent_epistemic_neg, Head %in% c('remember'))
parent_think_neg <- subset(parent_epistemic_neg, Head %in% c('think'))


child_know_neg_mlu <- mlu(child_know_neg)
child_remember_neg_mlu <- mlu(child_remember_neg)
child_think_neg_mlu <- mlu(child_think_neg)
parent_know_neg_mlu <- mlu(parent_know_neg)
parent_remember_neg_mlu <- mlu(parent_remember_neg)
parent_think_neg_mlu <- mlu(parent_think_neg)


child_know_neg <- data.frame(table(child_know_neg$Age))
names(child_know_neg) <- c('Age', 'Freq')
child_know_neg$Role <- rep('Child', nrow(child_know_neg))
child_know_neg$Head <- rep('know', nrow(child_know_neg))
temp <- merge(child_know_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_know_neg <- temp
child_know_neg$Total_ratio <- child_know_neg$Freq / child_know_neg$N_utterance
child_know_neg$Ratio <- child_know_neg$Freq / sum(child_know_neg$Freq)
child_know_neg$Polarity <- rep('negative', nrow(child_know_neg))
child_know_neg$Measure <- rep('negative construction ratio', nrow(child_know_neg))
child_know_neg$Which <- rep('ratio', nrow(child_know_neg))
child_know_neg$Function <- rep('Epistemic', nrow(child_know_neg))
child_know_neg <- negative_moving(child_know_neg, child_descriptive)


child_remember_neg <- data.frame(table(child_remember_neg$Age))
names(child_remember_neg) <- c('Age', 'Freq')
child_remember_neg$Role <- rep('Child', nrow(child_remember_neg))
child_remember_neg$Head <- rep('remember', nrow(child_remember_neg))
temp <- merge(child_remember_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_remember_neg <- temp
child_remember_neg$Total_ratio <- child_remember_neg$Freq / child_remember_neg$N_utterance
child_remember_neg$Ratio <- child_remember_neg$Freq / sum(child_remember_neg$Freq)
child_remember_neg$Polarity <- rep('negative', nrow(child_remember_neg))
child_remember_neg$Measure <- rep('negative construction ratio', nrow(child_remember_neg))
child_remember_neg$Which <- rep('ratio', nrow(child_remember_neg))
child_remember_neg$Function <- rep('Epistemic', nrow(child_remember_neg))
child_remember_neg <- negative_moving(child_remember_neg, child_descriptive)

child_think_neg <- data.frame(table(child_think_neg$Age))
names(child_think_neg) <- c('Age', 'Freq')
child_think_neg$Role <- rep('Child', nrow(child_think_neg))
child_think_neg$Head <- rep('think', nrow(child_think_neg))
temp <- merge(child_think_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_think_neg <- temp
child_think_neg$Total_ratio <- child_think_neg$Freq / child_think_neg$N_utterance
child_think_neg$Ratio <- child_think_neg$Freq / sum(child_think_neg$Freq)
child_think_neg$Polarity <- rep('negative', nrow(child_think_neg))
child_think_neg$Measure <- rep('negative construction ratio', nrow(child_think_neg))
child_think_neg$Which <- rep('ratio', nrow(child_think_neg))
child_think_neg$Function <- rep('Epistemic', nrow(child_think_neg))
child_think_neg <- negative_moving(child_think_neg, child_descriptive)

parent_know_neg <- data.frame(table(parent_know_neg$Age))
names(parent_know_neg) <- c('Age', 'Freq')
parent_know_neg$Role <- rep('Parent', nrow(parent_know_neg))
parent_know_neg$Head <- rep('know', nrow(parent_know_neg))
temp <- merge(parent_know_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_know_neg <- temp
parent_know_neg$Total_ratio <- parent_know_neg$Freq / parent_know_neg$N_utterance
parent_know_neg$Ratio <- parent_know_neg$Freq / sum(parent_know_neg$Freq)
parent_know_neg$Polarity <- rep('negative', nrow(parent_know_neg))
parent_know_neg$Measure <- rep('negative construction ratio', nrow(parent_know_neg))
parent_know_neg$Which <- rep('ratio', nrow(parent_know_neg))
parent_know_neg$Function <- rep('Epistemic', nrow(parent_know_neg))
parent_know_neg <- negative_moving(parent_know_neg, parent_descriptive)

parent_remember_neg <- data.frame(table(parent_remember_neg$Age))
names(parent_remember_neg) <- c('Age', 'Freq')
parent_remember_neg$Role <- rep('Parent', nrow(parent_remember_neg))
parent_remember_neg$Head <- rep('remember', nrow(parent_remember_neg))
temp <- merge(parent_remember_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_remember_neg <- temp
parent_remember_neg$Total_ratio <- parent_remember_neg$Freq / parent_remember_neg$N_utterance
parent_remember_neg$Ratio <- parent_remember_neg$Freq / sum(parent_remember_neg$Freq)
parent_remember_neg$Polarity <- rep('negative', nrow(parent_remember_neg))
parent_remember_neg$Measure <- rep('negative construction ratio', nrow(parent_remember_neg))
parent_remember_neg$Which <- rep('ratio', nrow(parent_remember_neg))
parent_remember_neg$Function <- rep('Epistemic', nrow(parent_remember_neg))
parent_remember_neg <- negative_moving(parent_remember_neg, parent_descriptive)

parent_think_neg <- data.frame(table(parent_think_neg$Age))
names(parent_think_neg) <- c('Age', 'Freq')
parent_think_neg$Role <- rep('Parent', nrow(parent_think_neg))
parent_think_neg$Head <- rep('think', nrow(parent_think_neg))
temp <- merge(parent_think_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_think_neg <- temp
parent_think_neg$Total_ratio <- parent_think_neg$Freq / parent_think_neg$N_utterance
parent_think_neg$Ratio <- parent_think_neg$Freq / sum(parent_think_neg$Freq)
parent_think_neg$Polarity <- rep('negative', nrow(parent_think_neg))
parent_think_neg$Measure <- rep('negative construction ratio', nrow(parent_think_neg))
parent_think_neg$Which <- rep('ratio', nrow(parent_think_neg))
parent_think_neg$Function <- rep('Epistemic', nrow(parent_think_neg))
parent_think_neg <- negative_moving(parent_think_neg, parent_descriptive)


child_epistemic_pos <- subset(epistemic_pos, Role %in% c('Child'))
parent_epistemic_pos <- subset(epistemic_pos, Role %in% c('Parent'))

child_know_pos <- subset(child_epistemic_pos, Head %in% c('know'))
child_remember_pos <- subset(child_epistemic_pos, Head %in% c('remember'))
child_think_pos <- subset(child_epistemic_pos, Head %in% c('think'))
parent_know_pos <- subset(parent_epistemic_pos, Head %in% c('know'))
parent_remember_pos <- subset(parent_epistemic_pos, Head %in% c('remember'))
parent_think_pos <- subset(parent_epistemic_pos, Head %in% c('think'))


child_know_pos_mlu <- mlu(child_know_pos)
child_remember_pos_mlu <- mlu(child_remember_pos)
child_think_pos_mlu <- mlu(child_think_pos)
parent_know_pos_mlu <- mlu(parent_know_pos)
parent_remember_pos_mlu <- mlu(parent_remember_pos)
parent_think_pos_mlu <- mlu(parent_think_pos)


child_know_pos <- data.frame(table(child_know_pos$Age))
names(child_know_pos) <- c('Age', 'Freq')
child_know_pos$Role <- rep('Child', nrow(child_know_pos))
child_know_pos$Head <- rep('know', nrow(child_know_pos))
temp <- merge(child_know_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_know_pos <- temp
child_know_pos$Total_ratio <- child_know_pos$Freq / child_know_pos$N_utterance
child_know_pos$Ratio <- child_know_pos$Freq / sum(child_know_pos$Freq)
child_know_pos$Polarity <- rep('positive', nrow(child_know_pos))
child_know_pos$Measure <- rep('positive construction ratio', nrow(child_know_pos))
child_know_pos$Which <- rep('ratio', nrow(child_know_pos))
child_know_pos$Function <- rep('Epistemic', nrow(child_know_pos))
child_know_pos <- positive_moving(child_know_pos, child_descriptive)


child_remember_pos <- data.frame(table(child_remember_pos$Age))
names(child_remember_pos) <- c('Age', 'Freq')
child_remember_pos$Role <- rep('Child', nrow(child_remember_pos))
child_remember_pos$Head <- rep('remember', nrow(child_remember_pos))
temp <- merge(child_remember_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_remember_pos <- temp
child_remember_pos$Total_ratio <- child_remember_pos$Freq / child_remember_pos$N_utterance
child_remember_pos$Ratio <- child_remember_pos$Freq / sum(child_remember_pos$Freq)
child_remember_pos$Polarity <- rep('positive', nrow(child_remember_pos))
child_remember_pos$Measure <- rep('positive construction ratio', nrow(child_remember_pos))
child_remember_pos$Which <- rep('ratio', nrow(child_remember_pos))
child_remember_pos$Function <- rep('Epistemic', nrow(child_remember_pos))
child_remember_pos <- positive_moving(child_remember_pos, child_descriptive)

child_think_pos <- data.frame(table(child_think_pos$Age))
names(child_think_pos) <- c('Age', 'Freq')
child_think_pos$Role <- rep('Child', nrow(child_think_pos))
child_think_pos$Head <- rep('think', nrow(child_think_pos))
temp <- merge(child_think_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_think_pos <- temp
child_think_pos$Total_ratio <- child_think_pos$Freq / child_think_pos$N_utterance
child_think_pos$Ratio <- child_think_pos$Freq / sum(child_think_pos$Freq)
child_think_pos$Polarity <- rep('positive', nrow(child_think_pos))
child_think_pos$Measure <- rep('positive construction ratio', nrow(child_think_pos))
child_think_pos$Which <- rep('ratio', nrow(child_think_pos))
child_think_pos$Function <- rep('Epistemic', nrow(child_think_pos))
child_think_pos <- positive_moving(child_think_pos, child_descriptive)

parent_know_pos <- data.frame(table(parent_know_pos$Age))
names(parent_know_pos) <- c('Age', 'Freq')
parent_know_pos$Role <- rep('Parent', nrow(parent_know_pos))
parent_know_pos$Head <- rep('know', nrow(parent_know_pos))
temp <- merge(parent_know_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_know_pos <- temp
parent_know_pos$Total_ratio <- parent_know_pos$Freq / parent_know_pos$N_utterance
parent_know_pos$Ratio <- parent_know_pos$Freq / sum(parent_know_pos$Freq)
parent_know_pos$Polarity <- rep('positive', nrow(parent_know_pos))
parent_know_pos$Measure <- rep('positive construction ratio', nrow(parent_know_pos))
parent_know_pos$Which <- rep('ratio', nrow(parent_know_pos))
parent_know_pos$Function <- rep('Epistemic', nrow(parent_know_pos))
parent_know_pos <- positive_moving(parent_know_pos, parent_descriptive)

parent_remember_pos <- data.frame(table(parent_remember_pos$Age))
names(parent_remember_pos) <- c('Age', 'Freq')
parent_remember_pos$Role <- rep('Parent', nrow(parent_remember_pos))
parent_remember_pos$Head <- rep('remember', nrow(parent_remember_pos))
temp <- merge(parent_remember_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_remember_pos <- temp
parent_remember_pos$Total_ratio <- parent_remember_pos$Freq / parent_remember_pos$N_utterance
parent_remember_pos$Ratio <- parent_remember_pos$Freq / sum(parent_remember_pos$Freq)
parent_remember_pos$Polarity <- rep('positive', nrow(parent_remember_pos))
parent_remember_pos$Measure <- rep('positive construction ratio', nrow(parent_remember_pos))
parent_remember_pos$Which <- rep('ratio', nrow(parent_remember_pos))
parent_remember_pos$Function <- rep('Epistemic', nrow(parent_remember_pos))
parent_remember_pos <- positive_moving(parent_remember_pos, parent_descriptive)

parent_think_pos <- data.frame(table(parent_think_pos$Age))
names(parent_think_pos) <- c('Age', 'Freq')
parent_think_pos$Role <- rep('Parent', nrow(parent_think_pos))
parent_think_pos$Head <- rep('think', nrow(parent_think_pos))
temp <- merge(parent_think_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_think_pos <- temp
parent_think_pos$Total_ratio <- parent_think_pos$Freq / parent_think_pos$N_utterance
parent_think_pos$Ratio <- parent_think_pos$Freq / sum(parent_think_pos$Freq)
parent_think_pos$Polarity <- rep('positive', nrow(parent_think_pos))
parent_think_pos$Measure <- rep('positive construction ratio', nrow(parent_think_pos))
parent_think_pos$Which <- rep('ratio', nrow(parent_think_pos))
parent_think_pos$Function <- rep('Epistemic', nrow(parent_think_pos))
parent_think_pos <- positive_moving(parent_think_pos, parent_descriptive)

epistemic_data <- rbind(child_know_neg, child_know_pos, parent_know_neg, parent_know_pos, child_remember_neg, child_remember_pos, parent_remember_neg, parent_remember_pos, child_think_neg, child_think_pos, parent_think_neg, parent_think_pos)

epistemic_data$Measure <- factor(epistemic_data$Measure, levels = c('negative construction ratio', 'negative construction moving ratio', 'positive construction ratio', 'positive construction moving ratio'))

epistemic_data_child <- subset(epistemic_data, Role == 'Child')
epistemic_data_parent <- subset(epistemic_data, Role == 'Parent')

```

```{r epistemiculdata, include=FALSE}

child_ul_know_neg <- subset(child_epistemic_neg, Head %in% c('know'))
child_ul_remember_neg <- subset(child_epistemic_neg, Head %in% c('remember'))
child_ul_think_neg <- subset(child_epistemic_neg, Head %in% c('think'))
parent_ul_know_neg <- subset(parent_epistemic_neg, Head %in% c('know'))
parent_ul_remember_neg <- subset(parent_epistemic_neg, Head %in% c('remember'))
parent_ul_think_neg <- subset(parent_epistemic_neg, Head %in% c('think'))

child_ul_know_neg <- data.frame(table(child_ul_know_neg$Sent_len))
names(child_ul_know_neg) <- c('Sent_len', 'Freq')
child_ul_know_neg$Role <- rep('Child', nrow(child_ul_know_neg))
child_ul_know_neg$Head <- rep('know', nrow(child_ul_know_neg))
temp <- merge(child_ul_know_neg, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_know_neg <- temp
child_ul_know_neg$Total_ratio <- child_ul_know_neg$Freq / child_ul_know_neg$N_utterance
child_ul_know_neg$Ratio <- child_ul_know_neg$Freq / sum(child_ul_know_neg$Freq)
child_ul_know_neg$Polarity <- rep('negative', nrow(child_ul_know_neg))
child_ul_know_neg$Measure <- rep('negative construction ratio', nrow(child_ul_know_neg))
child_ul_know_neg$Which <- rep('ratio', nrow(child_ul_know_neg))
child_ul_know_neg$Function <- rep('Epistemic', nrow(child_ul_know_neg))
child_ul_know_neg <- negative_ul_moving(child_ul_know_neg, child_ul_descriptive)

child_ul_remember_neg <- data.frame(table(child_ul_remember_neg$Sent_len))
names(child_ul_remember_neg) <- c('Sent_len', 'Freq')
child_ul_remember_neg$Role <- rep('Child', nrow(child_ul_remember_neg))
child_ul_remember_neg$Head <- rep('remember', nrow(child_ul_remember_neg))
temp <- merge(child_ul_remember_neg, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_remember_neg <- temp
child_ul_remember_neg$Total_ratio <- child_ul_remember_neg$Freq / child_ul_remember_neg$N_utterance
child_ul_remember_neg$Ratio <- child_ul_remember_neg$Freq / sum(child_ul_remember_neg$Freq)
child_ul_remember_neg$Polarity <- rep('negative', nrow(child_ul_remember_neg))
child_ul_remember_neg$Measure <- rep('negative construction ratio', nrow(child_ul_remember_neg))
child_ul_remember_neg$Which <- rep('ratio', nrow(child_ul_remember_neg))
child_ul_remember_neg$Function <- rep('Epistemic', nrow(child_ul_remember_neg))
child_ul_remember_neg <- negative_ul_moving(child_ul_remember_neg, child_ul_descriptive)

child_ul_think_neg <- data.frame(table(child_ul_think_neg$Sent_len))
names(child_ul_think_neg) <- c('Sent_len', 'Freq')
child_ul_think_neg$Role <- rep('Child', nrow(child_ul_think_neg))
child_ul_think_neg$Head <- rep('think', nrow(child_ul_think_neg))
temp <- merge(child_ul_think_neg, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_think_neg <- temp
child_ul_think_neg$Total_ratio <- child_ul_think_neg$Freq / child_ul_think_neg$N_utterance
child_ul_think_neg$Ratio <- child_ul_think_neg$Freq / sum(child_ul_think_neg$Freq)
child_ul_think_neg$Polarity <- rep('negative', nrow(child_ul_think_neg))
child_ul_think_neg$Measure <- rep('negative construction ratio', nrow(child_ul_think_neg))
child_ul_think_neg$Which <- rep('ratio', nrow(child_ul_think_neg))
child_ul_think_neg$Function <- rep('Epistemic', nrow(child_ul_think_neg))
child_ul_think_neg <- negative_ul_moving(child_ul_think_neg, child_ul_descriptive)

parent_ul_know_neg <- data.frame(table(parent_ul_know_neg$Sent_len))
names(parent_ul_know_neg) <- c('Sent_len', 'Freq')
parent_ul_know_neg$Role <- rep('Parent', nrow(parent_ul_know_neg))
parent_ul_know_neg$Head <- rep('know', nrow(parent_ul_know_neg))
temp <- merge(parent_ul_know_neg, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_know_neg <- temp
parent_ul_know_neg$Total_ratio <- parent_ul_know_neg$Freq / parent_ul_know_neg$N_utterance
parent_ul_know_neg$Ratio <- parent_ul_know_neg$Freq / sum(parent_ul_know_neg$Freq)
parent_ul_know_neg$Polarity <- rep('negative', nrow(parent_ul_know_neg))
parent_ul_know_neg$Measure <- rep('negative construction ratio', nrow(parent_ul_know_neg))
parent_ul_know_neg$Which <- rep('ratio', nrow(parent_ul_know_neg))
parent_ul_know_neg$Function <- rep('Epistemic', nrow(parent_ul_know_neg))
parent_ul_know_neg <- negative_ul_moving(parent_ul_know_neg, parent_ul_descriptive)

parent_ul_remember_neg <- data.frame(table(parent_ul_remember_neg$Sent_len))
names(parent_ul_remember_neg) <- c('Sent_len', 'Freq')
parent_ul_remember_neg$Role <- rep('Parent', nrow(parent_ul_remember_neg))
parent_ul_remember_neg$Head <- rep('remember', nrow(parent_ul_remember_neg))
temp <- merge(parent_ul_remember_neg, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_remember_neg <- temp
parent_ul_remember_neg$Total_ratio <- parent_ul_remember_neg$Freq / parent_ul_remember_neg$N_utterance
parent_ul_remember_neg$Ratio <- parent_ul_remember_neg$Freq / sum(parent_ul_remember_neg$Freq)
parent_ul_remember_neg$Polarity <- rep('negative', nrow(parent_ul_remember_neg))
parent_ul_remember_neg$Measure <- rep('negative construction ratio', nrow(parent_ul_remember_neg))
parent_ul_remember_neg$Which <- rep('ratio', nrow(parent_ul_remember_neg))
parent_ul_remember_neg$Function <- rep('Epistemic', nrow(parent_ul_remember_neg))
parent_ul_remember_neg <- negative_ul_moving(parent_ul_remember_neg, parent_ul_descriptive)

parent_ul_think_neg <- data.frame(table(parent_ul_think_neg$Sent_len))
names(parent_ul_think_neg) <- c('Sent_len', 'Freq')
parent_ul_think_neg$Role <- rep('Parent', nrow(parent_ul_think_neg))
parent_ul_think_neg$Head <- rep('think', nrow(parent_ul_think_neg))
temp <- merge(parent_ul_think_neg, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_think_neg <- temp
parent_ul_think_neg$Total_ratio <- parent_ul_think_neg$Freq / parent_ul_think_neg$N_utterance
parent_ul_think_neg$Ratio <- parent_ul_think_neg$Freq / sum(parent_ul_think_neg$Freq)
parent_ul_think_neg$Polarity <- rep('negative', nrow(parent_ul_think_neg))
parent_ul_think_neg$Measure <- rep('negative construction ratio', nrow(parent_ul_think_neg))
parent_ul_think_neg$Which <- rep('ratio', nrow(parent_ul_think_neg))
parent_ul_think_neg$Function <- rep('Epistemic', nrow(parent_ul_think_neg))
parent_ul_think_neg <- negative_ul_moving(parent_ul_think_neg, parent_ul_descriptive)


child_ul_know_pos <- subset(child_epistemic_pos, Head %in% c('know'))
child_ul_remember_pos <- subset(child_epistemic_pos, Head %in% c('remember'))
child_ul_think_pos <- subset(child_epistemic_pos, Head %in% c('think'))
parent_ul_know_pos <- subset(parent_epistemic_pos, Head %in% c('know'))
parent_ul_remember_pos <- subset(parent_epistemic_pos, Head %in% c('remember'))
parent_ul_think_pos <- subset(parent_epistemic_pos, Head %in% c('think'))

child_ul_know_pos <- data.frame(table(child_ul_know_pos$Sent_len))
names(child_ul_know_pos) <- c('Sent_len', 'Freq')
child_ul_know_pos$Role <- rep('Child', nrow(child_ul_know_pos))
child_ul_know_pos$Head <- rep('know', nrow(child_ul_know_pos))
temp <- merge(child_ul_know_pos, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_know_pos <- temp
child_ul_know_pos$Total_ratio <- child_ul_know_pos$Freq / child_ul_know_pos$N_utterance
child_ul_know_pos$Ratio <- child_ul_know_pos$Freq / sum(child_ul_know_pos$Freq)
child_ul_know_pos$Polarity <- rep('positive', nrow(child_ul_know_pos))
child_ul_know_pos$Measure <- rep('positive construction ratio', nrow(child_ul_know_pos))
child_ul_know_pos$Which <- rep('ratio', nrow(child_ul_know_pos))
child_ul_know_pos$Function <- rep('Epistemic', nrow(child_ul_know_pos))
child_ul_know_pos <- positive_ul_moving(child_ul_know_pos, child_ul_descriptive)


child_ul_remember_pos <- data.frame(table(child_ul_remember_pos$Sent_len))
names(child_ul_remember_pos) <- c('Sent_len', 'Freq')
child_ul_remember_pos$Role <- rep('Child', nrow(child_ul_remember_pos))
child_ul_remember_pos$Head <- rep('remember', nrow(child_ul_remember_pos))
temp <- merge(child_ul_remember_pos, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_remember_pos <- temp
child_ul_remember_pos$Total_ratio <- child_ul_remember_pos$Freq / child_ul_remember_pos$N_utterance
child_ul_remember_pos$Ratio <- child_ul_remember_pos$Freq / sum(child_ul_remember_pos$Freq)
child_ul_remember_pos$Polarity <- rep('positive', nrow(child_ul_remember_pos))
child_ul_remember_pos$Measure <- rep('positive construction ratio', nrow(child_ul_remember_pos))
child_ul_remember_pos$Which <- rep('ratio', nrow(child_ul_remember_pos))
child_ul_remember_pos$Function <- rep('Epistemic', nrow(child_ul_remember_pos))
child_ul_remember_pos <- positive_ul_moving(child_ul_remember_pos, child_ul_descriptive)

child_ul_think_pos <- data.frame(table(child_ul_think_pos$Sent_len))
names(child_ul_think_pos) <- c('Sent_len', 'Freq')
child_ul_think_pos$Role <- rep('Child', nrow(child_ul_think_pos))
child_ul_think_pos$Head <- rep('think', nrow(child_ul_think_pos))
temp <- merge(child_ul_think_pos, child_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
child_ul_think_pos <- temp
child_ul_think_pos$Total_ratio <- child_ul_think_pos$Freq / child_ul_think_pos$N_utterance
child_ul_think_pos$Ratio <- child_ul_think_pos$Freq / sum(child_ul_think_pos$Freq)
child_ul_think_pos$Polarity <- rep('positive', nrow(child_ul_think_pos))
child_ul_think_pos$Measure <- rep('positive construction ratio', nrow(child_ul_think_pos))
child_ul_think_pos$Which <- rep('ratio', nrow(child_ul_think_pos))
child_ul_think_pos$Function <- rep('Epistemic', nrow(child_ul_think_pos))
child_ul_think_pos <- positive_ul_moving(child_ul_think_pos, child_ul_descriptive)

parent_ul_know_pos <- data.frame(table(parent_ul_know_pos$Sent_len))
names(parent_ul_know_pos) <- c('Sent_len', 'Freq')
parent_ul_know_pos$Role <- rep('Parent', nrow(parent_ul_know_pos))
parent_ul_know_pos$Head <- rep('know', nrow(parent_ul_know_pos))
temp <- merge(parent_ul_know_pos, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_know_pos <- temp
parent_ul_know_pos$Total_ratio <- parent_ul_know_pos$Freq / parent_ul_know_pos$N_utterance
parent_ul_know_pos$Ratio <- parent_ul_know_pos$Freq / sum(parent_ul_know_pos$Freq)
parent_ul_know_pos$Polarity <- rep('positive', nrow(parent_ul_know_pos))
parent_ul_know_pos$Measure <- rep('positive construction ratio', nrow(parent_ul_know_pos))
parent_ul_know_pos$Which <- rep('ratio', nrow(parent_ul_know_pos))
parent_ul_know_pos$Function <- rep('Epistemic', nrow(parent_ul_know_pos))
parent_ul_know_pos <- positive_ul_moving(parent_ul_know_pos, parent_ul_descriptive)

parent_ul_remember_pos <- data.frame(table(parent_ul_remember_pos$Sent_len))
names(parent_ul_remember_pos) <- c('Sent_len', 'Freq')
parent_ul_remember_pos$Role <- rep('Parent', nrow(parent_ul_remember_pos))
parent_ul_remember_pos$Head <- rep('remember', nrow(parent_ul_remember_pos))
temp <- merge(parent_ul_remember_pos, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_remember_pos <- temp
parent_ul_remember_pos$Total_ratio <- parent_ul_remember_pos$Freq / parent_ul_remember_pos$N_utterance
parent_ul_remember_pos$Ratio <- parent_ul_remember_pos$Freq / sum(parent_ul_remember_pos$Freq)
parent_ul_remember_pos$Polarity <- rep('positive', nrow(parent_ul_remember_pos))
parent_ul_remember_pos$Measure <- rep('positive construction ratio', nrow(parent_ul_remember_pos))
parent_ul_remember_pos$Which <- rep('ratio', nrow(parent_ul_remember_pos))
parent_ul_remember_pos$Function <- rep('Epistemic', nrow(parent_ul_remember_pos))
parent_ul_remember_pos <- positive_ul_moving(parent_ul_remember_pos, parent_ul_descriptive)

parent_ul_think_pos <- data.frame(table(parent_ul_think_pos$Sent_len))
names(parent_ul_think_pos) <- c('Sent_len', 'Freq')
parent_ul_think_pos$Role <- rep('Parent', nrow(parent_ul_think_pos))
parent_ul_think_pos$Head <- rep('think', nrow(parent_ul_think_pos))
temp <- merge(parent_ul_think_pos, parent_ul_descriptive, by.x = 'Sent_len', all.x = TRUE)
parent_ul_think_pos <- temp
parent_ul_think_pos$Total_ratio <- parent_ul_think_pos$Freq / parent_ul_think_pos$N_utterance
parent_ul_think_pos$Ratio <- parent_ul_think_pos$Freq / sum(parent_ul_think_pos$Freq)
parent_ul_think_pos$Polarity <- rep('positive', nrow(parent_ul_think_pos))
parent_ul_think_pos$Measure <- rep('positive construction ratio', nrow(parent_ul_think_pos))
parent_ul_think_pos$Which <- rep('ratio', nrow(parent_ul_think_pos))
parent_ul_think_pos$Function <- rep('Epistemic', nrow(parent_ul_think_pos))
parent_ul_think_pos <- positive_ul_moving(parent_ul_think_pos, parent_ul_descriptive)

epistemic_ul_data <- rbind(child_ul_know_neg, child_ul_know_pos, parent_ul_know_neg, parent_ul_know_pos, child_ul_remember_neg, child_ul_remember_pos, parent_ul_remember_neg, parent_ul_remember_pos, child_ul_think_neg, child_ul_think_pos, parent_ul_think_neg, parent_ul_think_pos)

epistemic_ul_data$Measure <- factor(epistemic_ul_data$Measure, levels = c('negative construction ratio', 'negative construction moving ratio', 'positive construction ratio', 'positive construction moving ratio'))

epistemic_ul_data_child <- subset(epistemic_ul_data, Role == 'Child')
epistemic_ul_data_parent <- subset(epistemic_ul_data, Role == 'Parent')

```

```{r epistemicdiscoursedata, include=FALSE}

discourse_epistemic <-read.csv('data/epistemic_discourse.txt', header = T, sep = '\t')
discourse_epistemic$Role[which(discourse_epistemic$Role == "Father")] <- 'Parent'
discourse_epistemic$Role[which(discourse_epistemic$Role == "Mother")] <- 'Parent'
discourse_epistemic$Role[which(discourse_epistemic$Role == "Target_Child")] <- 'Child'

discourse_epistemic_neg = subset(discourse_epistemic, Polarity == 'negative')
discourse_epistemic_pos = subset(discourse_epistemic, Polarity == 'positive')

discourse_child_epistemic_neg <- subset(discourse_epistemic_neg, Role %in% c('Child'))
discourse_parent_epistemic_neg <- subset(discourse_epistemic_neg, Role %in% c('Parent'))

discourse_child_epistemic_neg <- data.frame(table(discourse_child_epistemic_neg$Age))
names(discourse_child_epistemic_neg) <- c('Age', 'Freq')
discourse_child_epistemic_neg$Role <- rep('Child', nrow(discourse_child_epistemic_neg))
discourse_child_epistemic_neg$Head <- rep('all', nrow(discourse_child_epistemic_neg))
temp <- merge(discourse_child_epistemic_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_epistemic_neg <- temp
discourse_child_epistemic_neg$Total_ratio <- discourse_child_epistemic_neg$Freq / discourse_child_epistemic_neg$N_utterance
discourse_child_epistemic_neg$Ratio <- discourse_child_epistemic_neg$Freq / sum(discourse_child_epistemic_neg$Freq)
discourse_child_epistemic_neg$Polarity <- rep('negative', nrow(discourse_child_epistemic_neg))
discourse_child_epistemic_neg$Measure <- rep('negative construction ratio', nrow(discourse_child_epistemic_neg))
discourse_child_epistemic_neg$Which <- rep('ratio', nrow(discourse_child_epistemic_neg))
discourse_child_epistemic_neg$Function <- rep('Rejection', nrow(discourse_child_epistemic_neg))
discourse_child_epistemic_neg <- negative_moving(discourse_child_epistemic_neg, child_descriptive)

discourse_parent_epistemic_neg <- data.frame(table(discourse_parent_epistemic_neg$Age))
names(discourse_parent_epistemic_neg) <- c('Age', 'Freq')
discourse_parent_epistemic_neg$Role <- rep('Parent', nrow(discourse_parent_epistemic_neg))
discourse_parent_epistemic_neg$Head <- rep('al', nrow(discourse_parent_epistemic_neg))
temp <- merge(discourse_parent_epistemic_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_epistemic_neg <- temp
discourse_parent_epistemic_neg$Total_ratio <- discourse_parent_epistemic_neg$Freq / discourse_parent_epistemic_neg$N_utterance
discourse_parent_epistemic_neg$Ratio <- discourse_parent_epistemic_neg$Freq / sum(discourse_parent_epistemic_neg$Freq)
discourse_parent_epistemic_neg$Polarity <- rep('negative', nrow(discourse_parent_epistemic_neg))
discourse_parent_epistemic_neg$Measure <- rep('negative construction ratio', nrow(discourse_parent_epistemic_neg))
discourse_parent_epistemic_neg$Which <- rep('ratio', nrow(discourse_parent_epistemic_neg))
discourse_parent_epistemic_neg$Function <- rep('Rejection', nrow(discourse_parent_epistemic_neg))
discourse_parent_epistemic_neg <- negative_moving(discourse_parent_epistemic_neg, parent_descriptive)

discourse_child_epistemic_pos <- subset(discourse_epistemic_pos, Role %in% c('Child'))
discourse_parent_epistemic_pos <- subset(discourse_epistemic_pos, Role %in% c('Parent'))

discourse_child_epistemic_pos <- data.frame(table(discourse_child_epistemic_pos$Age))
names(discourse_child_epistemic_pos) <- c('Age', 'Freq')
discourse_child_epistemic_pos$Role <- rep('Child', nrow(discourse_child_epistemic_pos))
discourse_child_epistemic_pos$Head <- rep('all', nrow(discourse_child_epistemic_pos))
temp <- merge(discourse_child_epistemic_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_epistemic_pos <- temp
discourse_child_epistemic_pos$Total_ratio <- discourse_child_epistemic_pos$Freq / discourse_child_epistemic_pos$N_utterance
discourse_child_epistemic_pos$Ratio <- discourse_child_epistemic_pos$Freq / sum(discourse_child_epistemic_pos$Freq)
discourse_child_epistemic_pos$Polarity <- rep('positive', nrow(discourse_child_epistemic_pos))
discourse_child_epistemic_pos$Measure <- rep('positive construction ratio', nrow(discourse_child_epistemic_pos))
discourse_child_epistemic_pos$Which <- rep('ratio', nrow(discourse_child_epistemic_pos))
discourse_child_epistemic_pos$Function <- rep('Rejection', nrow(discourse_child_epistemic_pos))
discourse_child_epistemic_pos <- positive_moving(discourse_child_epistemic_pos, child_descriptive)


discourse_parent_epistemic_pos <- data.frame(table(discourse_parent_epistemic_pos$Age))
names(discourse_parent_epistemic_pos) <- c('Age', 'Freq')
discourse_parent_epistemic_pos$Role <- rep('Parent', nrow(discourse_parent_epistemic_pos))
discourse_parent_epistemic_pos$Head <- rep('all', nrow(discourse_parent_epistemic_pos))
temp <- merge(discourse_parent_epistemic_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_epistemic_pos <- temp
discourse_parent_epistemic_pos$Total_ratio <- discourse_parent_epistemic_pos$Freq / discourse_parent_epistemic_pos$N_utterance
discourse_parent_epistemic_pos$Ratio <- discourse_parent_epistemic_pos$Freq / sum(discourse_parent_epistemic_pos$Freq)
discourse_parent_epistemic_pos$Polarity <- rep('positive', nrow(discourse_parent_epistemic_pos))
discourse_parent_epistemic_pos$Measure <- rep('positive construction ratio', nrow(discourse_parent_epistemic_pos))
discourse_parent_epistemic_pos$Which <- rep('ratio', nrow(discourse_parent_epistemic_pos))
discourse_parent_epistemic_pos$Function <- rep('Rejection', nrow(discourse_parent_epistemic_pos))
discourse_parent_epistemic_pos <- positive_moving(discourse_parent_epistemic_pos, parent_descriptive)

discourse_epistemic_data <- rbind(discourse_child_epistemic_neg, discourse_parent_epistemic_neg, discourse_child_epistemic_pos, discourse_parent_epistemic_pos)

discourse_epistemic_data$Measure <- factor(discourse_epistemic_data$Measure, levels = c('negative construction ratio', 'negative construction moving ratio', 'positive construction ratio', 'positive construction moving ratio'))

discourse_epistemic_data_child <- subset(discourse_epistemic_data, Role == 'Child')
discourse_epistemic_data_parent <- subset(discourse_epistemic_data, Role == 'Parent')

discourse_epistemic_data_plot <- aggregate(Total_ratio~Age+Which+Role,data=discourse_epistemic_data,sum)

names(discourse_epistemic_data_plot) <- c('Age', 'Measure', 'Role', 'Total_ratio')

```

Previous studies have reported instances in which children combined negative morphemes with mental state verbs such as *know*, *think*, and *remember* to express "epistemic negation" [@choi1988semantic]. For defining epistemic constructions we also focused on these three verbs. For sentence level epistemic negation, we analyzed negative utterances where these verbs were modified by negative morphemes, possibly after combining with an auxiliary verb like *do*. Table \@ref(tab:epistem) shows a few examples. Instances where the speaker asked about or describes the negative epistemic state of another speaker were also included, leading to `r format(sum(subset(epistemic_data,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")` negative utterances in total (child: `r format(sum(subset(epistemic_data_child,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`; parent: `r format(sum(subset(epistemic_data_parent,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`). For the positive counterparts, we selected instances with the same head verbs except that these verbs were not modified by negation. This resulted in a total of `r format(sum(subset(epistemic_data,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")` negative utterances (child: `r format(sum(subset(epistemic_data_child,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`; parent: `r format(sum(subset(epistemic_data_parent,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`).

|Epistemic (Negative)| Epistemic (Positive)|
|----------------|----------------|
|*I not know* | *I knows*|
|*I didn't remember*||
|*I don't think so*|*I think this one is good*|
|*don't you remember*||
|*She doesn't know this*|*She knows about this*|
Table: (\#tab:epistem) Examples of the epistemic construction in children's speech at the sentence level

Figure \@ref(fig:epistemic) shows log ratios and cumulative ratios of the epistemic construction as defined above in parents' and children's speech at the sentence level. Overall, positive epistemic utterances were more frequent than negative epistemic utterances, with the possible exception of *know* for children. The production of negative utterances headed by *know* was comparatively the highest among children, and became more frequent at an earlier age (17-18 months) compared to that of *remember* (~19 months) or *think* (~20 months). Across the three head verbs, children's productions with *know* and *remember* gradually approaches that of parents' around 30 - 36 months, whereas cases with the head verb *think* tend to be produced less frequently by children.

```{r epistemic, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=7, set.cap.width=T, num.cols.cap=1, fig.cap="Log ratios and cumulative ratios of negative and positive epistemic utterances in parents' and children's speech."}

epistemic_data %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(log(Total_ratio), 2), group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) +
  facet_grid(Head ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)") + 
  guides(linetype = guide_legend(nrow = 2))

```

<!--
```{r epistemicul, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=7, set.cap.width=T, num.cols.cap=1, fig.cap='Epistemic negation and its positive counterparts, indexed by utterance length.'}

epistemic_ul_data %>% 
  ggplot(aes(as.numeric(as.character(Sent_len)), round(log(Total_ratio), 2), group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) +
  facet_grid(Head ~ Role) +
  scale_x_continuous(breaks=seq(0, 130, 10)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)") + 
  guides(linetype = guide_legend(nrow = 2))

```
-->

For epistemic negation at the discourse level, we examined interactions in which the antecedent utterances took any of the three head verbs *know*, *remember* and *think*, leading to a total of `r format(sum(subset(discourse_epistemic_data,Which=='ratio')$Freq), big.mark=",")` utterances (child: `r format(sum(subset(epistemic_data_child,Which=='ratio')$Freq), big.mark=",")`; parent: `r format(sum(subset(epistemic_data_parent,Which=='ratio')$Freq), big.mark=",")`). Figure \@ref(fig:epistemicdiscourse) shows log ratios and cumulative ratios for epistemic negation at the discourse level. Children's productions increase rapidly between 24-36 months and after 36 months, they produce this construction close to parent levels.

```{r epistemicdiscourse, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap="Log ratios and cumulative ratios for discourse level Epistemic negation in parents' and children's speech.",warning=FALSE}

discourse_epistemic_data_plot %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(log(Total_ratio), 2), group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c('solid', 'dotted')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(16, 3)) +
  scale_color_manual(values = c("darkgreen", "grey")) +
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)") 

```

### Possession

The last function we explored was "possession". At the syntactic level, for negative structures we selected cases where negative morphemes were combined with auxiliary verbs to modify a head verb with the lemma form *have* and a POS tag of VERB. We also included individual noun phrases with possessive pronouns as heads and modified by negative morphemes. Table \@ref(tab:possess) shows a few examples. Cases in which the syntactic head of the negative morphemes is a predicate of a copula verb (e.g. "this is not mine") were excluded to separate them from the function "labeling". The number of negative utterances that were subjected to analysis for this function is `r format(sum(subset(possession_data,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`  (child: `r format(sum(subset(possession_data_child,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`; parent: `r format(sum(subset(possession_data_parent,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`). Again the positive counterparts share similar structures except with no negation, leading to a total of `r format(sum(subset(possession_data,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`  (child: `r format(sum(subset(possession_data_child,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`; parent: `r format(sum(subset(possession_data_parent,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`). One thing to note here is that for the positive structures with the head verb *have*, we restricted to cases where the verb takes a direct object (with the dependency relation *obj*). This is to avoid potential parsing errors of instances such as *I have*, where the verb could ambiguously be an auxiliary.

|Posession (Negative)| Posession (Positive)|
|----------------|----------------|
|*I don't have it* | *you have that*|
|*not mine*|*hers*|
Table: (\#tab:possess) Examples of negative and positive possession in children and parents' speech at the sentence level

Figure \@ref(fig:possession) shows log ratios and cumulative ratios of the negative and positive possession construction at the sentence level. The production trajectory for possession in child speech appears to have notable differences depending on what the negative morpheme modifies. With *have* as the syntactic head, children increase their productions between 18-36 months, and stay close to parent levels of production after 36 months. However, for utterances headed by possessive pronouns, productions increase rapidly between 18-24 months and stays close to parent levels as early as 24 months of age.

```{r possession, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=5, set.cap.width=T, num.cols.cap=1, fig.cap="Log ratios and cumulative ratios of the construction `possession` in parents' and children's speech."}

possession_data %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(log(Total_ratio), 2), group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) +
  facet_grid(Head ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)") + 
  guides(linetype = guide_legend(nrow = 2))

```

<!--
```{r possessionul, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=5, set.cap.width=T, num.cols.cap=1, fig.cap='Possession and its positive counterparts, indexed by utterance length.'}

possession_ul_data %>% 
  ggplot(aes(as.numeric(as.character(Sent_len)), round(log(Total_ratio), 2), group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkgrey", "steelblue", "bisque2", "mediumpurple4")) +
  facet_grid(Head ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)") + 
  guides(linetype = guide_legend(nrow = 2))

```
-->

At the discourse level, we selected antecedents to discourse level negative utterances (e.g. *no!*) which themselves had structures similar to both the negative and positive constructions at the syntactic level. Table \@ref(tab:dispossess) provides a few examples and Figure \@ref(fig:possessiondiscourse) shows log ratios and cumulative ratios of such utterances in parents' and children's speech. Overall, the production pattern for discourse level possession suggests that children produce such utterances frequently and at parents' level after 30 or 36 months of age.

|Antecedent|Utterance|
|------------|------------|
|Child: *I don't have the book*|Parent: *no no mommy please read it to me*|
|Parent: *not yours*|Child: *no it's mine mine*|
Table: (\#tab:dispossess) Example antecedents with the possession construction and discourse level negation in parents' and children's productions 

```{r possessiondiscourse, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap="Log ratios and cumulative ratios of the possession construction at the discourse level in parents' and children's speech.",warning=FALSE}

discourse_possession_data_plot %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(log(Total_ratio), 2), group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c('solid', 'dotted')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16)) +
  scale_color_manual(values = c("darkgreen", "grey")) +
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)") 

```

### Discussion 

```{r alldata, include=FALSE}

all <- rbind(emotion_data, epistemic_data, prohibition_data, inability_data, learning_data, existence_data, possession_data)
together <- subset(all, Which == 'moving ratio')
child_all <- subset(together, Role %in% c('Target_Child', 'Child'))
parent_all <- subset(together, Role %in% c('Parent'))

child_neg_together <- aggregate(Freq ~ Age + Function, data = subset(child_all, Polarity == 'negative'), sum)
child_neg_together$Role <- rep('Child', nrow(child_neg_together))
child_neg_together$Total_ratio <- rep(0, nrow(child_neg_together))

for (i in 1:nrow(child_neg_together)){
  age = as.numeric(as.character(child_neg_together$Age[i]))
  data = subset(child_descriptive, Age <= age)
  child_neg_together$Total_ratio[i] = child_neg_together$Freq[i] / sum(data$N_utterance)

  }

parent_neg_together <- aggregate(Freq ~ Age + Function, data = subset(parent_all, Polarity == 'negative'), sum)
parent_neg_together$Role <- rep('Parent', nrow(parent_neg_together))
parent_neg_together$Total_ratio <- rep(0, nrow(parent_neg_together))

for (i in 1:nrow(parent_neg_together)){
  age = as.numeric(as.character(parent_neg_together$Age[i]))
  data = subset(parent_descriptive, Age <= age)
  parent_neg_together$Total_ratio[i] = parent_neg_together$Freq[i] / sum(data$N_utterance)

  }


neg_together_final <- rbind(child_neg_together, parent_neg_together)

child_pos_together <- aggregate(Freq ~ Age + Function, data = subset(child_all, Polarity == 'positive'), sum)
child_pos_together$Role <- rep('Child', nrow(child_pos_together))
child_pos_together$Total_ratio <- rep(0, nrow(child_pos_together))

for (i in 1:nrow(child_pos_together)){
  age = as.numeric(as.character(child_pos_together$Age[i]))
  data = subset(child_descriptive, Age <= age)
  child_pos_together$Total_ratio[i] = child_pos_together$Freq[i] / sum(data$N_utterance)

  }

parent_pos_together <- aggregate(Freq ~ Age + Function, data = subset(parent_all, Polarity == 'positive'), sum)
parent_pos_together$Role <- rep('Parent', nrow(parent_pos_together))
parent_pos_together$Total_ratio <- rep(0, nrow(parent_pos_together))

for (i in 1:nrow(parent_pos_together)){
  age = as.numeric(as.character(parent_pos_together$Age[i]))
  data = subset(parent_descriptive, Age <= age)
  parent_pos_together$Total_ratio[i] = parent_pos_together$Freq[i] / sum(data$N_utterance)

  }


pos_together_final <- rbind(child_pos_together, parent_pos_together)


```

```{r allneg, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=5, set.cap.width=T, num.cols.cap=1, fig.cap='Log cumulative ratios for all negative constructions at the syntactic level.', warning=FALSE}


neg_together_final %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(log(Total_ratio), 2), group = Function, color = Function)) +
  geom_line(aes(linetype=Function), alpha = 1) +
  scale_color_brewer(palette = "Dark2") +
  geom_point(aes(color = Function, shape = Function), size = 1) +
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)") + 
  guides(linetype = guide_legend(nrow = 2)) 

```

```{r allpos, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=5, set.cap.width=T, num.cols.cap=1, fig.cap='Log cumulative ratios for the positive counpterparts to all negative constructions at the syntactic level.', warning=FALSE}


pos_together_final %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(log(Total_ratio), 2), group = Function, color = Function)) +
  geom_line(aes(linetype=Function), alpha = 1) +
  scale_color_brewer(palette = "Dark2") +
  geom_point(aes(color = Function, shape = Function), size = 1) +
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)") + 
  guides(linetype = guide_legend(nrow = 2)) 

```

```{r alldiscoursedata, include=FALSE}

discourse_all <- rbind(discourse_emotion_data, discourse_epistemic_data, discourse_prohibition_data, discourse_inability_data, discourse_learning_data, discourse_existence_data, discourse_possession_data)
discourse_together <- subset(discourse_all, Which == 'moving ratio')
discourse_child_all <- subset(discourse_together, Role %in% c('Target_Child', 'Child'))
discourse_parent_all <- subset(discourse_together, Role %in% c('Parent'))

discourse_child_together <- aggregate(Freq ~ Age + Function, data = discourse_child_all, sum)
discourse_child_together$Role <- rep('Child', nrow(discourse_child_together))
discourse_child_together$Total_ratio <- rep(0, nrow(discourse_child_together))

for (i in 1:nrow(discourse_child_together)){
  age = as.numeric(as.character(discourse_child_together$Age[i]))
  data = subset(child_descriptive, Age <= age)
  discourse_child_together$Total_ratio[i] = discourse_child_together$Freq[i] / sum(data$N_utterance)

  }

discourse_parent_together <- aggregate(Freq ~ Age + Function, data = discourse_parent_all, sum)
discourse_parent_together$Role <- rep('Parent', nrow(discourse_parent_together))
discourse_parent_together$Total_ratio <- rep(0, nrow(discourse_parent_together))

for (i in 1:nrow(discourse_parent_together)){
  age = as.numeric(as.character(discourse_parent_together$Age[i]))
  data = subset(parent_descriptive, Age <= age)
  discourse_parent_together$Total_ratio[i] = discourse_parent_together$Freq[i] / sum(data$N_utterance)

  }


discourse_together_final <- rbind(discourse_child_together, discourse_parent_together)

```

```{r alldiscourse, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=5, set.cap.width=T, num.cols.cap=1, fig.cap='Cumulative ratios for all negative constructions at the discourse level.', warning=FALSE}

discourse_together_final %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(log(Total_ratio), 2), group = Function, color = Function)) +
  geom_line(aes(linetype=Function), alpha = 1) +
  scale_color_brewer(palette = "Dark2") +
  geom_point(aes(color = Function, shape = Function), size = 1) +
  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)") + 
  guides(linetype = guide_legend(nrow = 2)) 

```

# Conclusion

Using automatic annotations of large-scale corpora of child-parent interactions, we presented production trajectories for seven negative constructions that tend to express rejection, non-existence, prohibition, inability, labeling, epistemic states, and possession (Table 1). The results suggest that the production of almost all these negative constructions (except for prohibition) emerges and gradually increases within the 18-36 months age range (Figure 8). Their production frequencies remain stable and regular after 36 months and relatively close to parents' levels of production. It is important to note that similar to prior studies, our conclusions are limited to negation in children's production. Systematic experiments testing children's comprehension of negative utterances with different communicative functions are necessary to better understand the origins and developmental trajectory of negation.

For future work, we would like to explore several directions. First, to more thoroughly examine and potentially model the developmental trajectories of negation in child production, certain production-specific factors (e.g. length of utterance, ease of pronunciation) should be taken into account as well. In addition, we aim to investigate the production trajectory of positive counterparts to our negative structures (e.g. "I know" for "I don't know"). Comparisons of negative utterances in relation to their positive counterparts would allow us to further analyze the developmental paths of negation within specific constructions.

Lastly, our experiments have concentrated on larger syntactic structures at the utterance level, hence cases where negation is used as discourse markers to respond to previous utterance(s) were excluded. However, these instances also have important semantic and conceptual roles in the communication between children and parents (e.g. parent: *do you want some bread?*; child: *no no no*). Thus inclusions of negative structures at a more comprehensive level would be able to paint a more clear picture about the development of negation.

\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}

\endgroup

```{r intersect, include=FALSE}

intersect_all <- function(a,b,...){
  Reduce(intersect, list(a,b,...))
}


```
