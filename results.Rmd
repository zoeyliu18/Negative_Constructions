---
title             : "English Negative Constructions and Communicative Functions in Early Child Language"
shorttitle        : "Negation and communicative functions"

author: 
  - name        : ""
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    address       : ""
    email         : ""
  - name          : ""
    affiliation   : "2"

affiliation:
  - id            : "1"
    institution   : 
  - id            : "2"
    institution   : 

authornote: |
  Add complete departmental affiliations for each author here. Each new line herein must be indented, like this line.

  Enter author note here.

abstract: |
  How does negation emerge in early conceptual and linguistic development? Previous research has hypothesized that negation develops to express different communicative functions such as rejection, non-existence, or prohibition. However, these functions pro been challenging to detect and classify by human annotators using contextual cues. Consequently, in previous research we pro been limited to relatively small number of children and small samples of their speech. In this study, we consider specific syntactic constructions as proxies for communicative functions and examine their developmental trajectories in children's speech. We used automatic annotation and identification of seven different functions in a large corpus of child-parent interactions. Our analyses demonstrated frequent usage of negation in all seven functions between the ages of 24 - 36 months; yet there are notable differences in production variability of negation depending on the specifc function examined.

  <!-- https://tinyurl.com/ybremelq -->
  
keywords          : "negation; acquisition; development, semantics, pragmatics, syntax, child language."
wordcount         : "X"

bibliography      : ["library.bib"]

floatsintext      : yes
figurelist        : no
tablelist         : no
footnotelist      : no
linenumbers       : yes
mask              : no
draft             : no

documentclass     : "apa6"
classoption       : "man"
output            : papaja::apa6_pdf
---
  
```{r setup, include = FALSE}
library("papaja")
library(data.table)
library(plyr)
library(devtools)
library(childesr)
library(tidyverse)
library(tm)
library(forcats)
library(gridExtra)
library(png)
library(grid)
library(ggplot2)
library(xtable)
library('RColorBrewer')
library(gridExtra)
library(tidyverse)
library(AICcmodavg)
library(broom)
library(corrr)
library(dplyr)
library(knitr)
library(kableExtra)
library(readr)
library(tidyr)
```

# Introduction

Negation is an abstract concept crucial to everyday communication. It can help a coffee shop divide its menu into "coffee" and "not coffee" sections, with the "not coffee" section bringing together diverse items with no common label. It can inform us to regulate each others' actions in a sign like "no mask, no entry". It can also communicate our deepest wants and dislikes as in "I don't like Mondays". But how does the abstract concept of negation emerge in the human mind? What are the specific communicative functions that negation combines with in early language development? 

Starting a century and a half ago, @darwin1872expression thought that negation has roots in the expression of human emotions and desires. He hypothesized the earliest manifestation of negation and affirmation in infants is when they refuse food from parents, by withdrawing their heads laterally, or when they accept the food, by inclining their heads forward. He suggested that head shaking and nodding as common gestures for negation and affirmation pro developed from this early habit. Similarly, many researchers studying early functions of negative morphemes like *no* proposed that children use them to "reject" or "refuse" [@bloom1970language; @pea1978; @choi1988semantic]. For example, when they are asked "do you want juice?", they may say "no", "not want it", or "don't like it". @pea1978 proposed this negation function is the first to emerge in children's early speech.

@bloom1970language argued that the use of negation to expresses "non-existence" emerges before rejection or refusal. For example, when an object that children expect to be present is not present, children may say: "no window", "no fish in the bathroom", or "I do not pro underpants". Two close concepts to non-existence are "disappearance" and "non-occurrence" [@de1979form; @pea1978]. Disappearance refers to situations where an object disappears and children use negation to express it (e.g. "no food. all gone" or "no more noise"). Non-occurrence refers to cases when an expected action or event does not occur as in "not working" or "doggie not barking". Some researchers referred to these cases as "failures" and included examples like "no fit in da box" or "it don't fit" [@choi1988semantic; @cameron2007part]. Non-existence can also be expressed by negation of locative prepositional phrases (e.g. "no in there" or "daddy was not on the phone"). While rejection was hypothesized to interact with human emotions and desires, non-existence (broadly construed to include "disappearance" and "non-occurrence") likely interacts with human perception. @choi1988semantic proposed that children's early linguistic negation is used to express both rejection and non-existence.

Additionally, @choi1988semantic introduced "prohibition" and suggested that it emerges as early as rejection and non-existence. In cases of prohibition, children use negation to stop others from performing actions; for example "don't go" or "do not spill milk". A special case of prohibition is "self-prohibition". For example, a child may approach prohibited food but immediately say "no, don't eat" to stop themselves. A function similar to prohibition is "inability" (e.g. *I can't reach* / *I cannot zip it*), in that both involve conceptualizing actions and negating them, possibly interacting with early development of motor control. @choi1988semantic suggested that expression of inability emerges after the first phase, namely non-existence, rejection, and prohibition.

"Denial" is another function of negation that is argued to be late in development. @bloom1970language defined it as asserting that "an actual or supposed predication was not the case", for example "It's not sharp". Later researchers formulated it as "truth-functional negation" because it is used to negate the truth of a proposition [@pea1978; @cameron2007part]. However, this definition depends on the assumed logical system and its assumptions on what type of propositions receive truth values. A particular sub-function of denial is "labeling", which is realized as the negation of nominal or adjectival predicates such as "this is not a bunny" or "not red". These utterances are often used to introduce new linguistic labels by parents and in turn may facilitate word learning [@clark2010adult]. Conversely, labeling and word learning may aid the development of abstract negation.

Despite considerable research on early functions of negation, their developmental trajectories in children's productions pro remained unclear. Different studies pro claimed different order of acquisition [@pea1978]. In a recent study, @nordmeyer2018individual looked at the speech of five children in the Providence corpus [@demuth2006word] and found a great deal of individual differences in how early a negative function is attested. This is partly because previous studies pro had to rely on human annotation and identification of functions from corpus data, a time-consuming and difficult process that has limited previous studies to a handful of children and a relatively small sample of their speech.

Our study addresses this issue by using syntactic constructions as a proxy for communicative functions. We used a large collection of child language corpora [@macwhinney2000childes] with part of speech tags and syntactic dependency relations. We automatically selected constructions that conveyed the functions discussed in prior research and asked: (1) how early do these constructions emerge in children's speech and what's their trajectory? (2) within the same communicative function, does the developmental trajectory differ depending on particular lexical items that negation modifies (e.g. *like* or *want* for rejection)? (3) taking all functions into account, do they share similar developmental characteristics, or would there be function-specific differences?

<!--
Previous research on the origins and functions of negation has faced two major issues. First, it mainly relied on human annotation and classification of negative utterances in corpora which is costly, time-consuming, and difficult. As a result, most studies focused on only a handful of children and a relatively small sample of their speech. Secondly, the results of previous studies pro shown great variability among children with respect to the emergence of different functions in children's speech. For example, @nordmeyer2018individual looked at the speech of five children in the Providence corpus [@demuth2006word] and found a great deal of individual variation in how early a negative function is attested. This was likely due to the prevalence of different types of activities children engage in such as book reading with parents vs. eating food. In this paper, we address these issues by focusing on the combinatorial and compositional capacity of negation in children's speech. We start with the widely accepted assumption that negation is a higher order operator, taking other concepts as its argument. The question we ask is: what type of concepts does linguistic negation operate on in early child language? Do we find negation composing with a limited set of lexical items? Or do we find it operating on a variety of lexical items and syntactic constructions?
-->

\begin{table*}[h!]
\small
\centering
\begin{tabular}{rrr}
  \hline
 \textbf{Function} & \textbf{Linguistic Composition} & \textbf{Examples} \\
  \hline
Rejection & with \textit{like} or \textit{want} & \textit{I not like it}, \textit{not want it}  \\
Non-existence & expletives; with a nominal; \textit{no more} & \textit{there is no soup}; \textit{no juice}; \textit{no more milk} \\
Prohibition & with imperative subjectless \textit{do} & \textit{do not spill milk} \\
Inability & with modal \textit{can} & \textit{I cannot zip it} \\
Labeling & modifying nominal or adjectival predicatives & \textit{that's not a crocodile}; \textit{it's no interesting} \\
Epistemic negation & with \textit{know}, \textit{think}, \textit{remember}  & \textit{I not know} \\
Possession & with \textit{pro}; or possesive pronouns & \textit{not pro the toy}; \textit{not mine} \\
   \hline
\end{tabular}
\caption{Communicative functions of negation in early child language of English.}
\end{table*}

\clearpage

# Experiments

## Data and preprocessing 

For developmental data of child language in English, we turned to the CHILDES database [@macwhinney2000childes].\footnote{Code and data are in quarantine at https://somewhereonearth.}. We focused on speech produced by children with typical development within the age range of 12 - 72 months. Negative structures were first identified based on whether a structure contains any of the three negative morphemes: *no*, *not* and *n't*. Since the matters of interest are individual utterances and what negation *combines* with, cases consisting of one negative morpheme were excluded (e.g. *no*!). Preprocessing led to a data set of 365,260 negative utterances from a total of 811 children across 56 corpora.
<!--
935; children with no specified names
-->

All utterances:
2,784,745 
1053 children
56 corpora

## Negation functions

Besides the communicative function of rejection, non-existence, prohibition, inability and denial (labeling), we expanded with two other functions: epistemic negation [@choi1988semantic] and possession (see Table 1). For each function, we first characterized the syntactic features of the linguistic structures that the negative morphemes are combined with. Then negative utterances of different communicative functions were automatically extracted in a rule-based fashion, i.e. based on the syntactic characteristics. In order to do this, we resorted to the available morphosyntactic information provided from CHILDES [@sagae2010morphosyntactic], such as part-of-speech (POS) tags as well as grammatical or syntactic dependency relations. After extracting negative utterances, the developmental trajectories of different constructions of interest were analyzed. 

In what follows we introduce each construction and present the results. While our focus is child utterances, we used parents' speech as references and therefore our plots often contrast the relative frequency (or ratio) of these constructions between children's and parents' production at the corresponding age of the child.

<!--
 c<-sapply(strsplit(a$Utterance, " "), length)
 -->
 
```{r entropy_function}
entropy <- function(data){
  start = 0
  for (i in 1:nrow(data)){
    p = as.vector(data$Ratio)[i] / 100
#    print(p)
    start = start - p * log2(p)
  }
  
  return(start)
}
```

```{r negative_bin_function}

negative_bin <- function(data){
  
  age <- c(18, 24, 30, 36, 42, 48, 54, 60, 66, 72)
  freq_list <- rep(0, 10)
  n_speaker_list <- rep(0, 10)
  n_utterances_list <- rep(0, 10)

  for (i in 1:length(age)){
    age_min = 0
    age_max = age[i]
    if (i == 1){
      age_min = 12
    }
    else{
      age_min = age[i - 1]
    }
  
    freq = 0
    n_speaker = 0
    n_utterances = 0
  
    for (z in 1:nrow(data)){

      if (as.numeric(as.vector(data$Age)[z]) < age_max & as.numeric(as.vector(data$Age)[z]) >= age_min){
        freq = freq + as.numeric(as.vector(data$Freq)[z])
        n_speaker = n_speaker + as.numeric(as.vector(data$N_speaker)[z])
        n_utterances = n_utterances + as.numeric(as.vector(data$N_utterance)[z])
      }
    }
    freq_list[i] = freq
    n_speaker_list[i] = n_speaker
    n_utterances_list[i] = n_utterances
    
    }

  moving_ave <- data.frame(as.character(age))
  names(moving_ave) <- c('Age')
  moving_ave$Freq <- freq_list
  moving_ave$Role <- rep(unique(data$Role), length(age))
  moving_ave$Head <- rep(unique(data$Head), length(age))
  moving_ave$N_speaker <- n_speaker_list
  moving_ave$N_utterance <- n_utterances_list
  moving_ave$Total_ratio <- moving_ave$Freq / moving_ave$N_utterance
  moving_ave$Ratio <- rep(0, length(age))
  moving_ave$Polarity <- rep(unique(data$Polarity), length(age))
  moving_ave$Measure <- rep('negative moving ratio', length(age))
  moving_ave$Which <- rep('moving ratio', length(age))
  temp <- rbind(data, moving_ave)
  data <- temp
  
  return(data)

}

```

```{r positive_bin_function}

positive_bin <- function(data){
  
  age <- c(18, 24, 30, 36, 42, 48, 54, 60, 66, 72)
  freq_list <- rep(0, 10)
  n_speaker_list <- rep(0, 10)
  n_utterances_list <- rep(0, 10)

  for (i in 1:length(age)){
    age_min = 0
    age_max = age[i]
    if (i == 1){
      age_min = 12
    }
    else{
      age_min = age[i - 1]
    }
  
    freq = 0
    n_speaker = 0
    n_utterances = 0
  
    for (z in 1:nrow(data)){

      if (as.numeric(as.vector(data$Age)[z]) < age_max & as.numeric(as.vector(data$Age)[z]) >= age_min){
        freq = freq + as.numeric(as.vector(data$Freq)[z])
        n_speaker = n_speaker + as.numeric(as.vector(data$N_speaker)[z])
        n_utterances = n_utterances + as.numeric(as.vector(data$N_utterance)[z])
      }
    }
    freq_list[i] = freq
    n_speaker_list[i] = n_speaker
    n_utterances_list[i] = n_utterances
    
    }

  moving_ave <- data.frame(as.character(age))
  names(moving_ave) <- c('Age')
  moving_ave$Freq <- freq_list
  moving_ave$Role <- rep(unique(data$Role), length(age))
  moving_ave$Head <- rep(unique(data$Head), length(age))
  moving_ave$N_speaker <- n_speaker_list
  moving_ave$N_utterance <- n_utterances_list
  moving_ave$Total_ratio <- moving_ave$Freq / moving_ave$N_utterance
  moving_ave$Ratio <- rep(0, length(age))
  moving_ave$Polarity <- rep(unique(data$Polarity), length(age))
  moving_ave$Measure <- rep('positive moving ratio', length(age))
  moving_ave$Which <- rep('moving ratio', length(age))
  temp <- rbind(data, moving_ave)
  data <- temp
  
  return(data)

}

```


```{r negative_moving_function}

negative_moving <- function(data, descriptive){
  
  age_list <- as.vector(data$Age)
  freq_list <- rep(0, length(age_list))
  n_speaker_list <- rep(0, length(age_list))
  n_utterances_list <- rep(0, length(age_list))
  
  data$Age <- as.numeric(as.vector(data$Age))
  
  for (i in 1:length(age_list)){
    age = as.numeric(age_list[i])
    select <- data.frame(subset(data, Age <= age)) # & Age >= (age - 5)))
    freq = sum(as.numeric(as.vector(select$Freq)))
    n_speaker = sum(as.numeric(as.vector(select$N_speaker)))
#    n_utterances = sum(as.numeric(as.vector(select$N_utterance)))
    n_utterances = sum(as.numeric(as.vector((subset(descriptive, Age <= age))$N_utterance)))
    freq_list[i] = freq
    n_speaker_list[i] = n_speaker
    n_utterances_list[i] = n_utterances
    
    }
  
  data$Age <- as.character(data$Age)
  
  moving_ave <- data.frame(as.character(age_list))
  names(moving_ave) <- c('Age')
  moving_ave$Freq <- freq_list
  moving_ave$Role <- rep(unique(data$Role), length(age))
  moving_ave$Head <- rep(unique(data$Head), length(age))
  moving_ave$N_speaker <- n_speaker_list
  moving_ave$N_utterance <- n_utterances_list
  moving_ave$Total_ratio <- moving_ave$Freq / moving_ave$N_utterance
  moving_ave$Ratio <- rep(0, length(age))
  moving_ave$Polarity <- rep(unique(data$Polarity), length(age))
  moving_ave$Measure <- rep('negative moving ratio', length(age))
  moving_ave$Which <- rep('moving ratio', length(age))
  moving_ave$Function <- rep(unique(data$Function), length(age))
  temp <- rbind(data, moving_ave)
  data <- temp
  
  return(data)

}

```


```{r positive_moving_function}

positive_moving <- function(data, descriptive){
  
  age_list <- as.vector(data$Age)
  freq_list <- rep(0, length(age_list))
  n_speaker_list <- rep(0, length(age_list))
  n_utterances_list <- rep(0, length(age_list))
  
  data$Age <- as.numeric(as.vector(data$Age))
  
  for (i in 1:length(age_list)){
    age = as.numeric(age_list[i])
    select <- data.frame(subset(data, Age <= age)) # & Age >= (age - 5)))
    freq = sum(as.numeric(as.vector(select$Freq)))
    n_speaker = sum(as.numeric(as.vector(select$N_speaker)))
    n_utterances = sum(as.numeric(as.vector((subset(descriptive, Age <= age))$N_utterance)))
#    n_utterances = sum(as.numeric(as.vector(select$N_utterance)))
    freq_list[i] = freq
    n_speaker_list[i] = n_speaker
    n_utterances_list[i] = n_utterances
    
    }
  
  data$Age <- as.character(data$Age)
  
  moving_ave <- data.frame(as.character(age_list))
  names(moving_ave) <- c('Age')
  moving_ave$Freq <- freq_list
  moving_ave$Role <- rep(unique(data$Role), length(age))
  moving_ave$Head <- rep(unique(data$Head), length(age))
  moving_ave$N_speaker <- n_speaker_list
  moving_ave$N_utterance <- n_utterances_list
  moving_ave$Total_ratio <- moving_ave$Freq / moving_ave$N_utterance
  moving_ave$Ratio <- rep(0, length(age))
  moving_ave$Polarity <- rep(unique(data$Polarity), length(age))
  moving_ave$Measure <- rep('positive moving ratio', length(age))
  moving_ave$Which <- rep('moving ratio', length(age))
  moving_ave$Function <- rep(unique(data$Function), length(age))
  temp <- rbind(data, moving_ave)
  data <- temp
  
  return(data)

}

```


```{r mlu_function}

mlu <- function(data){
  
  compose = as.vector(unique(data$Age))
  values = rep(0, length(compose))
  
  for (i in 1:length(compose)){
    age = as.numeric(compose[i])
    select <- data.frame(subset(data, Age <= age))
    mlu_value = sum(select$Sent_len) / nrow(select)
    values[i] = mlu_value
  }
  
  compose = data.frame(compose)
  names(compose) <- c('Age')
  compose$MLU <- values
  
  return(compose)
  
}  


```

### Rejection

For the function of rejection, we examined cases where the lemma of the head verb of the phrase is either *like* or *want*, and the head verb is modified by one of the three negative morphemes. Each of the utterances either takes a subject or has no subject at all. And the existence of a subject was determined via searching for a word in the utterance that has the *SUBJ* dependency relation with the head verb.

```{r descriptive, include=FALSE}

child_descriptive <- read.csv('data/diaparse/child_descriptive.txt', header = T, sep = '\t')
parent_descriptive <- read.csv('data/diaparse/parent_descriptive.txt', header = T, sep = '\t')

```

```{r emotiondata, include=FALSE}

emotion <-read.csv('data/diaparse/emotion.txt', header = T, sep = '\t')
# emotion <- subset(emotion, Subj == 'I' | Subj == 'NONE')
emotion$Role[which(emotion$Role == "Father")] <- 'Parent'
emotion$Role[which(emotion$Role == "Mother")] <- 'Parent'
emotion$Role[which(emotion$Role == "Target_Child")] <- 'Child'

emotion_neg = subset(emotion, Polarity == 'negative')
emotion_pos = subset(emotion, Polarity == 'positive')

child_emotion_neg <- subset(emotion_neg, Role %in% c('Child'))
parent_emotion_neg <- subset(emotion_neg, Role %in% c('Parent'))


child_like_neg <- subset(child_emotion_neg, Head %in% c('like'))
child_want_neg <- subset(child_emotion_neg, Head %in% c('want'))
parent_like_neg <- subset(parent_emotion_neg, Head %in% c('like'))
parent_want_neg <- subset(parent_emotion_neg, Head %in% c('want'))

child_like_neg_mlu <- mlu(child_like_neg)
child_want_neg_mlu <- mlu(child_want_neg)
parent_like_neg_mlu <- mlu(parent_like_neg)
parent_want_neg_mlu <- mlu(parent_want_neg)

child_like_neg <- data.frame(table(child_like_neg$Age))
names(child_like_neg) <- c('Age', 'Freq')
child_like_neg$Role <- rep('Child', nrow(child_like_neg))
child_like_neg$Head <- rep('like', nrow(child_like_neg))
temp <- merge(child_like_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_like_neg <- temp
child_like_neg$Total_ratio <- child_like_neg$Freq / child_like_neg$N_utterance
child_like_neg$Ratio <- child_like_neg$Freq / sum(child_like_neg$Freq)
child_like_neg$Polarity <- rep('negative', nrow(child_like_neg))
child_like_neg$Measure <- rep('negative ratio', nrow(child_like_neg))
child_like_neg$Which <- rep('ratio', nrow(child_like_neg))
child_like_neg$Function <- rep('Rejection', nrow(child_like_neg))
child_like_neg <- negative_moving(child_like_neg)


child_want_neg <- data.frame(table(child_want_neg$Age))
names(child_want_neg) <- c('Age', 'Freq')
child_want_neg$Role <- rep('Child', nrow(child_want_neg))
child_want_neg$Head <- rep('want', nrow(child_want_neg))
temp <- merge(child_want_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_want_neg <- temp
child_want_neg$Total_ratio <- child_want_neg$Freq / child_want_neg$N_utterance
child_want_neg$Ratio <- child_want_neg$Freq / sum(child_want_neg$Freq)
child_want_neg$Polarity <- rep('negative', nrow(child_want_neg))
child_want_neg$Measure <- rep('negative ratio', nrow(child_want_neg))
child_want_neg$Which <- rep('ratio', nrow(child_want_neg))
child_want_neg$Function <- rep('Rejection', nrow(child_want_neg))
child_want_neg <- negative_moving(child_want_neg)

parent_like_neg <- data.frame(table(parent_like_neg$Age))
names(parent_like_neg) <- c('Age', 'Freq')
parent_like_neg$Role <- rep('Parent', nrow(parent_like_neg))
parent_like_neg$Head <- rep('like', nrow(parent_like_neg))
temp <- merge(parent_like_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_like_neg <- temp
parent_like_neg$Total_ratio <- parent_like_neg$Freq / parent_like_neg$N_utterance
parent_like_neg$Ratio <- parent_like_neg$Freq / sum(parent_like_neg$Freq)
parent_like_neg$Polarity <- rep('negative', nrow(parent_like_neg))
parent_like_neg$Measure <- rep('negative ratio', nrow(parent_like_neg))
parent_like_neg$Which <- rep('ratio', nrow(parent_like_neg))
parent_like_neg$Function <- rep('Rejection', nrow(parent_like_neg))
parent_like_neg <- negative_moving(parent_like_neg)

parent_want_neg <- data.frame(table(parent_want_neg$Age))
names(parent_want_neg) <- c('Age', 'Freq')
parent_want_neg$Role <- rep('Parent', nrow(parent_want_neg))
parent_want_neg$Head <- rep('want', nrow(parent_want_neg))
temp <- merge(parent_want_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_want_neg <- temp
parent_want_neg$Total_ratio <- parent_want_neg$Freq / parent_want_neg$N_utterance
parent_want_neg$Ratio <- parent_want_neg$Freq / sum(parent_want_neg$Freq)
parent_want_neg$Polarity <- rep('negative', nrow(parent_want_neg))
parent_want_neg$Measure <- rep('negative ratio', nrow(parent_want_neg))
parent_want_neg$Which <- rep('ratio', nrow(parent_want_neg))
parent_want_neg$Function <- rep('Rejection', nrow(parent_want_neg))
parent_want_neg <- negative_moving(parent_want_neg)

child_emotion_pos <- subset(emotion_pos, Role %in% c('Child'))
parent_emotion_pos <- subset(emotion_pos, Role %in% c('Parent'))

child_like_pos <- subset(child_emotion_pos, Head %in% c('like'))
child_want_pos <- subset(child_emotion_pos, Head %in% c('want'))
parent_like_pos <- subset(parent_emotion_pos, Head %in% c('like'))
parent_want_pos <- subset(parent_emotion_pos, Head %in% c('want'))

child_like_pos_mlu <- mlu(child_like_pos)
child_want_pos_mlu <- mlu(child_want_pos)
parent_like_pos_mlu <- mlu(parent_like_pos)
parent_want_pos_mlu <- mlu(parent_want_pos)


child_like_pos <- data.frame(table(child_like_pos$Age))
names(child_like_pos) <- c("Age", 'Freq')
child_like_pos$Role <- rep('Child', nrow(child_like_pos))
child_like_pos$Head <- rep('like', nrow(child_like_pos))
temp <- merge(child_like_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_like_pos <- temp
child_like_pos$Total_ratio <- child_like_pos$Freq / child_like_pos$N_utterance
child_like_pos$Ratio <- child_like_pos$Freq / sum(child_like_pos$Freq)
child_like_pos$Polarity <- rep('positive', nrow(child_like_pos))
child_like_pos$Measure <- rep('positive ratio', nrow(child_like_pos))
child_like_pos$Which <- rep('ratio', nrow(child_like_pos))
child_like_pos$Function <- rep('Rejection', nrow(child_like_pos))
child_like_pos <- positive_moving(child_like_pos)

child_want_pos <- data.frame(table(child_want_pos$Age))
names(child_want_pos) <- c("Age", 'Freq')
child_want_pos$Role <- rep('Child', nrow(child_want_pos))
child_want_pos$Head <- rep('want', nrow(child_want_pos))
temp <- merge(child_want_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_want_pos <- temp
child_want_pos$Total_ratio <- child_want_pos$Freq / child_want_pos$N_utterance
child_want_pos$Ratio <- child_want_pos$Freq / sum(child_want_pos$Freq)
child_want_pos$Polarity <- rep('positive', nrow(child_want_pos))
child_want_pos$Measure <- rep('positive ratio', nrow(child_want_pos))
child_want_pos$Which <- rep('ratio', nrow(child_want_pos))
child_want_pos$Function <- rep('Rejection', nrow(child_want_pos))
child_want_pos <- positive_moving(child_want_pos)

parent_like_pos <- data.frame(table(parent_like_pos$Age))
names(parent_like_pos) <- c('Age', 'Freq')
parent_like_pos$Role <- rep('Parent', nrow(parent_like_pos))
parent_like_pos$Head <- rep('like', nrow(parent_like_pos))
temp <- merge(parent_like_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_like_pos <- temp
parent_like_pos$Total_ratio <- parent_like_pos$Freq / parent_like_pos$N_utterance
parent_like_pos$Ratio <- parent_like_pos$Freq / sum(parent_like_pos$Freq)
parent_like_pos$Polarity <- rep('positive', nrow(parent_like_pos))
parent_like_pos$Measure <- rep('positive ratio', nrow(parent_like_pos))
parent_like_pos$Which <- rep('ratio', nrow(parent_like_pos))
parent_like_pos$Function <- rep('Rejection', nrow(parent_like_pos))
parent_like_pos <- positive_moving(parent_like_pos)

parent_want_pos <- data.frame(table(parent_want_pos$Age))
names(parent_want_pos) <- c('Age', 'Freq')
parent_want_pos$Role <- rep('Parent', nrow(parent_want_pos))
parent_want_pos$Head <- rep('want', nrow(parent_want_pos))
temp <- merge(parent_want_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_want_pos <- temp
parent_want_pos$Total_ratio <- parent_want_pos$Freq / parent_want_pos$N_utterance
parent_want_pos$Ratio <- parent_want_pos$Freq / sum(parent_want_pos$Freq)
parent_want_pos$Polarity <- rep('positive', nrow(parent_want_pos))
parent_want_pos$Measure <- rep('positive ratio', nrow(parent_want_pos))
parent_want_pos$Which <- rep('ratio', nrow(parent_want_pos))
parent_want_pos$Function <- rep('Rejection', nrow(parent_want_pos))
parent_want_pos <- positive_moving(parent_want_pos)

emotion_data <- rbind(child_like_neg, child_like_pos, parent_like_neg, parent_like_pos, child_want_neg, child_want_pos, parent_want_neg, parent_want_pos)

emotion_data$Measure <- factor(emotion_data$Measure, levels = c('negative ratio', 'negative moving ratio', 'positive ratio', 'positive moving ratio'))

emotion_data_child <- subset(emotion_data, Role == 'Child')
emotion_data_parent <- subset(emotion_data, Role == 'Parent')

```

```{r emotion, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7.8, fig.height=4.5, set.cap.width=T, num.cols.cap=1, fig.cap = "Rejection" }


emotion_data %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(log(Total_ratio), 2), group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("grey", "mediumpurple4", "bisque2", "steelblue")) + #"peru", 
#  geom_line(linetype = c('dotted', 'solid')) +
#  geom_line(aes(color = Polarity, linetype = 'dotted', size = 1)) + 
  facet_grid(Head ~ Role) +
#  facet_grid(vars(Head)) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=10, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)") + 
#  ggtitle('Parent') +
  ylim(-9.5, -2.5) +
  theme(text = element_text(size=15))

```

```{r emotion_model, include=FALSE}


child_like_neg_Model <- merge(child_like_neg_mlu, subset(child_like_neg, Measure == 'negative moving ratio'))

child_want_neg_Model <- merge(child_want_neg_mlu, subset(child_want_neg, Measure == 'negative moving ratio'))

parent_like_neg_Model <- merge(parent_like_neg_mlu, subset(parent_like_neg, Measure == 'negative moving ratio'))

parent_want_neg_Model <- merge(parent_want_neg_mlu, subset(parent_want_neg, Measure == 'negative moving ratio'))

child_like_pos_Model <- merge(child_like_pos_mlu, subset(child_like_pos, Measure == 'positive moving ratio'))

child_want_pos_Model <- merge(child_want_pos_mlu, subset(child_want_pos, Measure == 'positive moving ratio'))

parent_like_pos_Model <- merge(parent_like_pos_mlu, subset(parent_like_pos, Measure == 'positive moving ratio'))

parent_want_pos_Model <- merge(parent_want_pos_mlu, subset(parent_want_pos, Measure == 'positive moving ratio'))

temp1<-data.frame(parent_like_neg_Model$Age)
names(temp1) <- c('Age')
temp1$Parent_negative_ratio <- parent_like_neg_Model$Total_ratio
temp1$Parent_negative_MLU <- parent_like_neg_Model$MLU

temp2<-data.frame(parent_like_pos_Model$Age)
names(temp2) <- c('Age')
temp2$Parent_positive_ratio <- parent_like_pos_Model$Total_ratio
temp2$Parent_positive_MLU <- parent_like_pos_Model$MLU

temp <- merge(temp1, temp2, by.x = 'Age', all.x = TRUE)

child_like_neg_Model <- merge(child_like_neg_Model, temp, by.x = 'Age', all.x = TRUE)
child_like_pos_Model <- merge(child_like_pos_Model, temp, by.x = 'Age', all.x = TRUE)

child_like_neg_m1 <- glm(log(Total_ratio) ~ Age + MLU, data = child_like_neg_Model)

child_like_neg_m2 <- glm(log(Total_ratio) ~ Age + MLU + log(Parent_negative_ratio) + log(Parent_positive_ratio) + Parent_negative_MLU + Parent_positive_MLU, data = child_like_neg_Model)

child_like_pos_m2 <- glm(log(Total_ratio) ~ Age + MLU + log(Parent_negative_ratio) + log(Parent_positive_ratio) + Parent_negative_MLU + Parent_positive_MLU, data = child_like_pos_Model)

temp1<-data.frame(parent_want_neg_Model$Age)
names(temp1) <- c('Age')
temp1$Parent_negative_ratio <- parent_want_neg_Model$Total_ratio
temp1$Parent_negative_MLU <- parent_want_neg_Model$MLU

temp2<-data.frame(parent_want_pos_Model$Age)
names(temp2) <- c('Age')
temp2$Parent_positive_ratio <- parent_want_pos_Model$Total_ratio
temp2$Parent_positive_MLU <- parent_want_pos_Model$MLU

temp <- merge(temp1, temp2, by.x = 'Age', all.x = TRUE)

child_want_neg_Model <- merge(child_want_neg_Model, temp, by.x = 'Age', all.x = TRUE)
child_want_pos_Model <- merge(child_want_pos_Model, temp, by.x = 'Age', all.x = TRUE)

child_want_neg_m1 <- glm(log(Total_ratio) ~ Age + MLU, data = child_want_neg_Model)

child_want_neg_m2 <- glm(log(Total_ratio) ~ Age + MLU + log(Parent_negative_ratio) + log(Parent_positive_ratio) + Parent_negative_MLU + Parent_positive_MLU, data = child_want_neg_Model)

child_want_pos_m2 <- glm(log(Total_ratio) ~ Age + MLU + log(Parent_negative_ratio) + log(Parent_positive_ratio) + Parent_negative_MLU + Parent_positive_MLU, data = child_want_pos_Model)

```

For both negative and positive:

Model: Production ratio ~ Age + MLU + Parent_negative_ratio + Parent_Positive_ratio + Parent_negative_MLU + Parent_positive_MLU

```{r echo = FALSE, results = 'asis'}

child_like_neg_m2 %>%
tidy() %>%
   mutate(
    p.value = scales::pvalue(p.value),
    term = c("Intercept", "Age", "MLU", "log(Parent_negative_ratio)", "log(Parent_positive_ratio)", "Parent_negative_MLU ", "Parent_positive_MLU")
  ) %>%
  kable(
    caption = "Estimating Production Ratio of Rejection in Child Speech, when head verb is like",
    col.names = c("Predictor", "B", "SE", "t", "p"),
    digits = c(0, 2, 3, 2, 3)
  )

child_like_pos_m2 %>%
tidy() %>%
   mutate(
    p.value = scales::pvalue(p.value),
    term = c("Intercept", "Age", "MLU", "log(Parent_negative_ratio)", "log(Parent_positive_ratio)", "Parent_negative_MLU ", "Parent_positive_MLU")
  ) %>%
  kable(
    caption = "Estimating Production Ratio of Positive Counterparts for Rejection in Child Speech, when head verb is like",
    col.names = c("Predictor", "B", "SE", "t", "p"),
    digits = c(0, 2, 3, 2, 3)
  )

```

\clearpage

```{r echo = FALSE, results = 'asis'}

child_want_neg_m2 %>%
tidy() %>%
   mutate(
    p.value = scales::pvalue(p.value),
    term = c("Intercept", "Age", "MLU", "log(Parent_negative_ratio)", "log(Parent_positive_ratio)", "Parent_negative_MLU ", "Parent_positive_MLU")
  ) %>%
  kable(
    caption = "Estimating Production Ratio of Rejection in Child Speech, when head verb is want",
    col.names = c("Predictor", "B", "SE", "t", "p"),
    digits = c(0, 2, 3, 2, 3)
  )

child_want_pos_m2 %>%
tidy() %>%
   mutate(
    p.value = scales::pvalue(p.value),
    term = c("Intercept", "Age", "MLU", "log(Parent_negative_ratio)", "log(Parent_positive_ratio)", "Parent_negative_MLU ", "Parent_positive_MLU")
  ) %>%
  kable(
    caption = "Estimating Production Ratio of Positive Counterparts for Rejection in Child Speech, when head verb is want",
    col.names = c("Predictor", "B", "SE", "t", "p"),
    digits = c(0, 2, 3, 2, 3)
  )

```


\clearpage

### Non-existence

```{r perceptiondata, include=FALSE}

perception <-read.csv('data/diaparse/perception.txt', header = T, sep = '\t')
# perception <- subset(perception, Subj == 'I' | Subj == 'NONE')
perception$Role[which(perception$Role == "Father")] <- 'Parent'
perception$Role[which(perception$Role == "Mother")] <- 'Parent'
perception$Role[which(perception$Role == "Target_Child")] <- 'Child'

perception_neg = subset(perception, Polarity == 'negative')
perception_pos = subset(perception, Polarity == 'positive')

child_perception_neg <- subset(perception_neg, Role %in% c('Child'))
parent_perception_neg <- subset(perception_neg, Role %in% c('Parent'))

child_existence_neg <- subset(child_perception_neg, Function %in% c('existence'))
child_possession_have_neg <- subset(child_perception_neg, Function %in% c('possession') & Head %in% c('have'))
child_possession_pro_neg <- subset(child_perception_neg, Function %in% c('possession') & Head != 'have')
parent_existence_neg <- subset(parent_perception_neg, Function %in% c('existence'))
parent_possession_have_neg <- subset(parent_perception_neg, Function %in% c('possession') & Head %in% c('have'))
parent_possession_pro_neg <- subset(parent_perception_neg, Function %in% c('possession') & Head != 'have')

child_existence_neg_mlu <- mlu(child_existence_neg)
child_possession_have_neg_mlu <- mlu(child_possession_have_neg)
child_possession_pro_neg_mlu <- mlu(child_possession_pro_neg)
parent_existence_neg_mlu <- mlu(parent_existence_neg)
parent_possession_have_neg_mlu <- mlu(parent_possession_have_neg)
parent_possession_pro_neg_mlu <- mlu(parent_possession_pro_neg)

child_existence_neg <- data.frame(table(child_existence_neg$Age))
names(child_existence_neg) <- c('Age', 'Freq')
child_existence_neg$Role <- rep('Child', nrow(child_existence_neg))
child_existence_neg$Head <- rep('', nrow(child_existence_neg))
temp <- merge(child_existence_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_existence_neg <- temp
child_existence_neg$Total_ratio <- child_existence_neg$Freq / child_existence_neg$N_utterance
child_existence_neg$Ratio <- child_existence_neg$Freq / sum(child_existence_neg$Freq)
child_existence_neg$Polarity <- rep('negative', nrow(child_existence_neg))
child_existence_neg$Measure <- rep('negative ratio', nrow(child_existence_neg))
child_existence_neg$Which <- rep('ratio', nrow(child_existence_neg))
child_existence_neg$Function <- rep('Existence', nrow(child_existence_neg))
child_existence_neg <- negative_moving(child_existence_neg)


child_possession_have_neg <- data.frame(table(child_possession_have_neg$Age))
names(child_possession_have_neg) <- c('Age', 'Freq')
child_possession_have_neg$Role <- rep('Child', nrow(child_possession_have_neg))
child_possession_have_neg$Head <- rep('have', nrow(child_possession_have_neg))
temp <- merge(child_possession_have_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_possession_have_neg <- temp
child_possession_have_neg$Total_ratio <- child_possession_have_neg$Freq / child_possession_have_neg$N_utterance
child_possession_have_neg$Ratio <- child_possession_have_neg$Freq / sum(child_possession_have_neg$Freq)
child_possession_have_neg$Polarity <- rep('negative', nrow(child_possession_have_neg))
child_possession_have_neg$Measure <- rep('negative ratio', nrow(child_possession_have_neg))
child_possession_have_neg$Which <- rep('ratio', nrow(child_possession_have_neg))
child_possession_have_neg$Function <- rep('Possession', nrow(child_possession_have_neg))
child_possession_have_neg <- negative_moving(child_possession_have_neg)

child_possession_pro_neg <- data.frame(table(child_possession_pro_neg$Age))
names(child_possession_pro_neg) <- c('Age', 'Freq')
child_possession_pro_neg$Role <- rep('Child', nrow(child_possession_pro_neg))
child_possession_pro_neg$Head <- rep('pronoun', nrow(child_possession_pro_neg))
temp <- merge(child_possession_pro_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_possession_pro_neg <- temp
child_possession_pro_neg$Total_ratio <- child_possession_pro_neg$Freq / child_possession_pro_neg$N_utterance
child_possession_pro_neg$Ratio <- child_possession_pro_neg$Freq / sum(child_possession_pro_neg$Freq)
child_possession_pro_neg$Polarity <- rep('negative', nrow(child_possession_pro_neg))
child_possession_pro_neg$Measure <- rep('negative ratio', nrow(child_possession_pro_neg))
child_possession_pro_neg$Which <- rep('ratio', nrow(child_possession_pro_neg))
child_possession_pro_neg$Function <- rep('Possession', nrow(child_possession_pro_neg))
child_possession_pro_neg <- negative_moving(child_possession_pro_neg)

parent_existence_neg <- data.frame(table(parent_existence_neg$Age))
names(parent_existence_neg) <- c('Age', 'Freq')
parent_existence_neg$Role <- rep('Parent', nrow(parent_existence_neg))
parent_existence_neg$Head <- rep('existence', nrow(parent_existence_neg))
temp <- merge(parent_existence_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_existence_neg <- temp
parent_existence_neg$Total_ratio <- parent_existence_neg$Freq / parent_existence_neg$N_utterance
parent_existence_neg$Ratio <- parent_existence_neg$Freq / sum(parent_existence_neg$Freq)
parent_existence_neg$Polarity <- rep('negative', nrow(parent_existence_neg))
parent_existence_neg$Measure <- rep('negative ratio', nrow(parent_existence_neg))
parent_existence_neg$Which <- rep('ratio', nrow(parent_existence_neg))
parent_existence_neg$Function <- rep('Existence', nrow(parent_existence_neg))
parent_existence_neg <- negative_moving(parent_existence_neg)

parent_possession_have_neg <- data.frame(table(parent_possession_have_neg$Age))
names(parent_possession_have_neg) <- c('Age', 'Freq')
parent_possession_have_neg$Role <- rep('Parent', nrow(parent_possession_have_neg))
parent_possession_have_neg$Head <- rep('have', nrow(parent_possession_have_neg))
temp <- merge(parent_possession_have_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_possession_have_neg <- temp
parent_possession_have_neg$Total_ratio <- parent_possession_have_neg$Freq / parent_possession_have_neg$N_utterance
parent_possession_have_neg$Ratio <- parent_possession_have_neg$Freq / sum(parent_possession_have_neg$Freq)
parent_possession_have_neg$Polarity <- rep('negative', nrow(parent_possession_have_neg))
parent_possession_have_neg$Measure <- rep('negative ratio', nrow(parent_possession_have_neg))
parent_possession_have_neg$Which <- rep('ratio', nrow(parent_possession_have_neg))
parent_possession_have_neg$Function <- rep('Possession', nrow(parent_possession_have_neg))
parent_possession_have_neg <- negative_moving(parent_possession_have_neg)

parent_possession_pro_neg <- data.frame(table(parent_possession_pro_neg$Age))
names(parent_possession_pro_neg) <- c('Age', 'Freq')
parent_possession_pro_neg$Role <- rep('Parent', nrow(parent_possession_pro_neg))
parent_possession_pro_neg$Head <- rep('pronoun', nrow(parent_possession_pro_neg))
temp <- merge(parent_possession_pro_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_possession_pro_neg <- temp
parent_possession_pro_neg$Total_ratio <- parent_possession_pro_neg$Freq / parent_possession_pro_neg$N_utterance
parent_possession_pro_neg$Ratio <- parent_possession_pro_neg$Freq / sum(parent_possession_pro_neg$Freq)
parent_possession_pro_neg$Polarity <- rep('negative', nrow(parent_possession_pro_neg))
parent_possession_pro_neg$Measure <- rep('negative ratio', nrow(parent_possession_pro_neg))
parent_possession_pro_neg$Which <- rep('ratio', nrow(parent_possession_pro_neg))
parent_possession_pro_neg$Function <- rep('Possession', nrow(parent_possession_pro_neg))
parent_possession_pro_neg <- negative_moving(parent_possession_pro_neg)

child_perception_pos <- subset(perception_pos, Role %in% c('Child'))
parent_perception_pos <- subset(perception_pos, Role %in% c('Parent'))

child_existence_pos <- subset(child_perception_pos, Function %in% c('existence'))
child_possession_have_pos <- subset(child_perception_pos, Function %in% c('possession') & Head %in% c('have'))
child_possession_pro_pos <- subset(child_perception_pos, Function %in% c('possession') & Head != 'have')
parent_existence_pos <- subset(parent_perception_pos, Function %in% c('existence'))
parent_possession_have_pos <- subset(parent_perception_pos, Function %in% c('possession') & Head %in% c('have'))
parent_possession_pro_pos <- subset(parent_perception_pos, Function %in% c('possession') & Head != 'have')

child_existence_pos_mlu <- mlu(child_existence_pos)
child_possession_have_pos_mlu <- mlu(child_possession_have_pos)
child_possession_pro_pos_mlu <- mlu(child_possession_pro_pos)
parent_existence_pos_mlu <- mlu(parent_existence_pos)
parent_possession_have_pos_mlu <- mlu(parent_possession_have_pos)
parent_possession_pro_pos_mlu <- mlu(parent_possession_pro_pos)

child_existence_pos <- data.frame(table(child_existence_pos$Age))
names(child_existence_pos) <- c("Age", 'Freq')
child_existence_pos$Role <- rep('Child', nrow(child_existence_pos))
child_existence_pos$Head <- rep('existence', nrow(child_existence_pos))
temp <- merge(child_existence_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_existence_pos <- temp
child_existence_pos$Total_ratio <- child_existence_pos$Freq / child_existence_pos$N_utterance
child_existence_pos$Ratio <- child_existence_pos$Freq / sum(child_existence_pos$Freq)
child_existence_pos$Polarity <- rep('positive', nrow(child_existence_pos))
child_existence_pos$Measure <- rep('positive ratio', nrow(child_existence_pos))
child_existence_pos$Which <- rep('ratio', nrow(child_existence_pos))
child_existence_pos$Function <- rep('Existence', nrow(child_existence_pos))
child_existence_pos <- positive_moving(child_existence_pos)

child_possession_have_pos <- data.frame(table(child_possession_have_pos$Age))
names(child_possession_have_pos) <- c("Age", 'Freq')
child_possession_have_pos$Role <- rep('Child', nrow(child_possession_have_pos))
child_possession_have_pos$Head <- rep('have', nrow(child_possession_have_pos))
temp <- merge(child_possession_have_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_possession_have_pos <- temp
child_possession_have_pos$Total_ratio <- child_possession_have_pos$Freq / child_possession_have_pos$N_utterance
child_possession_have_pos$Ratio <- child_possession_have_pos$Freq / sum(child_possession_have_pos$Freq)
child_possession_have_pos$Polarity <- rep('positive', nrow(child_possession_have_pos))
child_possession_have_pos$Measure <- rep('positive ratio', nrow(child_possession_have_pos))
child_possession_have_pos$Which <- rep('ratio', nrow(child_possession_have_pos))
child_possession_have_pos$Function <- rep('Possession', nrow(child_possession_have_pos))
child_possession_have_pos <- positive_moving(child_possession_have_pos)

child_possession_pro_pos <- data.frame(table(child_possession_pro_pos$Age))
names(child_possession_pro_pos) <- c("Age", 'Freq')
child_possession_pro_pos$Role <- rep('Child', nrow(child_possession_pro_pos))
child_possession_pro_pos$Head <- rep('pronoun', nrow(child_possession_pro_pos))
temp <- merge(child_possession_pro_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_possession_pro_pos <- temp
child_possession_pro_pos$Total_ratio <- child_possession_pro_pos$Freq / child_possession_pro_pos$N_utterance
child_possession_pro_pos$Ratio <- child_possession_pro_pos$Freq / sum(child_possession_pro_pos$Freq)
child_possession_pro_pos$Polarity <- rep('positive', nrow(child_possession_pro_pos))
child_possession_pro_pos$Measure <- rep('positive ratio', nrow(child_possession_pro_pos))
child_possession_pro_pos$Which <- rep('ratio', nrow(child_possession_pro_pos))
child_possession_pro_pos$Function <- rep('Possession', nrow(child_possession_pro_pos))
child_possession_pro_pos <- positive_moving(child_possession_pro_pos)

parent_existence_pos <- data.frame(table(parent_existence_pos$Age))
names(parent_existence_pos) <- c('Age', 'Freq')
parent_existence_pos$Role <- rep('Parent', nrow(parent_existence_pos))
parent_existence_pos$Head <- rep('existence', nrow(parent_existence_pos))
temp <- merge(parent_existence_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_existence_pos <- temp
parent_existence_pos$Total_ratio <- parent_existence_pos$Freq / parent_existence_pos$N_utterance
parent_existence_pos$Ratio <- parent_existence_pos$Freq / sum(parent_existence_pos$Freq)
parent_existence_pos$Polarity <- rep('positive', nrow(parent_existence_pos))
parent_existence_pos$Measure <- rep('positive ratio', nrow(parent_existence_pos))
parent_existence_pos$Which <- rep('ratio', nrow(parent_existence_pos))
parent_existence_pos$Function <- rep('Existence', nrow(parent_existence_pos))
parent_existence_pos <- positive_moving(parent_existence_pos)

parent_possession_have_pos <- data.frame(table(parent_possession_have_pos$Age))
names(parent_possession_have_pos) <- c("Age", 'Freq')
parent_possession_have_pos$Role <- rep('Parent', nrow(parent_possession_have_pos))
parent_possession_have_pos$Head <- rep('have', nrow(parent_possession_have_pos))
temp <- merge(parent_possession_have_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_possession_have_pos <- temp
parent_possession_have_pos$Total_ratio <- parent_possession_have_pos$Freq / parent_possession_have_pos$N_utterance
parent_possession_have_pos$Ratio <- parent_possession_have_pos$Freq / sum(parent_possession_have_pos$Freq)
parent_possession_have_pos$Polarity <- rep('positive', nrow(parent_possession_have_pos))
parent_possession_have_pos$Measure <- rep('positive ratio', nrow(parent_possession_have_pos))
parent_possession_have_pos$Which <- rep('ratio', nrow(parent_possession_have_pos))
parent_possession_have_pos$Function <- rep('Possession', nrow(parent_possession_have_pos))
parent_possession_have_pos <- positive_moving(parent_possession_have_pos)

parent_possession_pro_pos <- data.frame(table(parent_possession_pro_pos$Age))
names(parent_possession_pro_pos) <- c("Age", 'Freq')
parent_possession_pro_pos$Role <- rep('Parent', nrow(parent_possession_pro_pos))
parent_possession_pro_pos$Head <- rep('pronoun', nrow(parent_possession_pro_pos))
temp <- merge(parent_possession_pro_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_possession_pro_pos <- temp
parent_possession_pro_pos$Total_ratio <- parent_possession_pro_pos$Freq / parent_possession_pro_pos$N_utterance
parent_possession_pro_pos$Ratio <- parent_possession_pro_pos$Freq / sum(parent_possession_pro_pos$Freq)
parent_possession_pro_pos$Polarity <- rep('positive', nrow(parent_possession_pro_pos))
parent_possession_pro_pos$Measure <- rep('positive ratio', nrow(parent_possession_pro_pos))
parent_possession_pro_pos$Which <- rep('ratio', nrow(parent_possession_pro_pos))
parent_possession_pro_pos$Function <- rep('Possession', nrow(parent_possession_pro_pos))
parent_possession_pro_pos <- positive_moving(parent_possession_pro_pos)

perception_data <- rbind(child_existence_neg, child_existence_pos, parent_existence_neg, parent_existence_pos, child_possession_have_neg, child_possession_have_pos, parent_possession_have_neg, parent_possession_have_pos, child_possession_pro_neg, child_possession_pro_pos, parent_possession_pro_neg, parent_possession_pro_pos)

perception_data$Measure <- factor(perception_data$Measure, levels = c('negative ratio', 'negative moving ratio', 'positive ratio', 'positive moving ratio'))

perception_data_child <- subset(perception_data, Role == 'Child')
perception_data_parent <- subset(perception_data, Role == 'Parent')

existence_data <- subset(perception_data, Function == 'Existence')
possession_data <- subset(perception_data, Function == 'Possession')

```



```{r existence, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7.8, fig.height=3.5, set.cap.width=T, num.cols.cap=1, fig.cap = "Non-existence" }

existence_data %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(log(Total_ratio), 2), group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("grey", "mediumpurple4", "bisque2", "steelblue")) + #"peru", 
#  geom_line(linetype = c('dotted', 'solid')) +
#  geom_line(aes(color = Polarity, linetype = 'dotted', size = 1)) + 
  facet_grid( ~ Role) +
#  facet_grid(vars(Head)) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=10, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)") + 
#  ggtitle('Parent') +
  ylim(-11, -4) +
  theme(text = element_text(size=15))

```


```{r nonexistence_model, include=FALSE}

child_existence_neg_Model <- merge(child_existence_neg_mlu, subset(child_existence_neg, Measure == 'negative moving ratio'))

child_possession_have_neg_Model <- merge(child_possession_have_neg_mlu, subset(child_possession_have_neg, Measure == 'negative moving ratio'))

child_possession_pro_neg_Model <- merge(child_possession_pro_neg_mlu, subset(child_possession_pro_neg, Measure == 'negative moving ratio'))

parent_existence_neg_Model <- merge(parent_existence_neg_mlu, subset(parent_existence_neg, Measure == 'negative moving ratio'))

parent_possession_have_neg_Model <- merge(parent_possession_have_neg_mlu, subset(parent_possession_have_neg, Measure == 'negative moving ratio'))

parent_possession_pro_neg_Model <- merge(parent_possession_pro_neg_mlu, subset(parent_possession_pro_neg, Measure == 'negative moving ratio'))

child_existence_pos_Model <- merge(child_existence_pos_mlu, subset(child_existence_pos, Measure == 'positive moving ratio'))

child_possession_have_pos_Model <- merge(child_possession_have_pos_mlu, subset(child_possession_have_pos, Measure == 'positive moving ratio'))

child_possession_pro_pos_Model <- merge(child_possession_pro_pos_mlu, subset(child_possession_pro_pos, Measure == 'positive moving ratio'))

parent_existence_pos_Model <- merge(parent_existence_pos_mlu, subset(parent_existence_pos, Measure == 'positive moving ratio'))

parent_possession_have_pos_Model <- merge(parent_possession_have_pos_mlu, subset(parent_possession_have_pos, Measure == 'positive moving ratio'))

parent_possession_pro_pos_Model <- merge(parent_possession_pro_pos_mlu, subset(parent_possession_pro_pos, Measure == 'positive moving ratio'))

temp1<-data.frame(parent_existence_neg_Model$Age)
names(temp1) <- c('Age')
temp1$Parent_negative_ratio <- parent_existence_neg_Model$Total_ratio
temp1$Parent_negative_MLU <- parent_existence_neg_Model$MLU

temp2<-data.frame(parent_existence_pos_Model$Age)
names(temp2) <- c('Age')
temp2$Parent_positive_ratio <- parent_existence_pos_Model$Total_ratio
temp2$Parent_positive_MLU <- parent_existence_pos_Model$MLU

temp <- merge(temp1, temp2, by.x = 'Age', all.x = TRUE)

child_existence_neg_Model <- merge(child_existence_neg_Model, temp, by.x = 'Age', all.x = TRUE)
child_existence_pos_Model <- merge(child_existence_pos_Model, temp, by.x = 'Age', all.x = TRUE)

child_existence_neg_m1 <- glm(log(Total_ratio) ~ Age + MLU, data = child_existence_neg_Model)

child_existence_neg_m2 <- glm(log(Total_ratio) ~ Age + MLU + log(Parent_negative_ratio) + log(Parent_positive_ratio) + Parent_negative_MLU + Parent_positive_MLU, data = child_existence_neg_Model)

child_existence_pos_m2 <- glm(log(Total_ratio) ~ Age + MLU + log(Parent_negative_ratio) + log(Parent_positive_ratio) + Parent_negative_MLU + Parent_positive_MLU, data = child_existence_pos_Model)

temp1<-data.frame(parent_possession_have_neg_Model$Age)
names(temp1) <- c('Age')
temp1$Parent_negative_ratio <- parent_possession_have_neg_Model$Total_ratio
temp1$Parent_negative_MLU <- parent_possession_have_neg_Model$MLU

temp2<-data.frame(parent_possession_have_pos_Model$Age)
names(temp2) <- c('Age')
temp2$Parent_positive_ratio <- parent_possession_have_pos_Model$Total_ratio
temp2$Parent_positive_MLU <- parent_possession_have_pos_Model$MLU

temp <- merge(temp1, temp2, by.x = 'Age', all.x = TRUE)

child_possession_have_neg_Model <- merge(child_possession_have_neg_Model, temp, by.x = 'Age', all.x = TRUE)
child_possession_have_pos_Model <- merge(child_possession_have_pos_Model, temp, by.x = 'Age', all.x = TRUE)

child_possession_have_neg_m1 <- glm(log(Total_ratio) ~ Age + MLU, data = child_possession_have_neg_Model)

child_possession_have_neg_m2 <- glm(log(Total_ratio) ~ Age + MLU + log(Parent_negative_ratio) + log(Parent_positive_ratio) + Parent_negative_MLU + Parent_positive_MLU, data = child_possession_have_neg_Model)

child_possession_have_pos_m2 <- glm(log(Total_ratio) ~ Age + MLU + log(Parent_negative_ratio) + log(Parent_positive_ratio) + Parent_negative_MLU + Parent_positive_MLU, data = child_possession_have_pos_Model)

temp1<-data.frame(parent_possession_pro_neg_Model$Age)
names(temp1) <- c('Age')
temp1$Parent_negative_ratio <- parent_possession_pro_neg_Model$Total_ratio
temp1$Parent_negative_MLU <- parent_possession_pro_neg_Model$MLU

temp2<-data.frame(parent_possession_pro_pos_Model$Age)
names(temp2) <- c('Age')
temp2$Parent_positive_ratio <- parent_possession_pro_pos_Model$Total_ratio
temp2$Parent_positive_MLU <- parent_possession_pro_pos_Model$MLU

temp <- merge(temp1, temp2, by.x = 'Age', all.x = TRUE)

child_possession_pro_neg_Model <- merge(child_possession_pro_neg_Model, temp, by.x = 'Age', all.x = TRUE)
child_possession_pro_pos_Model <- merge(child_possession_pro_pos_Model, temp, by.x = 'Age', all.x = TRUE)

child_possession_pro_neg_m1 <- glm(log(Total_ratio) ~ Age + MLU, data = child_possession_pro_neg_Model)

child_possession_pro_neg_m2 <- glm(log(Total_ratio) ~ Age + MLU + log(Parent_negative_ratio) + log(Parent_positive_ratio) + Parent_negative_MLU + Parent_positive_MLU, data = child_possession_pro_neg_Model)

child_possession_pro_pos_m2 <- glm(log(Total_ratio) ~ Age + MLU + log(Parent_negative_ratio) + log(Parent_positive_ratio) + Parent_negative_MLU + Parent_positive_MLU, data = child_possession_pro_pos_Model)

```

\clearpage

```{r echo = FALSE, results = 'asis'}

child_existence_neg_m2 %>%
tidy() %>%
   mutate(
    p.value = scales::pvalue(p.value),
    term = c("Intercept", "Age", "MLU", "log(Parent_negative_ratio)", "log(Parent_positive_ratio)", "Parent_negative_MLU ", "Parent_positive_MLU")
  ) %>%
  kable(
    caption = "Estimating Production Ratio of Non-existence in Child Speech",
    col.names = c("Predictor", "B", "SE", "t", "p"),
    digits = c(0, 2, 3, 2, 3)
  )

child_existence_pos_m2 %>%
tidy() %>%
   mutate(
    p.value = scales::pvalue(p.value),
    term = c("Intercept", "Age", "MLU", "log(Parent_negative_ratio)", "log(Parent_positive_ratio)", "Parent_negative_MLU ", "Parent_positive_MLU")
  ) %>%
  kable(
    caption = "Estimating Production Ratio of Positive Counterparts for Non-existence in Child Speech",
    col.names = c("Predictor", "B", "SE", "t", "p"),
    digits = c(0, 2, 3, 2, 3)
  )


```


\clearpage

### Prohibition


```{r motordata, include=FALSE}

motor <-read.csv('data/diaparse/motor.txt', header = T, sep = '\t')
# motor <- subset(motor, Subj == 'I' | Subj == 'NONE')
motor$Role[which(motor$Role == "Father")] <- 'Parent'
motor$Role[which(motor$Role == "Mother")] <- 'Parent'
motor$Role[which(motor$Role == "Target_Child")] <- 'Child'

motor_neg = subset(motor, Polarity == 'negative')
motor_pos = subset(motor, Polarity == 'positive')

child_motor_neg <- subset(motor_neg, Role %in% c('Child'))
parent_motor_neg <- subset(motor_neg, Role %in% c('Parent'))

child_prohibition_neg <- subset(child_motor_neg, Function %in% c('prohibition'))
child_inability_neg <- subset(child_motor_neg, Function %in% c('inability') & Subj %in% c('I', 'i'))
parent_prohibition_neg <- subset(parent_motor_neg, Function %in% c('prohibition'))
parent_inability_neg <- subset(parent_motor_neg, Function %in% c('inability') & Subj %in% c('I', 'i'))

child_prohibition_neg_mlu <- mlu(child_prohibition_neg)
child_inability_neg_mlu <- mlu(child_inability_neg)
parent_prohibition_neg_mlu <- mlu(parent_prohibition_neg)
parent_inability_neg_mlu <- mlu(parent_inability_neg)

child_prohibition_neg <- data.frame(table(child_prohibition_neg$Age))
names(child_prohibition_neg) <- c('Age', 'Freq')
child_prohibition_neg$Role <- rep('Child', nrow(child_prohibition_neg))
child_prohibition_neg$Head <- rep('', nrow(child_prohibition_neg))
temp <- merge(child_prohibition_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_prohibition_neg <- temp
child_prohibition_neg$Total_ratio <- child_prohibition_neg$Freq / child_prohibition_neg$N_utterance
child_prohibition_neg$Ratio <- child_prohibition_neg$Freq / sum(child_prohibition_neg$Freq)
child_prohibition_neg$Polarity <- rep('negative', nrow(child_prohibition_neg))
child_prohibition_neg$Measure <- rep('negative ratio', nrow(child_prohibition_neg))
child_prohibition_neg$Which <- rep('ratio', nrow(child_prohibition_neg))
child_prohibition_neg$Function <- rep('Prohibition', nrow(child_prohibition_neg))
child_prohibition_neg <- negative_moving(child_prohibition_neg)


child_inability_neg <- data.frame(table(child_inability_neg$Age))
names(child_inability_neg) <- c('Age', 'Freq')
child_inability_neg$Role <- rep('Child', nrow(child_inability_neg))
child_inability_neg$Head <- rep('', nrow(child_inability_neg))
temp <- merge(child_inability_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_inability_neg <- temp
child_inability_neg$Total_ratio <- child_inability_neg$Freq / child_inability_neg$N_utterance
child_inability_neg$Ratio <- child_inability_neg$Freq / sum(child_inability_neg$Freq)
child_inability_neg$Polarity <- rep('negative', nrow(child_inability_neg))
child_inability_neg$Measure <- rep('negative ratio', nrow(child_inability_neg))
child_inability_neg$Which <- rep('ratio', nrow(child_inability_neg))
child_inability_neg$Function <- rep('Inability', nrow(child_inability_neg))
child_inability_neg <- negative_moving(child_inability_neg)


parent_prohibition_neg <- data.frame(table(parent_prohibition_neg$Age))
names(parent_prohibition_neg) <- c('Age', 'Freq')
parent_prohibition_neg$Role <- rep('Parent', nrow(parent_prohibition_neg))
parent_prohibition_neg$Head <- rep('', nrow(parent_prohibition_neg))
temp <- merge(parent_prohibition_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_prohibition_neg <- temp
parent_prohibition_neg$Total_ratio <- parent_prohibition_neg$Freq / parent_prohibition_neg$N_utterance
parent_prohibition_neg$Ratio <- parent_prohibition_neg$Freq / sum(parent_prohibition_neg$Freq)
parent_prohibition_neg$Polarity <- rep('negative', nrow(parent_prohibition_neg))
parent_prohibition_neg$Measure <- rep('negative ratio', nrow(parent_prohibition_neg))
parent_prohibition_neg$Which <- rep('ratio', nrow(parent_prohibition_neg))
parent_prohibition_neg$Function <- rep('Prohibition', nrow(parent_prohibition_neg))
parent_prohibition_neg <- negative_moving(parent_prohibition_neg)

parent_inability_neg <- data.frame(table(parent_inability_neg$Age))
names(parent_inability_neg) <- c('Age', 'Freq')
parent_inability_neg$Role <- rep('Parent', nrow(parent_inability_neg))
parent_inability_neg$Head <- rep('', nrow(parent_inability_neg))
temp <- merge(parent_inability_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_inability_neg <- temp
parent_inability_neg$Total_ratio <- parent_inability_neg$Freq / parent_inability_neg$N_utterance
parent_inability_neg$Ratio <- parent_inability_neg$Freq / sum(parent_inability_neg$Freq)
parent_inability_neg$Polarity <- rep('negative', nrow(parent_inability_neg))
parent_inability_neg$Measure <- rep('negative ratio', nrow(parent_inability_neg))
parent_inability_neg$Which <- rep('ratio', nrow(parent_inability_neg))
parent_inability_neg$Function <- rep('Inability', nrow(parent_inability_neg))
parent_inability_neg <- negative_moving(parent_inability_neg)


child_motor_pos <- subset(motor_pos, Role %in% c('Child'))
parent_motor_pos <- subset(motor_pos, Role %in% c('Parent'))

child_prohibition_pos <- subset(child_motor_pos, Function %in% c('prohibition'))
child_inability_pos <- subset(child_motor_pos, Function %in% c('inability') & Subj %in% c('I', 'i'))
parent_prohibition_pos <- subset(parent_motor_pos, Function %in% c('prohibition'))
parent_inability_pos <- subset(parent_motor_pos, Function %in% c('inability') & Subj %in% c('I', 'i'))

child_prohibition_pos_mlu <- mlu(child_prohibition_pos)
child_inability_pos_mlu <- mlu(child_inability_pos)
parent_prohibition_pos_mlu <- mlu(parent_prohibition_pos)
parent_inability_pos_mlu <- mlu(parent_inability_pos)

child_prohibition_pos <- data.frame(table(child_prohibition_pos$Age))
names(child_prohibition_pos) <- c("Age", 'Freq')
child_prohibition_pos$Role <- rep('Child', nrow(child_prohibition_pos))
child_prohibition_pos$Head <- rep('', nrow(child_prohibition_pos))
temp <- merge(child_prohibition_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_prohibition_pos <- temp
child_prohibition_pos$Total_ratio <- child_prohibition_pos$Freq / child_prohibition_pos$N_utterance
child_prohibition_pos$Ratio <- child_prohibition_pos$Freq / sum(child_prohibition_pos$Freq)
child_prohibition_pos$Polarity <- rep('positive', nrow(child_prohibition_pos))
child_prohibition_pos$Measure <- rep('positive ratio', nrow(child_prohibition_pos))
child_prohibition_pos$Which <- rep('ratio', nrow(child_prohibition_pos))
child_prohibition_pos$Function <- rep('Prohibition', nrow(child_prohibition_pos))
child_prohibition_pos <- positive_moving(child_prohibition_pos)

child_inability_pos <- data.frame(table(child_inability_pos$Age))
names(child_inability_pos) <- c("Age", 'Freq')
child_inability_pos$Role <- rep('Child', nrow(child_inability_pos))
child_inability_pos$Head <- rep('', nrow(child_inability_pos))
temp <- merge(child_inability_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_inability_pos <- temp
child_inability_pos$Total_ratio <- child_inability_pos$Freq / child_inability_pos$N_utterance
child_inability_pos$Ratio <- child_inability_pos$Freq / sum(child_inability_pos$Freq)
child_inability_pos$Polarity <- rep('positive', nrow(child_inability_pos))
child_inability_pos$Measure <- rep('positive ratio', nrow(child_inability_pos))
child_inability_pos$Which <- rep('ratio', nrow(child_inability_pos))
child_inability_pos$Function <- rep('Inability', nrow(child_inability_pos))
child_inability_pos <- positive_moving(child_inability_pos)


parent_prohibition_pos <- data.frame(table(parent_prohibition_pos$Age))
names(parent_prohibition_pos) <- c('Age', 'Freq')
parent_prohibition_pos$Role <- rep('Parent', nrow(parent_prohibition_pos))
parent_prohibition_pos$Head <- rep('', nrow(parent_prohibition_pos))
temp <- merge(parent_prohibition_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_prohibition_pos <- temp
parent_prohibition_pos$Total_ratio <- parent_prohibition_pos$Freq / parent_prohibition_pos$N_utterance
parent_prohibition_pos$Ratio <- parent_prohibition_pos$Freq / sum(parent_prohibition_pos$Freq)
parent_prohibition_pos$Polarity <- rep('positive', nrow(parent_prohibition_pos))
parent_prohibition_pos$Measure <- rep('positive ratio', nrow(parent_prohibition_pos))
parent_prohibition_pos$Which <- rep('ratio', nrow(parent_prohibition_pos))
parent_prohibition_pos$Function <- rep('Prohibition', nrow(parent_prohibition_pos))
parent_prohibition_pos <- positive_moving(parent_prohibition_pos)

parent_inability_pos <- data.frame(table(parent_inability_pos$Age))
names(parent_inability_pos) <- c("Age", 'Freq')
parent_inability_pos$Role <- rep('Parent', nrow(parent_inability_pos))
parent_inability_pos$Head <- rep('', nrow(parent_inability_pos))
temp <- merge(parent_inability_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_inability_pos <- temp
parent_inability_pos$Total_ratio <- parent_inability_pos$Freq / parent_inability_pos$N_utterance
parent_inability_pos$Ratio <- parent_inability_pos$Freq / sum(parent_inability_pos$Freq)
parent_inability_pos$Polarity <- rep('positive', nrow(parent_inability_pos))
parent_inability_pos$Measure <- rep('positive ratio', nrow(parent_inability_pos))
parent_inability_pos$Which <- rep('ratio', nrow(parent_inability_pos))
parent_inability_pos$Function <- rep('Inability', nrow(parent_inability_pos))
parent_inability_pos <- positive_moving(parent_inability_pos)


motor_data <- rbind(child_prohibition_neg, child_prohibition_pos, parent_prohibition_neg, parent_prohibition_pos, child_inability_neg, child_inability_pos, parent_inability_neg, parent_inability_pos)

motor_data$Measure <- factor(motor_data$Measure, levels = c('negative ratio', 'negative moving ratio', 'positive ratio', 'positive moving ratio'))

motor_data_child <- subset(motor_data, Role == 'Child')
motor_data_parent <- subset(motor_data, Role == 'Parent')

prohibition_data <- subset(motor_data, Function == 'prohibition')
inability_data <- subset(motor_data, Function == 'inability')


```


```{r prohibition, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7.8, fig.height=3.5, set.cap.width=T, num.cols.cap=1, fig.cap = "Prohibition" }

prohibition_data %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(log(Total_ratio), 2), group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("grey", "mediumpurple4", "bisque2", "steelblue")) + #"peru", 
#  geom_line(linetype = c('dotted', 'solid')) +
#  geom_line(aes(color = Polarity, linetype = 'dotted', size = 1)) + 
  facet_grid( ~ Role) +
#  facet_grid(vars(Head)) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=10, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)") + 
#  ggtitle('Parent') +
  ylim(-11, -2) +
  theme(text = element_text(size=15))

```


```{r prohibition_model, include=FALSE}

child_prohibition_neg_Model <- merge(child_prohibition_neg_mlu, subset(child_prohibition_neg, Measure == 'negative moving ratio'))

child_inability_neg_Model <- merge(child_inability_neg_mlu, subset(child_inability_neg, Measure == 'negative moving ratio'))

parent_prohibition_neg_Model <- merge(parent_prohibition_neg_mlu, subset(parent_prohibition_neg, Measure == 'negative moving ratio'))

parent_inability_neg_Model <- merge(parent_inability_neg_mlu, subset(parent_inability_neg, Measure == 'negative moving ratio'))

child_prohibition_pos_Model <- merge(child_prohibition_pos_mlu, subset(child_prohibition_pos, Measure == 'positive moving ratio'))

child_inability_pos_Model <- merge(child_inability_pos_mlu, subset(child_inability_pos, Measure == 'positive moving ratio'))

parent_prohibition_pos_Model <- merge(parent_prohibition_pos_mlu, subset(parent_prohibition_pos, Measure == 'positive moving ratio'))

parent_inability_pos_Model <- merge(parent_inability_pos_mlu, subset(parent_inability_pos, Measure == 'positive moving ratio'))

temp1<-data.frame(parent_prohibition_neg_Model$Age)
names(temp1) <- c('Age')
temp1$Parent_negative_ratio <- parent_prohibition_neg_Model$Total_ratio
temp1$Parent_negative_MLU <- parent_prohibition_neg_Model$MLU

temp2<-data.frame(parent_prohibition_pos_Model$Age)
names(temp2) <- c('Age')
temp2$Parent_positive_ratio <- parent_prohibition_pos_Model$Total_ratio
temp2$Parent_positive_MLU <- parent_prohibition_pos_Model$MLU

temp <- merge(temp1, temp2, by.x = 'Age', all.x = TRUE)

child_prohibition_neg_Model <- merge(child_prohibition_neg_Model, temp, by.x = 'Age', all.x = TRUE)
child_prohibition_pos_Model <- merge(child_prohibition_pos_Model, temp, by.x = 'Age', all.x = TRUE)

child_prohibition_neg_m1 <- glm(log(Total_ratio) ~ Age + MLU, data = child_prohibition_neg_Model)

child_prohibition_neg_m2 <- glm(log(Total_ratio) ~ Age + MLU + log(Parent_negative_ratio) + log(Parent_positive_ratio) + Parent_negative_MLU + Parent_positive_MLU, data = child_prohibition_neg_Model)

child_prohibition_pos_m2 <- glm(log(Total_ratio) ~ Age + MLU + log(Parent_negative_ratio) + log(Parent_positive_ratio) + Parent_negative_MLU + Parent_positive_MLU, data = child_prohibition_pos_Model)

temp1<-data.frame(parent_inability_neg_Model$Age)
names(temp1) <- c('Age')
temp1$Parent_negative_ratio <- parent_inability_neg_Model$Total_ratio
temp1$Parent_negative_MLU <- parent_inability_neg_Model$MLU

temp2<-data.frame(parent_inability_pos_Model$Age)
names(temp2) <- c('Age')
temp2$Parent_positive_ratio <- parent_inability_pos_Model$Total_ratio
temp2$Parent_positive_MLU <- parent_inability_pos_Model$MLU

temp <- merge(temp1, temp2, by.x = 'Age', all.x = TRUE)

child_inability_neg_Model <- merge(child_inability_neg_Model, temp, by.x = 'Age', all.x = TRUE)
child_inability_pos_Model <- merge(child_inability_pos_Model, temp, by.x = 'Age', all.x = TRUE)

child_inability_neg_m1 <- glm(log(Total_ratio) ~ Age + MLU, data = child_inability_neg_Model)

child_inability_neg_m2 <- glm(log(Total_ratio) ~ Age + MLU + log(Parent_negative_ratio) + log(Parent_positive_ratio) + Parent_negative_MLU + Parent_positive_MLU, data = child_inability_neg_Model)

child_inability_pos_m2 <- glm(log(Total_ratio) ~ Age + MLU + log(Parent_negative_ratio) + log(Parent_positive_ratio) + Parent_negative_MLU + Parent_positive_MLU, data = child_inability_pos_Model)

```

\clearpage

```{r echo = FALSE, results = 'asis'}

child_prohibition_neg_m2 %>%
tidy() %>%
   mutate(
    p.value = scales::pvalue(p.value),
    term = c("Intercept", "Age", "MLU", "log(Parent_negative_ratio)", "log(Parent_positive_ratio)", "Parent_negative_MLU ", "Parent_positive_MLU")
  ) %>%
  kable(
    caption = "Estimating Production Ratio of Prohibition in Child Speech",
    col.names = c("Predictor", "B", "SE", "t", "p"),
    digits = c(0, 2, 3, 2, 3)
  )

child_prohibition_pos_m2 %>%
tidy() %>%
   mutate(
    p.value = scales::pvalue(p.value),
    term = c("Intercept", "Age", "MLU", "log(Parent_negative_ratio)", "log(Parent_positive_ratio)", "Parent_negative_MLU ", "Parent_positive_MLU")
  ) %>%
  kable(
    caption = "Estimating Production Ratio of Positive Counterparts for Prohibition in Child Speech",
    col.names = c("Predictor", "B", "SE", "t", "p"),
    digits = c(0, 2, 3, 2, 3)
  )


```

\clearpage

### Inability 


```{r inability, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7.8, fig.height=3.5, set.cap.width=T, num.cols.cap=1, fig.cap = "Inability" }

inability_data %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(log(Total_ratio), 2), group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("grey", "mediumpurple4", "bisque2", "steelblue")) + #"peru", 
#  geom_line(linetype = c('dotted', 'solid')) +
#  geom_line(aes(color = Polarity, linetype = 'dotted', size = 1)) + 
  facet_grid( ~ Role) +
#  facet_grid(vars(Head)) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=10, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)") + 
#  ggtitle('Parent') +
  ylim(-9, -2) +
  theme(text = element_text(size=15))

```


```{r echo = FALSE, results = 'asis'}

child_inability_neg_m2 %>%
tidy() %>%
   mutate(
    p.value = scales::pvalue(p.value),
    term = c("Intercept", "Age", "MLU", "log(Parent_negative_ratio)", "log(Parent_positive_ratio)", "Parent_negative_MLU ", "Parent_positive_MLU")
  ) %>%
  kable(
    caption = "Estimating Production Ratio of Inability in Child Speech",
    col.names = c("Predictor", "B", "SE", "t", "p"),
    digits = c(0, 2, 3, 2, 3)
  )

child_inability_pos_m2 %>%
tidy() %>%
   mutate(
    p.value = scales::pvalue(p.value),
    term = c("Intercept", "Age", "MLU", "log(Parent_negative_ratio)", "log(Parent_positive_ratio)", "Parent_negative_MLU ", "Parent_positive_MLU")
  ) %>%
  kable(
    caption = "Estimating Production Ratio of Positive Counterparts for Inability in Child Speech",
    col.names = c("Predictor", "B", "SE", "t", "p"),
    digits = c(0, 2, 3, 2, 3)
  )


```


\clearpage

### Labeling

```{r learningdata, include=FALSE}

learning <-read.csv('data/diaparse/learning.txt', header = T, sep = '\t')
# learning <- subset(learning, Subj == 'I' | Subj == 'NONE')
learning$Role[which(learning$Role == "Father")] <- 'Parent'
learning$Role[which(learning$Role == "Mother")] <- 'Parent'
learning$Role[which(learning$Role == "Target_Child")] <- 'Child'

learning_neg = subset(learning, Polarity == 'negative')
learning_pos = subset(learning, Polarity == 'positive')

child_learning_neg <- subset(learning_neg, Role %in% c('Child'))
parent_learning_neg <- subset(learning_neg, Role %in% c('Parent'))

child_learning_neg_mlu <- mlu(child_learning_neg)
parent_learning_neg_mlu <- mlu(parent_learning_neg)


child_learning_neg <- data.frame(table(child_learning_neg$Age))
names(child_learning_neg) <- c('Age', 'Freq')
child_learning_neg$Role <- rep('Child', nrow(child_learning_neg))
child_learning_neg$Head <- rep('', nrow(child_learning_neg))
temp <- merge(child_learning_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_learning_neg <- temp
child_learning_neg$Total_ratio <- child_learning_neg$Freq / child_learning_neg$N_utterance
child_learning_neg$Ratio <- child_learning_neg$Freq / sum(child_learning_neg$Freq)
child_learning_neg$Polarity <- rep('negative', nrow(child_learning_neg))
child_learning_neg$Measure <- rep('negative ratio', nrow(child_learning_neg))
child_learning_neg$Which <- rep('ratio', nrow(child_learning_neg))
child_learning_neg$Function <- rep('Learning', nrow(child_learning_neg))
child_learning_neg <- negative_moving(child_learning_neg)


parent_learning_neg <- data.frame(table(parent_learning_neg$Age))
names(parent_learning_neg) <- c('Age', 'Freq')
parent_learning_neg$Role <- rep('Parent', nrow(parent_learning_neg))
parent_learning_neg$Head <- rep('learning', nrow(parent_learning_neg))
temp <- merge(parent_learning_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_learning_neg <- temp
parent_learning_neg$Total_ratio <- parent_learning_neg$Freq / parent_learning_neg$N_utterance
parent_learning_neg$Ratio <- parent_learning_neg$Freq / sum(parent_learning_neg$Freq)
parent_learning_neg$Polarity <- rep('negative', nrow(parent_learning_neg))
parent_learning_neg$Measure <- rep('negative ratio', nrow(parent_learning_neg))
parent_learning_neg$Which <- rep('ratio', nrow(parent_learning_neg))
parent_learning_neg$Function <- rep('Learning', nrow(parent_learning_neg))
parent_learning_neg <- negative_moving(parent_learning_neg)


child_learning_pos <- subset(learning_pos, Role %in% c('Child'))
parent_learning_pos <- subset(learning_pos, Role %in% c('Parent'))

child_learning_pos_mlu <- mlu(child_learning_pos)
parent_learning_pos_mlu <- mlu(parent_learning_pos)

child_learning_pos <- data.frame(table(child_learning_pos$Age))
names(child_learning_pos) <- c("Age", 'Freq')
child_learning_pos$Role <- rep('Child', nrow(child_learning_pos))
child_learning_pos$Head <- rep('learning', nrow(child_learning_pos))
temp <- merge(child_learning_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_learning_pos <- temp
child_learning_pos$Total_ratio <- child_learning_pos$Freq / child_learning_pos$N_utterance
child_learning_pos$Ratio <- child_learning_pos$Freq / sum(child_learning_pos$Freq)
child_learning_pos$Polarity <- rep('positive', nrow(child_learning_pos))
child_learning_pos$Measure <- rep('positive ratio', nrow(child_learning_pos))
child_learning_pos$Which <- rep('ratio', nrow(child_learning_pos))
child_learning_pos$Function <- rep('Learning', nrow(child_learning_pos))
child_learning_pos <- positive_moving(child_learning_pos)


parent_learning_pos <- data.frame(table(parent_learning_pos$Age))
names(parent_learning_pos) <- c('Age', 'Freq')
parent_learning_pos$Role <- rep('Parent', nrow(parent_learning_pos))
parent_learning_pos$Head <- rep('learning', nrow(parent_learning_pos))
temp <- merge(parent_learning_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_learning_pos <- temp
parent_learning_pos$Total_ratio <- parent_learning_pos$Freq / parent_learning_pos$N_utterance
parent_learning_pos$Ratio <- parent_learning_pos$Freq / sum(parent_learning_pos$Freq)
parent_learning_pos$Polarity <- rep('positive', nrow(parent_learning_pos))
parent_learning_pos$Measure <- rep('positive ratio', nrow(parent_learning_pos))
parent_learning_pos$Which <- rep('ratio', nrow(parent_learning_pos))
parent_learning_pos$Function <- rep('Learning', nrow(parent_learning_pos))
parent_learning_pos <- positive_moving(parent_learning_pos)


learning_data <- rbind(child_learning_neg, child_learning_pos, parent_learning_neg, parent_learning_pos)

learning_data$Measure <- factor(learning_data$Measure, levels = c('negative ratio', 'negative moving ratio', 'positive ratio', 'positive moving ratio'))

learning_data_child <- subset(learning_data, Role == 'Child')
learning_data_parent <- subset(learning_data, Role == 'Parent')


```



```{r learning, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7.8, fig.height=3.5, set.cap.width=T, num.cols.cap=1, fig.cap = "Language learning via labeling" }

learning_data %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(log(Total_ratio), 2), group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("grey", "mediumpurple4", "bisque2", "steelblue")) + #"peru", 
#  geom_line(linetype = c('dotted', 'solid')) +
#  geom_line(aes(color = Polarity, linetype = 'dotted', size = 1)) + 
  facet_grid( ~ Role) +
#  facet_grid(vars(Head)) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=10, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)") + 
#  ggtitle('Parent') +
  ylim(-10, -1.7) +
  theme(text = element_text(size=15))

```


```{r learning_model, include=FALSE}

child_learning_neg_Model <- merge(child_learning_neg_mlu, subset(child_learning_neg, Measure == 'negative moving ratio'))

parent_learning_neg_Model <- merge(parent_learning_neg_mlu, subset(parent_learning_neg, Measure == 'negative moving ratio'))

child_learning_pos_Model <- merge(child_learning_pos_mlu, subset(child_learning_pos, Measure == 'positive moving ratio'))

parent_learning_pos_Model <- merge(parent_learning_pos_mlu, subset(parent_learning_pos, Measure == 'positive moving ratio'))

temp1<-data.frame(parent_learning_neg_Model$Age)
names(temp1) <- c('Age')
temp1$Parent_negative_ratio <- parent_learning_neg_Model$Total_ratio
temp1$Parent_negative_MLU <- parent_learning_neg_Model$MLU

temp2<-data.frame(parent_learning_pos_Model$Age)
names(temp2) <- c('Age')
temp2$Parent_positive_ratio <- parent_learning_pos_Model$Total_ratio
temp2$Parent_positive_MLU <- parent_learning_pos_Model$MLU

temp <- merge(temp1, temp2, by.x = 'Age', all.x = TRUE)

child_learning_neg_Model <- merge(child_learning_neg_Model, temp, by.x = 'Age', all.x = TRUE)
child_learning_pos_Model <- merge(child_learning_pos_Model, temp, by.x = 'Age', all.x = TRUE)

child_learning_neg_m1 <- glm(log(Total_ratio) ~ Age + MLU, data = child_learning_neg_Model)

child_learning_neg_m2 <- glm(log(Total_ratio) ~ Age + MLU + log(Parent_negative_ratio) + log(Parent_positive_ratio) + Parent_negative_MLU + Parent_positive_MLU, data = child_learning_neg_Model)

child_learning_pos_m2 <- glm(log(Total_ratio) ~ Age + MLU + log(Parent_negative_ratio) + log(Parent_positive_ratio) + Parent_negative_MLU + Parent_positive_MLU, data = child_learning_pos_Model)


```

\clearpage

```{r echo = FALSE, results = 'asis'}

child_learning_neg_m2 %>%
tidy() %>%
   mutate(
    p.value = scales::pvalue(p.value),
    term = c("Intercept", "Age", "MLU", "log(Parent_negative_ratio)", "log(Parent_positive_ratio)", "Parent_negative_MLU ", "Parent_positive_MLU")
  ) %>%
  kable(
    caption = "Estimating Production Ratio of Learning in Child Speech",
    col.names = c("Predictor", "B", "SE", "t", "p"),
    digits = c(0, 2, 3, 2, 3)
  )

child_learning_pos_m2 %>%
tidy() %>%
   mutate(
    p.value = scales::pvalue(p.value),
    term = c("Intercept", "Age", "MLU", "log(Parent_negative_ratio)", "log(Parent_positive_ratio)", "Parent_negative_MLU ", "Parent_positive_MLU")
  ) %>%
  kable(
    caption = "Estimating Production Ratio of Positive Counterparts for Learning in Child Speech",
    col.names = c("Predictor", "B", "SE", "t", "p"),
    digits = c(0, 2, 3, 2, 3)
  )


```


\clearpage

### Epistemic Negation


```{r epistemicdata, include=FALSE}

epistemic <-read.csv('data/diaparse/epistemic.txt', header = T, sep = '\t')
# epistemic <- subset(epistemic, Subj == 'I' | Subj == 'NONE')
epistemic$Role[which(epistemic$Role == "Father")] <- 'Parent'
epistemic$Role[which(epistemic$Role == "Mother")] <- 'Parent'
epistemic$Role[which(epistemic$Role == "Target_Child")] <- 'Child'

epistemic_neg = subset(epistemic, Polarity == 'negative')
epistemic_pos = subset(epistemic, Polarity == 'positive')

child_epistemic_neg <- subset(epistemic_neg, Role %in% c('Child'))
parent_epistemic_neg <- subset(epistemic_neg, Role %in% c('Parent'))

child_know_neg <- subset(child_epistemic_neg, Head %in% c('know'))
child_remember_neg <- subset(child_epistemic_neg, Head %in% c('remember'))
child_think_neg <- subset(child_epistemic_neg, Head %in% c('think'))
parent_know_neg <- subset(parent_epistemic_neg, Head %in% c('know'))
parent_remember_neg <- subset(parent_epistemic_neg, Head %in% c('remember'))
parent_think_neg <- subset(parent_epistemic_neg, Head %in% c('think'))


child_know_neg_mlu <- mlu(child_know_neg)
child_remember_neg_mlu <- mlu(child_remember_neg)
child_think_neg_mlu <- mlu(child_think_neg)
parent_know_neg_mlu <- mlu(parent_know_neg)
parent_remember_neg_mlu <- mlu(parent_remember_neg)
parent_think_neg_mlu <- mlu(parent_think_neg)


child_know_neg <- data.frame(table(child_know_neg$Age))
names(child_know_neg) <- c('Age', 'Freq')
child_know_neg$Role <- rep('Child', nrow(child_know_neg))
child_know_neg$Head <- rep('know', nrow(child_know_neg))
temp <- merge(child_know_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_know_neg <- temp
child_know_neg$Total_ratio <- child_know_neg$Freq / child_know_neg$N_utterance
child_know_neg$Ratio <- child_know_neg$Freq / sum(child_know_neg$Freq)
child_know_neg$Polarity <- rep('negative', nrow(child_know_neg))
child_know_neg$Measure <- rep('negative ratio', nrow(child_know_neg))
child_know_neg$Which <- rep('ratio', nrow(child_know_neg))
child_know_neg$Function <- rep('Epistemic', nrow(child_know_neg))
child_know_neg <- negative_moving(child_know_neg)


child_remember_neg <- data.frame(table(child_remember_neg$Age))
names(child_remember_neg) <- c('Age', 'Freq')
child_remember_neg$Role <- rep('Child', nrow(child_remember_neg))
child_remember_neg$Head <- rep('remember', nrow(child_remember_neg))
temp <- merge(child_remember_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_remember_neg <- temp
child_remember_neg$Total_ratio <- child_remember_neg$Freq / child_remember_neg$N_utterance
child_remember_neg$Ratio <- child_remember_neg$Freq / sum(child_remember_neg$Freq)
child_remember_neg$Polarity <- rep('negative', nrow(child_remember_neg))
child_remember_neg$Measure <- rep('negative ratio', nrow(child_remember_neg))
child_remember_neg$Which <- rep('ratio', nrow(child_remember_neg))
child_remember_neg$Function <- rep('Epistemic', nrow(child_remember_neg))
child_remember_neg <- negative_moving(child_remember_neg)

child_think_neg <- data.frame(table(child_think_neg$Age))
names(child_think_neg) <- c('Age', 'Freq')
child_think_neg$Role <- rep('Child', nrow(child_think_neg))
child_think_neg$Head <- rep('think', nrow(child_think_neg))
temp <- merge(child_think_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_think_neg <- temp
child_think_neg$Total_ratio <- child_think_neg$Freq / child_think_neg$N_utterance
child_think_neg$Ratio <- child_think_neg$Freq / sum(child_think_neg$Freq)
child_think_neg$Polarity <- rep('negative', nrow(child_think_neg))
child_think_neg$Measure <- rep('negative ratio', nrow(child_think_neg))
child_think_neg$Which <- rep('ratio', nrow(child_think_neg))
child_think_neg$Function <- rep('Epistemic', nrow(child_think_neg))
child_think_neg <- negative_moving(child_think_neg)

parent_know_neg <- data.frame(table(parent_know_neg$Age))
names(parent_know_neg) <- c('Age', 'Freq')
parent_know_neg$Role <- rep('Parent', nrow(parent_know_neg))
parent_know_neg$Head <- rep('know', nrow(parent_know_neg))
temp <- merge(parent_know_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_know_neg <- temp
parent_know_neg$Total_ratio <- parent_know_neg$Freq / parent_know_neg$N_utterance
parent_know_neg$Ratio <- parent_know_neg$Freq / sum(parent_know_neg$Freq)
parent_know_neg$Polarity <- rep('negative', nrow(parent_know_neg))
parent_know_neg$Measure <- rep('negative ratio', nrow(parent_know_neg))
parent_know_neg$Which <- rep('ratio', nrow(parent_know_neg))
parent_know_neg$Function <- rep('Epistemic', nrow(parent_know_neg))
parent_know_neg <- negative_moving(parent_know_neg)

parent_remember_neg <- data.frame(table(parent_remember_neg$Age))
names(parent_remember_neg) <- c('Age', 'Freq')
parent_remember_neg$Role <- rep('Parent', nrow(parent_remember_neg))
parent_remember_neg$Head <- rep('remember', nrow(parent_remember_neg))
temp <- merge(parent_remember_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_remember_neg <- temp
parent_remember_neg$Total_ratio <- parent_remember_neg$Freq / parent_remember_neg$N_utterance
parent_remember_neg$Ratio <- parent_remember_neg$Freq / sum(parent_remember_neg$Freq)
parent_remember_neg$Polarity <- rep('negative', nrow(parent_remember_neg))
parent_remember_neg$Measure <- rep('negative ratio', nrow(parent_remember_neg))
parent_remember_neg$Which <- rep('ratio', nrow(parent_remember_neg))
parent_remember_neg$Function <- rep('Epistemic', nrow(parent_remember_neg))
parent_remember_neg <- negative_moving(parent_remember_neg)

parent_think_neg <- data.frame(table(parent_think_neg$Age))
names(parent_think_neg) <- c('Age', 'Freq')
parent_think_neg$Role <- rep('Parent', nrow(parent_think_neg))
parent_think_neg$Head <- rep('think', nrow(parent_think_neg))
temp <- merge(parent_think_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_think_neg <- temp
parent_think_neg$Total_ratio <- parent_think_neg$Freq / parent_think_neg$N_utterance
parent_think_neg$Ratio <- parent_think_neg$Freq / sum(parent_think_neg$Freq)
parent_think_neg$Polarity <- rep('negative', nrow(parent_think_neg))
parent_think_neg$Measure <- rep('negative ratio', nrow(parent_think_neg))
parent_think_neg$Which <- rep('ratio', nrow(parent_think_neg))
parent_think_neg$Function <- rep('Epistemic', nrow(parent_think_neg))
parent_think_neg <- negative_moving(parent_think_neg)

child_epistemic_pos <- subset(epistemic_pos, Role %in% c('Child'))
parent_epistemic_pos <- subset(epistemic_pos, Role %in% c('Parent'))

child_know_pos <- subset(child_epistemic_pos, Head %in% c('know'))
child_remember_pos <- subset(child_epistemic_pos, Head %in% c('remember'))
child_think_pos <- subset(child_epistemic_pos, Head %in% c('think'))
parent_know_pos <- subset(parent_epistemic_pos, Head %in% c('know'))
parent_remember_pos <- subset(parent_epistemic_pos, Head %in% c('remember'))
parent_think_pos <- subset(parent_epistemic_pos, Head %in% c('think'))

child_know_pos_mlu <- mlu(child_know_pos)
child_remember_pos_mlu <- mlu(child_remember_pos)
child_think_pos_mlu <- mlu(child_think_pos)
parent_know_pos_mlu <- mlu(parent_know_pos)
parent_remember_pos_mlu <- mlu(parent_remember_pos)
parent_think_pos_mlu <- mlu(parent_think_pos)

child_know_pos <- data.frame(table(child_know_pos$Age))
names(child_know_pos) <- c("Age", 'Freq')
child_know_pos$Role <- rep('Child', nrow(child_know_pos))
child_know_pos$Head <- rep('know', nrow(child_know_pos))
temp <- merge(child_know_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_know_pos <- temp
child_know_pos$Total_ratio <- child_know_pos$Freq / child_know_pos$N_utterance
child_know_pos$Ratio <- child_know_pos$Freq / sum(child_know_pos$Freq)
child_know_pos$Polarity <- rep('positive', nrow(child_know_pos))
child_know_pos$Measure <- rep('positive ratio', nrow(child_know_pos))
child_know_pos$Which <- rep('ratio', nrow(child_know_pos))
child_know_pos$Function <- rep('Epistemic', nrow(child_know_pos))
child_know_pos <- positive_moving(child_know_pos)

child_remember_pos <- data.frame(table(child_remember_pos$Age))
names(child_remember_pos) <- c("Age", 'Freq')
child_remember_pos$Role <- rep('Child', nrow(child_remember_pos))
child_remember_pos$Head <- rep('remember', nrow(child_remember_pos))
temp <- merge(child_remember_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_remember_pos <- temp
child_remember_pos$Total_ratio <- child_remember_pos$Freq / child_remember_pos$N_utterance
child_remember_pos$Ratio <- child_remember_pos$Freq / sum(child_remember_pos$Freq)
child_remember_pos$Polarity <- rep('positive', nrow(child_remember_pos))
child_remember_pos$Measure <- rep('positive ratio', nrow(child_remember_pos))
child_remember_pos$Which <- rep('ratio', nrow(child_remember_pos))
child_remember_pos$Function <- rep('Epistemic', nrow(child_remember_pos))
child_remember_pos <- positive_moving(child_remember_pos)

child_think_pos <- data.frame(table(child_think_pos$Age))
names(child_think_pos) <- c("Age", 'Freq')
child_think_pos$Role <- rep('Child', nrow(child_think_pos))
child_think_pos$Head <- rep('think', nrow(child_think_pos))
temp <- merge(child_think_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_think_pos <- temp
child_think_pos$Total_ratio <- child_think_pos$Freq / child_think_pos$N_utterance
child_think_pos$Ratio <- child_think_pos$Freq / sum(child_think_pos$Freq)
child_think_pos$Polarity <- rep('positive', nrow(child_think_pos))
child_think_pos$Measure <- rep('positive ratio', nrow(child_think_pos))
child_think_pos$Which <- rep('ratio', nrow(child_think_pos))
child_think_pos$Function <- rep('Epistemic', nrow(child_think_pos))
child_think_pos <- positive_moving(child_think_pos)

parent_know_pos <- data.frame(table(parent_know_pos$Age))
names(parent_know_pos) <- c('Age', 'Freq')
parent_know_pos$Role <- rep('Parent', nrow(parent_know_pos))
parent_know_pos$Head <- rep('know', nrow(parent_know_pos))
temp <- merge(parent_know_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_know_pos <- temp
parent_know_pos$Total_ratio <- parent_know_pos$Freq / parent_know_pos$N_utterance
parent_know_pos$Ratio <- parent_know_pos$Freq / sum(parent_know_pos$Freq)
parent_know_pos$Polarity <- rep('positive', nrow(parent_know_pos))
parent_know_pos$Measure <- rep('positive ratio', nrow(parent_know_pos))
parent_know_pos$Which <- rep('ratio', nrow(parent_know_pos))
parent_know_pos$Function <- rep('Epistemic', nrow(parent_know_pos))
parent_know_pos <- positive_moving(parent_know_pos)

parent_remember_pos <- data.frame(table(parent_remember_pos$Age))
names(parent_remember_pos) <- c('Age', 'Freq')
parent_remember_pos$Role <- rep('Parent', nrow(parent_remember_pos))
parent_remember_pos$Head <- rep('remember', nrow(parent_remember_pos))
temp <- merge(parent_remember_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_remember_pos <- temp
parent_remember_pos$Total_ratio <- parent_remember_pos$Freq / parent_remember_pos$N_utterance
parent_remember_pos$Ratio <- parent_remember_pos$Freq / sum(parent_remember_pos$Freq)
parent_remember_pos$Polarity <- rep('positive', nrow(parent_remember_pos))
parent_remember_pos$Measure <- rep('positive ratio', nrow(parent_remember_pos))
parent_remember_pos$Which <- rep('ratio', nrow(parent_remember_pos))
parent_remember_pos$Function <- rep('Epistemic', nrow(parent_remember_pos))
parent_remember_pos <- positive_moving(parent_remember_pos)

parent_think_pos <- data.frame(table(parent_think_pos$Age))
names(parent_think_pos) <- c('Age', 'Freq')
parent_think_pos$Role <- rep('Parent', nrow(parent_think_pos))
parent_think_pos$Head <- rep('think', nrow(parent_think_pos))
temp <- merge(parent_think_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_think_pos <- temp
parent_think_pos$Total_ratio <- parent_think_pos$Freq / parent_think_pos$N_utterance
parent_think_pos$Ratio <- parent_think_pos$Freq / sum(parent_think_pos$Freq)
parent_think_pos$Polarity <- rep('positive', nrow(parent_think_pos))
parent_think_pos$Measure <- rep('positive ratio', nrow(parent_think_pos))
parent_think_pos$Which <- rep('ratio', nrow(parent_think_pos))
parent_think_pos$Function <- rep('Epistemic', nrow(parent_think_pos))
parent_think_pos <- positive_moving(parent_think_pos)

epistemic_data <- rbind(child_know_neg, child_know_pos, parent_know_neg, parent_know_pos, child_remember_neg, child_remember_pos, parent_remember_neg, parent_remember_pos, child_think_neg, child_think_pos, parent_think_neg, parent_think_pos)

epistemic_data$Measure <- factor(epistemic_data$Measure, levels = c('negative ratio', 'negative moving ratio', 'positive ratio', 'positive moving ratio'))

epistemic_data_child <- subset(epistemic_data, Role == 'Child')
epistemic_data_parent <- subset(epistemic_data, Role == 'Parent')


```


```{r epistemic, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7.8, fig.height=7, set.cap.width=T, num.cols.cap=1, fig.cap = "Epistemic negation" }


epistemic_data %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(log(Total_ratio), 2), group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("grey", "mediumpurple4", "bisque2", "steelblue")) + #"peru", 
#  geom_line(linetype = c('dotted', 'solid')) +
#  geom_line(aes(color = Polarity, linetype = 'dotted', size = 1)) + 
  facet_grid(Head ~ Role) +
#  facet_grid(vars(Head)) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=10, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)") + 
#  ggtitle('Parent') +
  ylim(-11, -3) +
  theme(text = element_text(size=15))

```


```{r epistemic_model, include=FALSE}

child_know_neg_Model <- merge(child_know_neg_mlu, subset(child_know_neg, Measure == 'negative moving ratio'))

parent_know_neg_Model <- merge(parent_know_neg_mlu, subset(parent_know_neg, Measure == 'negative moving ratio'))

child_know_pos_Model <- merge(child_know_pos_mlu, subset(child_know_pos, Measure == 'positive moving ratio'))

parent_know_pos_Model <- merge(parent_know_pos_mlu, subset(parent_know_pos, Measure == 'positive moving ratio'))

temp1<-data.frame(parent_know_neg_Model$Age)
names(temp1) <- c('Age')
temp1$Parent_negative_ratio <- parent_know_neg_Model$Total_ratio
temp1$Parent_negative_MLU <- parent_know_neg_Model$MLU

temp2<-data.frame(parent_know_pos_Model$Age)
names(temp2) <- c('Age')
temp2$Parent_positive_ratio <- parent_know_pos_Model$Total_ratio
temp2$Parent_positive_MLU <- parent_know_pos_Model$MLU

temp <- merge(temp1, temp2, by.x = 'Age', all.x = TRUE)

child_know_neg_Model <- merge(child_know_neg_Model, temp, by.x = 'Age', all.x = TRUE)
child_know_pos_Model <- merge(child_know_pos_Model, temp, by.x = 'Age', all.x = TRUE)

child_know_neg_m1 <- glm(log(Total_ratio) ~ Age + MLU, data = child_know_neg_Model)

child_know_neg_m2 <- glm(log(Total_ratio) ~ Age + MLU + log(Parent_negative_ratio) + log(Parent_positive_ratio) + Parent_negative_MLU + Parent_positive_MLU, data = child_know_neg_Model)

child_know_pos_m2 <- glm(log(Total_ratio) ~ Age + MLU + log(Parent_negative_ratio) + log(Parent_positive_ratio) + Parent_negative_MLU + Parent_positive_MLU, data = child_know_pos_Model)

child_remember_neg_Model <- merge(child_remember_neg_mlu, subset(child_remember_neg, Measure == 'negative moving ratio'))

parent_remember_neg_Model <- merge(parent_remember_neg_mlu, subset(parent_remember_neg, Measure == 'negative moving ratio'))

child_remember_pos_Model <- merge(child_remember_pos_mlu, subset(child_remember_pos, Measure == 'positive moving ratio'))

parent_remember_pos_Model <- merge(parent_remember_pos_mlu, subset(parent_remember_pos, Measure == 'positive moving ratio'))

temp1<-data.frame(parent_remember_neg_Model$Age)
names(temp1) <- c('Age')
temp1$Parent_negative_ratio <- parent_remember_neg_Model$Total_ratio
temp1$Parent_negative_MLU <- parent_remember_neg_Model$MLU

temp2<-data.frame(parent_remember_pos_Model$Age)
names(temp2) <- c('Age')
temp2$Parent_positive_ratio <- parent_remember_pos_Model$Total_ratio
temp2$Parent_positive_MLU <- parent_remember_pos_Model$MLU

temp <- merge(temp1, temp2, by.x = 'Age', all.x = TRUE)

child_remember_neg_Model <- merge(child_remember_neg_Model, temp, by.x = 'Age', all.x = TRUE)
child_remember_pos_Model <- merge(child_remember_pos_Model, temp, by.x = 'Age', all.x = TRUE)

child_remember_neg_m1 <- glm(log(Total_ratio) ~ Age + MLU, data = child_remember_neg_Model)

child_remember_neg_m2 <- glm(log(Total_ratio) ~ Age + MLU + log(Parent_negative_ratio) + log(Parent_positive_ratio) + Parent_negative_MLU + Parent_positive_MLU, data = child_remember_neg_Model)

child_remember_pos_m2 <- glm(log(Total_ratio) ~ Age + MLU + log(Parent_negative_ratio) + log(Parent_positive_ratio) + Parent_negative_MLU + Parent_positive_MLU, data = child_remember_pos_Model)


child_think_neg_Model <- merge(child_think_neg_mlu, subset(child_think_neg, Measure == 'negative moving ratio'))

parent_think_neg_Model <- merge(parent_think_neg_mlu, subset(parent_think_neg, Measure == 'negative moving ratio'))

child_think_pos_Model <- merge(child_think_pos_mlu, subset(child_think_pos, Measure == 'positive moving ratio'))

parent_think_pos_Model <- merge(parent_think_pos_mlu, subset(parent_think_pos, Measure == 'positive moving ratio'))

temp1<-data.frame(parent_think_neg_Model$Age)
names(temp1) <- c('Age')
temp1$Parent_negative_ratio <- parent_think_neg_Model$Total_ratio
temp1$Parent_negative_MLU <- parent_think_neg_Model$MLU

temp2<-data.frame(parent_think_pos_Model$Age)
names(temp2) <- c('Age')
temp2$Parent_positive_ratio <- parent_think_pos_Model$Total_ratio
temp2$Parent_positive_MLU <- parent_think_pos_Model$MLU

temp <- merge(temp1, temp2, by.x = 'Age', all.x = TRUE)

child_think_neg_Model <- merge(child_think_neg_Model, temp, by.x = 'Age', all.x = TRUE)
child_think_pos_Model <- merge(child_think_pos_Model, temp, by.x = 'Age', all.x = TRUE)

child_think_neg_m1 <- glm(log(Total_ratio) ~ Age + MLU, data = child_think_neg_Model)

child_think_neg_m2 <- glm(log(Total_ratio) ~ Age + MLU + log(Parent_negative_ratio) + log(Parent_positive_ratio) + Parent_negative_MLU + Parent_positive_MLU, data = child_think_neg_Model)

child_think_pos_m2 <- glm(log(Total_ratio) ~ Age + MLU + log(Parent_negative_ratio) + log(Parent_positive_ratio) + Parent_negative_MLU + Parent_positive_MLU, data = child_think_pos_Model)


```

\clearpage

```{r echo = FALSE, results = 'asis'}

child_know_neg_m2 %>%
tidy() %>%
   mutate(
    p.value = scales::pvalue(p.value),
    term = c("Intercept", "Age", "MLU", "log(Parent_negative_ratio)", "log(Parent_positive_ratio)", "Parent_negative_MLU ", "Parent_positive_MLU")
  ) %>%
  kable(
    caption = "Estimating Production Ratio of Epistemic Negation in Child Speech, when head verb is know",
    col.names = c("Predictor", "B", "SE", "t", "p"),
    digits = c(0, 2, 3, 2, 3)
  )

child_know_pos_m2 %>%
tidy() %>%
   mutate(
    p.value = scales::pvalue(p.value),
    term = c("Intercept", "Age", "MLU", "log(Parent_negative_ratio)", "log(Parent_positive_ratio)", "Parent_negative_MLU ", "Parent_positive_MLU")
  ) %>%
  kable(
    caption = "Estimating Production Ratio of Positive Counterparts for Epistemic Negation in Child Speech, when head verb is know",
    col.names = c("Predictor", "B", "SE", "t", "p"),
    digits = c(0, 2, 3, 2, 3)
  )

```

\clearpage

```{r echo = FALSE, results = 'asis'}

child_remember_neg_m2 %>%
tidy() %>%
   mutate(
    p.value = scales::pvalue(p.value),
    term = c("Intercept", "Age", "MLU", "log(Parent_negative_ratio)", "log(Parent_positive_ratio)", "Parent_negative_MLU ", "Parent_positive_MLU")
  ) %>%
  kable(
    caption = "Estimating Production Ratio of Epistemic Negation in Child Speech, when head verb is remember",
    col.names = c("Predictor", "B", "SE", "t", "p"),
    digits = c(0, 2, 3, 2, 3)
  )

child_remember_pos_m2 %>%
tidy() %>%
   mutate(
    p.value = scales::pvalue(p.value),
    term = c("Intercept", "Age", "MLU", "log(Parent_negative_ratio)", "log(Parent_positive_ratio)", "Parent_negative_MLU ", "Parent_positive_MLU")
  ) %>%
  kable(
    caption = "Estimating Production Ratio of Positive Counterparts for Epistemic Negation in Child Speech, when head verb is remember",
    col.names = c("Predictor", "B", "SE", "t", "p"),
    digits = c(0, 2, 3, 2, 3)
  )

```

\clearpage

```{r echo = FALSE, results = 'asis'}

child_think_neg_m2 %>%
tidy() %>%
   mutate(
    p.value = scales::pvalue(p.value),
    term = c("Intercept", "Age", "MLU", "log(Parent_negative_ratio)", "log(Parent_positive_ratio)", "Parent_negative_MLU ", "Parent_positive_MLU")
  ) %>%
  kable(
    caption = "Estimating Production Ratio of Epistemic Negation in Child Speech, when head verb is think",
    col.names = c("Predictor", "B", "SE", "t", "p"),
    digits = c(0, 2, 3, 2, 3)
  )

child_think_pos_m2 %>%
tidy() %>%
   mutate(
    p.value = scales::pvalue(p.value),
    term = c("Intercept", "Age", "MLU", "log(Parent_negative_ratio)", "log(Parent_positive_ratio)", "Parent_negative_MLU ", "Parent_positive_MLU")
  ) %>%
  kable(
    caption = "Estimating Production Ratio of Positive Counterparts for Epistemic Negation in Child Speech, when head verb is think",
    col.names = c("Predictor", "B", "SE", "t", "p"),
    digits = c(0, 2, 3, 2, 3)
  )


```


\clearpage



### Possession

```{r possession, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7.8, fig.height=4.5, set.cap.width=T, num.cols.cap=1, fig.cap = "Possession" }

possession_data %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(log(Total_ratio), 2), group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("grey", "mediumpurple4", "bisque2", "steelblue")) + #"peru", 
#  geom_line(linetype = c('dotted', 'solid')) +
#  geom_line(aes(color = Polarity, linetype = 'dotted', size = 1)) + 
  facet_grid(Head ~ Role) +
#  facet_grid(vars(Head)) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=10, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)") + 
#  ggtitle('Parent') +
  ylim(-11, -3) +
  theme(text = element_text(size=15))


```


```{r echo = FALSE, results = 'asis'}

child_possession_have_neg_m2 %>%
tidy() %>%
   mutate(
    p.value = scales::pvalue(p.value),
    term = c("Intercept", "Age", "MLU", "log(Parent_negative_ratio)", "log(Parent_positive_ratio)", "Parent_negative_MLU ", "Parent_positive_MLU")
  ) %>%
  kable(
    caption = "Estimating Production Ratio of Posession in Child Speech, when head verb is have",
    col.names = c("Predictor", "B", "SE", "t", "p"),
    digits = c(0, 2, 3, 2, 3)
  )

child_possession_have_pos_m2 %>%
tidy() %>%
   mutate(
    p.value = scales::pvalue(p.value),
    term = c("Intercept", "Age", "MLU", "log(Parent_negative_ratio)", "log(Parent_positive_ratio)", "Parent_negative_MLU ", "Parent_positive_MLU")
  ) %>%
  kable(
    caption = "Estimating Production Ratio of Positive Counterparts for Posession in Child Speech, when head verb is have",
    col.names = c("Predictor", "B", "SE", "t", "p"),
    digits = c(0, 2, 3, 2, 3)
  )

```

\clearpage

```{r echo = FALSE, results = 'asis'}

child_possession_pro_neg_m2 %>%
tidy() %>%
   mutate(
    p.value = scales::pvalue(p.value),
    term = c("Intercept", "Age", "MLU", "log(Parent_negative_ratio)", "log(Parent_positive_ratio)", "Parent_negative_MLU ", "Parent_positive_MLU")
  ) %>%
  kable(
    caption = "Estimating Production Ratio of Posession in Child Speech, when syntactic head is pronoun",
    col.names = c("Predictor", "B", "SE", "t", "p"),
    digits = c(0, 2, 3, 2, 3)
  )

child_possession_pro_pos_m2 %>%
tidy() %>%
   mutate(
    p.value = scales::pvalue(p.value),
    term = c("Intercept", "Age", "MLU", "log(Parent_negative_ratio)", "log(Parent_positive_ratio)", "Parent_negative_MLU ", "Parent_positive_MLU")
  ) %>%
  kable(
    caption = "Estimating Production Ratio of Positive Counterparts for Posession in Child Speech, when syntactic head is pronoun",
    col.names = c("Predictor", "B", "SE", "t", "p"),
    digits = c(0, 2, 3, 2, 3)
  )

```



\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}

\endgroup

