---
title             : "The Development of English Negative Constructions and Communicative Functions in Early Child Language"
shorttitle        : "Children's Negative Constructions and Communicative Functions"

author: 
  - name        : "Zoey Liu"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    address       : ""
    email         : "liu.ying@ufl.edu"
  - name          : "Masoud Jasbi"
    affiliation   : "2"

affiliation:
  - id            : "1"
    institution   : "University of Florida"
  - id            : "2"
    institution   : "Uinversity of California, Davis"

authornote: |
  Zoey Liu, Department of Linguistics, University of Florida
  
  Masound Jasbi, Department of Linguistics, University of California, Davis

abstract: |
  How does linguistic negation develop in early child language? Prior research has suggested that abstract and context-general negation develops from more concrete and context-specific communicative functions such as rejection, prohibition, or non-existence in fixed and ordered stages. The evidence for the emergence of these functions in stages is mixed, however, leaving the possibility that negation starts as an abstract concept that can serve multiple specific functions from the beginning, and that the development of the different functions start more or less simutanouesly depending on the early communicative environment. Leveraging automatic annotations of large-scale child speech corpora in English and growth-curve modeling, we examine children's production of seven negative constructions that tend to convey communicative functions previously discussed in the literature. We also investigate children's discourse-level negative responses (saying *no*) to parents' utterances with the same constructions as a proxy for children's comprehension. We do not find strong evidence for a fixed and ordred stage-hypothesis of negation development. Instead, the results of our growth-curve modeling suggest that for both measures of comprehension and production, children's ability to negate different constructions emerges around 18-22 months of age. Our results complement and confirm recent findings in experiental studies on children's comprehension of negation.

keywords: >
    negation; syntactic construction; communicative function; data-driven; child language development.
    
wordcount         : "X"

bibliography      : ["neg_construction.bib"]

floatsintext      : yes
figurelist        : no
tablelist         : no
footnotelist      : no
linenumbers       : yes
mask              : no
draft             : no

documentclass     : "apa6"
classoption       : "man"
output            : papaja::apa6_pdf
fig_caption: yes
---

```{r setup, include = FALSE, message=FALSE, warning=FALSE}
library("papaja")
library(data.table)
library(scales)
library(plyr)
library(devtools)
library(childesr)
library(tidyverse)
library(tm)
library(forcats)
library(gridExtra)
library(png)
library(grid)
library(ggplot2, warn.conflicts = FALSE, quietly=TRUE)
library(xtable)
library('RColorBrewer')
library(gridExtra)
library(tidyverse)
library(AICcmodavg)
library(broom)
library(corrr)
library(dplyr)
library(knitr)
library(kableExtra)
library(readr)
library(tidyr)
library(brms)
library(rstan)
library(tidybayes)
library(ggrepel)
library(ggeffects)
```

```{rstan, include=FALSE}

rstan_options(auto_write = TRUE)
options(mc.cores = parallel::detectCores())

```

<!--Important things to double check:
1. Did we assign a lower cutoff point? Or did even a single occurrence count? I remember we had a lower cutoff of 12 or something
2. 


-->


<!--when do you use capacities instead of capacity?-->

<!--English-->

<!--consistencies in examples, table/figure captions, formats, quotations, capitalization, etc-->

<!--For most of the functions, the discourse level is a subset of the sentence level-->

<!--the story somehow just does not sound right with prohibition (and sometimes inability) at the discourse level, especially given that we are looking at production and keep saying "convey communicative functions". I did back-n-forth writing but it didn't sound very cohesive. I'm leaning towards picking only the negative antecedents for these cases and the story would be probing children's "understanding" (knowledge) more broadly.-->

<!-- the usage of "emerge" vs. "develops"; right now I'm using them interchangeably and "develops" doesn't mean it's fully developed but I wonder if people would get mixed reactions -->

<!-- past tense mostly when describing experiments; present tense when describing observations; or whatver tense as long as it's consistent -->

<!-- parents'; apostrophe-->

<!-- try to not have duplicated phrases or especially verbs within adjacent sentences -->

<!-- Perhaps add a footnote that acknowledges shaking head does not mean negation in all cultures -->

# Introduction

Negation is a basic human concept and foundational to many areas of human thought including logic and mathematics. It is also present in all attested human languages [@jespersen1917negation; @horn1989natural]. An important feature of linguistic negation is that it has an abstract meaning and serves different communicative functions in different contexts. In English, for example, a coffee shop can use *not* to divide the menu into "coffee" and "not coffee" sections, with "not coffee" forming a category with diverse items such as tea and hot chocolate. The coffee shop can also use *no* in a sign like "no mask, no entry" to direct customer behavior, and a customer could say "I don't want milk" to reject an offer of milk in their coffee. Despite its abstract meaning, a word like *no* is among the early words produced by children. Therefore, a fundamental question in cognitive development and language acquisition is how negation emerges and develops in the human mind. Is early development of negation in child language limited to specific contexts with specific communicative functions? Or does negation emerge as an abstract and multi-functional concept from the beginning?

Previous literature has proposed that abstract negation develops from less abstract communicative functions in a fixed order [@mcneill1968; @bloom1970language; @pea1978; @choi1988semantic]. In other words, different functions of negation have been argued to have separate *stages* of acquisition. For instance, @darwin1872expression hypothesized that headshake as a sign for negation (in some cultures) develops from infants' habit to refuse or reject food from parents by withdrawing their heads. Similarly, @pea1978 proposed that at first, children use *no* to convey "rejection". In a second stage, they conceptualize and express non-existence of objects (e.g., "no water [in the cup]"), and finally in the third stage, negation reaches an abstract status that can deny truth of statements (e.g., "that is not a cow"). For @pea1978, this order reflected a natural progression in the conceptual space: from the more primitive domain of internal desires to the more complex domain of external existence, and finally the abstract domain of truth. Over the past fifty years, many studies have proposed different communicative functions and their stages of development [@bloom1970language;@mcneill1968;@choi1988semantic]. However, there has been no consensus regarding the exact stages and their order. Alternatively, some researchers have proposed that logical concepts such as negation, conjunction, and disjunction are innate and abstract from the start [@crain2012emergence]. The task of the child is to map the relevant morphemes in their native language to these abstract concepts. Once they achieve this task, negation can function across linguistic contexts already acquired by the child.

In this study, we use a relatively large collection of transcripts of parent-child interactions in English to investigate the development of seven negative constructions that typicaly convey seven communicative functions. For each negative construction, we both look at children's negative responses (saying *no*) to parent utterances with that construction, as well as children's own productions of these constructions. We take children's negative responses as a proxy for their comprehension of negation, and their production of negative constructions as a proxy for their productive capacity for negation. We use growth curves to model the development of each construction and compare the onset age and the age at which children show maximum rate of growth in their comprehension and production of negation.

# Previous Studies

Darwin [-@darwin1872expression, Chapter 11] explained the emergence of linguistic negation using the function it plays in early communication. He hypothesized that nodding and shaking are the earliest expressions of affirmation and negation respectively: "With infants, the first act of denial consists in refusing food; and I repeatedly noticed with my own infants, that they did so by withdrawing their heads laterally from the breast, or from anything offered them in a spoon ... [moreover] ... when the voice is exerted with closed teeth or lips, it produces the sound of the letter *n* or *m*. Hence we may account for the use of the particle *ne* to signify negation, ...". In later research, this communicative function of negation was referred to as "rejection" or "refusal" [@bloom1970language; @pea1978; @choi1988semantic].

Unlike Darwin, @mcneill1968's developmental account did not start with rejection, but rather with expressing external states (non-existence of objects). They studied the development of three Japanese negative morphemes (*nai*, *iya*, *iiya*) in the speech of a 27-month-old Japanese speaking girl called Izanami. According to @mcneill1968, in Japanese, *nai* expresses falsity of statements (e.g., "no [that's not an apple]"), *iya* expresses desires (e.g.,"no [I don't want an apple]"), and *iiya* expresses contrast (e.g., "no [I didn't have an apple. I had a pear]"). The appearance of these negative morphemes in the speech of a child reflects the developmental stages for the respective communicative functions. @mcneill1968 reported that in the first stage, Izanami used a simple negation like *nai* to express non-existence of events and objects. They also mentioned the early use of *shira-nai* ("I don't know") but did not incorporate it into their developmental account. In the second stage, Izanami used negation to mark incorrectness of statements, e.g., saying "false". Such use of negation was labeled as "denials" in later research. In stage three, negation was also used to express disapproval or rejection - like saying "I don't want that". In the fourth stage, Izanami used negation to express contrasts - as if to say "not this but something else". Finally in the last stage, Izanami had an abstract and multi-functional concept of negation. According to @mcneill1968, these stages took about five months and started with expressing external states (non-existence of objects) before internal desires (rejection).

@bloom1970language considered three communicative functions for early negation: non-existence, rejection, and denial. She studied three children, two from 19 months and another from 21 months of age. She argued that in all three children, negation was produced in the following order: non-existence, rejection, and denial. Table \@ref(tab:bloom) provides a few examples for each category. Many of these examples do not immediately stand out as instances of their category. This is partly because many early examples in child production are fairly short with underspecified syntactic structures, leading their interpretations to be heavily reliant on the context. It is therefore hard to assess the intention behind the use of negation in such cases.

| Non-existence                    | Rejection             | Denial                  |
|------------------------------|---------------------|----------------------|
| ***no*** *more choochoo train*   | ***no*** *train*      | ***no*** *Daddy hungry* |
| ***no*** *more noise*            | ***no*** *want this*  | ***no*** *more birdie*  |
| ***no*** *children*              | ***no*** *bear book*  | ***no*** *ready*        |
| ***no*** *it won't fit*          | ***no*** *go outside* | ***no*** *tire*         |
| *Kathryn* ***no*** *like celery* | ***no*** *dirty soap* | ***no*** *dirty*        |

: (#tab:bloom) Examples of non-existence, rejection, and denial negation in the speech of Eric, Kathryn, and Gia from @bloom1970language.

@pea1978 studied six children between the ages of 8-24 months. Children were recorded in their homes for about 90 minutes every month. All utterances that convey a negative meaning (e.g., containing *no*, *not*, *all gone*, *gone*, *away*, *stop*) and gestures (e.g., headshakes and headnods) were annotated and analyzed. @pea1978 reported that children first started by using negation to express internal states (rejection), then external states (non-existence), and finally they used negation to connect language and the external world, (e.g., truth-functional negation or denials). This was in direct contradiction to @mcneill1968 who proposed that children start with expressing external states before internal states.

@de1979form examined the communicative functions of negation in the speech of Adam (27-31 months), Eve (18-22 months), and their own child Nicholas (23-29 months). The first two children were recorded for an hour every two or three weeks [@Brown1973]. They annotated children's examples of negation for six communicative functions: non-existence, disappearance, non-occurrence, cessation, rejection, and denial. Disappearance referred to cases where an object became hidden and cessation referred to the use of negation when a movement or action stopped (e.g., "no walk" when a toy stopped walking). They found rejections and denials to be the most frequent (and most reliable-to-annotate) functions of negation, both present in the earliest samples of children's speech. The authors emphasized that there are considerable individual differences across the three children, whose production of negation mirror parent usage and child-directed speech; therefore the results cannot be taken as strong evidence that there are specific fixed stages of development for negation in child production. 

<!--
The authors emphasized that there are considerable individual differences that mirror parent usage and child-directed speech rather than specific fixed stages of development.
-->

@choi1988semantic looked at the speech of 11 children (2 English, 4 Korean and 5 French speaking) between 19 to 40 months of age. She reported 9 communicative functions for children's negation shown in Table \@ref(tab:choi). She matched communicative functions with linguistic constructions that commonly convey them and proposed that these constructions and functions developed in three phases. First, children used *no* alone to express the four functions of non-existence, prohibition, rejection, and failure. In the second phase, *no* was used to express denial, inability, and epistemic negation. New constructions such as "not+Noun Phrase" (e.g., "not a bee"), *can't* (e.g. "I can't put back"), and "I don't know" also emerged to express these functions. New constructions were also used to distinguish the functions in the previous phase such as rejection (e.g. "I don't want to"). In the third phase, normative negation and inferential negation emerged in children's speech with modal auxiliaries like *can't*. Negative forms for prohibition also appeared with the structure "don't+Verb".

| Function| Definition| Constructions| Example|
|--------------|-----------------|--------------|---------------------------|
| Non-existence | expressing absence of entities| *no*+V| "no more" (after emptying a bag)|
| Failure | expressing absence of an event| *it won't*| "not work" (puzzle piece not fitting)|
| Prohibition| negating actions of others| *don't* + V| |
| Rejection| negating the child's own actions | *I don't want (to)* ||
| Denial | negating others' propositions| AUX + *not*| "no that's a pony" (in response to "Is this a car?")  |
| Inability| expressing physical inability || "can't!" (taking two lego pieces apart)               |
| Epistemic| lack of knowledge| *I don't know* | "I don't know" (in response to "what color is this?")|
| Normative| expressing expected norms| *(you) can't*| "Him can't go on a boat"|
| Inferential| child's inference about the listener | AUX + *not*| "I not broken this" (seeing a broken crayon)|
: (#tab:choi) Examples of communicative functions and their forms in @choi1988semantic.

@cameron2007part recorded an English speaking child for an hour five times a week between the ages of 27 to 39 months. They classified his negative utterances into seven communicative functions by using categories from @choi1988semantic and leaving out normative and inferential negation. They found examples of all seven functions in Brian's early speech. Starting at 27 months, single-word discourse-level *no* was used to convey most functions but gradually other forms using *not*, *don't*, *can't*, or *won't* emerged and replaced *no* in usage. For instance with inability and prohibition, Brian mostly used *no* and *not* at 27 months but switched to *can't* to express inability, and *don't* to express prohibition at 39 months. @cameron2007part argued that at 27 months, Brian had a broad conceptualization of negation and likely represented it as a "unitary category in conceptual space".

In a recent study, @nordmeyer2018individual looked at twice-a-month recordings of five children between the 12-36 months of age (1-3 years) in the Providence corpus [@demuth2006word] and classified children's negative utterances into seven functional categories: disappearance, prohibition, self-prohibition, refusal (rejection), failure, denial, and unfulfilled expectations. Self-prohibition referred to cases where children addressed a prohibition to themselves (e.g. saying *no* to themselves when reaching for a forbidden object) and unfulfilled expectations referred to instances that expressed surprise when an object was not in an expected place, similar to some cases of non-existence in previous research. They found that refusal (rejections) and denial were the most common functions in children's production and that children varied with respect to which function was produced first. In line with @de1979form, they concluded that the developmental trajectory of different communicative functions of negation may not be as consistent across individuals as some previous research had suggested.

| Study | Number of Children | Age Range (Months) | Proposed Functional Stages|
|------------|------------|------------|-------------------------------------|
| @mcneill1968 | 1 | 27-32 | non-existence \> denial (non-contrastive) \> rejection \> denial (contrastive)|
| @bloom1970language| 3 | 19-28 | non-existence \> rejection \> denial|
| @pea1978 | 6 | 8-24 | rejection \> non-existence \> denial |
| @de1979form | 3 | 18-31 | rejection, denial (variable) |
| @choi1988semantic | 11 | 19-40 | non-existence, prohibition, rejection, failure \> denial, inability, epistemic \> normative, inferential |
| @cameron2007part | 1 | 27-39 | non-existence, failure, prohibition, rejection, denial, inability, epistemic |
| @nordmeyer2018individual | 5 | 12-36 | denial, rejection, prohibition, failure, disappearance (variable) |
: (#tab:summary) Summary of previous studies on the development of negation's communicative functions; "variable" indicates the developmental order of different functions claimed by the study is not fixed.

Table \@ref(tab:summary) provides a summary of previous research on the communicative functions of negation in children's speech. As the summary shows, there is currently no consensus on which functional categories should be included or in which order they are produced. Here we are going to discuss three possible reasons for this lack of consensus. First, @de1979form and @nordmeyer2018individual have emphasized that there is considerable variability among children and their parents in their use of negation. Given that previous studies have typically considered only a few children (3-4 on average), they could have reached conclusions that are true of their sample but not of the population of English-speaking children.

Second, previous studies have used monthly or fortnightly recordings of children's speech for about 60-90 minutes per recording session. Given that children produce many hours of speech daily, such sparse sampling might have created accidental gaps for certain communicative functions and consequently made it as if functions appear in ordered stages. The only study with relatively dense recording is @cameron2007part which reports the presence of all communicative functions in the child's speech from early on. However, the recordings for their study start at a later age (27 months) than many other studies.

Third, prior research shows that defining and detecting the communicative functions of negation is not a trivial task. Different studies have sometimes used different basic categories and different definitions or criteria for classifying negative utterances. Therefore, what counts as an instance of rejection or non-existence may vary among studies and contribute to the reported variability. Most importantly, annotations focus on many utterances with underspecified syntactic structures such as "no car" or "no more", which are highly ambiguous and can count as an instance of different communicative functions. Does "no car" mean "there is no car here" (non-existence) or "I don't want a toy car" (rejection)? Researchers often have to rely on the context but the context is not fully represented in many child language corpora used for annotations. More importantly, this approach is not scalable to larger numbers of children and bigger corpora since manual annotations take considerable amount of time, energy, and training. In the next section, we discuss how the current study addresses these three issues.

# Current Study

This study builds on previous research in four ways. First, it uses large corpora of parent-child interactions, aggregating speech samples from 693 children between the ages of 1-6 years (12-72 months). If the lack of consensus in previous research was mainly due to the small number of children or speech samples, increasing these numbers should address the issue. Aggregating speech samples across children would also provide denser samples at each age interval and reduce the possibility of accidental gaps. The reasoning behind this approach is that despite individual variation, if there are general developmental stages, they should be detectable in large aggregated corpora of children's speech.

Second, in this study we adopted @choi1988semantic's approach; instead of classifying negative communicative functions, we classifed negative constructions that typically communicate negative communicative functions (Table \@ref(tab:summary)). Here by negative constructions, we refer to syntactic constructions modified by any one of the three negative morphemes in English: *no*, *not*, *n't*. Table \@ref(tab:constructions) summarizes the constructions and communicative functions used in this study. This approach has a few advantages. To begin with, negative constructions are more concrete and thus easier to define. For example, utterances that combine negation with the main verb *want* (e.g., "I don't want that") constitute a construction that typically conveys rejection. In addition, because of their concrete definitions, negative constructions can be detected and classified automatically in large corpora following lexical and syntactic heuristics. For instance, rather than manually annotating sentences that express rejection, it is relatively easier to automate the process by searching for utterances containing the verb *want* modified by negative morphemes.

| Function | Negative morpheme combines with | Examples (negative)|
|----------------|-------------------|-------------------------------------|
| Rejection | *like*/*want* | *I* ***not*** *like it*; ***not*** *want it*|
| Non-existence | *there*-expletive | *there is* ***no*** *soup*|
| Prohibition | imperative subjectless *do* |*do* ***not*** *spill milk*|
| Inability| *can*| *I can* ***not*** *zip it*|
| Labeling (Denial) | nominal/adjectival predicates | *that's* ***not*** *a crocodile*; *it's* ***no*** *interesting* |
| Epistemic | *know*/*think*/*remember* | *I* ***not*** *know/think/remember*|
| Possession| *have*/possesive pronouns | ***not*** *have the toy*; ***not*** *mine*|
: (#tab:constructions) Negative constructions used in this study that typically convey communicative functions studied in previous functional accounts of negation development.

Third, focusing on children's productions runs the risk of underestimating their linguistic competence. Children produce shorter constructions and utterances before longer ones and typically develop the comprehension of those constructions before they can produce them [@clark2009first]. For example, children may be able to understand rejection and communicate it with a simple *no* in response to a question like "do you want an apple?", before they can produce the full construction "I don't want an apple". In other words, the child may understand the meaning of the question as well as the meaning of *no* and how it anaphorically negates the content of the previous utterance but due to production limitations not be able to produce the full sentence. In this study, we look at children's anaphoric negation with *no* in response to parents positive constructions, as well as their productions of the corresponding negative constructions. We call the first "discourse-level negation" and the second "sentence-level negation". We take children's discourse-level negation as an approximation of their comprehension for negation and their sentence-level negation as an approximation for their production.

Fourth, we use growth curves to model the development of negative constructions in children's speech. We also estimate the age at which children reach maximum growth in their comprehension and production of different communicative functions of negation. For proxy measures of both comprehension and production, we check to see if the estimated age ranges support the hypothesis that negation develops in stages. We also ask whether developmental stages mirror each other in comprehension and production, or whether we find different stages and patterns of development for comprehension vs. production.

## Methods

We used the CHILDES database [@macwhinney2000childes]\footnote{Code and data are in quarantine at \url{https://thegoodplace.com}} and selected data of English speaking children with typical development within the age range of 12-72 months. Parents' and children's utterances were extracted via the childes-db [@sanchez2019childes] interface using the programming language R. In order to obtain (morpho)syntactic representations for parents' and children's utterances, we used the dependency grammar framework [@dg]. Part-of-speech (POS) tags for each token within an utterance were automatically derived with Stanza [@qi-etal-2020-stanza], an open-source natural language processing library; dependency relations for all utterances were acquired also in an automatic fashion using DiaParser [@diaparser], a dependency parsing system that has been demonstrated to achieve excellent performance for at least written texts in English.

<!--https://github.com/zoeyliu18/Negative_Constructions.-->

At the sentence level, we characterized the syntactic features of the negative utterances associated with each communicative function (Table \@ref(tab:constructions)), then classified utterances based on these features in a rule-based fashion with the help of POS information and syntactic dependencies. To decouple the development of the syntactic construction from the development of negation in that construction, we also examined the production of positive counterparts to each negative construction. The positive counterparts of our negative constructions share the same syntactic features (e.g., same head verb) but they have no negative morphemes (e.g. "I know" for "I don't know"). Although these positive constructions do not express the same communicative function as their negative counterparts, our main purpose for including them is to factor in the development of the syntactic construction without negation as a reference.

At the discourse level, we analyze the negative constructions that the discourse particle *no* stands for (or responds to in cases like prohibition, as discussed in the previous section). To achieve this, we selected utterances that started with negative discourse particles like "no no I like it" and the dependency parser had tagged their dependency relation as *discourse*. We also included cases with repetitions of the discourse particle ("no no no"). For each negative utterance identified this way, we extracted the previous utterance (the antecedent) in the discourse context. For child speech, we included antecedents produced by either the parents or the children themselves. For parent speech, we only included interactions where the antecedent was produced by children. We then applied the same analyses performed on sentence level constructions to these antecedent utterances. The assumption is that the negative discourse particle *no* is implicitly negating the content of the discourse antecedent.

We took age as a proxy for children's developmental stage and divided the 12-72 months range into monthly bins. We used the following two metrics to measure the production level of every communicative function at each age bin. First, we defined the ratio $f_{c,t}$ for construction $c$ and age bin $t$ as the number of utterances in construction $c$ and age bin $t$ divided by the total number of utterances produced at age bin $t$. For example, there are a total of 81,302 utterances produced by children at age 30 months in the data, out of which 391 were classified as rejections. Therefore the ratio of rejection at 30 months is 391/81,302 = 0.005.

$f_{c, t} = \frac{n_{c,t}}{n_{t}}$

Second, we borrowed the measure of "cumulative (moving) ratio" from the analysis of time series data [@wei2006time]. We defined the cumulative ratio $F_{c,t}$ for a construction $c$ at age bin $t$, as the sum of the number of utterances produced with construction $c$ from the first age bin to age bin $t$, divided by the sum of all utterances produced between the first age bin and age bin $t$. For instance, up to age 30 months, children in our corpus produced 721,748 total utterances, out of which 2,166 were instances of rejection. Therefore, the cumulative ratio of rejection at age 30 months is 2,166/721,748 = 0.003. The cumulative ratio has the advantage that at each age bin, it takes into account the production in previous age bins. Assuming that children accumulate linguistic knowledge throughout their development, this measure provides a more realistic and stable measure of children's productive capacity at each age.

$F_{c, t} = \frac{\sum_{i=1}^{t} n_{c,i}}{\sum_{i=1}^{t} n_{i}}$

The two ratios mentioned above were calculated for negative constructions (and their positive counterparts) at the sentence and discourse levels for children as well as parents. For the sake of presentations, our figures focus on the results of cumulative ratios. In addition, in this study we use parents' speech as a benchmark for children's development. Therefore, the subfigures within each figure contrast children's production to that of parents' at the corresponding age of the children.

```{r function}

entropy <- function(data){
  start = 0
  for (i in 1:nrow(data)){
    p = as.vector(data$Total_ratio)[i] 
    start = start - p * log2(p)
  }
  start = start / nrow(data)
  return(start)
}

```

```{r negative_cumulative_function}

negative_cumulative <- function(data, descriptive){
  
  age_list <- as.vector(data$Age)
  freq_list <- rep(0, length(age_list))
  n_speaker_list <- rep(0, length(age_list))
  n_utterances_list <- rep(0, length(age_list))
  
  data$Age <- as.numeric(as.vector(data$Age))
  
  for (i in 1:length(age_list)){
    age = as.numeric(age_list[i])
    select <- data.frame(subset(data, Age <= age)) 
    freq = sum(as.numeric(as.vector(select$Freq)))
    n_speaker = sum(as.numeric(as.vector(select$N_speaker)))
    n_utterances = sum(subset(descriptive, as.numeric(Age) <= age)$N_utterance)
    freq_list[i] = freq
    n_speaker_list[i] = n_speaker
    n_utterances_list[i] = n_utterances
    
    }

  data$Age <- as.character(data$Age)
  
  cumulative_ave <- data.frame(as.character(age_list))
  names(cumulative_ave) <- c('Age')
  cumulative_ave$Freq <- freq_list
  cumulative_ave$Role <- rep(unique(data$Role), length(age_list))
  cumulative_ave$Head <- rep(unique(data$Head), length(age_list))
  cumulative_ave$N_speaker <- n_speaker_list
  cumulative_ave$N_utterance <- n_utterances_list
  cumulative_ave$Total_ratio <- cumulative_ave$Freq / cumulative_ave$N_utterance
  cumulative_ave$Ratio <- rep(0, length(age_list))
  cumulative_ave$Polarity <- rep(unique(data$Polarity), length(age_list))
  cumulative_ave$Measure <- rep('negative construction cumulative ratio', length(age_list))
  cumulative_ave$Which <- rep('cumulative ratio', length(age_list))
  cumulative_ave$Function <- rep(unique(data$Function), length(age_list))
  temp <- rbind(data, cumulative_ave)
  data <- temp
  
  return(data)

}

```

```{r positive_cumulative_function}

positive_cumulative <- function(data, descriptive){
  
  age_list <- as.vector(data$Age)
  freq_list <- rep(0, length(age_list))
  n_speaker_list <- rep(0, length(age_list))
  n_utterances_list <- rep(0, length(age_list))
  
  data$Age <- as.numeric(as.vector(data$Age))
  
  for (i in 1:length(age_list)){
    age = as.numeric(age_list[i])
    select <- data.frame(subset(data, Age <= age)) 
    freq = sum(as.numeric(as.vector(select$Freq)))
    n_speaker = sum(as.numeric(as.vector(select$N_speaker)))
    n_utterances = sum(as.numeric(as.vector((subset(descriptive, Age <= age))$N_utterance)))
    freq_list[i] = freq
    n_speaker_list[i] = n_speaker
    n_utterances_list[i] = n_utterances
    
    }
  
  data$Age <- as.character(data$Age)
  
  cumulative_ave <- data.frame(as.character(age_list))
  names(cumulative_ave) <- c('Age')
  cumulative_ave$Freq <- freq_list
  cumulative_ave$Role <- rep(unique(data$Role), length(age_list))
  cumulative_ave$Head <- rep(unique(data$Head), length(age_list))
  cumulative_ave$N_speaker <- n_speaker_list
  cumulative_ave$N_utterance <- n_utterances_list
  cumulative_ave$Total_ratio <- cumulative_ave$Freq / cumulative_ave$N_utterance
  cumulative_ave$Ratio <- rep(0, length(age_list))
  cumulative_ave$Polarity <- rep(unique(data$Polarity), length(age_list))
  cumulative_ave$Measure <- rep('positive construction cumulative ratio', length(age_list))
  cumulative_ave$Which <- rep('cumulative ratio', length(age_list))
  cumulative_ave$Function <- rep(unique(data$Function), length(age_list))
  temp <- rbind(data, cumulative_ave)
  data <- temp
  
  return(data)

}

```

```{r negative_ul_cumulative_function}

negative_ul_cumulative <- function(data, descriptive){
  
  sent_len_list <- as.vector(data$Sent_len)
  freq_list <- rep(0, length(sent_len_list))
  n_speaker_list <- rep(0, length(sent_len_list))
  n_utterances_list <- rep(0, length(sent_len_list))
  
  data$Sent_len <- as.numeric(as.vector(data$Sent_len))
  
  for (i in 1:length(sent_len_list)){
    sent_len = as.numeric(sent_len_list[i])
    select <- data.frame(subset(data, Sent_len <= sent_len)) 
    freq = sum(as.numeric(as.vector(select$Freq)))
    n_speaker = sum(as.numeric(as.vector(select$N_speaker)))
    n_utterances = sum(as.numeric(as.vector((subset(descriptive, Sent_len <= sent_len))$N_utterance)))
    freq_list[i] = freq
    n_speaker_list[i] = n_speaker
    n_utterances_list[i] = n_utterances
    
    }
  
  data$Sent_len <- as.character(data$Sent_len)
  
  cumulative_ave <- data.frame(as.character(sent_len_list))
  names(cumulative_ave) <- c('Sent_len')
  cumulative_ave$Freq <- freq_list
  cumulative_ave$Role <- rep(unique(data$Role), length(sent_len_list))
  cumulative_ave$Head <- rep(unique(data$Head), length(sent_len_list))
  cumulative_ave$N_speaker <- n_speaker_list
  cumulative_ave$N_utterance <- n_utterances_list
  cumulative_ave$Total_ratio <- cumulative_ave$Freq / cumulative_ave$N_utterance
  cumulative_ave$Ratio <- rep(0, length(sent_len_list))
  cumulative_ave$Polarity <- rep(unique(data$Polarity), length(sent_len_list))
  cumulative_ave$Measure <- rep('negative construction cumulative ratio', length(sent_len_list))
  cumulative_ave$Which <- rep('cumulative ratio', length(sent_len_list))
  cumulative_ave$Function <- rep(unique(data$Function), length(sent_len_list))
  temp <- rbind(data, cumulative_ave)
  data <- temp
  
  return(data)

}

```

```{r positive_ul_cumulative_function}
positive_ul_cumulative <- function(data, descriptive){
  
  sent_len_list <- as.vector(data$Sent_len)
  freq_list <- rep(0, length(sent_len_list))
  n_speaker_list <- rep(0, length(sent_len_list))
  n_utterances_list <- rep(0, length(sent_len_list))
  
  data$Sent_len <- as.numeric(as.vector(data$Sent_len))
  
  for (i in 1:length(sent_len_list)){
    sent_len = as.numeric(sent_len_list[i])
    select <- data.frame(subset(data, Sent_len <= sent_len)) 
    freq = sum(as.numeric(as.vector(select$Freq)))
    n_speaker = sum(as.numeric(as.vector(select$N_speaker)))
    n_utterances = sum(as.numeric(as.vector((subset(descriptive, Sent_len <= sent_len))$N_utterance)))
    freq_list[i] = freq
    n_speaker_list[i] = n_speaker
    n_utterances_list[i] = n_utterances
    
    }
  
  data$Sent_len <- as.character(data$Sent_len)
  
  cumulative_ave <- data.frame(as.character(sent_len_list))
  names(cumulative_ave) <- c('Sent_len')
  cumulative_ave$Freq <- freq_list
  cumulative_ave$Role <- rep(unique(data$Role), length(sent_len_list))
  cumulative_ave$Head <- rep(unique(data$Head), length(sent_len_list))
  cumulative_ave$N_speaker <- n_speaker_list
  cumulative_ave$N_utterance <- n_utterances_list
  cumulative_ave$Total_ratio <- cumulative_ave$Freq / cumulative_ave$N_utterance
  cumulative_ave$Ratio <- rep(0, length(sent_len_list))
  cumulative_ave$Polarity <- rep(unique(data$Polarity), length(sent_len_list))
  cumulative_ave$Measure <- rep('positive construction cumulative ratio', length(sent_len_list))
  cumulative_ave$Which <- rep('cumulative ratio', length(sent_len_list))
  cumulative_ave$Function <- rep(unique(data$Function), length(sent_len_list))
  temp <- rbind(data, cumulative_ave)
  data <- temp
  
  return(data)

}

```

```{r mlu_function}

mlu <- function(data){
  
  compose = as.vector(unique(data$Age))
  values = rep(0, length(compose))
  
  for (i in 1:length(compose)){
    age = as.numeric(compose[i])
    select <- data.frame(subset(data, Age <= age))
    mlu_value = sum(as.numeric(select$Sent_len)) / nrow(select)
    values[i] = mlu_value
  }
  
  compose = data.frame(compose)
  names(compose) <- c('Age')
  compose$MLU <- values
  
  return(compose)
  
}  

```

```{r descriptive, include=FALSE}

child_descriptive <- subset(read.csv('data/child_descriptive.txt', header = T, sep = '\t'), Age >= 12 & Age <= 72)
parent_descriptive <- subset(read.csv('data/parent_descriptive.txt', header = T, sep = '\t'), Age >= 12 & Age <= 72)

child_ul_descriptive <- read.csv('data/child_ul_descriptive.txt', header = T, sep = '\t')
parent_ul_descriptive <- read.csv('data/parent_ul_descriptive.txt', header = T, sep = '\t')

child_individual_descriptive <- subset(read.csv('data/individual_child_descriptive.txt', header = T, sep = '\t'), Age >= 12 & Age <= 72)
parent_individual_descriptive <- subset(read.csv('data/individual_parent_descriptive.txt', header = T, sep = '\t'), Age >= 12 & Age <= 72)


```

## Results

In this section, we first present the results for each communicative function and its associated negative constructions separately, before aggregating and presenting them together. We start with rejections.

### Rejection

```{r emotiondata, include=FALSE}

emotion <-read.csv('data/emotion.txt', header = T, sep = '\t')
# emotion <- subset(emotion, Subj == 'I' | Subj == 'NONE')
emotion$Role[which(emotion$Role == "Father")] <- 'Parent'
emotion$Role[which(emotion$Role == "Mother")] <- 'Parent'
emotion$Role[which(emotion$Role == "Target_Child")] <- 'Child'

emotion_neg = subset(emotion, Polarity == 'negative')
emotion_pos = subset(emotion, Polarity == 'positive')

child_emotion_neg <- subset(emotion_neg, Role %in% c('Child'))
parent_emotion_neg <- subset(emotion_neg, Role %in% c('Parent'))


child_like_neg <- subset(child_emotion_neg, Head %in% c('like'))
child_want_neg <- subset(child_emotion_neg, Head %in% c('want'))
parent_like_neg <- subset(parent_emotion_neg, Head %in% c('like'))
parent_want_neg <- subset(parent_emotion_neg, Head %in% c('want'))

child_like_neg_mlu <- mlu(child_like_neg)
child_want_neg_mlu <- mlu(child_want_neg)
parent_like_neg_mlu <- mlu(parent_like_neg)
parent_want_neg_mlu <- mlu(parent_want_neg)

child_like_neg <- data.frame(table(child_like_neg$Age))
names(child_like_neg) <- c('Age', 'Freq')
child_like_neg$Role <- rep('Child', nrow(child_like_neg))
child_like_neg$Head <- rep('like', nrow(child_like_neg))
temp <- merge(child_like_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_like_neg <- temp
child_like_neg$Total_ratio <- child_like_neg$Freq / child_like_neg$N_utterance
child_like_neg$Ratio <- child_like_neg$Freq / sum(child_like_neg$Freq)
child_like_neg$Polarity <- rep('negative', nrow(child_like_neg))
child_like_neg$Measure <- rep('negative construction ratio', nrow(child_like_neg))
child_like_neg$Which <- rep('ratio', nrow(child_like_neg))
child_like_neg$Function <- rep('Rejection', nrow(child_like_neg))
child_like_neg <- negative_cumulative(child_like_neg, child_descriptive)

child_want_neg <- data.frame(table(child_want_neg$Age))
names(child_want_neg) <- c('Age', 'Freq')
child_want_neg$Role <- rep('Child', nrow(child_want_neg))
child_want_neg$Head <- rep('want', nrow(child_want_neg))
temp <- merge(child_want_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_want_neg <- temp
child_want_neg$Total_ratio <- child_want_neg$Freq / child_want_neg$N_utterance
child_want_neg$Ratio <- child_want_neg$Freq / sum(child_want_neg$Freq)
child_want_neg$Polarity <- rep('negative', nrow(child_want_neg))
child_want_neg$Measure <- rep('negative construction ratio', nrow(child_want_neg))
child_want_neg$Which <- rep('ratio', nrow(child_want_neg))
child_want_neg$Function <- rep('Rejection', nrow(child_want_neg))
child_want_neg <- negative_cumulative(child_want_neg, child_descriptive)

parent_like_neg <- data.frame(table(parent_like_neg$Age))
names(parent_like_neg) <- c('Age', 'Freq')
parent_like_neg$Role <- rep('Parent', nrow(parent_like_neg))
parent_like_neg$Head <- rep('like', nrow(parent_like_neg))
temp <- merge(parent_like_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_like_neg <- temp
parent_like_neg$Total_ratio <- parent_like_neg$Freq / parent_like_neg$N_utterance
parent_like_neg$Ratio <- parent_like_neg$Freq / sum(parent_like_neg$Freq)
parent_like_neg$Polarity <- rep('negative', nrow(parent_like_neg))
parent_like_neg$Measure <- rep('negative construction ratio', nrow(parent_like_neg))
parent_like_neg$Which <- rep('ratio', nrow(parent_like_neg))
parent_like_neg$Function <- rep('Rejection', nrow(parent_like_neg))
parent_like_neg <- negative_cumulative(parent_like_neg, parent_descriptive)

parent_want_neg <- data.frame(table(parent_want_neg$Age))
names(parent_want_neg) <- c('Age', 'Freq')
parent_want_neg$Role <- rep('Parent', nrow(parent_want_neg))
parent_want_neg$Head <- rep('want', nrow(parent_want_neg))
temp <- merge(parent_want_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_want_neg <- temp
parent_want_neg$Total_ratio <- parent_want_neg$Freq / parent_want_neg$N_utterance
parent_want_neg$Ratio <- parent_want_neg$Freq / sum(parent_want_neg$Freq)
parent_want_neg$Polarity <- rep('negative', nrow(parent_want_neg))
parent_want_neg$Measure <- rep('negative construction ratio', nrow(parent_want_neg))
parent_want_neg$Which <- rep('ratio', nrow(parent_want_neg))
parent_want_neg$Function <- rep('Rejection', nrow(parent_want_neg))
parent_want_neg <- negative_cumulative(parent_want_neg, parent_descriptive)


child_emotion_pos <- subset(emotion_pos, Role %in% c('Child'))
parent_emotion_pos <- subset(emotion_pos, Role %in% c('Parent'))


child_like_pos <- subset(child_emotion_pos, Head %in% c('like'))
child_want_pos <- subset(child_emotion_pos, Head %in% c('want'))
parent_like_pos <- subset(parent_emotion_pos, Head %in% c('like'))
parent_want_pos <- subset(parent_emotion_pos, Head %in% c('want'))

child_like_pos_mlu <- mlu(child_like_pos)
child_want_pos_mlu <- mlu(child_want_pos)
parent_like_pos_mlu <- mlu(parent_like_pos)
parent_want_pos_mlu <- mlu(parent_want_pos)

child_like_pos <- data.frame(table(child_like_pos$Age))
names(child_like_pos) <- c('Age', 'Freq')
child_like_pos$Role <- rep('Child', nrow(child_like_pos))
child_like_pos$Head <- rep('like', nrow(child_like_pos))
temp <- merge(child_like_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_like_pos <- temp
child_like_pos$Total_ratio <- child_like_pos$Freq / child_like_pos$N_utterance
child_like_pos$Ratio <- child_like_pos$Freq / sum(child_like_pos$Freq)
child_like_pos$Polarity <- rep('positive', nrow(child_like_pos))
child_like_pos$Measure <- rep('positive construction ratio', nrow(child_like_pos))
child_like_pos$Which <- rep('ratio', nrow(child_like_pos))
child_like_pos$Function <- rep('Rejection', nrow(child_like_pos))
child_like_pos <- positive_cumulative(child_like_pos, child_descriptive)


child_want_pos <- data.frame(table(child_want_pos$Age))
names(child_want_pos) <- c('Age', 'Freq')
child_want_pos$Role <- rep('Child', nrow(child_want_pos))
child_want_pos$Head <- rep('want', nrow(child_want_pos))
temp <- merge(child_want_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_want_pos <- temp
child_want_pos$Total_ratio <- child_want_pos$Freq / child_want_pos$N_utterance
child_want_pos$Ratio <- child_want_pos$Freq / sum(child_want_pos$Freq)
child_want_pos$Polarity <- rep('positive', nrow(child_want_pos))
child_want_pos$Measure <- rep('positive construction ratio', nrow(child_want_pos))
child_want_pos$Which <- rep('ratio', nrow(child_want_pos))
child_want_pos$Function <- rep('Rejection', nrow(child_want_pos))
child_want_pos <- positive_cumulative(child_want_pos, child_descriptive)

parent_like_pos <- data.frame(table(parent_like_pos$Age))
names(parent_like_pos) <- c('Age', 'Freq')
parent_like_pos$Role <- rep('Parent', nrow(parent_like_pos))
parent_like_pos$Head <- rep('like', nrow(parent_like_pos))
temp <- merge(parent_like_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_like_pos <- temp
parent_like_pos$Total_ratio <- parent_like_pos$Freq / parent_like_pos$N_utterance
parent_like_pos$Ratio <- parent_like_pos$Freq / sum(parent_like_pos$Freq)
parent_like_pos$Polarity <- rep('positive', nrow(parent_like_pos))
parent_like_pos$Measure <- rep('positive construction ratio', nrow(parent_like_pos))
parent_like_pos$Which <- rep('ratio', nrow(parent_like_pos))
parent_like_pos$Function <- rep('Rejection', nrow(parent_like_pos))
parent_like_pos <- positive_cumulative(parent_like_pos, parent_descriptive)

parent_want_pos <- data.frame(table(parent_want_pos$Age))
names(parent_want_pos) <- c('Age', 'Freq')
parent_want_pos$Role <- rep('Parent', nrow(parent_want_pos))
parent_want_pos$Head <- rep('want', nrow(parent_want_pos))
temp <- merge(parent_want_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_want_pos <- temp
parent_want_pos$Total_ratio <- parent_want_pos$Freq / parent_want_pos$N_utterance
parent_want_pos$Ratio <- parent_want_pos$Freq / sum(parent_want_pos$Freq)
parent_want_pos$Polarity <- rep('positive', nrow(parent_want_pos))
parent_want_pos$Measure <- rep('positive construction ratio', nrow(parent_want_pos))
parent_want_pos$Which <- rep('ratio', nrow(parent_want_pos))
parent_want_pos$Function <- rep('Rejection', nrow(parent_want_pos))
parent_want_pos <- positive_cumulative(parent_want_pos, parent_descriptive)

emotion_data <- rbind(child_like_neg, parent_like_neg, child_want_neg, parent_want_neg, child_like_pos, parent_like_pos, child_want_pos, parent_want_pos)

emotion_data$Measure <- factor(emotion_data$Measure, levels = c('negative construction ratio', 'negative construction cumulative ratio', 'positive construction ratio', 'positive construction cumulative ratio'))

emotion_data_child <- subset(emotion_data, Role == 'Child')
emotion_data_parent <- subset(emotion_data, Role == 'Parent')

emotion_data$Production <- paste(emotion_data$Role, emotion_data$Measure, sep= " ")

```

```{r emotiondiscoursedata, include=FALSE}

discourse_emotion <-read.csv('data/emotion_discourse.txt', header = T, sep = '\t')
discourse_emotion$Role[which(discourse_emotion$Role == "Father")] <- 'Parent'
discourse_emotion$Role[which(discourse_emotion$Role == "Mother")] <- 'Parent'
discourse_emotion$Role[which(discourse_emotion$Role == "Target_Child")] <- 'Child'

discourse_emotion_neg = subset(discourse_emotion, Polarity == 'negative')
discourse_emotion_pos = subset(discourse_emotion, Polarity == 'positive')

discourse_child_emotion_neg <- subset(discourse_emotion_neg, Role %in% c('Child'))
discourse_parent_emotion_neg <- subset(discourse_emotion_neg, Role %in% c('Parent'))

discourse_child_emotion_neg <- data.frame(table(discourse_child_emotion_neg$Age))
names(discourse_child_emotion_neg) <- c('Age', 'Freq')
discourse_child_emotion_neg$Role <- rep('Child', nrow(discourse_child_emotion_neg))
discourse_child_emotion_neg$Head <- rep('both', nrow(discourse_child_emotion_neg))
temp <- merge(discourse_child_emotion_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_emotion_neg <- temp
discourse_child_emotion_neg$Total_ratio <- discourse_child_emotion_neg$Freq / discourse_child_emotion_neg$N_utterance
discourse_child_emotion_neg$Ratio <- discourse_child_emotion_neg$Freq / discourse_child_emotion_neg$N_utterance
discourse_child_emotion_neg$Polarity <- rep('negative', nrow(discourse_child_emotion_neg))
discourse_child_emotion_neg$Measure <- rep('negative construction ratio', nrow(discourse_child_emotion_neg))
discourse_child_emotion_neg$Which <- rep('ratio', nrow(discourse_child_emotion_neg))
discourse_child_emotion_neg$Function <- rep('Rejection', nrow(discourse_child_emotion_neg))
discourse_child_emotion_neg <- negative_cumulative(discourse_child_emotion_neg, child_descriptive)

discourse_parent_emotion_neg <- data.frame(table(discourse_parent_emotion_neg$Age))
names(discourse_parent_emotion_neg) <- c('Age', 'Freq')
discourse_parent_emotion_neg$Role <- rep('Parent', nrow(discourse_parent_emotion_neg))
discourse_parent_emotion_neg$Head <- rep('both', nrow(discourse_parent_emotion_neg))
temp <- merge(discourse_parent_emotion_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_emotion_neg <- temp
discourse_parent_emotion_neg$Total_ratio <- discourse_parent_emotion_neg$Freq / discourse_parent_emotion_neg$N_utterance
discourse_parent_emotion_neg$Ratio <- discourse_parent_emotion_neg$Freq / discourse_parent_emotion_neg$N_utterance
discourse_parent_emotion_neg$Polarity <- rep('negative', nrow(discourse_parent_emotion_neg))
discourse_parent_emotion_neg$Measure <- rep('negative construction ratio', nrow(discourse_parent_emotion_neg))
discourse_parent_emotion_neg$Which <- rep('ratio', nrow(discourse_parent_emotion_neg))
discourse_parent_emotion_neg$Function <- rep('Rejection', nrow(discourse_parent_emotion_neg))
discourse_parent_emotion_neg <- negative_cumulative(discourse_parent_emotion_neg, parent_descriptive)

discourse_child_emotion_pos <- subset(discourse_emotion_pos, Role %in% c('Child'))
discourse_parent_emotion_pos <- subset(discourse_emotion_pos, Role %in% c('Parent'))

discourse_child_emotion_pos <- data.frame(table(discourse_child_emotion_pos$Age))
names(discourse_child_emotion_pos) <- c('Age', 'Freq')
discourse_child_emotion_pos$Role <- rep('Child', nrow(discourse_child_emotion_pos))
discourse_child_emotion_pos$Head <- rep('both', nrow(discourse_child_emotion_pos))
temp <- merge(discourse_child_emotion_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_emotion_pos <- temp
discourse_child_emotion_pos$Total_ratio <- discourse_child_emotion_pos$Freq / discourse_child_emotion_pos$N_utterance
discourse_child_emotion_pos$Ratio <- discourse_child_emotion_pos$Freq / discourse_child_emotion_pos$N_utterance
discourse_child_emotion_pos$Polarity <- rep('positive', nrow(discourse_child_emotion_pos))
discourse_child_emotion_pos$Measure <- rep('positive construction ratio', nrow(discourse_child_emotion_pos))
discourse_child_emotion_pos$Which <- rep('ratio', nrow(discourse_child_emotion_pos))
discourse_child_emotion_pos$Function <- rep('Rejection', nrow(discourse_child_emotion_pos))
discourse_child_emotion_pos <- positive_cumulative(discourse_child_emotion_pos, child_descriptive)


discourse_parent_emotion_pos <- data.frame(table(discourse_parent_emotion_pos$Age))
names(discourse_parent_emotion_pos) <- c('Age', 'Freq')
discourse_parent_emotion_pos$Role <- rep('Parent', nrow(discourse_parent_emotion_pos))
discourse_parent_emotion_pos$Head <- rep('both', nrow(discourse_parent_emotion_pos))
temp <- merge(discourse_parent_emotion_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_emotion_pos <- temp
discourse_parent_emotion_pos$Total_ratio <- discourse_parent_emotion_pos$Freq / discourse_parent_emotion_pos$N_utterance
discourse_parent_emotion_pos$Ratio <- discourse_parent_emotion_pos$Freq / discourse_parent_emotion_pos$N_utterance
discourse_parent_emotion_pos$Polarity <- rep('positive', nrow(discourse_parent_emotion_pos))
discourse_parent_emotion_pos$Measure <- rep('positive construction ratio', nrow(discourse_parent_emotion_pos))
discourse_parent_emotion_pos$Which <- rep('ratio', nrow(discourse_parent_emotion_pos))
discourse_parent_emotion_pos$Function <- rep('Rejection', nrow(discourse_parent_emotion_pos))
discourse_parent_emotion_pos <- positive_cumulative(discourse_parent_emotion_pos, parent_descriptive)

discourse_emotion_data <- rbind(discourse_child_emotion_neg, discourse_parent_emotion_neg, discourse_child_emotion_pos, discourse_parent_emotion_pos)

discourse_emotion_data$Measure <- factor(discourse_emotion_data$Measure, levels = c('negative construction ratio', 'negative construction cumulative ratio', 'positive construction ratio', 'positive construction cumulative ratio'))


discourse_emotion_data_child <- subset(discourse_emotion_data, Role == 'Child')
discourse_emotion_data_parent <- subset(discourse_emotion_data, Role == 'Parent')

discourse_emotion_data_plot <- aggregate(Total_ratio~Age+Which+Role,data=discourse_emotion_data,sum)

names(discourse_emotion_data_plot) <- c('Age', 'Measure', 'Role', 'Total_ratio')

```

For instances of rejection and their positive counterparts, we selected utterances in which the lemma of the head verb of the phrase was either *like* or *want*. For negative instances, the head verb is modified by one of the three negative morphemes *no*, *not* or *n't*, whereas cases including the same head verb but without negation were classified as positive (Table \@ref(tab:rejection)). In particular, the negative utterances included cases in which the speakers describe their own desires with or without an auxiliary verb, examples that express rhetorical inquiries of desires from one interlocutor to another, and instances where the speaker is describing the desires of somebody else. Our search critiera for this function led to a total of `r format(sum(subset(emotion_data,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")` negative utterances (child: `r format(sum(subset(emotion_data_child,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`; parent: `r format(sum(subset(emotion_data_parent,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`), and a total of `r format(sum(subset(emotion_data,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")` positive utterances (child: `r format(sum(subset(emotion_data_child,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`; parent: `r format(sum(subset(emotion_data_parent,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`).

| Rejection (Negative)                   | Positive counterpart |
|----------------------------------------|----------------------|
| *I* ***no*** *like sea*                | *she likes cheese*   |
| *do**n't*** *wanna go*                 | *I want it*          |
| *do**n't*** *you wanna try it*         | *I wanna have that*  |
| *Sarah does**n't*** *like that either* | *she likes this one* |

: (#tab:rejection) Examples of sentence-level rejections and their positive counterparts in children's speech.

```{r emotion, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=6.5, fig.height=4, set.cap.width=T, num.cols.cap=1, fig.cap="Cumulative ratios for the production of rejection at the sentence level for children between 12 to 72 months of age, and their parents. The y-axes are scaled differently for the panels to accommodate differences in production ratios."}

subset(emotion_data, Which=='cumulative ratio')  %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Production, color = Production)) +
  geom_line(aes(linetype=Production), alpha = 1) +
#  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Production, shape = Production), size = 1.5) +
#  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkred", "darkgreen", "steelblue",  "mediumpurple4")) + 
  facet_wrap(Head ~ Polarity, scales = "free_y") +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") + 
  guides(color = guide_legend(nrow = 2)) + 
  theme(legend.title = element_blank())

```

Starting with our analysis at the sentence level, Figure \@ref(fig:emotion) shows the cumulative ratios of parents' and children's instances of rejections and their positive counterparts (y-axis) with age along the x-axis. Overall, we see a similar pattern of production for rejection whether the head verb is *want* or *like* in child speech. Children's production of rejection gradually increases between the ages of 18 and 36 months. After about 36 months of age, children's production of these constructions starts to become relatively constant and close to parent levels. In all age bins, the production ratio for negative utterances was lower than that for their positive counterparts.

At the discourse level, we investigated discourse interactions (antecedent + utterance with negative discourse particle) in which the antecedent has one of the head verbs *like* or *want*, yet the head verb does not have to be modified by negative morphemes (Table \@ref(tab:disreject)). We found a total of `r format(sum(subset(discourse_emotion_data,Which=='ratio')$Freq), big.mark=",")` such utterances (child: `r format(sum(subset(discourse_emotion_data_child,Which=='ratio')$Freq), big.mark=",")`; parent: `r format(sum(subset(discourse_emotion_data_parent,Which=='ratio')$Freq), big.mark=",")`). As shown in Figure 2, children's production of *no* to convey rejection increases regularly from the age of 18 - 36 months.\footnote{For each communicative function, at the discourse level we also examined cases of different subtypes (e.g., different head verbs) separately; though due to data sparsity issues, we collapsed these instances for our final analyses.} Overall, discourse-level rejection is produced more frequently in child speech compared to parent speech.

| Antecedent                       | Utterance                                   |
|-------------------------------|-----------------------------------------|
| Parent: *I want you to try it*   | Child: ***no no no***                       |
| Parent: *would you like to go*   | Child: ***no no***                          |
| Child: *I do**n't*** *like that* | Parent: ***no*** *honey you have to try it* |
| Child: *I want it*               | Parent: ***no*** *this is not for you*      |

: (#tab:disreject) Examples of discourse-level rejections in children's and parents' speech.

```{r emotiondiscourse, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=2.8, set.cap.width=T, num.cols.cap=1, fig.cap="Cumulative ratios for the production of rejection at the discourse level for children between 12 to 72 months of age, and their parents.",warning=FALSE}

subset(discourse_emotion_data_plot, Measure=='cumulative ratio') %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Role, color = Role)) +
  geom_line(aes(linetype=Role), alpha = 1) +
  scale_linetype_manual(values=c('solid', 'dotted')) +
  geom_point(aes(color = Role, shape = Role), size = 1.5) +
  scale_shape_manual(values = c(16, 3)) +
  scale_color_manual(values = c("darkblue", "peru")) + 
#  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio")

```

### Non-existence

```{r perceptiondata, include=FALSE}

perception <-read.csv('data/perception.txt', header = T, sep = '\t')
# perception <- subset(perception, Subj == 'I' | Subj == 'NONE')
perception$Role[which(perception$Role == "Father")] <- 'Parent'
perception$Role[which(perception$Role == "Mother")] <- 'Parent'
perception$Role[which(perception$Role == "Target_Child")] <- 'Child'

perception_neg = subset(perception, Polarity == 'negative')
perception_pos = subset(perception, Polarity == 'positive')

child_perception_neg <- subset(perception_neg, Role %in% c('Child'))
parent_perception_neg <- subset(perception_neg, Role %in% c('Parent'))

child_existence_neg <- subset(child_perception_neg, Function %in% c('existence'))
child_possession_have_neg <- subset(child_perception_neg, Function %in% c('possession') & Head %in% c('have'))
child_possession_pro_neg <- subset(child_perception_neg, Function %in% c('possession') & Head != 'have')
parent_existence_neg <- subset(parent_perception_neg, Function %in% c('existence'))
parent_possession_have_neg <- subset(parent_perception_neg, Function %in% c('possession') & Head %in% c('have'))
parent_possession_pro_neg <- subset(parent_perception_neg, Function %in% c('possession') & Head != 'have')

child_existence_neg_mlu <- mlu(child_existence_neg)
child_possession_have_neg_mlu <- mlu(child_possession_have_neg)
child_possession_pro_neg_mlu <- mlu(child_possession_pro_neg)
parent_existence_neg_mlu <- mlu(parent_existence_neg)
parent_possession_have_neg_mlu <- mlu(parent_possession_have_neg)
parent_possession_pro_neg_mlu <- mlu(parent_possession_pro_neg)

child_existence_neg <- data.frame(table(child_existence_neg$Age))
names(child_existence_neg) <- c('Age', 'Freq')
child_existence_neg$Role <- rep('Child', nrow(child_existence_neg))
child_existence_neg$Head <- rep('', nrow(child_existence_neg))
temp <- merge(child_existence_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_existence_neg <- temp
child_existence_neg$Total_ratio <- child_existence_neg$Freq / child_existence_neg$N_utterance
child_existence_neg$Ratio <- child_existence_neg$Freq / sum(child_existence_neg$Freq)
child_existence_neg$Polarity <- rep('negative', nrow(child_existence_neg))
child_existence_neg$Measure <- rep('negative construction ratio', nrow(child_existence_neg))
child_existence_neg$Which <- rep('ratio', nrow(child_existence_neg))
child_existence_neg$Function <- rep('Non-existence', nrow(child_existence_neg))
child_existence_neg <- negative_cumulative(child_existence_neg, child_descriptive)


child_possession_have_neg <- data.frame(table(child_possession_have_neg$Age))
names(child_possession_have_neg) <- c('Age', 'Freq')
child_possession_have_neg$Role <- rep('Child', nrow(child_possession_have_neg))
child_possession_have_neg$Head <- rep('have', nrow(child_possession_have_neg))
temp <- merge(child_possession_have_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_possession_have_neg <- temp
child_possession_have_neg$Total_ratio <- child_possession_have_neg$Freq / child_possession_have_neg$N_utterance
child_possession_have_neg$Ratio <- child_possession_have_neg$Freq / sum(child_possession_have_neg$Freq)
child_possession_have_neg$Polarity <- rep('negative', nrow(child_possession_have_neg))
child_possession_have_neg$Measure <- rep('negative construction ratio', nrow(child_possession_have_neg))
child_possession_have_neg$Which <- rep('ratio', nrow(child_possession_have_neg))
child_possession_have_neg$Function <- rep('Possession', nrow(child_possession_have_neg))
child_possession_have_neg <- negative_cumulative(child_possession_have_neg, child_descriptive)

child_possession_pro_neg <- data.frame(table(child_possession_pro_neg$Age))
names(child_possession_pro_neg) <- c('Age', 'Freq')
child_possession_pro_neg$Role <- rep('Child', nrow(child_possession_pro_neg))
child_possession_pro_neg$Head <- rep('pronoun', nrow(child_possession_pro_neg))
temp <- merge(child_possession_pro_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_possession_pro_neg <- temp
child_possession_pro_neg$Total_ratio <- child_possession_pro_neg$Freq / child_possession_pro_neg$N_utterance
child_possession_pro_neg$Ratio <- child_possession_pro_neg$Freq / sum(child_possession_pro_neg$Freq)
child_possession_pro_neg$Polarity <- rep('negative', nrow(child_possession_pro_neg))
child_possession_pro_neg$Measure <- rep('negative construction ratio', nrow(child_possession_pro_neg))
child_possession_pro_neg$Which <- rep('ratio', nrow(child_possession_pro_neg))
child_possession_pro_neg$Function <- rep('Possession', nrow(child_possession_pro_neg))
child_possession_pro_neg <- negative_cumulative(child_possession_pro_neg, child_descriptive)

parent_existence_neg <- data.frame(table(parent_existence_neg$Age))
names(parent_existence_neg) <- c('Age', 'Freq')
parent_existence_neg$Role <- rep('Parent', nrow(parent_existence_neg))
parent_existence_neg$Head <- rep('existence', nrow(parent_existence_neg))
temp <- merge(parent_existence_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_existence_neg <- temp
parent_existence_neg$Total_ratio <- parent_existence_neg$Freq / parent_existence_neg$N_utterance
parent_existence_neg$Ratio <- parent_existence_neg$Freq / sum(parent_existence_neg$Freq)
parent_existence_neg$Polarity <- rep('negative', nrow(parent_existence_neg))
parent_existence_neg$Measure <- rep('negative construction ratio', nrow(parent_existence_neg))
parent_existence_neg$Which <- rep('ratio', nrow(parent_existence_neg))
parent_existence_neg$Function <- rep('Non-existence', nrow(parent_existence_neg))
parent_existence_neg <- negative_cumulative(parent_existence_neg, parent_descriptive)

parent_possession_have_neg <- data.frame(table(parent_possession_have_neg$Age))
names(parent_possession_have_neg) <- c('Age', 'Freq')
parent_possession_have_neg$Role <- rep('Parent', nrow(parent_possession_have_neg))
parent_possession_have_neg$Head <- rep('have', nrow(parent_possession_have_neg))
temp <- merge(parent_possession_have_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_possession_have_neg <- temp
parent_possession_have_neg$Total_ratio <- parent_possession_have_neg$Freq / parent_possession_have_neg$N_utterance
parent_possession_have_neg$Ratio <- parent_possession_have_neg$Freq / sum(parent_possession_have_neg$Freq)
parent_possession_have_neg$Polarity <- rep('negative', nrow(parent_possession_have_neg))
parent_possession_have_neg$Measure <- rep('negative construction ratio', nrow(parent_possession_have_neg))
parent_possession_have_neg$Which <- rep('ratio', nrow(parent_possession_have_neg))
parent_possession_have_neg$Function <- rep('Possession', nrow(parent_possession_have_neg))
parent_possession_have_neg <- negative_cumulative(parent_possession_have_neg, parent_descriptive)

parent_possession_pro_neg <- data.frame(table(parent_possession_pro_neg$Age))
names(parent_possession_pro_neg) <- c('Age', 'Freq')
parent_possession_pro_neg$Role <- rep('Parent', nrow(parent_possession_pro_neg))
parent_possession_pro_neg$Head <- rep('pronoun', nrow(parent_possession_pro_neg))
temp <- merge(parent_possession_pro_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_possession_pro_neg <- temp
parent_possession_pro_neg$Total_ratio <- parent_possession_pro_neg$Freq / parent_possession_pro_neg$N_utterance
parent_possession_pro_neg$Ratio <- parent_possession_pro_neg$Freq / sum(parent_possession_pro_neg$Freq)
parent_possession_pro_neg$Polarity <- rep('negative', nrow(parent_possession_pro_neg))
parent_possession_pro_neg$Measure <- rep('negative construction ratio', nrow(parent_possession_pro_neg))
parent_possession_pro_neg$Which <- rep('ratio', nrow(parent_possession_pro_neg))
parent_possession_pro_neg$Function <- rep('Possession', nrow(parent_possession_pro_neg))
parent_possession_pro_neg <- negative_cumulative(parent_possession_pro_neg, parent_descriptive)

perception_pos = subset(perception, Polarity == 'positive')
perception_pos = subset(perception, Polarity == 'positive')

child_perception_pos <- subset(perception_pos, Role %in% c('Child'))
parent_perception_pos <- subset(perception_pos, Role %in% c('Parent'))

child_existence_pos <- subset(child_perception_pos, Function %in% c('existence'))
child_possession_have_pos <- subset(child_perception_pos, Function %in% c('possession') & Head %in% c('have'))
child_possession_pro_pos <- subset(child_perception_pos, Function %in% c('possession') & Head != 'have')
parent_existence_pos <- subset(parent_perception_pos, Function %in% c('existence'))
parent_possession_have_pos <- subset(parent_perception_pos, Function %in% c('possession') & Head %in% c('have'))
parent_possession_pro_pos <- subset(parent_perception_pos, Function %in% c('possession') & Head != 'have')

child_existence_pos_mlu <- mlu(child_existence_pos)
child_possession_have_pos_mlu <- mlu(child_possession_have_pos)
child_possession_pro_pos_mlu <- mlu(child_possession_pro_pos)
parent_existence_pos_mlu <- mlu(parent_existence_pos)
parent_possession_have_pos_mlu <- mlu(parent_possession_have_pos)
parent_possession_pro_pos_mlu <- mlu(parent_possession_pro_pos)

child_existence_pos <- data.frame(table(child_existence_pos$Age))
names(child_existence_pos) <- c('Age', 'Freq')
child_existence_pos$Role <- rep('Child', nrow(child_existence_pos))
child_existence_pos$Head <- rep('', nrow(child_existence_pos))
temp <- merge(child_existence_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_existence_pos <- temp
child_existence_pos$Total_ratio <- child_existence_pos$Freq / child_existence_pos$N_utterance
child_existence_pos$Ratio <- child_existence_pos$Freq / sum(child_existence_pos$Freq)
child_existence_pos$Polarity <- rep('positive', nrow(child_existence_pos))
child_existence_pos$Measure <- rep('positive construction ratio', nrow(child_existence_pos))
child_existence_pos$Which <- rep('ratio', nrow(child_existence_pos))
child_existence_pos$Function <- rep('Non-existence', nrow(child_existence_pos))
child_existence_pos <- positive_cumulative(child_existence_pos, child_descriptive)


child_possession_have_pos <- data.frame(table(child_possession_have_pos$Age))
names(child_possession_have_pos) <- c('Age', 'Freq')
child_possession_have_pos$Role <- rep('Child', nrow(child_possession_have_pos))
child_possession_have_pos$Head <- rep('have', nrow(child_possession_have_pos))
temp <- merge(child_possession_have_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_possession_have_pos <- temp
child_possession_have_pos$Total_ratio <- child_possession_have_pos$Freq / child_possession_have_pos$N_utterance
child_possession_have_pos$Ratio <- child_possession_have_pos$Freq / sum(child_possession_have_pos$Freq)
child_possession_have_pos$Polarity <- rep('positive', nrow(child_possession_have_pos))
child_possession_have_pos$Measure <- rep('positive construction ratio', nrow(child_possession_have_pos))
child_possession_have_pos$Which <- rep('ratio', nrow(child_possession_have_pos))
child_possession_have_pos$Function <- rep('Possession', nrow(child_possession_have_pos))
child_possession_have_pos <- positive_cumulative(child_possession_have_pos, child_descriptive)

child_possession_pro_pos <- data.frame(table(child_possession_pro_pos$Age))
names(child_possession_pro_pos) <- c('Age', 'Freq')
child_possession_pro_pos$Role <- rep('Child', nrow(child_possession_pro_pos))
child_possession_pro_pos$Head <- rep('pronoun', nrow(child_possession_pro_pos))
temp <- merge(child_possession_pro_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_possession_pro_pos <- temp
child_possession_pro_pos$Total_ratio <- child_possession_pro_pos$Freq / child_possession_pro_pos$N_utterance
child_possession_pro_pos$Ratio <- child_possession_pro_pos$Freq / sum(child_possession_pro_pos$Freq)
child_possession_pro_pos$Polarity <- rep('positive', nrow(child_possession_pro_pos))
child_possession_pro_pos$Measure <- rep('positive construction ratio', nrow(child_possession_pro_pos))
child_possession_pro_pos$Which <- rep('ratio', nrow(child_possession_pro_pos))
child_possession_pro_pos$Function <- rep('Possession', nrow(child_possession_pro_pos))
child_possession_pro_pos <- positive_cumulative(child_possession_pro_pos, child_descriptive)

parent_existence_pos <- data.frame(table(parent_existence_pos$Age))
names(parent_existence_pos) <- c('Age', 'Freq')
parent_existence_pos$Role <- rep('Parent', nrow(parent_existence_pos))
parent_existence_pos$Head <- rep('existence', nrow(parent_existence_pos))
temp <- merge(parent_existence_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_existence_pos <- temp
parent_existence_pos$Total_ratio <- parent_existence_pos$Freq / parent_existence_pos$N_utterance
parent_existence_pos$Ratio <- parent_existence_pos$Freq / sum(parent_existence_pos$Freq)
parent_existence_pos$Polarity <- rep('positive', nrow(parent_existence_pos))
parent_existence_pos$Measure <- rep('positive construction ratio', nrow(parent_existence_pos))
parent_existence_pos$Which <- rep('ratio', nrow(parent_existence_pos))
parent_existence_pos$Function <- rep('Non-existence', nrow(parent_existence_pos))
parent_existence_pos <- positive_cumulative(parent_existence_pos, parent_descriptive)

parent_possession_have_pos <- data.frame(table(parent_possession_have_pos$Age))
names(parent_possession_have_pos) <- c('Age', 'Freq')
parent_possession_have_pos$Role <- rep('Parent', nrow(parent_possession_have_pos))
parent_possession_have_pos$Head <- rep('have', nrow(parent_possession_have_pos))
temp <- merge(parent_possession_have_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_possession_have_pos <- temp
parent_possession_have_pos$Total_ratio <- parent_possession_have_pos$Freq / parent_possession_have_pos$N_utterance
parent_possession_have_pos$Ratio <- parent_possession_have_pos$Freq / sum(parent_possession_have_pos$Freq)
parent_possession_have_pos$Polarity <- rep('positive', nrow(parent_possession_have_pos))
parent_possession_have_pos$Measure <- rep('positive construction ratio', nrow(parent_possession_have_pos))
parent_possession_have_pos$Which <- rep('ratio', nrow(parent_possession_have_pos))
parent_possession_have_pos$Function <- rep('Possession', nrow(parent_possession_have_pos))
parent_possession_have_pos <- positive_cumulative(parent_possession_have_pos, parent_descriptive)

parent_possession_pro_pos <- data.frame(table(parent_possession_pro_pos$Age))
names(parent_possession_pro_pos) <- c('Age', 'Freq')
parent_possession_pro_pos$Role <- rep('Parent', nrow(parent_possession_pro_pos))
parent_possession_pro_pos$Head <- rep('pronoun', nrow(parent_possession_pro_pos))
temp <- merge(parent_possession_pro_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_possession_pro_pos <- temp
parent_possession_pro_pos$Total_ratio <- parent_possession_pro_pos$Freq / parent_possession_pro_pos$N_utterance
parent_possession_pro_pos$Ratio <- parent_possession_pro_pos$Freq / sum(parent_possession_pro_pos$Freq)
parent_possession_pro_pos$Polarity <- rep('positive', nrow(parent_possession_pro_pos))
parent_possession_pro_pos$Measure <- rep('positive construction ratio', nrow(parent_possession_pro_pos))
parent_possession_pro_pos$Which <- rep('ratio', nrow(parent_possession_pro_pos))
parent_possession_pro_pos$Function <- rep('Possession', nrow(parent_possession_pro_pos))
parent_possession_pro_pos <- positive_cumulative(parent_possession_pro_pos, parent_descriptive)


perception_data <- rbind(child_existence_neg, child_existence_pos, parent_existence_neg, parent_existence_pos, child_possession_have_neg, child_possession_have_pos, parent_possession_have_neg, parent_possession_have_pos, child_possession_pro_neg, child_possession_pro_pos, parent_possession_pro_neg, parent_possession_pro_pos)

perception_data$Measure <- factor(perception_data$Measure, levels = c('negative construction ratio', 'negative construction cumulative ratio', 'positive construction ratio', 'positive construction cumulative ratio'))

perception_data$Production <- paste(perception_data$Role, perception_data$Measure, sep = " ")

perception_data_child <- subset(perception_data, Role == 'Child')
perception_data_parent <- subset(perception_data, Role == 'Parent')

existence_data <- subset(perception_data, Function == 'Non-existence')
possession_data <- subset(perception_data, Function == 'Possession')

existence_data_child <- subset(existence_data, Role == 'Child')
existence_data_parent <- subset(existence_data, Role == 'Parent')

possession_data_child <- subset(possession_data, Role == 'Child')
possession_data_parent <- subset(possession_data, Role == 'Parent')

```

```{r discourseperceptiondata, include=FALSE}

discourse_perception <-read.csv('data/perception_discourse.txt', header = T, sep = '\t')
# perception <- subset(perception, Subj == 'I' | Subj == 'NONE')
discourse_perception$Role[which(discourse_perception$Role == "Father")] <- 'Parent'
discourse_perception$Role[which(discourse_perception$Role == "Mother")] <- 'Parent'
discourse_perception$Role[which(discourse_perception$Role == "Target_Child")] <- 'Child'

discourse_perception_neg = subset(discourse_perception, Polarity == 'negative')
discourse_perception_pos = subset(discourse_perception, Polarity == 'positive')

discourse_child_perception_neg <- subset(discourse_perception_neg, Role %in% c('Child'))
discourse_parent_perception_neg <- subset(discourse_perception_neg, Role %in% c('Parent'))

discourse_child_existence_neg <- subset(discourse_child_perception_neg, Function %in% c('existence'))
discourse_child_possession_neg <- subset(discourse_child_perception_neg, Function %in% c('possession'))
discourse_parent_existence_neg <- subset(discourse_parent_perception_neg, Function %in% c('existence'))
discourse_parent_possession_neg <- subset(discourse_parent_perception_neg, Function %in% c('possession'))

discourse_child_existence_neg <- data.frame(table(discourse_child_existence_neg$Age))
names(discourse_child_existence_neg) <- c('Age', 'Freq')
discourse_child_existence_neg$Role <- rep('Child', nrow(discourse_child_existence_neg))
discourse_child_existence_neg$Head <- rep('', nrow(discourse_child_existence_neg))
temp <- merge(discourse_child_existence_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_existence_neg <- temp
discourse_child_existence_neg$Total_ratio <- discourse_child_existence_neg$Freq / discourse_child_existence_neg$N_utterance
discourse_child_existence_neg$Ratio <- discourse_child_existence_neg$Freq / sum(discourse_child_existence_neg$Freq)
discourse_child_existence_neg$Polarity <- rep('negative', nrow(discourse_child_existence_neg))
discourse_child_existence_neg$Measure <- rep('negative construction ratio', nrow(discourse_child_existence_neg))
discourse_child_existence_neg$Which <- rep('ratio', nrow(discourse_child_existence_neg))
discourse_child_existence_neg$Function <- rep('Non-existence', nrow(discourse_child_existence_neg))
discourse_child_existence_neg <- negative_cumulative(discourse_child_existence_neg, child_descriptive)


discourse_child_possession_neg <- data.frame(table(discourse_child_possession_neg$Age))
names(discourse_child_possession_neg) <- c('Age', 'Freq')
discourse_child_possession_neg$Role <- rep('Child', nrow(discourse_child_possession_neg))
discourse_child_possession_neg$Head <- rep('have', nrow(discourse_child_possession_neg))
temp <- merge(discourse_child_possession_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_possession_neg <- temp
discourse_child_possession_neg$Total_ratio <- discourse_child_possession_neg$Freq / discourse_child_possession_neg$N_utterance
discourse_child_possession_neg$Ratio <- discourse_child_possession_neg$Freq / sum(discourse_child_possession_neg$Freq)
discourse_child_possession_neg$Polarity <- rep('negative', nrow(discourse_child_possession_neg))
discourse_child_possession_neg$Measure <- rep('negative construction ratio', nrow(discourse_child_possession_neg))
discourse_child_possession_neg$Which <- rep('ratio', nrow(discourse_child_possession_neg))
discourse_child_possession_neg$Function <- rep('Possession', nrow(discourse_child_possession_neg))
discourse_child_possession_neg <- negative_cumulative(discourse_child_possession_neg, child_descriptive)


discourse_parent_existence_neg <- data.frame(table(discourse_parent_existence_neg$Age))
names(discourse_parent_existence_neg) <- c('Age', 'Freq')
discourse_parent_existence_neg$Role <- rep('Parent', nrow(discourse_parent_existence_neg))
discourse_parent_existence_neg$Head <- rep('existence', nrow(discourse_parent_existence_neg))
temp <- merge(discourse_parent_existence_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_existence_neg <- temp
discourse_parent_existence_neg$Total_ratio <- discourse_parent_existence_neg$Freq / discourse_parent_existence_neg$N_utterance
discourse_parent_existence_neg$Ratio <- discourse_parent_existence_neg$Freq / sum(discourse_parent_existence_neg$Freq)
discourse_parent_existence_neg$Polarity <- rep('negative', nrow(discourse_parent_existence_neg))
discourse_parent_existence_neg$Measure <- rep('negative construction ratio', nrow(discourse_parent_existence_neg))
discourse_parent_existence_neg$Which <- rep('ratio', nrow(discourse_parent_existence_neg))
discourse_parent_existence_neg$Function <- rep('Non-existence', nrow(discourse_parent_existence_neg))
discourse_parent_existence_neg <- negative_cumulative(discourse_parent_existence_neg, parent_descriptive)

discourse_parent_possession_neg <- data.frame(table(discourse_parent_possession_neg$Age))
names(discourse_parent_possession_neg) <- c('Age', 'Freq')
discourse_parent_possession_neg$Role <- rep('Parent', nrow(discourse_parent_possession_neg))
discourse_parent_possession_neg$Head <- rep('have', nrow(discourse_parent_possession_neg))
temp <- merge(discourse_parent_possession_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_possession_neg <- temp
discourse_parent_possession_neg$Total_ratio <- discourse_parent_possession_neg$Freq / discourse_parent_possession_neg$N_utterance
discourse_parent_possession_neg$Ratio <- discourse_parent_possession_neg$Freq / sum(discourse_parent_possession_neg$Freq)
discourse_parent_possession_neg$Polarity <- rep('negative', nrow(discourse_parent_possession_neg))
discourse_parent_possession_neg$Measure <- rep('negative construction ratio', nrow(discourse_parent_possession_neg))
discourse_parent_possession_neg$Which <- rep('ratio', nrow(discourse_parent_possession_neg))
discourse_parent_possession_neg$Function <- rep('Possession', nrow(discourse_parent_possession_neg))
discourse_parent_possession_neg <- negative_cumulative(discourse_parent_possession_neg, parent_descriptive)


discourse_child_perception_pos <- subset(discourse_perception_pos, Role %in% c('Child'))
discourse_parent_perception_pos <- subset(discourse_perception_pos, Role %in% c('Parent'))

discourse_child_existence_pos <- subset(discourse_child_perception_pos, Function %in% c('existence'))
#discourse_child_possession_pos <- subset(discourse_child_perception_pos, Function %in% c('possession'))

discourse_parent_existence_pos <- subset(discourse_parent_perception_pos, Function %in% c('existence'))
#discourse_parent_possession_pos <- subset(discourse_parent_perception_pos, Function %in% c('possession'))


discourse_child_existence_pos <- data.frame(table(discourse_child_existence_pos$Age))
names(discourse_child_existence_pos) <- c('Age', 'Freq')
discourse_child_existence_pos$Role <- rep('Child', nrow(discourse_child_existence_pos))
discourse_child_existence_pos$Head <- rep('', nrow(discourse_child_existence_pos))
temp <- merge(discourse_child_existence_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_existence_pos <- temp
discourse_child_existence_pos$Total_ratio <- discourse_child_existence_pos$Freq / discourse_child_existence_pos$N_utterance
discourse_child_existence_pos$Ratio <- discourse_child_existence_pos$Freq / sum(discourse_child_existence_pos$Freq)
discourse_child_existence_pos$Polarity <- rep('positive', nrow(discourse_child_existence_pos))
discourse_child_existence_pos$Measure <- rep('positive construction ratio', nrow(discourse_child_existence_pos))
discourse_child_existence_pos$Which <- rep('ratio', nrow(discourse_child_existence_pos))
discourse_child_existence_pos$Function <- rep('Non-existence', nrow(discourse_child_existence_pos))
discourse_child_existence_pos <- positive_cumulative(discourse_child_existence_pos, child_descriptive)


#discourse_child_possession_pos <- data.frame(table(discourse_child_possession_pos$Age))
#names(discourse_child_possession_pos) <- c('Age', 'Freq')
#discourse_child_possession_pos$Role <- rep('Child', nrow(discourse_child_possession_pos))
#discourse_child_possession_pos$Head <- rep('have', nrow(discourse_child_possession_pos))
#temp <- merge(discourse_child_possession_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
#discourse_child_possession_pos <- temp
#discourse_child_possession_pos$Total_ratio <- discourse_child_possession_pos$Freq / discourse_child_possession_pos$N_utterance
#discourse_child_possession_pos$Ratio <- discourse_child_possession_pos$Freq / sum(discourse_child_possession_pos$Freq)
#discourse_child_possession_pos$Polarity <- rep('positive', nrow(discourse_child_possession_pos))
#discourse_child_possession_pos$Measure <- rep('positive construction ratio', nrow(discourse_child_possession_pos))
#discourse_child_possession_pos$Which <- rep('ratio', nrow(discourse_child_possession_pos))
#discourse_child_possession_pos$Function <- rep('Possession', #nrow(discourse_child_possession_pos))
#discourse_child_possession_pos <- positive_cumulative(discourse_child_possession_pos, child_descriptive)

discourse_parent_existence_pos <- data.frame(table(discourse_parent_existence_pos$Age))
names(discourse_parent_existence_pos) <- c('Age', 'Freq')
discourse_parent_existence_pos$Role <- rep('Parent', nrow(discourse_parent_existence_pos))
discourse_parent_existence_pos$Head <- rep('existence', nrow(discourse_parent_existence_pos))
temp <- merge(discourse_parent_existence_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_existence_pos <- temp
discourse_parent_existence_pos$Total_ratio <- discourse_parent_existence_pos$Freq / discourse_parent_existence_pos$N_utterance
discourse_parent_existence_pos$Ratio <- discourse_parent_existence_pos$Freq / sum(discourse_parent_existence_pos$Freq)
discourse_parent_existence_pos$Polarity <- rep('positive', nrow(discourse_parent_existence_pos))
discourse_parent_existence_pos$Measure <- rep('positive construction ratio', nrow(discourse_parent_existence_pos))
discourse_parent_existence_pos$Which <- rep('ratio', nrow(discourse_parent_existence_pos))
discourse_parent_existence_pos$Function <- rep('Non-existence', nrow(discourse_parent_existence_pos))
discourse_parent_existence_pos <- positive_cumulative(discourse_parent_existence_pos, parent_descriptive)


#discourse_parent_possession_pos <- data.frame(table(discourse_parent_possession_pos$Age))
#names(discourse_parent_possession_pos) <- c('Age', 'Freq')
#discourse_parent_possession_pos$Role <- rep('Parent', nrow(discourse_parent_possession_pos))
#discourse_parent_possession_pos$Head <- rep('have', nrow(discourse_parent_possession_pos))
#temp <- merge(discourse_parent_possession_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
#discourse_parent_possession_pos <- temp
#discourse_parent_possession_pos$Total_ratio <- discourse_parent_possession_pos$Freq / discourse_parent_possession_pos$N_utterance
#discourse_parent_possession_pos$Ratio <- discourse_parent_possession_pos$Freq / sum(discourse_parent_possession_pos$Freq)
#discourse_parent_possession_pos$Polarity <- rep('positive', nrow(discourse_parent_possession_pos))
#discourse_parent_possession_pos$Measure <- rep('positive construction ratio', nrow(discourse_parent_possession_pos))
#discourse_parent_possession_pos$Which <- rep('ratio', nrow(discourse_parent_possession_pos))
#discourse_parent_possession_pos$Function <- rep('Possession', nrow(discourse_parent_possession_pos))
#discourse_parent_possession_pos <- positive_cumulative(discourse_parent_possession_pos, parent_descriptive)


discourse_perception_data <- rbind(discourse_child_existence_neg, discourse_child_existence_pos, discourse_parent_existence_neg, discourse_parent_existence_pos, discourse_child_possession_neg, discourse_parent_possession_neg)

discourse_perception_data$Measure <- factor(discourse_perception_data$Measure, c('negative construction ratio', 'negative construction cumulative ratio', 'positive construction ratio', 'positive construction cumulative ratio'))

discourse_perception_data_child <- subset(discourse_perception_data, Role == 'Child')
discourse_perception_data_parent <- subset(discourse_perception_data, Role == 'Parent')

discourse_existence_data <- subset(discourse_perception_data, Function == 'Non-existence')
discourse_possession_data <- subset(discourse_perception_data, Function == 'Possession')

discourse_existence_data_child <- subset(discourse_existence_data, Role == 'Child')
discourse_existence_data_parent <- subset(discourse_existence_data, Role == 'Parent')

discourse_possession_data_child <- subset(discourse_possession_data, Role == 'Child')
discourse_possession_data_parent <- subset(discourse_possession_data, Role == 'Parent')

discourse_existence_data_plot <- aggregate(Total_ratio~Age+Which+Role,data=discourse_existence_data,sum)

names(discourse_existence_data_plot) <- c('Age', 'Measure', 'Role', 'Total_ratio')

discourse_possession_data_plot <- aggregate(Total_ratio~Age+Which+Role,data=discourse_possession_data,sum)

names(discourse_possession_data_plot) <- c('Age', 'Measure', 'Role', 'Total_ratio')

```

For the function of non-existence, we searched for the English expletive construction and extracted utterances that had *there*-expletives, followed by a copula, and a noun phrase (phrases headed by either nouns or pronouns). We classified utterances where the predicate was modified by negation as negative, and the rest as positive. This led to a total of `r format(sum(subset(existence_data, Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")` negative utterances (child: `r format(sum(subset(existence_data_child, Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`; parent: `r format(sum(subset(existence_data_parent, Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`), and `r format(sum(subset(existence_data,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")` positive utterances (child: `r format(sum(subset(existence_data_child,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`; parent: `r format(sum(subset(existence_data_parent,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`).

| Non-existence (Negative)          | Positive counterpart |
|-----------------------------------|----------------------|
| *there's* ***no*** *(more) water* | *there are books*    |
| *there is* **n't** *it*           | *there is it*        |
| *there's* ***no*** *more cheese*  | *there is the toy*   |
| *there is* ***no*** *food*        | *there is an apple*  |

: (#tab:nonexist) Examples of sentence-level non-existence and positive counterparts in children's speech.

At the sentence level, children produce negative constructions to express non-existence less frequently than they do for the positive counterparts. As presented in Figure \@ref(fig:existence), the cumulative ratio for the production of non-existence increases mostly from 18 to 36 months. Then around and after 36 months of age, children's production gradually reaches a stable ratio but stays below parents' level. Notice that there appears to be slight fluctuations of cumulative ratios between the age of 19 and 25 months in child speech. A closer inspection of the data reveals that within that age range, the frequency of negative utterances at most ages is either one or zero. Therefore as the number of total utterances increases along the developmental trajectory, the cumulative ratio for non-existence utterances actually decreases in this brief period.

```{r existence, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=6.5, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap="Cumulative ratios for the production of non-existence at the sentence level for children between 12 to 72 months of age, and their parents. The y-axes are scaled differently for the panels to accommodate differences in production ratios."}

subset(existence_data, Which=='cumulative ratio') %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Production, color = Production)) +
  geom_line(aes(linetype=Production), alpha = 1) +
#  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Production, shape = Production), size = 1.5) +
#  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkred", "darkgreen", "steelblue",  "mediumpurple4")) + 
  facet_wrap( ~ Polarity, scales = "free_y") +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") + 
  guides(color = guide_legend(nrow = 2)) + 
  theme(legend.title = element_blank())

```

For non-existence at the discourse level, we applied similar selection criteria and extracted utterances (negative and positive) with existential constructions in their antecedents (Table \@ref(tab:disexist)). This led to a total of `r format(sum(subset(discourse_existence_data, Which=='ratio')$Freq), big.mark=",")` utterances (child: `r format(sum(subset(discourse_existence_data_child, Which=='ratio')$Freq), big.mark=",")`; parent: `r format(sum(subset(discourse_existence_data_parent, Which=='ratio')$Freq), big.mark=",")`). As Figure \@ref(fig:existencediscourse) shows, there is an increase in children's responses with *no* to parents' existential utterances between the ages of 18 and 36 months. After 36 months, despite the fact that ratios show fluctuations, the cumulative ratios of children's production seem stable and similar. Therefore with non-existence, both sentence-level and discourse level analyses point to substantial development in the age rage of 18-36 months.

| Antecedent                  | Utterance                           |
|-----------------------------|-------------------------------------|
| Parent: *is there a bunny*  | Child: ***no no*** *bunny*          |
| Parent: *is there a table*  | Child: ***no no***                  |
| Child: *there is my ball*   | Parent: ***no*** *that's not yours* |
| Child: *is there lunch bag* | Parent: ***no*** *not yet sweety*   |

: (#tab:disexist) Examples of discourse-level non-existence in children's and parents' speech.

```{r existencediscourse, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=2.8, set.cap.width=T, num.cols.cap=1, fig.cap="Cumulative ratios for the production of non-existence at the discourse level for children between 12 to 72 months of age, and their parents.",warning=FALSE}

subset(discourse_existence_data_plot, Measure=='cumulative ratio') %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Role, color = Role)) +
  geom_line(aes(linetype=Role), alpha = 1) +
  scale_linetype_manual(values=c('solid', 'dotted')) +
  geom_point(aes(color = Role, shape = Role), size = 1.5) +
  scale_shape_manual(values = c(16, 3)) +
  scale_color_manual(values = c("darkblue", "peru")) + 
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio")

```

### Prohibition

```{r motordata, include=FALSE}

motor <-read.csv('data/motor.txt', header = T, sep = '\t')
# motor <- subset(motor, Subj == 'I' | Subj == 'NONE')
motor$Role[which(motor$Role == "Father")] <- 'Parent'
motor$Role[which(motor$Role == "Mother")] <- 'Parent'
motor$Role[which(motor$Role == "Target_Child")] <- 'Child'

motor_neg = subset(motor, Polarity == 'negative')
motor_pos = subset(motor, Polarity == 'positive')

child_motor_neg <- subset(motor_neg, Role %in% c('Child'))
parent_motor_neg <- subset(motor_neg, Role %in% c('Parent'))

child_prohibition_neg <- subset(child_motor_neg, Function %in% c('prohibition') & Aux == 'do')
child_inability_neg <- subset(child_motor_neg, Function %in% c('inability') & Subj %in% c('I', 'i'))
parent_prohibition_neg <- subset(parent_motor_neg, Function %in% c('prohibition') & Aux == 'do')
parent_inability_neg <- subset(parent_motor_neg, Function %in% c('inability') & Subj %in% c('I', 'i'))

child_prohibition_neg_mlu <- mlu(child_prohibition_neg)
child_inability_neg_mlu <- mlu(child_inability_neg)
parent_prohibition_neg_mlu <- mlu(parent_prohibition_neg)
parent_inability_neg_mlu <- mlu(parent_inability_neg)

child_prohibition_neg <- data.frame(table(child_prohibition_neg$Age))
names(child_prohibition_neg) <- c('Age', 'Freq')
child_prohibition_neg$Role <- rep('Child', nrow(child_prohibition_neg))
child_prohibition_neg$Head <- rep('', nrow(child_prohibition_neg))
temp <- merge(child_prohibition_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_prohibition_neg <- temp
child_prohibition_neg$Total_ratio <- child_prohibition_neg$Freq / child_prohibition_neg$N_utterance
child_prohibition_neg$Ratio <- child_prohibition_neg$Freq / sum(child_prohibition_neg$Freq)
child_prohibition_neg$Polarity <- rep('negative', nrow(child_prohibition_neg))
child_prohibition_neg$Measure <- rep('negative construction ratio', nrow(child_prohibition_neg))
child_prohibition_neg$Which <- rep('ratio', nrow(child_prohibition_neg))
child_prohibition_neg$Function <- rep('Prohibition', nrow(child_prohibition_neg))
child_prohibition_neg <- negative_cumulative(child_prohibition_neg, child_descriptive)


child_inability_neg <- data.frame(table(child_inability_neg$Age))
names(child_inability_neg) <- c('Age', 'Freq')
child_inability_neg$Role <- rep('Child', nrow(child_inability_neg))
child_inability_neg$Head <- rep('', nrow(child_inability_neg))
temp <- merge(child_inability_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_inability_neg <- temp
child_inability_neg$Total_ratio <- child_inability_neg$Freq / child_inability_neg$N_utterance
child_inability_neg$Ratio <- child_inability_neg$Freq / sum(child_inability_neg$Freq)
child_inability_neg$Polarity <- rep('negative', nrow(child_inability_neg))
child_inability_neg$Measure <- rep('negative construction ratio', nrow(child_inability_neg))
child_inability_neg$Which <- rep('ratio', nrow(child_inability_neg))
child_inability_neg$Function <- rep('Inability', nrow(child_inability_neg))
child_inability_neg <- negative_cumulative(child_inability_neg, child_descriptive)


parent_prohibition_neg <- data.frame(table(parent_prohibition_neg$Age))
names(parent_prohibition_neg) <- c('Age', 'Freq')
parent_prohibition_neg$Role <- rep('Parent', nrow(parent_prohibition_neg))
parent_prohibition_neg$Head <- rep('', nrow(parent_prohibition_neg))
temp <- merge(parent_prohibition_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_prohibition_neg <- temp
parent_prohibition_neg$Total_ratio <- parent_prohibition_neg$Freq / parent_prohibition_neg$N_utterance
parent_prohibition_neg$Ratio <- parent_prohibition_neg$Freq / sum(parent_prohibition_neg$Freq)
parent_prohibition_neg$Polarity <- rep('negative', nrow(parent_prohibition_neg))
parent_prohibition_neg$Measure <- rep('negative construction ratio', nrow(parent_prohibition_neg))
parent_prohibition_neg$Which <- rep('ratio', nrow(parent_prohibition_neg))
parent_prohibition_neg$Function <- rep('Prohibition', nrow(parent_prohibition_neg))
parent_prohibition_neg <- negative_cumulative(parent_prohibition_neg, parent_descriptive)

parent_inability_neg <- data.frame(table(parent_inability_neg$Age))
names(parent_inability_neg) <- c('Age', 'Freq')
parent_inability_neg$Role <- rep('Parent', nrow(parent_inability_neg))
parent_inability_neg$Head <- rep('', nrow(parent_inability_neg))
temp <- merge(parent_inability_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_inability_neg <- temp
parent_inability_neg$Total_ratio <- parent_inability_neg$Freq / parent_inability_neg$N_utterance
parent_inability_neg$Ratio <- parent_inability_neg$Freq / sum(parent_inability_neg$Freq)
parent_inability_neg$Polarity <- rep('negative', nrow(parent_inability_neg))
parent_inability_neg$Measure <- rep('negative construction ratio', nrow(parent_inability_neg))
parent_inability_neg$Which <- rep('ratio', nrow(parent_inability_neg))
parent_inability_neg$Function <- rep('Inability', nrow(parent_inability_neg))
parent_inability_neg <- negative_cumulative(parent_inability_neg, parent_descriptive)


child_motor_pos <- subset(motor_pos, Role %in% c('Child'))
parent_motor_pos <- subset(motor_pos, Role %in% c('Parent'))

child_prohibition_pos <- subset(child_motor_pos, Function %in% c('prohibition'))
child_inability_pos <- subset(child_motor_pos, Function %in% c('inability') & Subj %in% c('I', 'i'))
parent_prohibition_pos <- subset(parent_motor_pos, Function %in% c('prohibition'))
parent_inability_pos <- subset(parent_motor_pos, Function %in% c('inability') & Subj %in% c('I', 'i'))

child_prohibition_pos_mlu <- mlu(child_prohibition_pos)
child_inability_pos_mlu <- mlu(child_inability_pos)
parent_prohibition_pos_mlu <- mlu(parent_prohibition_pos)
parent_inability_pos_mlu <- mlu(parent_inability_pos)

child_prohibition_pos <- data.frame(table(child_prohibition_pos$Age))
names(child_prohibition_pos) <- c('Age', 'Freq')
child_prohibition_pos$Role <- rep('Child', nrow(child_prohibition_pos))
child_prohibition_pos$Head <- rep('', nrow(child_prohibition_pos))
temp <- merge(child_prohibition_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_prohibition_pos <- temp
child_prohibition_pos$Total_ratio <- child_prohibition_pos$Freq / child_prohibition_pos$N_utterance
child_prohibition_pos$Ratio <- child_prohibition_pos$Freq / sum(child_prohibition_pos$Freq)
child_prohibition_pos$Polarity <- rep('positive', nrow(child_prohibition_pos))
child_prohibition_pos$Measure <- rep('positive construction ratio', nrow(child_prohibition_pos))
child_prohibition_pos$Which <- rep('ratio', nrow(child_prohibition_pos))
child_prohibition_pos$Function <- rep('Prohibition', nrow(child_prohibition_pos))
child_prohibition_pos <- positive_cumulative(child_prohibition_pos, child_descriptive)


child_inability_pos <- data.frame(table(child_inability_pos$Age))
names(child_inability_pos) <- c('Age', 'Freq')
child_inability_pos$Role <- rep('Child', nrow(child_inability_pos))
child_inability_pos$Head <- rep('', nrow(child_inability_pos))
temp <- merge(child_inability_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_inability_pos <- temp
child_inability_pos$Total_ratio <- child_inability_pos$Freq / child_inability_pos$N_utterance
child_inability_pos$Ratio <- child_inability_pos$Freq / sum(child_inability_pos$Freq)
child_inability_pos$Polarity <- rep('positive', nrow(child_inability_pos))
child_inability_pos$Measure <- rep('positive construction ratio', nrow(child_inability_pos))
child_inability_pos$Which <- rep('ratio', nrow(child_inability_pos))
child_inability_pos$Function <- rep('Inability', nrow(child_inability_pos))
child_inability_pos <- positive_cumulative(child_inability_pos, child_descriptive)


parent_prohibition_pos <- data.frame(table(parent_prohibition_pos$Age))
names(parent_prohibition_pos) <- c('Age', 'Freq')
parent_prohibition_pos$Role <- rep('Parent', nrow(parent_prohibition_pos))
parent_prohibition_pos$Head <- rep('', nrow(parent_prohibition_pos))
temp <- merge(parent_prohibition_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_prohibition_pos <- temp
parent_prohibition_pos$Total_ratio <- parent_prohibition_pos$Freq / parent_prohibition_pos$N_utterance
parent_prohibition_pos$Ratio <- parent_prohibition_pos$Freq / sum(parent_prohibition_pos$Freq)
parent_prohibition_pos$Polarity <- rep('positive', nrow(parent_prohibition_pos))
parent_prohibition_pos$Measure <- rep('positive construction ratio', nrow(parent_prohibition_pos))
parent_prohibition_pos$Which <- rep('ratio', nrow(parent_prohibition_pos))
parent_prohibition_pos$Function <- rep('Prohibition', nrow(parent_prohibition_pos))
parent_prohibition_pos <- positive_cumulative(parent_prohibition_pos, parent_descriptive)

parent_inability_pos <- data.frame(table(parent_inability_pos$Age))
names(parent_inability_pos) <- c('Age', 'Freq')
parent_inability_pos$Role <- rep('Parent', nrow(parent_inability_pos))
parent_inability_pos$Head <- rep('', nrow(parent_inability_pos))
temp <- merge(parent_inability_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_inability_pos <- temp
parent_inability_pos$Total_ratio <- parent_inability_pos$Freq / parent_inability_pos$N_utterance
parent_inability_pos$Ratio <- parent_inability_pos$Freq / sum(parent_inability_pos$Freq)
parent_inability_pos$Polarity <- rep('positive', nrow(parent_inability_pos))
parent_inability_pos$Measure <- rep('positive construction ratio', nrow(parent_inability_pos))
parent_inability_pos$Which <- rep('ratio', nrow(parent_inability_pos))
parent_inability_pos$Function <- rep('Inability', nrow(parent_inability_pos))
parent_inability_pos <- positive_cumulative(parent_inability_pos, parent_descriptive)


motor_data <- rbind(child_prohibition_neg, child_prohibition_pos, parent_prohibition_neg, parent_prohibition_pos, child_inability_neg, child_inability_pos, parent_inability_neg, parent_inability_pos)

motor_data$Measure <- factor(motor_data$Measure, levels = c('negative construction ratio', 'negative construction cumulative ratio', 'positive construction ratio', 'positive construction cumulative ratio'))

motor_data$Production <- paste(motor_data$Role, motor_data$Measure, sep = " ")

motor_data_child <- subset(motor_data, Role == 'Child')
motor_data_parent <- subset(motor_data, Role == 'Parent')

prohibition_data <- subset(motor_data, Function == 'Prohibition')
inability_data <- subset(motor_data, Function == 'Inability')

prohibition_data_child <- subset(prohibition_data, Role =='Child')
prohibition_data_parent <- subset(prohibition_data, Role =='Parent')

inability_data_child <- subset(inability_data, Role =='Child')
inability_data_parent <- subset(inability_data, Role =='Parent')

```

```{r motordiscoursedata, include=FALSE}

discourse_motor <-read.csv('data/motor_discourse.txt', header = T, sep = '\t')
discourse_motor$Role[which(discourse_motor$Role == "Father")] <- 'Parent'
discourse_motor$Role[which(discourse_motor$Role == "Mother")] <- 'Parent'
discourse_motor$Role[which(discourse_motor$Role == "Target_Child")] <- 'Child'

discourse_motor_neg = subset(discourse_motor, Polarity == 'negative')
discourse_motor_pos = subset(discourse_motor, Polarity == 'positive')

discourse_child_motor_neg <- subset(discourse_motor_neg, Role %in% c('Child'))
discourse_parent_motor_neg <- subset(discourse_motor_neg, Role %in% c('Parent'))

discourse_child_prohibition_neg <- subset(discourse_child_motor_neg, Function %in% c('prohibition') & Aux == 'do'&Previous_Sent_type=='imperative_emphatic')
discourse_child_inability_neg <- subset(discourse_child_motor_neg, Function %in% c('inability') & Subj %in% c('I', 'i'))
discourse_parent_prohibition_neg <- subset(discourse_parent_motor_neg, Function %in% c('prohibition')  & Aux == 'do'&Previous_Sent_type=='imperative_emphatic')
discourse_parent_inability_neg <- subset(discourse_parent_motor_neg, Function %in% c('inability') & Subj %in% c('I', 'i'))


discourse_child_prohibition_neg <- data.frame(table(discourse_child_prohibition_neg$Age))
names(discourse_child_prohibition_neg) <- c('Age', 'Freq')
discourse_child_prohibition_neg$Role <- rep('Child', nrow(discourse_child_prohibition_neg))
discourse_child_prohibition_neg$Head <- rep('', nrow(discourse_child_prohibition_neg))
temp <- merge(discourse_child_prohibition_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_prohibition_neg <- temp
discourse_child_prohibition_neg$Total_ratio <- discourse_child_prohibition_neg$Freq / discourse_child_prohibition_neg$N_utterance
discourse_child_prohibition_neg$Ratio <- discourse_child_prohibition_neg$Freq / sum(discourse_child_prohibition_neg$Freq)
discourse_child_prohibition_neg$Polarity <- rep('negative', nrow(discourse_child_prohibition_neg))
discourse_child_prohibition_neg$Measure <- rep('negative construction ratio', nrow(discourse_child_prohibition_neg))
discourse_child_prohibition_neg$Which <- rep('ratio', nrow(discourse_child_prohibition_neg))
discourse_child_prohibition_neg$Function <- rep('Prohibition', nrow(discourse_child_prohibition_neg))
discourse_child_prohibition_neg <- negative_cumulative(discourse_child_prohibition_neg, child_descriptive)


discourse_child_inability_neg <- data.frame(table(discourse_child_inability_neg$Age))
names(discourse_child_inability_neg) <- c('Age', 'Freq')
discourse_child_inability_neg$Role <- rep('Child', nrow(discourse_child_inability_neg))
discourse_child_inability_neg$Head <- rep('', nrow(discourse_child_inability_neg))
temp <- merge(discourse_child_inability_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_inability_neg <- temp
discourse_child_inability_neg$Total_ratio <- discourse_child_inability_neg$Freq / discourse_child_inability_neg$N_utterance
discourse_child_inability_neg$Ratio <- discourse_child_inability_neg$Freq / sum(discourse_child_inability_neg$Freq)
discourse_child_inability_neg$Polarity <- rep('negative', nrow(discourse_child_inability_neg))
discourse_child_inability_neg$Measure <- rep('negative construction ratio', nrow(discourse_child_inability_neg))
discourse_child_inability_neg$Which <- rep('ratio', nrow(discourse_child_inability_neg))
discourse_child_inability_neg$Function <- rep('Inability', nrow(discourse_child_inability_neg))
discourse_child_inability_neg <- negative_cumulative(discourse_child_inability_neg, child_descriptive)


discourse_parent_prohibition_neg <- data.frame(table(discourse_parent_prohibition_neg$Age))
names(discourse_parent_prohibition_neg) <- c('Age', 'Freq')
discourse_parent_prohibition_neg$Role <- rep('Parent', nrow(discourse_parent_prohibition_neg))
discourse_parent_prohibition_neg$Head <- rep('', nrow(discourse_parent_prohibition_neg))
temp <- merge(discourse_parent_prohibition_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_prohibition_neg <- temp
discourse_parent_prohibition_neg$Total_ratio <- discourse_parent_prohibition_neg$Freq / discourse_parent_prohibition_neg$N_utterance
discourse_parent_prohibition_neg$Ratio <- discourse_parent_prohibition_neg$Freq / sum(discourse_parent_prohibition_neg$Freq)
discourse_parent_prohibition_neg$Polarity <- rep('negative', nrow(discourse_parent_prohibition_neg))
discourse_parent_prohibition_neg$Measure <- rep('negative construction ratio', nrow(discourse_parent_prohibition_neg))
discourse_parent_prohibition_neg$Which <- rep('ratio', nrow(discourse_parent_prohibition_neg))
discourse_parent_prohibition_neg$Function <- rep('Prohibition', nrow(discourse_parent_prohibition_neg))
discourse_parent_prohibition_neg <- negative_cumulative(discourse_parent_prohibition_neg, parent_descriptive)

discourse_parent_inability_neg <- data.frame(table(discourse_parent_inability_neg$Age))
names(discourse_parent_inability_neg) <- c('Age', 'Freq')
discourse_parent_inability_neg$Role <- rep('Parent', nrow(discourse_parent_inability_neg))
discourse_parent_inability_neg$Head <- rep('', nrow(discourse_parent_inability_neg))
temp <- merge(discourse_parent_inability_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_inability_neg <- temp
discourse_parent_inability_neg$Total_ratio <- discourse_parent_inability_neg$Freq / discourse_parent_inability_neg$N_utterance
discourse_parent_inability_neg$Ratio <- discourse_parent_inability_neg$Freq / sum(discourse_parent_inability_neg$Freq)
discourse_parent_inability_neg$Polarity <- rep('negative', nrow(discourse_parent_inability_neg))
discourse_parent_inability_neg$Measure <- rep('negative construction ratio', nrow(discourse_parent_inability_neg))
discourse_parent_inability_neg$Which <- rep('ratio', nrow(discourse_parent_inability_neg))
discourse_parent_inability_neg$Function <- rep('Inability', nrow(discourse_parent_inability_neg))
discourse_parent_inability_neg <- negative_cumulative(discourse_parent_inability_neg, parent_descriptive)


discourse_child_motor_pos <- subset(discourse_motor_pos, Role %in% c('Child'))
discourse_parent_motor_pos <- subset(discourse_motor_pos, Role %in% c('Parent'))

discourse_child_prohibition_pos <- subset(discourse_child_motor_pos, Function %in% c('prohibition')&Previous_Sent_type=='imperative_emphatic')
discourse_child_inability_pos <- subset(discourse_child_motor_pos, Function %in% c('inability') & Subj %in% c('I', 'i'))
discourse_parent_prohibition_pos <- subset(discourse_parent_motor_pos, Function %in% c('prohibition')&Previous_Sent_type=='imperative_emphatic')
discourse_parent_inability_pos <- subset(discourse_parent_motor_pos, Function %in% c('inability') & Subj %in% c('I', 'i'))

discourse_child_prohibition_pos <- data.frame(table(discourse_child_prohibition_pos$Age))
names(discourse_child_prohibition_pos) <- c('Age', 'Freq')
discourse_child_prohibition_pos$Role <- rep('Child', nrow(discourse_child_prohibition_pos))
discourse_child_prohibition_pos$Head <- rep('', nrow(discourse_child_prohibition_pos))
temp <- merge(discourse_child_prohibition_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_prohibition_pos <- temp
discourse_child_prohibition_pos$Total_ratio <- discourse_child_prohibition_pos$Freq / discourse_child_prohibition_pos$N_utterance
discourse_child_prohibition_pos$Ratio <- discourse_child_prohibition_pos$Freq / sum(discourse_child_prohibition_pos$Freq)
discourse_child_prohibition_pos$Polarity <- rep('positive', nrow(discourse_child_prohibition_pos))
discourse_child_prohibition_pos$Measure <- rep('positive construction ratio', nrow(discourse_child_prohibition_pos))
discourse_child_prohibition_pos$Which <- rep('ratio', nrow(discourse_child_prohibition_pos))
discourse_child_prohibition_pos$Function <- rep('Prohibition', nrow(discourse_child_prohibition_pos))
discourse_child_prohibition_pos <- positive_cumulative(discourse_child_prohibition_pos, child_descriptive)


discourse_child_inability_pos <- data.frame(table(discourse_child_inability_pos$Age))
names(discourse_child_inability_pos) <- c('Age', 'Freq')
discourse_child_inability_pos$Role <- rep('Child', nrow(discourse_child_inability_pos))
discourse_child_inability_pos$Head <- rep('', nrow(discourse_child_inability_pos))
temp <- merge(discourse_child_inability_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_inability_pos <- temp
discourse_child_inability_pos$Total_ratio <- discourse_child_inability_pos$Freq / discourse_child_inability_pos$N_utterance
discourse_child_inability_pos$Ratio <- discourse_child_inability_pos$Freq / sum(discourse_child_inability_pos$Freq)
discourse_child_inability_pos$Polarity <- rep('positive', nrow(discourse_child_inability_pos))
discourse_child_inability_pos$Measure <- rep('positive construction ratio', nrow(discourse_child_inability_pos))
discourse_child_inability_pos$Which <- rep('ratio', nrow(discourse_child_inability_pos))
discourse_child_inability_pos$Function <- rep('Inability', nrow(discourse_child_inability_pos))
discourse_child_inability_pos <- positive_cumulative(discourse_child_inability_pos, child_descriptive)


discourse_parent_prohibition_pos <- data.frame(table(discourse_parent_prohibition_pos$Age))
names(discourse_parent_prohibition_pos) <- c('Age', 'Freq')
discourse_parent_prohibition_pos$Role <- rep('Parent', nrow(discourse_parent_prohibition_pos))
discourse_parent_prohibition_pos$Head <- rep('', nrow(discourse_parent_prohibition_pos))
temp <- merge(discourse_parent_prohibition_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_prohibition_pos <- temp
discourse_parent_prohibition_pos$Total_ratio <- discourse_parent_prohibition_pos$Freq / discourse_parent_prohibition_pos$N_utterance
discourse_parent_prohibition_pos$Ratio <- discourse_parent_prohibition_pos$Freq / sum(discourse_parent_prohibition_pos$Freq)
discourse_parent_prohibition_pos$Polarity <- rep('positive', nrow(discourse_parent_prohibition_pos))
discourse_parent_prohibition_pos$Measure <- rep('positive construction ratio', nrow(discourse_parent_prohibition_pos))
discourse_parent_prohibition_pos$Which <- rep('ratio', nrow(discourse_parent_prohibition_pos))
discourse_parent_prohibition_pos$Function <- rep('Prohibition', nrow(discourse_parent_prohibition_pos))
discourse_parent_prohibition_pos <- positive_cumulative(discourse_parent_prohibition_pos, parent_descriptive)

discourse_parent_inability_pos <- data.frame(table(discourse_parent_inability_pos$Age))
names(discourse_parent_inability_pos) <- c('Age', 'Freq')
discourse_parent_inability_pos$Role <- rep('Parent', nrow(discourse_parent_inability_pos))
discourse_parent_inability_pos$Head <- rep('', nrow(discourse_parent_inability_pos))
temp <- merge(discourse_parent_inability_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_inability_pos <- temp
discourse_parent_inability_pos$Total_ratio <- discourse_parent_inability_pos$Freq / discourse_parent_inability_pos$N_utterance
discourse_parent_inability_pos$Ratio <- discourse_parent_inability_pos$Freq / sum(discourse_parent_inability_pos$Freq)
discourse_parent_inability_pos$Polarity <- rep('positive', nrow(discourse_parent_inability_pos))
discourse_parent_inability_pos$Measure <- rep('positive construction ratio', nrow(discourse_parent_inability_pos))
discourse_parent_inability_pos$Which <- rep('ratio', nrow(discourse_parent_inability_pos))
discourse_parent_inability_pos$Function <- rep('Inability', nrow(discourse_parent_inability_pos))
discourse_parent_inability_pos <- positive_cumulative(discourse_parent_inability_pos, parent_descriptive)

discourse_motor_data <- rbind(discourse_child_prohibition_neg, discourse_child_prohibition_pos, discourse_parent_prohibition_neg, discourse_parent_prohibition_pos, discourse_child_inability_neg, discourse_child_inability_pos, discourse_parent_inability_neg, discourse_parent_inability_pos)

discourse_motor_data$Measure <- factor(discourse_motor_data$Measure, levels = c('negative construction ratio', 'negative construction cumulative ratio', 'positive construction ratio', 'positive construction cumulative ratio'))


discourse_motor_data_child <- subset(discourse_motor_data, Role == 'Child')
discourse_motor_data_parent <- subset(discourse_motor_data, Role == 'Parent')

discourse_prohibition_data <- subset(discourse_motor_data, Function == 'Prohibition')
discourse_inability_data <- subset(discourse_motor_data, Function == 'Inability')

discourse_prohibition_data_child <- subset(discourse_prohibition_data, Role =='Child')
discourse_prohibition_data_parent <- subset(discourse_prohibition_data, Role =='Parent')

discourse_inability_data_child <- subset(discourse_inability_data, Role =='Child')
discourse_inability_data_parent <- subset(discourse_inability_data, Role =='Parent')

discourse_prohibition_data_plot <- aggregate(Total_ratio~Age+Which+Role,data=discourse_prohibition_data,sum)

names(discourse_prohibition_data_plot) <- c('Age', 'Measure', 'Role', 'Total_ratio')

discourse_inability_data_plot <- aggregate(Total_ratio~Age+Which+Role,data=discourse_inability_data,sum)

names(discourse_inability_data_plot) <- c('Age', 'Measure', 'Role', 'Total_ratio')

```

For constructions that typically convey prohibition, we extracted utterances that were labeled as "imperatives" in the CHILDES database. In particular, we selected instances where the head verbs do not take any subjects. As before, cases without any negative morphemes are considered as positive. For negative constructions, we chose structures where the negative morphemes are combined with the auxiliary verb *do* and they together modify the head verbs of the sentences. In order to not have overlap with rejection, non-existence, epistemic negation and possession (see below), our search excluded utterances where the head verb had any of the following lemma forms: *like*, *want*, *know*, *think*, *remember*, *have*. This resulted in a total of `r format(sum(subset(prohibition_data,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")` negative utterances (child: `r format(sum(subset(prohibition_data_child,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`; parent: `r format(sum(subset(prohibition_data_parent,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`), and `r format(sum(subset(prohibition_data,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")` positive utterances (child: `r format(sum(subset(prohibition_data_child,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`; parent: `r format(sum(subset(prohibition_data_parent,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`).

Figure \@ref(fig:prohibition) demonstrates the cumulative ratios of prohibition and their positive counterparts in parents' and children's production at the sentence level. In both child and parent speech, negative constructions for prohibition are consistently produced less frequently than their positive counterparts. Children produce negative imperatives more and more often between 24 and 36 months. In comparison, the cumulative ratio in parent speech gradually decreases at the beginning when children are between 12 - 24 months. Yet overall, children's production remains consistently lower than parents' production of prohibition. This might be due to the social nature of parent-child interactions, in which it is more likely for parents to explicitly command and direct children's actions than the other way round.

| Prohibition (Negative)        | Positive counterpart |
|-------------------------------|----------------------|
| *do* **n't** *blame Charlotte* | *cook it*            |
| *do* **n't** *do that*         | *try this*           |
| *do* ***not*** *touch that*   | *drink your water*   |
| *do* ***not*** *break it*     | *come here*          |

: (#tab:prohibit) Examples of sentence-level prohibition and positive counterparts in children's speech.

```{r prohibition, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=6.5, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap='Cumulative ratios for the production of prohibition at the sentence level for children between 12 to 72 months of age, and their parents. The y-axes are scaled differently for the panels to accommodate differences in production ratios.'}

subset(prohibition_data, Which=='cumulative ratio') %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Production, color = Production)) +
  geom_line(aes(linetype=Production), alpha = 1) +
#  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Production, shape = Production), size = 1.5) +
#  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkred", "darkgreen", "steelblue",  "mediumpurple4")) +
  facet_wrap( ~ Polarity, scales = "free_y") +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") + 
  guides(color = guide_legend(nrow = 2)) + 
  theme(legend.title = element_blank())

```

At the discourse level, we selected utterances where *no* serves as a discourse response particle to antecedents that were subjectless imperatives headed by a verb. Again we excluded cases where the head verbs have any of the following lemmas: *like*, *want*, *know*, *think*, *remember*, and *have*. We would like to point out that in these instances, children's (and parents') production of *no* is not necessarily negating the content of the antecedent prohibition. Instead we simply included these cases as a way of probing children's negative responses to imperatives, and also to be consistent with our analyses of the negative constructions of other communicative functions. Our search resulted in a total of `r format(sum(subset(discourse_prohibition_data,Which=='ratio')$Freq), big.mark=",")` utterances (child: `r format(sum(subset(discourse_prohibition_data_child,Which=='ratio')$Freq), big.mark=",")`; parent: `r format(sum(subset(discourse_prohibition_data_parent,Which=='ratio')$Freq), big.mark=",")`). As shown in Figure \@ref(fig:prohibitiondiscourse), both children's and parents' usage of negation as a response particle to imperatives gradually decrease before 36 months, then stays relatively stable after. Nevertheless, given the extremely small sample size here, these observations are not conclusive.

| Antecedent                         | Utterance                            |
|-----------------------------------|-------------------------------------|
| Parent: *put away your toys*       | Child: ***no*** *mommy I like these* |
| Parent: *do**n't*** *put it there* | Child: ***no*** *I really want to*   |
| Child: *give it to me*             | Parent: ***no*** *not right now*     |
| Child: *try it*                    | Parent: ***no no*** *please*         |

: (#tab:disprohib) Examples of discourse-level prohibition in children's and parents' speech.

```{r prohibitiondiscourse, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=2.8, set.cap.width=T, num.cols.cap=1, fig.cap="Cumulative ratios for the production of prohibition at the discourse level for children between 12 to 72 months of age, and their parents.",warning=FALSE}

subset(discourse_prohibition_data_plot, Measure=='cumulative ratio') %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Role, color = Role)) +
  geom_line(aes(linetype=Role), alpha = 1) +
  scale_linetype_manual(values=c('solid', 'dotted')) +
  geom_point(aes(color = Role, shape = Role), size = 1.5) +
  scale_shape_manual(values = c(16, 3)) +
  scale_color_manual(values = c("darkblue", "peru")) + 
#  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio")

```

### Inability

For the function of inability, we analyzed instances with head verbs that are modified by the modal auxiliaries *can* and *could*. If the head verb was also modified by a negative morpheme, we classified it as negative. Otherwise, we considered it positive. Depending on the larger context, the interpretation of utterances such as "can't go yet" and "this can't go in the box" could be deontic (e.g., "not allowed to go yet"). Given the automatic fashion of our approach, in order to limit the number of cases that potentially yield readings other than (in)ability, we excluded cases without a subject or with subjects that were not first person singular *I*. This led to `r format(sum(subset(inability_data,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")` negative utterances (child: `r format(sum(subset(inability_data_child,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`; parent: `r format(sum(subset(inability_data_parent,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`), and `r format(sum(subset(inability_data,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")` positive utterances (child: `r format(sum(subset(inability_data_child,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`; parent: `r format(sum(subset(inability_data_parent,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`). Table \@ref(tab:inab) shows a few example of the cases we considered.

| Inability (Negative)      | Positive counterpart |
|---------------------------|----------------------|
| *I ca**n't*** *see*       | *I could do it*      |
| *I ca**n't*** *go*        | *I could help it*    |
| *I can* ***not***         | *I can try*          |
| *I can* ***not*** *do it* | *I can put it back*  |

: (#tab:inab) Examples of sentence-level inability and positive counterparts in children's speech.

Figure \@ref(fig:inability) shows cumulative ratios of parents' and children's production of constructions that convey (in)ability. Similar to previous constructions, positive instances are generally more frequent than negative ones. Children produce inability more and more frequently between 18-36 months. After 36 months, their production is gradually becoming stable and higher than parents' production level.

```{r inability, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=6.5, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap="Cumulative ratios for the production of inability at the sentence level for children between 12 to 72 months of age, and their parents. The y-axes are scaled differently for the panels to accommodate differences in production ratios."}

subset(inability_data, Which=='cumulative ratio') %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Production, color = Production)) +
  geom_line(aes(linetype=Production), alpha = 1) +
#  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Production, shape = Production), size = 1.5) +
#  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkred", "darkgreen", "steelblue",  "mediumpurple4")) +
  facet_grid( ~ Polarity, scales = "free_y") +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") + 
  guides(color = guide_legend(nrow = 2)) + 
  theme(legend.title = element_blank())

```

| Antecedent                    | Utterance                      |
|-------------------------------|--------------------------------|
| Parent: *I can do it for you* | Child: ***no no***             |
| Parent: *I ca**n't*** *see*   | Child: ***no*** *try again*    |
| Child: *I can pour this*      | Parent: ***no no*** *please*   |
| Child: *I ca**n't*** *finish* | Parent: ***no*** *you have to* |

: (#tab:disinability) Examples of discourse level inability in children's and parents' speech.

At the discourse level, we chose utterances with the negative particle *no* in response to antecedents that had a similar structure to the inability construction defined at the sentence level. In these interactions, *no* is not always negating the content of the antecedents exactly. However, similar to our motivation for analyzing prohibition at the discourse level, we included these instances to investigate children's (and parents') negative responses to (in)ability more broadly. This yielded a total of `r format(sum(subset(discourse_inability_data,Which=='ratio')$Freq), big.mark=",")` negative utterances (child: `r format(sum(subset(discourse_inability_data_child,Which=='ratio')$Freq), big.mark=",")`; parent: `r format(sum(subset(discourse_inability_data_parent,Which=='ratio')$Freq), big.mark=",")`). Figure \@ref(fig:inabilitydiscourse) presents the cumulative ratios for parents' and children's production of discourse-level inability. Children's production gradually increases from 24 to 36 months and stabilizes after 36 months at a similar rate to that of parent's. Children may be producing instances of inability more than parents because due to their developmental limitations they have more reason to express inability, and perhaps seek help.

```{r inabilitydiscourse, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap="Cumulative ratios for the production of inability at the discourse level for children between 12 to 72 months of age, and their parents.",warning=FALSE}

subset(discourse_inability_data_plot, Measure=='cumulative ratio') %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Role, color = Role)) +
  geom_line(aes(linetype=Role), alpha = 1) +
  scale_linetype_manual(values=c('solid', 'dotted')) +
  geom_point(aes(color = Role, shape = Role), size = 1.5) +
  scale_shape_manual(values = c(16, 3)) +
  scale_color_manual(values = c("darkblue", "peru")) + 
#  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio")

```

### Labeling

```{r learningdata, include=FALSE}

learning <-read.csv('data/learning.txt', header = T, sep = '\t')
# learning <- subset(learning, Subj == 'I' | Subj == 'NONE')
learning$Role[which(learning$Role == "Father")] <- 'Parent'
learning$Role[which(learning$Role == "Mother")] <- 'Parent'
learning$Role[which(learning$Role == "Target_Child")] <- 'Child'

learning_neg = subset(learning, Polarity == 'negative')
learning_pos = subset(learning, Polarity == 'positive')

child_learning_neg <- subset(learning_neg, Role %in% c('Child'))
parent_learning_neg <- subset(learning_neg, Role %in% c('Parent'))

child_learning_neg_mlu <- mlu(child_learning_neg)
parent_learning_neg_mlu <- mlu(parent_learning_neg)


child_learning_neg <- data.frame(table(child_learning_neg$Age))
names(child_learning_neg) <- c('Age', 'Freq')
child_learning_neg$Role <- rep('Child', nrow(child_learning_neg))
child_learning_neg$Head <- rep('', nrow(child_learning_neg))
temp <- merge(child_learning_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_learning_neg <- temp
child_learning_neg$Total_ratio <- child_learning_neg$Freq / child_learning_neg$N_utterance
child_learning_neg$Ratio <- child_learning_neg$Freq / sum(child_learning_neg$Freq)
child_learning_neg$Polarity <- rep('negative', nrow(child_learning_neg))
child_learning_neg$Measure <- rep('negative construction ratio', nrow(child_learning_neg))
child_learning_neg$Which <- rep('ratio', nrow(child_learning_neg))
child_learning_neg$Function <- rep('Labeling', nrow(child_learning_neg))
child_learning_neg <- negative_cumulative(child_learning_neg, child_descriptive)


parent_learning_neg <- data.frame(table(parent_learning_neg$Age))
names(parent_learning_neg) <- c('Age', 'Freq')
parent_learning_neg$Role <- rep('Parent', nrow(parent_learning_neg))
parent_learning_neg$Head <- rep('Learning', nrow(parent_learning_neg))
temp <- merge(parent_learning_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_learning_neg <- temp
parent_learning_neg$Total_ratio <- parent_learning_neg$Freq / parent_learning_neg$N_utterance
parent_learning_neg$Ratio <- parent_learning_neg$Freq / sum(parent_learning_neg$Freq)
parent_learning_neg$Polarity <- rep('negative', nrow(parent_learning_neg))
parent_learning_neg$Measure <- rep('negative construction ratio', nrow(parent_learning_neg))
parent_learning_neg$Which <- rep('ratio', nrow(parent_learning_neg))
parent_learning_neg$Function <- rep('Labeling', nrow(parent_learning_neg))
parent_learning_neg <- negative_cumulative(parent_learning_neg, parent_descriptive)


child_learning_pos <- subset(learning_pos, Role %in% c('Child'))
parent_learning_pos <- subset(learning_pos, Role %in% c('Parent'))

child_learning_pos_mlu <- mlu(child_learning_pos)
parent_learning_pos_mlu <- mlu(parent_learning_pos)


child_learning_pos <- data.frame(table(child_learning_pos$Age))
names(child_learning_pos) <- c('Age', 'Freq')
child_learning_pos$Role <- rep('Child', nrow(child_learning_pos))
child_learning_pos$Head <- rep('', nrow(child_learning_pos))
temp <- merge(child_learning_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_learning_pos <- temp
child_learning_pos$Total_ratio <- child_learning_pos$Freq / child_learning_pos$N_utterance
child_learning_pos$Ratio <- child_learning_pos$Freq / sum(child_learning_pos$Freq)
child_learning_pos$Polarity <- rep('positive', nrow(child_learning_pos))
child_learning_pos$Measure <- rep('positive construction ratio', nrow(child_learning_pos))
child_learning_pos$Which <- rep('ratio', nrow(child_learning_pos))
child_learning_pos$Function <- rep('Labeling', nrow(child_learning_pos))
child_learning_pos <- positive_cumulative(child_learning_pos, child_descriptive)


parent_learning_pos <- data.frame(table(parent_learning_pos$Age))
names(parent_learning_pos) <- c('Age', 'Freq')
parent_learning_pos$Role <- rep('Parent', nrow(parent_learning_pos))
parent_learning_pos$Head <- rep('Learning', nrow(parent_learning_pos))
temp <- merge(parent_learning_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_learning_pos <- temp
parent_learning_pos$Total_ratio <- parent_learning_pos$Freq / parent_learning_pos$N_utterance
parent_learning_pos$Ratio <- parent_learning_pos$Freq / sum(parent_learning_pos$Freq)
parent_learning_pos$Polarity <- rep('positive', nrow(parent_learning_pos))
parent_learning_pos$Measure <- rep('positive construction ratio', nrow(parent_learning_pos))
parent_learning_pos$Which <- rep('ratio', nrow(parent_learning_pos))
parent_learning_pos$Function <- rep('Labeling', nrow(parent_learning_pos))
parent_learning_pos <- positive_cumulative(parent_learning_pos, parent_descriptive)

learning_data <- rbind(child_learning_neg, child_learning_pos, parent_learning_neg, parent_learning_pos)

learning_data$Measure <- factor(learning_data$Measure, levels = c('negative construction ratio', 'negative construction cumulative ratio', 'positive construction ratio', 'positive construction cumulative ratio'))

learning_data$Production <- paste(learning_data$Role, learning_data$Measure, sep = " ")

learning_data_child <- subset(learning_data, Role == 'Child')
learning_data_parent <- subset(learning_data, Role == 'Parent')


```

```{r discourselearningdata, include=FALSE}

discourse_learning <-read.csv('data/learning_discourse.txt', header = T, sep = '\t')
discourse_learning$Role[which(discourse_learning$Role == "Father")] <- 'Parent'
discourse_learning$Role[which(discourse_learning$Role == "Mother")] <- 'Parent'
discourse_learning$Role[which(discourse_learning$Role == "Target_Child")] <- 'Child'

discourse_learning_neg = subset(discourse_learning, Polarity == 'negative')
discourse_learning_pos = subset(discourse_learning, Polarity == 'positive')

discourse_child_learning_neg <- subset(discourse_learning_neg, Role %in% c('Child'))
discourse_parent_learning_neg <- subset(discourse_learning_neg, Role %in% c('Parent'))

discourse_child_learning_neg <- data.frame(table(discourse_child_learning_neg$Age))
names(discourse_child_learning_neg) <- c('Age', 'Freq')
discourse_child_learning_neg$Role <- rep('Child', nrow(discourse_child_learning_neg))
discourse_child_learning_neg$Head <- rep('', nrow(discourse_child_learning_neg))
temp <- merge(discourse_child_learning_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_learning_neg <- temp
discourse_child_learning_neg$Total_ratio <- discourse_child_learning_neg$Freq / discourse_child_learning_neg$N_utterance
discourse_child_learning_neg$Ratio <- discourse_child_learning_neg$Freq / sum(discourse_child_learning_neg$Freq)
discourse_child_learning_neg$Polarity <- rep('negative', nrow(discourse_child_learning_neg))
discourse_child_learning_neg$Measure <- rep('negative construction ratio', nrow(discourse_child_learning_neg))
discourse_child_learning_neg$Which <- rep('ratio', nrow(discourse_child_learning_neg))
discourse_child_learning_neg$Function <- rep('Labeling', nrow(discourse_child_learning_neg))
discourse_child_learning_neg <- negative_cumulative(discourse_child_learning_neg, child_descriptive)


discourse_parent_learning_neg <- data.frame(table(discourse_parent_learning_neg$Age))
names(discourse_parent_learning_neg) <- c('Age', 'Freq')
discourse_parent_learning_neg$Role <- rep('Parent', nrow(discourse_parent_learning_neg))
discourse_parent_learning_neg$Head <- rep('Learning', nrow(discourse_parent_learning_neg))
temp <- merge(discourse_parent_learning_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_learning_neg <- temp
discourse_parent_learning_neg$Total_ratio <- discourse_parent_learning_neg$Freq / discourse_parent_learning_neg$N_utterance
discourse_parent_learning_neg$Ratio <- discourse_parent_learning_neg$Freq / sum(discourse_parent_learning_neg$Freq)
discourse_parent_learning_neg$Polarity <- rep('negative', nrow(discourse_parent_learning_neg))
discourse_parent_learning_neg$Measure <- rep('negative construction ratio', nrow(discourse_parent_learning_neg))
discourse_parent_learning_neg$Which <- rep('ratio', nrow(discourse_parent_learning_neg))
discourse_parent_learning_neg$Function <- rep('Labeling', nrow(discourse_parent_learning_neg))
discourse_parent_learning_neg <- negative_cumulative(discourse_parent_learning_neg, parent_descriptive)


discourse_child_learning_pos <- subset(discourse_learning_pos, Role %in% c('Child'))
discourse_parent_learning_pos <- subset(discourse_learning_pos, Role %in% c('Parent'))

discourse_child_learning_pos <- data.frame(table(discourse_child_learning_pos$Age))
names(discourse_child_learning_pos) <- c('Age', 'Freq')
discourse_child_learning_pos$Role <- rep('Child', nrow(discourse_child_learning_pos))
discourse_child_learning_pos$Head <- rep('', nrow(discourse_child_learning_pos))
temp <- merge(discourse_child_learning_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_learning_pos <- temp
discourse_child_learning_pos$Total_ratio <- discourse_child_learning_pos$Freq / discourse_child_learning_pos$N_utterance
discourse_child_learning_pos$Ratio <- discourse_child_learning_pos$Freq / sum(discourse_child_learning_pos$Freq)
discourse_child_learning_pos$Polarity <- rep('positive', nrow(discourse_child_learning_pos))
discourse_child_learning_pos$Measure <- rep('positive construction ratio', nrow(discourse_child_learning_pos))
discourse_child_learning_pos$Which <- rep('ratio', nrow(discourse_child_learning_pos))
discourse_child_learning_pos$Function <- rep('Labeling', nrow(discourse_child_learning_pos))
discourse_child_learning_pos <- positive_cumulative(discourse_child_learning_pos, child_descriptive)


discourse_parent_learning_pos <- data.frame(table(discourse_parent_learning_pos$Age))
names(discourse_parent_learning_pos) <- c('Age', 'Freq')
discourse_parent_learning_pos$Role <- rep('Parent', nrow(discourse_parent_learning_pos))
discourse_parent_learning_pos$Head <- rep('Learning', nrow(discourse_parent_learning_pos))
temp <- merge(discourse_parent_learning_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_learning_pos <- temp
discourse_parent_learning_pos$Total_ratio <- discourse_parent_learning_pos$Freq / discourse_parent_learning_pos$N_utterance
discourse_parent_learning_pos$Ratio <- discourse_parent_learning_pos$Freq / sum(discourse_parent_learning_pos$Freq)
discourse_parent_learning_pos$Polarity <- rep('positive', nrow(discourse_parent_learning_pos))
discourse_parent_learning_pos$Measure <- rep('positive construction ratio', nrow(discourse_parent_learning_pos))
discourse_parent_learning_pos$Which <- rep('ratio', nrow(discourse_parent_learning_pos))
discourse_parent_learning_pos$Function <- rep('Labeling', nrow(discourse_parent_learning_pos))
discourse_parent_learning_pos <- positive_cumulative(discourse_parent_learning_pos, parent_descriptive)

discourse_learning_data <- rbind(discourse_child_learning_neg, discourse_child_learning_pos, discourse_parent_learning_neg, discourse_parent_learning_pos)

discourse_learning_data$Measure <- factor(discourse_learning_data$Measure, levels = c('negative construction ratio', 'negative construction cumulative ratio', 'positive construction ratio', 'positive construction cumulative ratio'))

discourse_learning_data_child <- subset(discourse_learning_data, Role == 'Child')
discourse_learning_data_parent <- subset(discourse_learning_data, Role == 'Parent')

discourse_learning_data_plot <- aggregate(Total_ratio~Age+Which+Role,data=discourse_learning_data,sum)

names(discourse_learning_data_plot) <- c('Age', 'Measure', 'Role', 'Total_ratio')


```

To capture the function of labeling at the sentence level, we concentrated on copula structures in which the predicate is a nominal or an adjectival phrase. Specifically, the nominal predicates exclude possessive pronouns (e.g., "mine") as well as nominals with a possessive dependent (e.g., "my book") in order to not overlap with the communicative function of possession (see Possession below). We considered instances where the predicate is modified by negative morphemes as negative, and others as positive. To also avoid overlap with cases of non-existence, none of the utterances contained expletives (e.g., "there is no book"). This resulted in a total of `r format(sum(subset(learning_data,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")` negative utterances (Child: `r format(sum(subset(learning_data_child,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`; Parent: `r format(sum(subset(learning_data_parent,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`), and `r format(sum(subset(learning_data,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")` positive utterances (Child: `r format(sum(subset(learning_data_child,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`; Parent: `r format(sum(subset(learning_data_parent,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`).

| Labeling (Negative)        | Positive counterpart |
|----------------------------|----------------------|
| *that's not a farmer*      | *this is a book*     |
| *this is not the book*     | *this is nice*       |
| *I'm not a heavy baby Mum* | *it's a nice bowl*   |
| *It's no good*             | *she's pretty*       |

: (#tab:label) Examples of sentence-level labeling (negative) and positive counterparts in children's speech.

Figure \@ref(fig:learning) shows cumulative ratios for parent's and children's production of the labeling construction at the sentence level. In both parent and children speech, the frequency of positive counterparts is consistently higher than that of negative labeling instances. Children's production of negative labeling increases between 18-36 months, and remains stable after then; though the production ratios remained lower than those of parents'.

```{r learning, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=6.5, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap="Cumulative ratios for the production of (negative) labeling at the sentence level for children between 12 to 72 months of age, and their parents. The y-axes are scaled differently for the panels to accommodate differences in production ratios."}

subset(learning_data, Which=='cumulative ratio') %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Production, color = Production)) +
  geom_line(aes(linetype=Production), alpha = 1) +
#  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Production, shape = Production), size = 1.5) +
#  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkred", "darkgreen", "steelblue",  "mediumpurple4")) +
  facet_wrap( ~ Polarity, scales = "free_y") +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") + 
  guides(color = guide_legend(nrow = 2)) + 
  theme(legend.title = element_blank())


```

At the discourse level, we selected antecedent utterances with copula structures that are combined with a nominal or an adjectival predicate (\@ref(tab:dislabel)). In total we found `r format(sum(subset(discourse_learning_data,Which=='ratio')$Freq), big.mark=",")` utterances (Child: `r format(sum(subset(discourse_learning_data_child,Which=='ratio')$Freq), big.mark=",")`; Parent: `r format(sum(subset(discourse_learning_data_parent,Which=='ratio')$Freq), big.mark=",")`). The cumulative ratios for labeling instances at the discourse level are illustrated in Figure \@ref(fig:learningdiscourse). There is an increase in children's use of *no* to negate labeling between 18 to 36 months. After 36 months, however, the production stays at a stable rate above parents level.

| Antecedent                  | Utterance                             |
|-----------------------------|---------------------------------------|
| Parent: *is this one good*  | Child: ***no*** *it's not*            |
| Parent: *are you a captain* | Child: ***no*** *I'm not*             |
| Child: *that's the one*     | Parent: ***no*** *it's the green one* |
| Child: *this is the key*    | Parent: ***no no***                   |

: (#tab:dislabel) Examples of discourse-level labeling (negative) in children's and parents' speech.

```{r learningdiscourse, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap="Cumulative ratios for the production of (negative) labeling at the discourse level for children between 12 to 72 months of age, and their parents.",warning=FALSE}

subset(discourse_learning_data_plot, Measure=='cumulative ratio') %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Role, color = Role)) +
  geom_line(aes(linetype=Role), alpha = 1) +
  scale_linetype_manual(values=c('solid', 'dotted')) +
  geom_point(aes(color = Role, shape = Role), size = 1.5) +
  scale_shape_manual(values = c(16, 3)) +
  scale_color_manual(values = c("darkblue", "peru")) + 
#  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio")

```

### Epistemic Negation

```{r epistemicdata, include=FALSE}

epistemic <-read.csv('data/epistemic.txt', header = T, sep = '\t')
# epistemic <- subset(epistemic, Subj == 'I' | Subj == 'NONE')
epistemic$Role[which(epistemic$Role == "Father")] <- 'Parent'
epistemic$Role[which(epistemic$Role == "Mother")] <- 'Parent'
epistemic$Role[which(epistemic$Role == "Target_Child")] <- 'Child'

epistemic_neg = subset(epistemic, Polarity == 'negative')
epistemic_pos = subset(epistemic, Polarity == 'positive')

child_epistemic_neg <- subset(epistemic_neg, Role %in% c('Child'))
parent_epistemic_neg <- subset(epistemic_neg, Role %in% c('Parent'))

child_know_neg <- subset(child_epistemic_neg, Head %in% c('know'))
child_remember_neg <- subset(child_epistemic_neg, Head %in% c('remember'))
child_think_neg <- subset(child_epistemic_neg, Head %in% c('think'))
parent_know_neg <- subset(parent_epistemic_neg, Head %in% c('know'))
parent_remember_neg <- subset(parent_epistemic_neg, Head %in% c('remember'))
parent_think_neg <- subset(parent_epistemic_neg, Head %in% c('think'))


child_know_neg_mlu <- mlu(child_know_neg)
child_remember_neg_mlu <- mlu(child_remember_neg)
child_think_neg_mlu <- mlu(child_think_neg)
parent_know_neg_mlu <- mlu(parent_know_neg)
parent_remember_neg_mlu <- mlu(parent_remember_neg)
parent_think_neg_mlu <- mlu(parent_think_neg)


child_know_neg <- data.frame(table(child_know_neg$Age))
names(child_know_neg) <- c('Age', 'Freq')
child_know_neg$Role <- rep('Child', nrow(child_know_neg))
child_know_neg$Head <- rep('know', nrow(child_know_neg))
temp <- merge(child_know_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_know_neg <- temp
child_know_neg$Total_ratio <- child_know_neg$Freq / child_know_neg$N_utterance
child_know_neg$Ratio <- child_know_neg$Freq / sum(child_know_neg$Freq)
child_know_neg$Polarity <- rep('negative', nrow(child_know_neg))
child_know_neg$Measure <- rep('negative construction ratio', nrow(child_know_neg))
child_know_neg$Which <- rep('ratio', nrow(child_know_neg))
child_know_neg$Function <- rep('Epistemic', nrow(child_know_neg))
child_know_neg <- negative_cumulative(child_know_neg, child_descriptive)


child_remember_neg <- data.frame(table(child_remember_neg$Age))
names(child_remember_neg) <- c('Age', 'Freq')
child_remember_neg$Role <- rep('Child', nrow(child_remember_neg))
child_remember_neg$Head <- rep('remember', nrow(child_remember_neg))
temp <- merge(child_remember_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_remember_neg <- temp
child_remember_neg$Total_ratio <- child_remember_neg$Freq / child_remember_neg$N_utterance
child_remember_neg$Ratio <- child_remember_neg$Freq / sum(child_remember_neg$Freq)
child_remember_neg$Polarity <- rep('negative', nrow(child_remember_neg))
child_remember_neg$Measure <- rep('negative construction ratio', nrow(child_remember_neg))
child_remember_neg$Which <- rep('ratio', nrow(child_remember_neg))
child_remember_neg$Function <- rep('Epistemic', nrow(child_remember_neg))
child_remember_neg <- negative_cumulative(child_remember_neg, child_descriptive)

child_think_neg <- data.frame(table(child_think_neg$Age))
names(child_think_neg) <- c('Age', 'Freq')
child_think_neg$Role <- rep('Child', nrow(child_think_neg))
child_think_neg$Head <- rep('think', nrow(child_think_neg))
temp <- merge(child_think_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
child_think_neg <- temp
child_think_neg$Total_ratio <- child_think_neg$Freq / child_think_neg$N_utterance
child_think_neg$Ratio <- child_think_neg$Freq / sum(child_think_neg$Freq)
child_think_neg$Polarity <- rep('negative', nrow(child_think_neg))
child_think_neg$Measure <- rep('negative construction ratio', nrow(child_think_neg))
child_think_neg$Which <- rep('ratio', nrow(child_think_neg))
child_think_neg$Function <- rep('Epistemic', nrow(child_think_neg))
child_think_neg <- negative_cumulative(child_think_neg, child_descriptive)

parent_know_neg <- data.frame(table(parent_know_neg$Age))
names(parent_know_neg) <- c('Age', 'Freq')
parent_know_neg$Role <- rep('Parent', nrow(parent_know_neg))
parent_know_neg$Head <- rep('know', nrow(parent_know_neg))
temp <- merge(parent_know_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_know_neg <- temp
parent_know_neg$Total_ratio <- parent_know_neg$Freq / parent_know_neg$N_utterance
parent_know_neg$Ratio <- parent_know_neg$Freq / sum(parent_know_neg$Freq)
parent_know_neg$Polarity <- rep('negative', nrow(parent_know_neg))
parent_know_neg$Measure <- rep('negative construction ratio', nrow(parent_know_neg))
parent_know_neg$Which <- rep('ratio', nrow(parent_know_neg))
parent_know_neg$Function <- rep('Epistemic', nrow(parent_know_neg))
parent_know_neg <- negative_cumulative(parent_know_neg, parent_descriptive)

parent_remember_neg <- data.frame(table(parent_remember_neg$Age))
names(parent_remember_neg) <- c('Age', 'Freq')
parent_remember_neg$Role <- rep('Parent', nrow(parent_remember_neg))
parent_remember_neg$Head <- rep('remember', nrow(parent_remember_neg))
temp <- merge(parent_remember_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_remember_neg <- temp
parent_remember_neg$Total_ratio <- parent_remember_neg$Freq / parent_remember_neg$N_utterance
parent_remember_neg$Ratio <- parent_remember_neg$Freq / sum(parent_remember_neg$Freq)
parent_remember_neg$Polarity <- rep('negative', nrow(parent_remember_neg))
parent_remember_neg$Measure <- rep('negative construction ratio', nrow(parent_remember_neg))
parent_remember_neg$Which <- rep('ratio', nrow(parent_remember_neg))
parent_remember_neg$Function <- rep('Epistemic', nrow(parent_remember_neg))
parent_remember_neg <- negative_cumulative(parent_remember_neg, parent_descriptive)

parent_think_neg <- data.frame(table(parent_think_neg$Age))
names(parent_think_neg) <- c('Age', 'Freq')
parent_think_neg$Role <- rep('Parent', nrow(parent_think_neg))
parent_think_neg$Head <- rep('think', nrow(parent_think_neg))
temp <- merge(parent_think_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_think_neg <- temp
parent_think_neg$Total_ratio <- parent_think_neg$Freq / parent_think_neg$N_utterance
parent_think_neg$Ratio <- parent_think_neg$Freq / sum(parent_think_neg$Freq)
parent_think_neg$Polarity <- rep('negative', nrow(parent_think_neg))
parent_think_neg$Measure <- rep('negative construction ratio', nrow(parent_think_neg))
parent_think_neg$Which <- rep('ratio', nrow(parent_think_neg))
parent_think_neg$Function <- rep('Epistemic', nrow(parent_think_neg))
parent_think_neg <- negative_cumulative(parent_think_neg, parent_descriptive)


child_epistemic_pos <- subset(epistemic_pos, Role %in% c('Child'))
parent_epistemic_pos <- subset(epistemic_pos, Role %in% c('Parent'))

child_know_pos <- subset(child_epistemic_pos, Head %in% c('know'))
child_remember_pos <- subset(child_epistemic_pos, Head %in% c('remember'))
child_think_pos <- subset(child_epistemic_pos, Head %in% c('think'))
parent_know_pos <- subset(parent_epistemic_pos, Head %in% c('know'))
parent_remember_pos <- subset(parent_epistemic_pos, Head %in% c('remember'))
parent_think_pos <- subset(parent_epistemic_pos, Head %in% c('think'))


child_know_pos_mlu <- mlu(child_know_pos)
child_remember_pos_mlu <- mlu(child_remember_pos)
child_think_pos_mlu <- mlu(child_think_pos)
parent_know_pos_mlu <- mlu(parent_know_pos)
parent_remember_pos_mlu <- mlu(parent_remember_pos)
parent_think_pos_mlu <- mlu(parent_think_pos)


child_know_pos <- data.frame(table(child_know_pos$Age))
names(child_know_pos) <- c('Age', 'Freq')
child_know_pos$Role <- rep('Child', nrow(child_know_pos))
child_know_pos$Head <- rep('know', nrow(child_know_pos))
temp <- merge(child_know_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_know_pos <- temp
child_know_pos$Total_ratio <- child_know_pos$Freq / child_know_pos$N_utterance
child_know_pos$Ratio <- child_know_pos$Freq / sum(child_know_pos$Freq)
child_know_pos$Polarity <- rep('positive', nrow(child_know_pos))
child_know_pos$Measure <- rep('positive construction ratio', nrow(child_know_pos))
child_know_pos$Which <- rep('ratio', nrow(child_know_pos))
child_know_pos$Function <- rep('Epistemic', nrow(child_know_pos))
child_know_pos <- positive_cumulative(child_know_pos, child_descriptive)


child_remember_pos <- data.frame(table(child_remember_pos$Age))
names(child_remember_pos) <- c('Age', 'Freq')
child_remember_pos$Role <- rep('Child', nrow(child_remember_pos))
child_remember_pos$Head <- rep('remember', nrow(child_remember_pos))
temp <- merge(child_remember_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_remember_pos <- temp
child_remember_pos$Total_ratio <- child_remember_pos$Freq / child_remember_pos$N_utterance
child_remember_pos$Ratio <- child_remember_pos$Freq / sum(child_remember_pos$Freq)
child_remember_pos$Polarity <- rep('positive', nrow(child_remember_pos))
child_remember_pos$Measure <- rep('positive construction ratio', nrow(child_remember_pos))
child_remember_pos$Which <- rep('ratio', nrow(child_remember_pos))
child_remember_pos$Function <- rep('Epistemic', nrow(child_remember_pos))
child_remember_pos <- positive_cumulative(child_remember_pos, child_descriptive)

child_think_pos <- data.frame(table(child_think_pos$Age))
names(child_think_pos) <- c('Age', 'Freq')
child_think_pos$Role <- rep('Child', nrow(child_think_pos))
child_think_pos$Head <- rep('think', nrow(child_think_pos))
temp <- merge(child_think_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
child_think_pos <- temp
child_think_pos$Total_ratio <- child_think_pos$Freq / child_think_pos$N_utterance
child_think_pos$Ratio <- child_think_pos$Freq / sum(child_think_pos$Freq)
child_think_pos$Polarity <- rep('positive', nrow(child_think_pos))
child_think_pos$Measure <- rep('positive construction ratio', nrow(child_think_pos))
child_think_pos$Which <- rep('ratio', nrow(child_think_pos))
child_think_pos$Function <- rep('Epistemic', nrow(child_think_pos))
child_think_pos <- positive_cumulative(child_think_pos, child_descriptive)

parent_know_pos <- data.frame(table(parent_know_pos$Age))
names(parent_know_pos) <- c('Age', 'Freq')
parent_know_pos$Role <- rep('Parent', nrow(parent_know_pos))
parent_know_pos$Head <- rep('know', nrow(parent_know_pos))
temp <- merge(parent_know_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_know_pos <- temp
parent_know_pos$Total_ratio <- parent_know_pos$Freq / parent_know_pos$N_utterance
parent_know_pos$Ratio <- parent_know_pos$Freq / sum(parent_know_pos$Freq)
parent_know_pos$Polarity <- rep('positive', nrow(parent_know_pos))
parent_know_pos$Measure <- rep('positive construction ratio', nrow(parent_know_pos))
parent_know_pos$Which <- rep('ratio', nrow(parent_know_pos))
parent_know_pos$Function <- rep('Epistemic', nrow(parent_know_pos))
parent_know_pos <- positive_cumulative(parent_know_pos, parent_descriptive)

parent_remember_pos <- data.frame(table(parent_remember_pos$Age))
names(parent_remember_pos) <- c('Age', 'Freq')
parent_remember_pos$Role <- rep('Parent', nrow(parent_remember_pos))
parent_remember_pos$Head <- rep('remember', nrow(parent_remember_pos))
temp <- merge(parent_remember_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_remember_pos <- temp
parent_remember_pos$Total_ratio <- parent_remember_pos$Freq / parent_remember_pos$N_utterance
parent_remember_pos$Ratio <- parent_remember_pos$Freq / sum(parent_remember_pos$Freq)
parent_remember_pos$Polarity <- rep('positive', nrow(parent_remember_pos))
parent_remember_pos$Measure <- rep('positive construction ratio', nrow(parent_remember_pos))
parent_remember_pos$Which <- rep('ratio', nrow(parent_remember_pos))
parent_remember_pos$Function <- rep('Epistemic', nrow(parent_remember_pos))
parent_remember_pos <- positive_cumulative(parent_remember_pos, parent_descriptive)

parent_think_pos <- data.frame(table(parent_think_pos$Age))
names(parent_think_pos) <- c('Age', 'Freq')
parent_think_pos$Role <- rep('Parent', nrow(parent_think_pos))
parent_think_pos$Head <- rep('think', nrow(parent_think_pos))
temp <- merge(parent_think_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
parent_think_pos <- temp
parent_think_pos$Total_ratio <- parent_think_pos$Freq / parent_think_pos$N_utterance
parent_think_pos$Ratio <- parent_think_pos$Freq / sum(parent_think_pos$Freq)
parent_think_pos$Polarity <- rep('positive', nrow(parent_think_pos))
parent_think_pos$Measure <- rep('positive construction ratio', nrow(parent_think_pos))
parent_think_pos$Which <- rep('ratio', nrow(parent_think_pos))
parent_think_pos$Function <- rep('Epistemic', nrow(parent_think_pos))
parent_think_pos <- positive_cumulative(parent_think_pos, parent_descriptive)

epistemic_data <- rbind(child_know_neg, child_know_pos, parent_know_neg, parent_know_pos, child_remember_neg, child_remember_pos, parent_remember_neg, parent_remember_pos, child_think_neg, child_think_pos, parent_think_neg, parent_think_pos)

epistemic_data$Measure <- factor(epistemic_data$Measure, levels = c('negative construction ratio', 'negative construction cumulative ratio', 'positive construction ratio', 'positive construction cumulative ratio'))

epistemic_data$Polarity <- factor(epistemic_data$Polarity, levels = c('negative', 'positive'))

epistemic_data$Production <- paste(epistemic_data$Role, epistemic_data$Measure, sep = " ")

epistemic_data_child <- subset(epistemic_data, Role == 'Child')
epistemic_data_parent <- subset(epistemic_data, Role == 'Parent')

```

```{r epistemicdiscoursedata, include=FALSE}

discourse_epistemic <-read.csv('data/epistemic_discourse.txt', header = T, sep = '\t')
discourse_epistemic$Role[which(discourse_epistemic$Role == "Father")] <- 'Parent'
discourse_epistemic$Role[which(discourse_epistemic$Role == "Mother")] <- 'Parent'
discourse_epistemic$Role[which(discourse_epistemic$Role == "Target_Child")] <- 'Child'

discourse_epistemic_neg = subset(discourse_epistemic, Polarity == 'negative')
discourse_epistemic_pos = subset(discourse_epistemic, Polarity == 'positive')

discourse_child_epistemic_neg <- subset(discourse_epistemic_neg, Role %in% c('Child'))
discourse_parent_epistemic_neg <- subset(discourse_epistemic_neg, Role %in% c('Parent'))

discourse_child_epistemic_neg <- data.frame(table(discourse_child_epistemic_neg$Age))
names(discourse_child_epistemic_neg) <- c('Age', 'Freq')
discourse_child_epistemic_neg$Role <- rep('Child', nrow(discourse_child_epistemic_neg))
discourse_child_epistemic_neg$Head <- rep('all', nrow(discourse_child_epistemic_neg))
temp <- merge(discourse_child_epistemic_neg, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_epistemic_neg <- temp
discourse_child_epistemic_neg$Total_ratio <- discourse_child_epistemic_neg$Freq / discourse_child_epistemic_neg$N_utterance
discourse_child_epistemic_neg$Ratio <- discourse_child_epistemic_neg$Freq / sum(discourse_child_epistemic_neg$Freq)
discourse_child_epistemic_neg$Polarity <- rep('negative', nrow(discourse_child_epistemic_neg))
discourse_child_epistemic_neg$Measure <- rep('negative construction ratio', nrow(discourse_child_epistemic_neg))
discourse_child_epistemic_neg$Which <- rep('ratio', nrow(discourse_child_epistemic_neg))
discourse_child_epistemic_neg$Function <- rep('Epistemic', nrow(discourse_child_epistemic_neg))
discourse_child_epistemic_neg <- negative_cumulative(discourse_child_epistemic_neg, child_descriptive)

discourse_parent_epistemic_neg <- data.frame(table(discourse_parent_epistemic_neg$Age))
names(discourse_parent_epistemic_neg) <- c('Age', 'Freq')
discourse_parent_epistemic_neg$Role <- rep('Parent', nrow(discourse_parent_epistemic_neg))
discourse_parent_epistemic_neg$Head <- rep('al', nrow(discourse_parent_epistemic_neg))
temp <- merge(discourse_parent_epistemic_neg, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_epistemic_neg <- temp
discourse_parent_epistemic_neg$Total_ratio <- discourse_parent_epistemic_neg$Freq / discourse_parent_epistemic_neg$N_utterance
discourse_parent_epistemic_neg$Ratio <- discourse_parent_epistemic_neg$Freq / sum(discourse_parent_epistemic_neg$Freq)
discourse_parent_epistemic_neg$Polarity <- rep('negative', nrow(discourse_parent_epistemic_neg))
discourse_parent_epistemic_neg$Measure <- rep('negative construction ratio', nrow(discourse_parent_epistemic_neg))
discourse_parent_epistemic_neg$Which <- rep('ratio', nrow(discourse_parent_epistemic_neg))
discourse_parent_epistemic_neg$Function <- rep('Epistemic', nrow(discourse_parent_epistemic_neg))
discourse_parent_epistemic_neg <- negative_cumulative(discourse_parent_epistemic_neg, parent_descriptive)

discourse_child_epistemic_pos <- subset(discourse_epistemic_pos, Role %in% c('Child'))
discourse_parent_epistemic_pos <- subset(discourse_epistemic_pos, Role %in% c('Parent'))

discourse_child_epistemic_pos <- data.frame(table(discourse_child_epistemic_pos$Age))
names(discourse_child_epistemic_pos) <- c('Age', 'Freq')
discourse_child_epistemic_pos$Role <- rep('Child', nrow(discourse_child_epistemic_pos))
discourse_child_epistemic_pos$Head <- rep('all', nrow(discourse_child_epistemic_pos))
temp <- merge(discourse_child_epistemic_pos, child_descriptive, by.x = 'Age', all.x = TRUE)
discourse_child_epistemic_pos <- temp
discourse_child_epistemic_pos$Total_ratio <- discourse_child_epistemic_pos$Freq / discourse_child_epistemic_pos$N_utterance
discourse_child_epistemic_pos$Ratio <- discourse_child_epistemic_pos$Freq / sum(discourse_child_epistemic_pos$Freq)
discourse_child_epistemic_pos$Polarity <- rep('positive', nrow(discourse_child_epistemic_pos))
discourse_child_epistemic_pos$Measure <- rep('positive construction ratio', nrow(discourse_child_epistemic_pos))
discourse_child_epistemic_pos$Which <- rep('ratio', nrow(discourse_child_epistemic_pos))
discourse_child_epistemic_pos$Function <- rep('Epistemic', nrow(discourse_child_epistemic_pos))
discourse_child_epistemic_pos <- positive_cumulative(discourse_child_epistemic_pos, child_descriptive)


discourse_parent_epistemic_pos <- data.frame(table(discourse_parent_epistemic_pos$Age))
names(discourse_parent_epistemic_pos) <- c('Age', 'Freq')
discourse_parent_epistemic_pos$Role <- rep('Parent', nrow(discourse_parent_epistemic_pos))
discourse_parent_epistemic_pos$Head <- rep('all', nrow(discourse_parent_epistemic_pos))
temp <- merge(discourse_parent_epistemic_pos, parent_descriptive, by.x = 'Age', all.x = TRUE)
discourse_parent_epistemic_pos <- temp
discourse_parent_epistemic_pos$Total_ratio <- discourse_parent_epistemic_pos$Freq / discourse_parent_epistemic_pos$N_utterance
discourse_parent_epistemic_pos$Ratio <- discourse_parent_epistemic_pos$Freq / sum(discourse_parent_epistemic_pos$Freq)
discourse_parent_epistemic_pos$Polarity <- rep('positive', nrow(discourse_parent_epistemic_pos))
discourse_parent_epistemic_pos$Measure <- rep('positive construction ratio', nrow(discourse_parent_epistemic_pos))
discourse_parent_epistemic_pos$Which <- rep('ratio', nrow(discourse_parent_epistemic_pos))
discourse_parent_epistemic_pos$Function <- rep('Epistemic', nrow(discourse_parent_epistemic_pos))
discourse_parent_epistemic_pos <- positive_cumulative(discourse_parent_epistemic_pos, parent_descriptive)

discourse_epistemic_data <- rbind(discourse_child_epistemic_neg, discourse_parent_epistemic_neg, discourse_child_epistemic_pos, discourse_parent_epistemic_pos)

discourse_epistemic_data$Measure <- factor(discourse_epistemic_data$Measure, levels = c('negative construction ratio', 'negative construction cumulative ratio', 'positive construction ratio', 'positive construction cumulative ratio'))

discourse_epistemic_data_child <- subset(discourse_epistemic_data, Role == 'Child')
discourse_epistemic_data_parent <- subset(discourse_epistemic_data, Role == 'Parent')

discourse_epistemic_data_plot <- aggregate(Total_ratio~Age+Which+Role,data=discourse_epistemic_data,sum)

names(discourse_epistemic_data_plot) <- c('Age', 'Measure', 'Role', 'Total_ratio')

```

Previous studies have reported instances in which children combined negative morphemes with mental state verbs such as *know*, *think*, and *remember* to express "epistemic negation" [@choi1988semantic]. To define epistemic constructions, we also focused on these three verbs. For sentence-level epistemic negation, we analyzed negative utterances where these verbs were modified by negative morphemes, possibly after combining with an auxiliary verb like *do*. Table \@ref(tab:epistem) shows a few examples. Instances where the speaker asked about or described the negative epistemic state of another speaker were also included, leading to `r format(sum(subset(epistemic_data,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")` negative utterances in total (child: `r format(sum(subset(epistemic_data_child,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`; parent: `r format(sum(subset(epistemic_data_parent,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`). For the positive counterparts, we selected instances with the same head verbs except that these verbs were not modified by negation. This resulted in a total of `r format(sum(subset(epistemic_data,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")` positive utterances (child: `r format(sum(subset(epistemic_data_child,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`; parent: `r format(sum(subset(epistemic_data_parent,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`).

| Epistemic (Negative)          | Positive counterpart         |
|-------------------------------|------------------------------|
| *I* ***not*** *know*          | *I know*                     |
| *I did**n't*** *remember*     | *she remembers*              |
| *I do**n't*** *think so*      | *he thinks this one is good* |
| *She does**n't*** *know this* | *She knows about this*       |

: (#tab:epistem) Examples of sentence-level epistemic negation and positive counterparts in children's speech.

Figure \@ref(fig:epistemic) shows the cumulative ratios of the epistemic construction as defined above in parents' and children's speech at the sentence level. Across the three head verbs, children's production increases substantially from 18 to 36 months then gradually becomes stable yet still lower than parents' production level afterwards. The number of epistemic instances headed by *know* is overall higher than the number of cases headed by either *remember* or *think*, an observation that is consistent in both negative constructions and positive counterparts. However, the majority of negative constructions headed by *know* are idiomatic expressions such as "I don't know" (51.66%) or "don't know" (13.73%). Positive epistemic utterances are in general more frequent than negative ones, with the exception of *know* in child speech. 

```{r epistemic, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=6.5, fig.height=8, set.cap.width=T, num.cols.cap=1, fig.cap="Cumulative ratios for the production of epistemic negation at the sentence level for children between 12 to 72 months of age, and their parents. The y-axes are scaled differently for the panels to accommodate differences in production ratios."}

subset(epistemic_data, Which=='cumulative ratio') %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Production, color = Production)) +
  geom_line(aes(linetype=Production), alpha = 1) +
#  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Production, shape = Production), size = 1.5) +
#  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkred", "darkgreen", "steelblue",  "mediumpurple4")) +
  facet_wrap(Head ~ Polarity, scales = "free_y", ncol = 2) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") + 
  guides(color = guide_legend(nrow = 2)) + 
  theme(legend.title = element_blank())

```

For epistemic negation at the discourse level, we examined interactions in which the antecedent utterances took any of the three head verbs: *know*, *remember* and *think*, leading to a total of `r format(sum(subset(discourse_epistemic_data,Which=='ratio')$Freq), big.mark=",")` utterances (child: `r format(sum(subset(discourse_epistemic_data_child,Which=='ratio')$Freq), big.mark=",")`; parent: `r format(sum(subset(discourse_epistemic_data_parent,Which=='ratio')$Freq), big.mark=",")`). As shown in Figure \@ref(fig:epistemicdiscourse), children's production of *no* to negate antecedent epistemic utterances increases rapidly between 18-36 months and is in general higher than the production ratio of parents'.

| Epistemic (Negative)             | Positive counterpart                    |
|---------------------------------|---------------------------------------|
| Parent: *do you know*            | Child: ***no***                         |
| Parent: *do you remember*        | ***no*** *I do**n't*** *remember it*    |
| Child: *does she think so*       | Parent: ***no*** ***not*** *really*     |
| Child: *do they know it's today* | ***no*** *I do**n't*** *think so honey* |

: (#tab:epistem) Examples of discourse-level epistemic negation in children's and parents' speech.

```{r epistemicdiscourse, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap="Cumulative ratios for the production of epistemic negation at the discourse level for children between 12 to 72 months of age, and their parents.",warning=FALSE}

subset(discourse_epistemic_data_plot, Measure=='cumulative ratio') %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Role, color = Role)) +
  geom_line(aes(linetype=Role), alpha = 1) +
  scale_linetype_manual(values=c('solid', 'dotted')) +
  geom_point(aes(color = Role, shape = Role), size = 1.5) +
  scale_shape_manual(values = c(16, 3)) +
  scale_color_manual(values = c("darkblue", "peru")) + 
#  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio")

```

### Possession

The last function we explored was possession. At the sentence level, for negative structures we selected cases where negative morphemes were combined with auxiliary verbs to modify head verbs with the lemma form *have*, and the POS tag of these head verbs is all "VERB". We also included cases of which the syntactic head is a nominal predicate; the nominal predicate can either be a possessive pronoun (e.g., "yours") or a noun phrase with a possessive modifier (e.g., "her book"). Table \@ref(tab:possess) presents several examples. <!--Cases in which the syntactic head of the negative morphemes is a predicate of a copula verb (e.g., "this is not mine") were excluded to separate them from the function "labeling".--> The number of negative utterances subjected to analysis for this function is `r format(sum(subset(possession_data,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")` (child: `r format(sum(subset(possession_data_child,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`; parent: `r format(sum(subset(possession_data_parent,Which=='ratio' & Polarity == 'negative')$Freq), big.mark=",")`). Again the positive counterparts share similar structures except without negation, leading to a total of `r format(sum(subset(possession_data,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")` utterances (child: `r format(sum(subset(possession_data_child,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`; parent: `r format(sum(subset(possession_data_parent,Which=='ratio' & Polarity == 'positive')$Freq), big.mark=",")`). One thing to note here is that for the positive structures with the head verb *have*, we restricted our search to instances where the head verb takes a direct object (with the dependency relation *obj*). This is to avoid potential parsing errors of utterances such as *I have*, where the verb could be an auxiliary.

| Posession (Negative)              | Positive counterpart |
|-----------------------------------|----------------------|
| *I do**n't*** *have it*           | *you have that*      |
| *you do**n't*** *have my toy car* | *she has it*         |
| ***not*** *mine*                  | *this is hers*       |
| ***not*** *yours either*          | *mine mine mine*     |

: (#tab:possess) Examples of sentence-level possession (negative) and positive counterparts in children's speech.

Figure \@ref(fig:possession) presents cumulative ratios of possession construction at the sentence level. Regardless of whether the utterances are negative or positive, the production trajectory in child speech appears to have notable differences depending on the syntactic head. When the instances are headed by *have*, children increase their production between 18-36 months, a pattern that is present in both negative and positive constructions; yet children's production ratio consistently stays below parents' level across the developmental path. For utterances headed by possessive pronouns, on the other hand, children's production increases rapidly between 18-24 months and stays above parents' production level as early as 24 months of age.

```{r possession, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=6.5, fig.height=5, set.cap.width=T, num.cols.cap=1, fig.cap="Cumulative ratios for the production of possession at the sentence level for children between 12 to 72 months of age, and their parents. The y-axes are scaled differently for the panels to accommodate differences in production ratios."}

subset(possession_data, Which=='cumulative ratio') %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Production, color = Production)) +
  geom_line(aes(linetype=Production), alpha = 1) +
#  scale_linetype_manual(values=c("dotted", 'solid', 'dotted', 'solid')) +
  geom_point(aes(color = Production, shape = Production), size = 1.5) +
#  scale_shape_manual(values = c(3, 16, 3, 16)) +
  scale_color_manual(values = c("darkred", "darkgreen", "steelblue",  "mediumpurple4")) +
  facet_wrap(Head ~ Polarity, scales = "free_y") +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") + 
  guides(color = guide_legend(nrow = 2)) + 
  theme(legend.title = element_blank())

```

For discourse-level possessives, we selected antecedents of the negative response particle *no* which themselves had structures similar to the negative and positive constructions of possession at the sentence level (Table \@ref(tab:dispossess)). Based on Figure \@ref(fig:possessiondiscourse), the overall patterns indicate that children's production of possession at the discourse level increases gradually within the age range of 18 to 36 months; and their production ratio is mostly higher than that of parents.

| Antecedent                               | Utterance                        |
|------------------------------------------|----------------------------------|
| Parent: ***not*** *yours*                | Child: ***no*** *it's mine mine* |
| Parent: *do you still have that picture* | Child: ***no***                  |
| Child: ***not*** *hers*                  | Parent: ***no no***              |
| Child: *mommy has it*                    | Parent: ***no*** *I do**n't***   |

: (#tab:dispossess) Examples of discourse-level possession (negative) in children's and parents' speech.

```{r possessiondiscourse, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.cap="Cumulative ratios for the production of possession at the discourse level for children between 12 to 72 months of age, and their parents.",warning=FALSE}

subset(discourse_possession_data_plot, Measure=='cumulative ratio') %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Role, color = Role)) +
  geom_line(aes(linetype=Role), alpha = 1) +
  scale_linetype_manual(values=c('solid', 'dotted')) +
  geom_point(aes(color = Role, shape = Role), size = 1.5) +
  scale_shape_manual(values = c(16, 3)) +
  scale_color_manual(values = c("darkblue", "peru")) + 
#  facet_grid( ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio")

```

### All Constructions

In Figure \@ref(fig:allneg), we present the cumulative ratios of all our negative constructions at the sentence level for children (left panel) and parents (right panel). Parents produce most negative constructions at relatively constant rates across most of the age bins. Notable exceptions are labeling, epistemic, and prohibitions between 12-36 months. Parents increase their production of labeling and epistemic constructions in this period and their productions become more stable after 36 months. This obervation aligns with labeling and epistemic negation in child speech, which suggests that the production patterns in child speech for these two functions may be more influenced by interactions with parents, and vice versa as children grow to be more conversant and interactive. On the other hand, prohibition starts as one of the most frequent constructions at 12-18 months of age and ends up as the least frequently used construction after around 30 months. One reason for this trend may be that when children are younger, they need more guidance on their actions and parents provide such guidance with imperatives and commands, often in the form of prohibiting children from particular actions. As children grow older, verbal prohibitions become less necessary.

Children start producing most of the constructions in the 12-18 age range. Two functions, non-existence and prohibition, seem to emerge at later ages than others. With non-existence, even though there are examples between 18-24 months, the cumulative production ratios are fluctuating and discontinuous, instead of demonstrating a slow and steady increase as seen in most of the other functions. As described in previous sections, the data for non-existence before 25 months based on our corpus search is relatively sparse; it is possible that with larger corpora a clearer pattern may arise. With prohibition, we see a relatively smooth pattern. Children begin to produce them more regularly between 24-30 months and its rate of production stays below parents' levels. One explanation for this pattern is that parent-child interactions do not provide many contexts for children to prohibit parents. Overall by 36 months of age, children's production of most constructions starts to become stable.

```{r alldata, include=FALSE}
all <- rbind(emotion_data, epistemic_data, prohibition_data, inability_data, learning_data, existence_data, possession_data)
together <- subset(all, Which == 'cumulative ratio')
child_all <- subset(together, Role %in% c('Target_Child', 'Child'))
parent_all <- subset(together, Role %in% c('Parent'))

child_neg_together <- aggregate(Freq ~ Age + Function, data = subset(child_all, Polarity == 'negative'), sum)
child_neg_together$Role <- rep('Child', nrow(child_neg_together))
child_neg_together$Total_ratio <- rep(0, nrow(child_neg_together))

for (i in 1:nrow(child_neg_together)){
  age = as.numeric(as.character(child_neg_together$Age[i]))
  data = subset(child_descriptive, Age <= age)
  child_neg_together$Total_ratio[i] = child_neg_together$Freq[i] / sum(data$N_utterance)

  }

parent_neg_together <- aggregate(Freq ~ Age + Function, data = subset(parent_all, Polarity == 'negative'), sum)
parent_neg_together$Role <- rep('Parent', nrow(parent_neg_together))
parent_neg_together$Total_ratio <- rep(0, nrow(parent_neg_together))

for (i in 1:nrow(parent_neg_together)){
  age = as.numeric(as.character(parent_neg_together$Age[i]))
  data = subset(parent_descriptive, Age <= age)
  parent_neg_together$Total_ratio[i] = parent_neg_together$Freq[i] / sum(data$N_utterance)

  }


neg_together_final <- rbind(child_neg_together, parent_neg_together)

child_pos_together <- aggregate(Freq ~ Age + Function, data = subset(child_all, Polarity == 'positive'), sum)
child_pos_together$Role <- rep('Child', nrow(child_pos_together))
child_pos_together$Total_ratio <- rep(0, nrow(child_pos_together))

for (i in 1:nrow(child_pos_together)){
  age = as.numeric(as.character(child_pos_together$Age[i]))
  data = subset(child_descriptive, Age <= age)
  child_pos_together$Total_ratio[i] = child_pos_together$Freq[i] / sum(data$N_utterance)

  }

parent_pos_together <- aggregate(Freq ~ Age + Function, data = subset(parent_all, Polarity == 'positive'), sum)
parent_pos_together$Role <- rep('Parent', nrow(parent_pos_together))
parent_pos_together$Total_ratio <- rep(0, nrow(parent_pos_together))

for (i in 1:nrow(parent_pos_together)){
  age = as.numeric(as.character(parent_pos_together$Age[i]))
  data = subset(parent_descriptive, Age <= age)
  parent_pos_together$Total_ratio[i] = parent_pos_together$Freq[i] / sum(data$N_utterance)

  }

pos_together_final <- rbind(child_pos_together, parent_pos_together)
```

```{r allneg, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=5, set.cap.width=T, num.cols.cap=1, fig.cap="Cumulative ratios for all negative constructions at the sentence level.", warning=FALSE}

neg_together_final %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Function, color = Function)) +
  geom_line(aes(linetype=Function), alpha = 1) +
  scale_color_brewer(palette = "Dark2") +
  geom_point(aes(color = Function, shape = Function), size = 1.5) +
  facet_wrap( ~ Role, scales = 'free_y') +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") + 
  guides(linetype = guide_legend(nrow = 2)) 

```

Figure \@ref(fig:allpos) shows the cumulative ratios of all positive counterparts to our negative constructions at the sentence level for children (left panel) and parents (right panel). The production of the positive instances in parent speech for almost all constructions is stable. Notable exceptions are labeling and positive counterparts to prohibitions (positive imperatives) between 12-30 months. Similar to negative instances of labeling, positive instances increase in frequency between 12-30 months but remain constant after. Positive imperatives are produced much more frequently between 12-36 months, but their production decreases later. This pattern mirrors what we see in Figure \@ref(fig:allneg) with (negative) prohibitions, that the usage of imperatives in interactions potentially becomes less necessary as children grow older.

Children start producing all positive counterparts to our negative constructions between the age range of 12-18 months. By 36 months, almost all positive constructions are being produced at a relatively constant rate close to parents' levels. Another noteworthy pattern is the relative high frequency of positive counterparts to prohibitions in the 12-24 months age period. In contrast to the production of (negative) prohibitions, positive imperatives are produced with high frequency even before 24 months of age. In other words, even though children do not frequently prohibit parents, they seem to be frequently ordering or commanding parents to do things for them; a finding that would not surprise many parents or caregivers!

```{r allpos, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=5, set.cap.width=T, num.cols.cap=1, fig.cap="Cumulative ratios for the positive counpterparts to all negative constructions at the sentence level.", warning=FALSE}

pos_together_final %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Function, color = Function)) +
  geom_line(aes(linetype=Function), alpha = 1) +
  scale_color_brewer(palette = "Dark2") +
  geom_point(aes(color = Function, shape = Function), size = 1.5) +
  facet_wrap( ~ Role, scales = 'free_y') +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") + 
  guides(linetype = guide_legend(nrow = 2)) 

```

Summarizing children's production patterns at the sentence level, whether the utterance is negative or positive, there are considerable similarities in terms of the developmental trajectories across the different communicative functions. Though there are discrepancies for cases of prohibition, overall the development of most negative constructions and their positive counterparts emerges between 12-18 months; their production increases substantially from 18 to 36 months, then starts to become stable (increase very slowly) after 36 months of age.

```{r alldiscoursedata, include=FALSE}

discourse_all <- rbind(discourse_emotion_data, discourse_epistemic_data, discourse_prohibition_data, discourse_inability_data, discourse_learning_data, discourse_existence_data, discourse_possession_data)
discourse_together <- subset(discourse_all, Which == 'cumulative ratio'&Polarity=='negative')
discourse_child_all <- subset(discourse_together, Role %in% c('Target_Child', 'Child'))
discourse_parent_all <- subset(discourse_together, Role %in% c('Parent'))

discourse_child_together <- aggregate(Freq ~ Age + Function, data = discourse_child_all, sum)
discourse_child_together$Role <- rep('Child', nrow(discourse_child_together))
discourse_child_together$Total_ratio <- rep(0, nrow(discourse_child_together))

for (i in 1:nrow(discourse_child_together)){
  age = as.numeric(as.character(discourse_child_together$Age[i]))
  data = subset(child_descriptive, Age <= age)
  discourse_child_together$Total_ratio[i] = discourse_child_together$Freq[i] / sum(data$N_utterance)

  }

discourse_parent_together <- aggregate(Freq ~ Age + Function, data = discourse_parent_all, sum)
discourse_parent_together$Role <- rep('Parent', nrow(discourse_parent_together))
discourse_parent_together$Total_ratio <- rep(0, nrow(discourse_parent_together))

for (i in 1:nrow(discourse_parent_together)){
  age = as.numeric(as.character(discourse_parent_together$Age[i]))
  data = subset(parent_descriptive, Age <= age)
  discourse_parent_together$Total_ratio[i] = discourse_parent_together$Freq[i] / sum(data$N_utterance)

  }

discourse_together_final <- rbind(discourse_child_together, discourse_parent_together)

```

Finally, Figure \@ref(fig:alldiscourse) illustrates the cumulative ratios of all negative responses at the discourse level. Observations for parents' speech on the right again demonstrates a relatively constant rate of production after 36 months. Before 36 months, however, most constructions show a gradual increase with the exception of prohibition. Parents start with more frequent "no!"-responses to imperatives produced by children, but the frequency of these negative responses drops to a relatively low and stable level after children are 36 months of age; this pattern again corresponds to parents' production of subjectless imperatives in Figure \@ref(fig:allneg) and Figure \@ref(fig:allpos).

```{r alldiscourse, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=5, set.cap.width=T, num.cols.cap=1, fig.cap="Cumulative ratios for all negative constructions at the discourse level.", warning=FALSE}

discourse_together_final %>% 
  ggplot(aes(as.numeric(as.character(Age)), Total_ratio, group = Function, color = Function)) +
  geom_line(aes(linetype=Function), alpha = 1) +
  scale_color_brewer(palette = "Dark2") +
  geom_point(aes(color = Function, shape = Function), size = 1.5) +
  facet_wrap( ~ Role, scales = 'free_y') +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("production ratio") + 
  guides(linetype = guide_legend(nrow = 2))
```

Looking at children's negative responses on the left panel, we see that production begins for most functions around 18 months of age and by 36 months children are also producing negative responses at a relatively constant rate; these patterns draw similarity to those at the sentence level. <!--or even higher than parents' production levels. Compared to the sentence level, the most frequent communicative functions expressed by these discourse interactions are still rejection, epistemic, and labeling.--> The comparability of the developmental trajectories for different communicative functions at the discourse level shown in Figure \@ref(fig:alldiscourse) is strengthened further with the logistic growth curves. As demonstrated in Table \@ref(tab:growthdiscourse), the asymptotic levels across functions are estimated to be similar to each other; same holds for the maximum growth rate and the age of one-half production growth. Furthermore, the results of the growth curve models at the discourse level are also comparable to those at the sentence level presented in Table \@ref(tab:growthsyntax), indicating overall similar production patterns between the two levels.

## Statistical Modeling

In order to model the overall production trajectories of different negative constructions, we adopted developmental growth curve analysis [@kemper1995complexity; @van2009parental]. In particular, we used Gompertz curves [@gompertz1825; @panik2014growth; @boedeker2021nonlinear] to model the cumulative ratio $R_{c,t}$ for a construction $c$ at a monthly age bin $t$ using three parameters: the upper asymptote $a$, the growth rate $b$, and the inflection point $i$ ($e$ is Euler's number): 

$R_{c, t} = a \times e^{-e^{(-b \times (t - i))}}$

The basic assumptions behind this model are the following: First, there is an overall proportion or probability of children producing a particular construction in childhood. Second, this proportion or ratio is not constant across their development. It starts at zero (children don't produce the construction) and increases until it reaches the overall proportion (i.e. upper threshold) at a certain age. Third, this growth from no production to the upper threshold is non-linear. The ratio increases rapidly at first until it reaches peak growth of $b$ at time interval $i$, then the growth slows down until the ratio for that construction reaches the stable maximum threshold estimated by the upper asymptote $a$. The rapid growth period and the slowdown period before and after the inflection point $i$ can be asymmetrical.  

We used the statistical package $brms$ to implement our Gompertz growth curve analysis. We fit separate growth curves to each negative and positive construction. We used uniform priors with appropriate bounds for the three parameters of our Gompertz models. Since we did not have enough data to capture the developmental paths of individual children, the logistic curves did not have random effects and were fit at the population level for each communicative function. Each model ran 4 chains with 4000 iterations each and 2000 of them as warm-up. 95% credible intervals for each parameter were derived from their respective posterior distribution.

$a$ $\sim$ $Uniform(0, 10)$

$b$ $\sim$ $Uniform(0, 3)$

$i$ $\sim$ $Uniform(12, 72)$

```{r NegConstructionCurveModels, include=FALSE}
neg_together_final_model <-
  neg_together_final %>% 
  filter(Role=="Child") %>%
  mutate(ppt=Total_ratio*1000)

neg_together_final_model$Age <- as.numeric(neg_together_final_model$Age)

epistemic_model_data <- neg_together_final_model %>% filter(Function=="Epistemic")

epistemic_neg_nonlinear <- brm(
  bf(ppt  ~ upperAsymptote * exp(-exp(-growthRate*(Age-inflection))),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     inflection ~ 1,
     nl = TRUE),
  data = epistemic_model_data,
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 3), nlpar = "growthRate", lb = 0, ub = 3),
    prior(uniform(12, 72), nlpar = "inflection", lb = 12, ub = 72)
  ),
  file = "statsmodels/epistemic_neg_nonlinear",
  iter = 4000)

inability_model_data <- neg_together_final_model %>% filter(Function=="Inability")

inability_neg_nonlinear <- brm(
  bf(ppt  ~ upperAsymptote * exp(-exp(-growthRate*(Age-inflection))),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     inflection ~ 1,
     nl = TRUE),
  data = inability_model_data,
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 3), nlpar = "growthRate", lb = 0, ub = 3),
    prior(uniform(12, 72), nlpar = "inflection", lb = 12, ub = 72)
  ),
  file = "statsmodels/inability_neg_nonlinear",
  iter = 4000)

labeling_model_data <- neg_together_final_model %>% filter(Function=="Labeling")

labeling_neg_nonlinear <- brm(
  bf(ppt  ~ upperAsymptote * exp(-exp(-growthRate*(Age-inflection))),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     inflection ~ 1,
     nl = TRUE),
  data = labeling_model_data,
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 3), nlpar = "growthRate", lb = 0, ub = 3),
    prior(uniform(12, 72), nlpar = "inflection", lb = 12, ub = 72)
  ),
  file = "statsmodels/labeling_neg_nonlinear",
  iter = 4000)

nonexist_model_data <- neg_together_final_model %>% filter(Function=="Non-existence")

nonexist_neg_nonlinear <- brm(
  bf(ppt  ~ upperAsymptote * exp(-exp(-growthRate*(Age-inflection))),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     inflection ~ 1,
     nl = TRUE),
  data = nonexist_model_data,
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 3), nlpar = "growthRate", lb = 0, ub = 3),
    prior(uniform(12, 72), nlpar = "inflection", lb = 12, ub = 72)
  ),
  file = "statsmodels/nonexist_neg_nonlinear",
  iter = 4000)

possession_model_data <- neg_together_final_model %>% filter(Function=="Possession")

possession_neg_nonlinear <- brm(
  bf(ppt  ~ upperAsymptote * exp(-exp(-growthRate*(Age-inflection))),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     inflection ~ 1,
     nl = TRUE),
  data = possession_model_data,
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 3), nlpar = "growthRate", lb = 0, ub = 3),
    prior(uniform(12, 72), nlpar = "inflection", lb = 12, ub = 72)
  ),
  file = "statsmodels/possession_neg_nonlinear",
  iter = 4000)

prohibition_model_data <- neg_together_final_model %>% filter(Function=="Prohibition")

prohibition_neg_nonlinear <- brm(
  bf(ppt  ~ upperAsymptote * exp(-exp(-growthRate*(Age-inflection))),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     inflection ~ 1,
     nl = TRUE),
  data = prohibition_model_data,
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 3), nlpar = "growthRate", lb = 0, ub = 3),
    prior(uniform(12, 72), nlpar = "inflection", lb = 12, ub = 72)
  ),
  file = "statsmodels/prohibition_neg_nonlinear",
  iter = 4000)

rejection_model_data <- neg_together_final_model %>% filter(Function=="Rejection")

rejection_neg_nonlinear <- brm(
  bf(ppt  ~ upperAsymptote * exp(-exp(-growthRate*(Age-inflection))),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     inflection ~ 1,
     nl = TRUE),
  data = rejection_model_data,
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 3), nlpar = "growthRate", lb = 0, ub = 3),
    prior(uniform(12, 72), nlpar = "inflection", lb = 12, ub = 72)
  ),
  file = "statsmodels/rejection_neg_nonlinear",
  iter = 4000)
```

```{r PosConstructionCurveModels, include=FALSE}
pos_together_final_model <-
  pos_together_final %>% 
  filter(Role=="Child") %>%
  mutate(ppt=Total_ratio*1000)

pos_together_final_model$Age <- as.numeric(pos_together_final_model$Age)

epistemic_model_posdata <- pos_together_final_model %>% filter(Function=="Epistemic")

epistemic_pos_nonlinear <- brm(
  bf(ppt  ~ upperAsymptote * exp(-exp(-growthRate*(Age-inflection))),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     inflection ~ 1,
     nl = TRUE),
  data = epistemic_model_posdata,
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 3), nlpar = "growthRate", lb = 0, ub = 3),
    prior(uniform(12, 72), nlpar = "inflection", lb = 12, ub = 72)
  ),
  file = "statsmodels/epistemic_pos_nonlinear",
  iter = 4000)

inability_model_posdata <- pos_together_final_model %>% filter(Function=="Inability")

inability_pos_nonlinear <- brm(
  bf(ppt  ~ upperAsymptote * exp(-exp(-growthRate*(Age-inflection))),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     inflection ~ 1,
     nl = TRUE),
  data = inability_model_posdata,
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 3), nlpar = "growthRate", lb = 0, ub = 3),
    prior(uniform(12, 72), nlpar = "inflection", lb = 12, ub = 72)
  ),
  file = "statsmodels/inability_pos_nonlinear",
  iter = 4000)

labeling_model_posdata <- pos_together_final_model %>% filter(Function=="Labeling")

labeling_pos_nonlinear <- brm(
  bf(ppt  ~ upperAsymptote * exp(-exp(-growthRate*(Age-inflection))),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     inflection ~ 1,
     nl = TRUE),
  data = labeling_model_posdata,
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 3), nlpar = "growthRate", lb = 0, ub = 3),
    prior(uniform(12, 72), nlpar = "inflection", lb = 12, ub = 72)
  ),
  file = "statsmodels/labeling_pos_nonlinear",
  iter = 4000)

nonexist_model_posdata <- pos_together_final_model %>% filter(Function=="Non-existence")

nonexist_pos_nonlinear <- brm(
  bf(ppt  ~ upperAsymptote * exp(-exp(-growthRate*(Age-inflection))),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     inflection ~ 1,
     nl = TRUE),
  data = nonexist_model_posdata,
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 3), nlpar = "growthRate", lb = 0, ub = 3),
    prior(uniform(12, 72), nlpar = "inflection", lb = 12, ub = 72)
  ),
  file = "statsmodels/nonexist_pos_nonlinear",
  iter = 4000)

possession_model_posdata <- pos_together_final_model %>% filter(Function=="Possession")

possession_pos_nonlinear <- brm(
  bf(ppt  ~ upperAsymptote * exp(-exp(-growthRate*(Age-inflection))),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     inflection ~ 1,
     nl = TRUE),
  data = possession_model_posdata,
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 3), nlpar = "growthRate", lb = 0, ub = 3),
    prior(uniform(12, 72), nlpar = "inflection", lb = 12, ub = 72)
  ),
  file = "statsmodels/possession_pos_nonlinear",
  iter = 4000)

prohibition_model_posdata <- pos_together_final_model %>% filter(Function=="Prohibition")

prohibition_pos_nonlinear <- brm(
  bf(ppt  ~ upperAsymptote * exp(-exp(-growthRate*(Age-inflection))),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     inflection ~ 1,
     nl = TRUE),
  data = prohibition_model_posdata,
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 3), nlpar = "growthRate", lb = 0, ub = 3),
    prior(uniform(12, 72), nlpar = "inflection", lb = 12, ub = 72)
  ),
  file = "statsmodels/prohibition_pos_nonlinear",
  iter = 4000)

rejection_model_posdata <- pos_together_final_model %>% filter(Function=="Rejection")

rejection_pos_nonlinear <- brm(
  bf(ppt  ~ upperAsymptote * exp(-exp(-growthRate*(Age-inflection))),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     inflection ~ 1,
     nl = TRUE),
  data = rejection_model_posdata,
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 3), nlpar = "growthRate", lb = 0, ub = 3),
    prior(uniform(12, 72), nlpar = "inflection", lb = 12, ub = 72)
  ),
  file = "statsmodels/rejection_pos_nonlinear",
  iter = 4000)
```

```{r DiscourseCurveModels, include=FALSE}
discourse_together_final <-
  discourse_together_final %>% 
  filter(Role=="Child") %>%
  mutate(ppt=Total_ratio*1000)

discourse_together_final$Age <- as.numeric(discourse_together_final$Age)

epistemic_model_discoursedata <- discourse_together_final %>% filter(Function=="Epistemic")

epistemic_dis_nonlinear <- brm(
  bf(ppt  ~ upperAsymptote * exp(-exp(-growthRate*(Age-inflection))),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     inflection ~ 1,
     nl = TRUE),
  data = epistemic_model_discoursedata,
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 3), nlpar = "growthRate", lb = 0, ub = 3),
    prior(uniform(12, 72), nlpar = "inflection", lb = 12, ub = 72)
  ),
  file = "statsmodels/epistemic_dis_nonlinear",
  iter = 4000)

inability_model_discoursedata <- discourse_together_final %>% filter(Function=="Inability")

inability_dis_nonlinear <- brm(
  bf(ppt  ~ upperAsymptote * exp(-exp(-growthRate*(Age-inflection))),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     inflection ~ 1,
     nl = TRUE),
  data = inability_model_discoursedata,
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 3), nlpar = "growthRate", lb = 0, ub = 3),
    prior(uniform(12, 72), nlpar = "inflection", lb = 12, ub = 72)
  ),
  file = "statsmodels/inability_dis_nonlinear",
  iter = 4000)

labeling_model_discoursedata <- discourse_together_final %>% filter(Function=="Labeling")

labeling_dis_nonlinear <- brm(
  bf(ppt  ~ upperAsymptote * exp(-exp(-growthRate*(Age-inflection))),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     inflection ~ 1,
     nl = TRUE),
  data = labeling_model_discoursedata,
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 3), nlpar = "growthRate", lb = 0, ub = 3),
    prior(uniform(12, 72), nlpar = "inflection", lb = 12, ub = 72)
  ),
  file = "statsmodels/labeling_dis_nonlinear",
  iter = 4000)

nonexist_model_discoursedata <- discourse_together_final %>% filter(Function=="Non-existence")

nonexist_dis_nonlinear <- brm(
  bf(ppt  ~ upperAsymptote * exp(-exp(-growthRate*(Age-inflection))),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     inflection ~ 1,
     nl = TRUE),
  data = nonexist_model_discoursedata,
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 3), nlpar = "growthRate", lb = 0, ub = 3),
    prior(uniform(12, 72), nlpar = "inflection", lb = 12, ub = 72)
  ),
  file = "statsmodels/nonexist_dis_nonlinear",
  iter = 4000)

nonexist_model_data <- discourse_together_final %>% filter(Function=="Non-existence")

nonexist_neg_nonlinear <- brm(
  bf(ppt  ~ upperAsymptote * exp(-exp(-growthRate*(Age-inflection))),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     inflection ~ 1,
     nl = TRUE),
  data = nonexist_model_data,
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 3), nlpar = "growthRate", lb = 0, ub = 3),
    prior(uniform(12, 72), nlpar = "inflection", lb = 12, ub = 72)
  ),
  file = "statsmodels/nonexist_neg_nonlinear",
  iter = 4000)

nonexist_model_data <- discourse_together_final %>% filter(Function=="Non-existence")

nonexist_neg_nonlinear <- brm(
  bf(ppt  ~ upperAsymptote * exp(-exp(-growthRate*(Age-inflection))),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     inflection ~ 1,
     nl = TRUE),
  data = nonexist_model_data,
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 3), nlpar = "growthRate", lb = 0, ub = 3),
    prior(uniform(12, 72), nlpar = "inflection", lb = 12, ub = 72)
  ),
  file = "statsmodels/nonexist_neg_nonlinear",
  iter = 4000)

possession_model_discoursedata <- discourse_together_final %>% filter(Function=="Possession")

possession_dis_nonlinear <- brm(
  bf(ppt  ~ upperAsymptote * exp(-exp(-growthRate*(Age-inflection))),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     inflection ~ 1,
     nl = TRUE),
  data = possession_model_discoursedata,
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 3), nlpar = "growthRate", lb = 0, ub = 3),
    prior(uniform(12, 72), nlpar = "inflection", lb = 12, ub = 72)
  ),
  file = "statsmodels/possession_dis_nonlinear",
  iter = 4000)

prohibition_model_discoursedata <- discourse_together_final %>% filter(Function=="Prohibition")

prohibition_dis_nonlinear <- brm(
  bf(ppt  ~ upperAsymptote * exp(-exp(-growthRate*(Age-inflection))),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     inflection ~ 1,
     nl = TRUE),
  data = prohibition_model_discoursedata,
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 3), nlpar = "growthRate", lb = 0, ub = 3),
    prior(uniform(12, 72), nlpar = "inflection", lb = 12, ub = 72)
  ),
  file = "statsmodels/prohibition_dis_nonlinear",
  iter = 4000)

rejection_model_discoursedata <- discourse_together_final %>% filter(Function=="Rejection")

rejection_dis_nonlinear <- brm(
  bf(ppt  ~ upperAsymptote * exp(-exp(-growthRate*(Age-inflection))),
     upperAsymptote ~ 1,
     growthRate ~ 1,
     inflection ~ 1,
     nl = TRUE),
  data = rejection_model_discoursedata,
  prior = c(
    prior(uniform(0, 10), nlpar = "upperAsymptote", lb = 0, ub = 10),
    prior(uniform(0, 3), nlpar = "growthRate", lb = 0, ub = 3),
    prior(uniform(12, 72), nlpar = "inflection", lb = 12, ub = 72)
  ),
  file = "statsmodels/rejection_dis_nonlinear",
  iter = 4000)
```

```{r sentencePredictions, include=FALSE, eval=FALSE}
# Negative Sentence Predictions
rejection_neg_predictions <- as.data.frame(ggpredict(rejection_neg_nonlinear))
rejection_neg_predictions$construction <- "rejection"
rejection_neg_predictions$valence <- "negative"
rejection_neg_predictions$level <- "sentence"

labeling_neg_predictions <- as.data.frame(ggpredict(labeling_neg_nonlinear))
labeling_neg_predictions$construction <- "labeling"
labeling_neg_predictions$valence <- "negative"
labeling_neg_predictions$level <- "sentence"

nonexist_neg_predictions <- as.data.frame(ggpredict(nonexist_neg_nonlinear))
nonexist_neg_predictions$construction <- "nonexistence"
nonexist_neg_predictions$valence <- "negative"
nonexist_neg_predictions$level <- "sentence"

inability_neg_predictions <- as.data.frame(ggpredict(inability_neg_nonlinear))
inability_neg_predictions$construction <- "inability"
inability_neg_predictions$valence <- "negative"
inability_neg_predictions$level <- "sentence"

possession_neg_predictions <- as.data.frame(ggpredict(possession_neg_nonlinear))
possession_neg_predictions$construction <- "possession"
possession_neg_predictions$valence <- "negative"
possession_neg_predictions$level <- "sentence"

epistemic_neg_predictions <- as.data.frame(ggpredict(epistemic_neg_nonlinear))
epistemic_neg_predictions$construction <- "epistemic"
epistemic_neg_predictions$valence <- "negative"
epistemic_neg_predictions$level <- "sentence"

prohibition_neg_predictions <- as.data.frame(ggpredict(prohibition_neg_nonlinear))
prohibition_neg_predictions$construction <- "prohibition"
prohibition_neg_predictions$valence <- "negative"
prohibition_neg_predictions$level <- "sentence"

#Positive Sentence Predictions:

rejection_pos_predictions <- as.data.frame(ggpredict(rejection_pos_nonlinear))
rejection_pos_predictions$construction <- "rejection"
rejection_pos_predictions$valence <- "positive"
rejection_pos_predictions$level <- "sentence"

labeling_pos_predictions <- as.data.frame(ggpredict(labeling_pos_nonlinear))
labeling_pos_predictions$construction <- "labeling"
labeling_pos_predictions$valence <- "positive"
labeling_pos_predictions$level <- "sentence"

nonexist_pos_predictions <- as.data.frame(ggpredict(nonexist_pos_nonlinear))
nonexist_pos_predictions$construction <- "nonexistence"
nonexist_pos_predictions$valence <- "positive"
nonexist_pos_predictions$level <- "sentence"

inability_pos_predictions <- as.data.frame(ggpredict(inability_pos_nonlinear))
inability_pos_predictions$construction <- "inability"
inability_pos_predictions$valence <- "positive"
inability_pos_predictions$level <- "sentence"

possession_pos_predictions <- as.data.frame(ggpredict(possession_pos_nonlinear))
possession_pos_predictions$construction <- "possession"
possession_pos_predictions$valence <- "positive"
possession_pos_predictions$level <- "sentence"

epistemic_pos_predictions <- as.data.frame(ggpredict(epistemic_pos_nonlinear))
epistemic_pos_predictions$construction <- "epistemic"
epistemic_pos_predictions$valence <- "positive"
epistemic_pos_predictions$level <- "sentence"

prohibition_pos_predictions <- as.data.frame(ggpredict(prohibition_pos_nonlinear))
prohibition_pos_predictions$construction <- "prohibition"
prohibition_pos_predictions$valence <- "positive"
prohibition_pos_predictions$level <- "sentence"

# Negative Discourse Predictions

rejection_dis_predictions <- as.data.frame(ggpredict(rejection_dis_nonlinear))
rejection_dis_predictions$construction <- "rejection"
rejection_dis_predictions$valence <- "negative"
rejection_dis_predictions$level <- "discourse"

labeling_dis_predictions <- as.data.frame(ggpredict(labeling_dis_nonlinear))
labeling_dis_predictions$construction <- "labeling"
labeling_dis_predictions$valence <- "negative"
labeling_dis_predictions$level <- "discourse"

nonexist_dis_predictions <- as.data.frame(ggpredict(nonexist_dis_nonlinear))
nonexist_dis_predictions$construction <- "nonexistence"
nonexist_dis_predictions$valence <- "negative"
nonexist_dis_predictions$level <- "discourse"

inability_dis_predictions <- as.data.frame(ggpredict(inability_dis_nonlinear))
inability_dis_predictions$construction <- "inability"
inability_dis_predictions$valence <- "negative"
inability_dis_predictions$level <- "discourse"

possession_dis_predictions <- as.data.frame(ggpredict(possession_dis_nonlinear))
possession_dis_predictions$construction <- "possession"
possession_dis_predictions$valence <- "negative"
possession_dis_predictions$level <- "discourse"

epistemic_dis_predictions <- as.data.frame(ggpredict(epistemic_dis_nonlinear))
epistemic_dis_predictions$construction <- "epistemic"
epistemic_dis_predictions$valence <- "negative"
epistemic_dis_predictions$level <- "discourse"

prohibition_dis_predictions <- as.data.frame(ggpredict(prohibition_dis_nonlinear))
prohibition_dis_predictions$construction <- "prohibition"
prohibition_dis_predictions$valence <- "negative"
prohibition_dis_predictions$level <- "discourse"

predictions <- rbind(rejection_neg_predictions,
                              labeling_neg_predictions,
                              nonexist_neg_predictions,
                              inability_neg_predictions,
                              possession_neg_predictions,
                              epistemic_neg_predictions,
                              prohibition_neg_predictions,
                              rejection_pos_predictions,
                              labeling_pos_predictions,
                              nonexist_pos_predictions,
                              inability_pos_predictions,
                              possession_pos_predictions,
                              epistemic_pos_predictions,
                              prohibition_pos_predictions,
                              rejection_dis_predictions,
                              labeling_dis_predictions,
                              nonexist_dis_predictions,
                              inability_dis_predictions,
                              possession_dis_predictions,
                              epistemic_dis_predictions,
                              prohibition_dis_predictions
                              )

saveRDS(predictions, "statsmodels/predictions")
```

```{r sentencePredictionPlot, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=5, set.cap.width=T, num.cols.cap=1, fig.cap="Predicted Gompertz growth curves for sentence-level negative constructions. The x-axis is age in months, and the y-axis represents cumulative production ratio per thousand utterances."}
predictions <- readRDS("statsmodels/predictions")

predictions %>%
  filter(valence=="negative", level=="sentence") %>%
  ggplot(aes(Age.x, Age.predicted, color=construction)) +
  geom_line(aes(color=construction)) +
  geom_label_repel(aes(label=construction), data=filter(predictions, Age.x == 60, level=="sentence", valence=="negative")) +
  geom_ribbon(aes(ymin = Age.conf.low, ymax = Age.conf.high, fill = construction), alpha=0.3, linetype=0) +
  xlab("child age (months)") + ylab("Cumulative Production Ratio (Per Mille)")+
  theme_linedraw() + theme(legend.position="none")
```

First we look at the predictions of our models for sentence-level negation, which reflect children's productive capacities. Figure \@ref(fig:sentencePredictionPlot) presents the predicted growth curves for the seven sentence-level negative constructions in children's speech. While the curves differ substantially in their asymptote (the upper threshold for the production), they seem to have similar onset of production around 20 months of age or slightly earlier. Prohibitions do not show a proper curve likely due to the limited amount of available data. Figure \@ref(fig:valencePredictionPlot) compares the positive (green) and negative (red) growth curves for the same constructions. The negative curves always have lower asymptotes compared to the positive curves, which means positive constructions constitute larger proportions of children's speech compared to their negative counterparts. More importantly, the onsets for the negative curves are always at or after the positive curves. This suggests that on average, children produce negative constructions at or after they learn to produce their positive counterparts.

```{r valencePredictionPlot, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=8, fig.height=4, set.cap.width=T, num.cols.cap=1, fig.cap="Predicted Gompertz growth curves for sentence-level positive (green) vs. negative (red) constructions. The x-axis is age in months, and the y-axis represents cumulative production ratio per thousand utterances."}
predictions %>%
    filter(level=="sentence") %>%
  ggplot(aes(Age.x, Age.predicted, color=valence)) +
  geom_line(aes(color=valence)) +
  geom_ribbon(aes(ymin = Age.conf.low, ymax = Age.conf.high, color=valence), alpha=0.3, linetype=0) +
  facet_wrap(.~construction) +
  xlab("child age (months)") + ylab("Cumulative Production Ratio (Per Mille)")+
  theme_linedraw()
```

Figure \@ref(fig:negativePositiveInflectionPlot) shows model estimates for the inflection points for sentence-level positive and negative growth curves. The inflection point is the age at which children's production ratio for a construction has reached maximum growth and starts to slow down. The inflection points for most positive constructions are earlier than their negative counterpart. The two exceptions are epistemic and inability constructions, which have very frequent negative usage early on. The inflection points for most negative constructions fall between 26 and 32 months of age. This is the age range where many experimental studies report successful comprehension of negation in a wide range of tasks using different constructions [@feiman2017you; @austin2014young; @de1975some; @hummer1993origins; @reuter2018getting]. It is also the age range for many production studies that report the presence of different communicative functions discussed in our literature review earlier.

```{r aoaEstimatesPos, include=FALSE}
aoa_estimates_pos <- data.frame(
  functions = c("rejection", "possession", "labeling", "inability", "epistemic", "nonexistence", "prohibition"),
  mean = c(fixef(rejection_pos_nonlinear)[3,1], fixef(possession_pos_nonlinear)[3,1], fixef(labeling_pos_nonlinear)[3,1], fixef(inability_pos_nonlinear)[3,1], epistemic = fixef(epistemic_pos_nonlinear)[3,1], nonexistence = fixef(nonexist_pos_nonlinear)[3,1], prohibition = fixef(prohibition_pos_nonlinear)[3,1]),
  lower = c(fixef(rejection_pos_nonlinear)[3,3], fixef(possession_pos_nonlinear)[3,3], fixef(labeling_pos_nonlinear)[3,3], fixef(inability_pos_nonlinear)[3,3], epistemic = fixef(epistemic_pos_nonlinear)[3,3], nonexistence = fixef(nonexist_pos_nonlinear)[3,3], prohibition = fixef(prohibition_pos_nonlinear)[3,3]),
    upper = c(fixef(rejection_pos_nonlinear)[3,4], fixef(possession_pos_nonlinear)[3,4], fixef(labeling_pos_nonlinear)[3,4], fixef(inability_pos_nonlinear)[3,4], epistemic = fixef(epistemic_pos_nonlinear)[3,4], nonexistence = fixef(nonexist_pos_nonlinear)[3,4], prohibition = fixef(prohibition_pos_nonlinear)[3,4]),
  type = c(rep("discourse", 7))
)

aoa_estimates_pos$valence <- "positive"
```

```{r aoaEstimatesNeg, include=FALSE}
aoa_estimates_neg <- data.frame(
  functions = c("rejection", "possession", "labeling", "inability", "epistemic", "nonexistence", "prohibition"),
  mean = c(fixef(rejection_neg_nonlinear)[3,1], fixef(possession_neg_nonlinear)[3,1], fixef(labeling_neg_nonlinear)[3,1], fixef(inability_neg_nonlinear)[3,1], epistemic = fixef(epistemic_neg_nonlinear)[3,1], nonexistence = fixef(nonexist_neg_nonlinear)[3,1], prohibition = fixef(prohibition_neg_nonlinear)[3,1]),
  lower = c(fixef(rejection_neg_nonlinear)[3,3], fixef(possession_neg_nonlinear)[3,3], fixef(labeling_neg_nonlinear)[3,3], fixef(inability_neg_nonlinear)[3,3], epistemic = fixef(epistemic_neg_nonlinear)[3,3], nonexistence = fixef(nonexist_neg_nonlinear)[3,3], prohibition = fixef(prohibition_neg_nonlinear)[3,3]),
    upper = c(fixef(rejection_neg_nonlinear)[3,4], fixef(possession_neg_nonlinear)[3,4], fixef(labeling_neg_nonlinear)[3,4], fixef(inability_neg_nonlinear)[3,4], epistemic = fixef(epistemic_neg_nonlinear)[3,4], nonexistence = fixef(nonexist_neg_nonlinear)[3,4], prohibition = fixef(prohibition_neg_nonlinear)[3,4]),
  type = c(rep("sentence", 7))
)

aoa_estimates_neg$valence <- "negative"
```

```{r negativePositiveInflectionPlot, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=4, fig.cap="Estimates with 95 percent credible intervals for inflection points of the Gompertz growth curves for sentence-level positive (green) and negative constructions. The x-axis is age in months, and the y-axis represents seven negative constructions."}
aoa_estimates <- rbind(aoa_estimates_neg, aoa_estimates_pos)

aoa_estimates$functions <- factor(aoa_estimates$functions, levels=c("rejection", "inability", "possession", "epistemic", "labeling", "nonexistence",  "prohibition"))

aoa_estimates %>%
  ggplot(aes(mean, functions, color=valence)) +
  geom_point(position=position_dodge(0.4)) +
  geom_linerange(aes(xmin=lower, xmax=upper), position=position_dodge(0.4)) +
  scale_x_continuous(breaks = seq(12, 72, by = 2)) +
  theme_bw()
```

Next we consider the predictions of our models for discourse-level negation, which likely reflects their comprehension capacities. Figure \@ref(fig:discoursePredictionPlot) shows the predicted growth curves for children's discourse level negation. Similar to sentence-level growth curves, we see different asymptotes for each construction, suggesting that different constructions are used and negated at different proportions. However, similar to what we saw with sentence-level negation, these constructions seem to start recieving discourse level negative responses around 20 months of age and in some cases slightly earlier. The curve for the rejection construction leaves this possibility open that rejections are negated at the discourse level much earlier than the other constructions. However, we need much more data in the early age range of 12-30 months to be able to assess this hypothesis with more confidence.

```{r discoursePredictionPlot, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=6, fig.height=4, set.cap.width=T, num.cols.cap=1, fig.cap="Predicted Gompertz growth curves for discourse-level negative constructions. The x-axis is age in months, and the y-axis represents cumulative production ratio per thousand utterances."}
predictions %>%  
  filter(level=="discourse") %>%
  ggplot(aes(Age.x, Age.predicted, color=construction)) +
  geom_line(aes(color=construction)) +
  geom_label_repel(aes(label=construction), data=filter(predictions, level=="discourse", Age.x == 60)) +
  geom_ribbon(aes(ymin = Age.conf.low, ymax = Age.conf.high, fill = construction), 
              alpha=0.3, 
              linetype=0) +
  xlab("child age (months)") + ylab("Cumulative Production Ratio (Per Mille)")+
  theme_linedraw() + theme(legend.position="none")
```

Figure \@ref(fig:sentenceDiscoursePredictionPlot) compares the growth curves for discourse-level negative responses to each construction with the growth curves for the sentence-level production of that construction. Across all constructions, their discourse-level curves show lower asymptotes than sentence-level curves. At the discourse-level, almost all constructions show similar onset of production around 20-months or slightly earlier. For episetmic and inability constructions, the sentence level productions seem to appear slightly earlier than discourse level productions. For rejections, on the other hand, discourse-level prodution of negation seems to start slightly earlier. However, for more accurate estimates we need denser corpora in the 12-30 months age range.

```{r sentenceDiscoursePredictionPlot, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=8, fig.height=4, set.cap.width=T, fig.cap="Predicted Gompertz growth curves for children's sentence-level (green) vs discourse-level (red) negation. The x-axis is age in months, and the y-axis represents cumulative production ratio per thousand utterances."}
predictions %>%
    filter(valence=="negative") %>%
  ggplot(aes(Age.x, Age.predicted, color=valence)) +
  geom_line(aes(color=level)) +
  geom_ribbon(aes(ymin = Age.conf.low, ymax = Age.conf.high, color=level), alpha=0.3, linetype=0) +
  facet_wrap(.~construction) +
  xlab("child age (months)") + ylab("Cumulative Production Ratio (Per Mille)")+
  theme_linedraw()
```

Finally, Figure \@ref(fig:sentenceDiscourseInflectionPlot) shows the model estimates for the inflection points of the discourse-level (red) and sentence-level (green) negative growth curves. Overall, discourse-level curves reach their maximum growth earlier than sentence-level curves. For most discourse-level curves, the inflection point is around 24 months of age. Prohibition and non-existence constructions show more uncertain estimates likely due to the limited amount of data available across age bins.

```{r inflectionDiscourseEstimates, include=FALSE}
aoa_dis_estimates <- data.frame(
  functions = c("rejection", "possession", "labeling", "inability", "epistemic", "nonexistence", "prohibition"),
  mean = c(fixef(rejection_dis_nonlinear)[3,1], fixef(possession_dis_nonlinear)[3,1], fixef(labeling_dis_nonlinear)[3,1], fixef(inability_dis_nonlinear)[3,1], epistemic = fixef(epistemic_dis_nonlinear)[3,1], nonexistence = fixef(nonexist_dis_nonlinear)[3,1], prohibition = fixef(prohibition_dis_nonlinear)[3,1]),
  lower = c(fixef(rejection_dis_nonlinear)[3,3], fixef(possession_dis_nonlinear)[3,3], fixef(labeling_dis_nonlinear)[3,3], fixef(inability_dis_nonlinear)[3,3], epistemic = fixef(epistemic_dis_nonlinear)[3,3], nonexistence = fixef(nonexist_dis_nonlinear)[3,3], prohibition = fixef(prohibition_dis_nonlinear)[3,3]),
    upper = c(fixef(rejection_dis_nonlinear)[3,4], fixef(possession_dis_nonlinear)[3,4], fixef(labeling_dis_nonlinear)[3,4], fixef(inability_dis_nonlinear)[3,4], epistemic = fixef(epistemic_dis_nonlinear)[3,4], nonexistence = fixef(nonexist_dis_nonlinear)[3,4], prohibition = fixef(prohibition_dis_nonlinear)[3,4]),
    type = c(rep("discourse", 7))
)
```

```{r sentenceDiscourseInflection, include=FALSE}
aoa_all <- rbind(select(aoa_estimates_neg, -valence), aoa_dis_estimates)

aoa_all$functions <- factor(aoa_estimates$functions, levels=c("rejection", "inability", "possession", "epistemic", "labeling", "nonexistence",  "prohibition"))
```

```{r sentenceDiscourseInflectionPlot, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=6, fig.height=4, fig.cap="Estimates with 95 percent credible intervals for inflection points of the Gompertz growth curves for discourse-level (red) and sentence-level (green) negative constructions. The x-axis is age in months, and the y-axis represents seven negative constructions."}
aoa_all %>%
  ggplot(aes(mean, functions, color=type)) +
  geom_point(position=position_dodge(0.4)) +
  geom_linerange(aes(xmin=lower, xmax=upper), position=position_dodge(0.4)) +
  scale_x_continuous(breaks = seq(12, 72, by = 2)) +
  theme_bw() +
  xlab("child age (months)") + 
  ylab("")
```

# Conclusion

Natural language negation is abstract and context-general. It can be applied to a wide verity of concepts to communicate negation in many specific and potentially novel contexts. There are two overarching hypotheses regarding the development of this ability in children. First, some researchers have suggested that it is the result of abstraction over concrete communicative contexts and that it develops in fixed and logically defined stages. For example, it is hypothesized that children start with negating their internal desires before external observations or facts. The data to support stage-wise hypotheses of negation development come from children's linguistic productions, especially the specific age at which they produce general purpose discourse negation (e.g. *no*) as well as specific negative constructions that carry those context-specific communicative functions. However, there has been no consensus among researchers with respect to the exact timing or the order of these stages. Some researchers, on the other hand, have suggested that there may be no fixed order across children and that children's comprehension and production of negation may vary depending on their early environment [@de1979form; @nordmeyer2018individual]. Second, some researchers have suggested that negation emerges as an abstract and context-general concept from the start. In the strongest version of this hypothesis, abstract logical concepts such as negation, conjunction, and disjunction are innate [@crain2012emergence; @Crain_2008]. Under this hypothesis, all children need to do is to map the concept of negation to the morphemes that conventionally mark them in their native languages. Once this is done they can use the full combinatorial capacity of abstract context-general negation.

In this study, we used the largest available collection of English child language corpora to examine the production trajectories of seven negative constructions that tend to convey communicative functions previously discussed in the literature. We used growth curves to model the emergence and development of these constructions in children's linguistic productions between one and six years of age. As a proxy for their comprehension, we also conducted the same analyses with parents' constructions that children responded to with discourse level negation (*no*). Overall, we did not find strong evidence for ordered stage-wise development of negative communicative functions. Both sentence-level and discourse-level negation as proxies for production and comprehension of negation found that almost all communicative functions have their onset around the 18-22 months window. The comparison of negative and positive curves showed that for some constructions, the production of the negative construction emerges after the positive counterpart. In other cases they emerge around the same time.

While our results do not support a fixed-order stage-wise development of negation from concrete communicative functions, they leave open three possibilities. First, our results are compatible with the possibility that negation emerges as an abstract (possibly innate) concept available to the child from early on [@crain2012emergence; @Crain_2008]. According to this account, the main learning task of the child is mapping the right linguistic units to the available logical concept of negation. Second, it is possible that there are stages in the development of abstract negation from concrete communicative functions, but there is great variation in children's developmental pathways and there is no set of fixed stages across children [@de1979form; @nordmeyer2018individual]. Unfortunately, we do not have enough longitudinal data to assess individual level stages of negation development at this point. Third, it is also possible that negation is abstracted away from concrete communicative functions in fixed-order stages but very quickly and in the much narrower window of 18-22 months. Testing this hypothesis requires intensive data collection in this time period, both testing children's comprehension and production. This is what we plan to pursue in future research.

The emergence of negation around 20 months and reaching maximum growth around 26 months is consistent with prior experimental and observational studies. @deCarvalho2021 tested 18- and 24-month-old children in an experimental paradigm that tested the role of negation in early word learning. They presented novel labels for novel objects and actions to 18-month-old children, then tested their looking times on negative sentences that were either true or false given the presented visual stimuli. They also presented novel labels for objects to 24-month-olds using positive or negative statements (e.g. "It's a bamoule!" vs. "It's not a bamoule!"). They found that both groups were capable of using negation to understand the intended objects in such labeling constructions. Some other studies have also confirmed children's successful comprehension of negation around 27 months or slightly older [@feiman2017you; @austin2014young; @de1975some; @hummer1993origins; @reuter2018getting]. In this study, and using different methods than prior literature, namely automatic detection and classification of negative constructions in children's speech and growth curve modeling, we provided further evidence that the 18-22 months window is where we expect various uses of negation to emerge in both comprehension and production. We believe that future research in this age range can help us tease apart the theoretical possibilities discussed above and converge on a unified account for the development of negation in child language.

