<!--

emotion_like_children = ''

children <- as.vector(unique(subset(emotion, Age<=36)$Child))

for (i in 1:length(children)){
  select <- data.frame(subset(emotion, Child == children[i] & Polarity == 'negative' & Role == 'Child' & Head %in% c('like') & grepl(' nan', children[i]) == FALSE))
    if (min(as.vector(unique(select$Age))) < 26 & as.numeric(length(unique(select$Age))) >= 8){
  emotion_like_children = c(children[i], emotion_like_children)
  }
}

emotion_like_children = emotion_like_children[1: length(emotion_like_children) - 1]

emotion_want_children = ''

children <- as.vector(unique(subset(emotion, Age<=36)$Child))

for (i in 1:length(children)){
  select <- data.frame(subset(emotion, Child == children[i] & Polarity == 'negative' & Role == 'Child' & Head %in% c('want') & grepl(' nan', children[i]) == FALSE))
    if (min(as.vector(unique(select$Age))) < 26 & as.numeric(length(unique(select$Age))) >= 8){
  emotion_want_children = c(children[i], emotion_want_children)
  }
}

emotion_want_children = emotion_want_children[1: length(emotion_want_children) - 1]

individual_emotion_like_data = 0
individual_emotion_want_data = 0

for (i in emotion_like_children){

  child_individual_like_neg <- subset(child_emotion_neg, Head %in% c('like') & Child == i)
  parent_individual_like_neg <- subset(parent_emotion_neg, Head %in% c('like') & Child == i)

  child_individual_like_pos <- subset(child_emotion_pos, Head %in% c('like') & Child == i)
  parent_individual_like_pos <- subset(parent_emotion_pos, Head %in% c('like') & Child == i)
  
  child_individual_like_neg <- data.frame(table(child_individual_like_neg$Age))
  
  if (nrow(child_individual_like_neg) != 0){
  names(child_individual_like_neg) <- c('Age', 'Freq')
  child_individual_like_neg$Role <- rep('Child', nrow(child_individual_like_neg))
  child_individual_like_neg$Head <- rep('like', nrow(child_individual_like_neg))
  temp <- merge(child_individual_like_neg, subset(child_individual_descriptive, Child == i)[, -c(4)], by.x = 'Age', all.x = TRUE)
  child_individual_like_neg <- temp
  child_individual_like_neg$Total_ratio <- child_individual_like_neg$Freq /    child_individual_like_neg$N_utterance
child_individual_like_neg$Ratio <- child_individual_like_neg$Freq / sum(child_individual_like_neg$Freq)
child_individual_like_neg$Polarity <- rep('negative', nrow(child_individual_like_neg))
child_individual_like_neg$Measure <- rep('negative construction ratio', nrow(child_individual_like_neg))
child_individual_like_neg$Which <- rep('ratio', nrow(child_individual_like_neg))
child_individual_like_neg$Function <- rep('Rejection', nrow(child_individual_like_neg))
child_individual_like_neg <- negative_moving(child_individual_like_neg, subset(child_individual_descriptive, Child == i))
child_individual_like_neg$Child <- rep(i, nrow(child_individual_like_neg))
individual_emotion_like_data <- rbind(child_individual_like_neg, individual_emotion_like_data)

}
  

parent_individual_like_neg <- data.frame(table(parent_individual_like_neg$Age))

  if (nrow(parent_individual_like_neg) != 0){
names(parent_individual_like_neg) <- c('Age', 'Freq')
parent_individual_like_neg$Role <- rep('Parent', nrow(parent_individual_like_neg))
parent_individual_like_neg$Head <- rep('like', nrow(parent_individual_like_neg))
temp <- merge(parent_individual_like_neg, subset(parent_individual_descriptive, Child == i)[, -c(4)], by.x = 'Age', all.x = TRUE)
parent_individual_like_neg <- temp
parent_individual_like_neg$Total_ratio <- parent_individual_like_neg$Freq / parent_individual_like_neg$N_utterance
parent_individual_like_neg$Ratio <- parent_individual_like_neg$Freq / sum(parent_individual_like_neg$Freq)
parent_individual_like_neg$Polarity <- rep('negative', nrow(parent_individual_like_neg))
parent_individual_like_neg$Measure <- rep('negative construction ratio', nrow(parent_individual_like_neg))
parent_individual_like_neg$Which <- rep('ratio', nrow(parent_individual_like_neg))
parent_individual_like_neg$Function <- rep('Rejection', nrow(parent_individual_like_neg))
parent_individual_like_neg <- negative_moving(parent_individual_like_neg, subset(parent_individual_descriptive, Child == i))
parent_individual_like_neg$Child <- rep(i, nrow(parent_individual_like_neg))
individual_emotion_like_data <- rbind(parent_individual_like_neg, individual_emotion_like_data)

  }
  

child_individual_like_pos <- data.frame(table(child_individual_like_pos$Age))

if (nrow(child_individual_like_pos) != 0){
names(child_individual_like_pos) <- c('Age', 'Freq')
child_individual_like_pos$Role <- rep('Child', nrow(child_individual_like_pos))
child_individual_like_pos$Head <- rep('like', nrow(child_individual_like_pos))
temp <- merge(child_individual_like_pos, subset(child_individual_descriptive, Child == i)[, -c(4)], by.x = 'Age', all.x = TRUE)
child_individual_like_pos <- temp
child_individual_like_pos$Total_ratio <- child_individual_like_pos$Freq / child_individual_like_pos$N_utterance
child_individual_like_pos$Ratio <- child_individual_like_pos$Freq / sum(child_individual_like_pos$Freq)
child_individual_like_pos$Polarity <- rep('positive', nrow(child_individual_like_pos))
child_individual_like_pos$Measure <- rep('positive construction ratio', nrow(child_individual_like_pos))
child_individual_like_pos$Which <- rep('ratio', nrow(child_individual_like_pos))
child_individual_like_pos$Function <- rep('Rejection', nrow(child_individual_like_pos))
child_individual_like_pos <- positive_moving(child_individual_like_pos, subset(child_individual_descriptive, Child == i))
child_individual_like_pos$Child <- rep(i, nrow(child_individual_like_pos))
individual_emotion_like_data <- rbind(child_individual_like_pos, individual_emotion_like_data)

}

parent_individual_like_pos <- data.frame(table(parent_individual_like_pos$Age))

  if (nrow(parent_individual_like_pos) != 0){
names(parent_individual_like_pos) <- c('Age', 'Freq')
parent_individual_like_pos$Role <- rep('Parent', nrow(parent_individual_like_pos))
parent_individual_like_pos$Head <- rep('like', nrow(parent_individual_like_pos))
temp <- merge(parent_individual_like_pos, subset(parent_individual_descriptive, Child == i)[, -c(4)], by.x = 'Age', all.x = TRUE)
parent_individual_like_pos <- temp
parent_individual_like_pos$Total_ratio <- parent_individual_like_pos$Freq / parent_individual_like_pos$N_utterance
parent_individual_like_pos$Ratio <- parent_individual_like_pos$Freq / sum(parent_individual_like_pos$Freq)
parent_individual_like_pos$Polarity <- rep('positive', nrow(parent_individual_like_pos))
parent_individual_like_pos$Measure <- rep('positive construction ratio', nrow(parent_individual_like_pos))
parent_individual_like_pos$Which <- rep('ratio', nrow(parent_individual_like_pos))
parent_individual_like_pos$Function <- rep('Rejection', nrow(parent_individual_like_pos))
parent_individual_like_pos <- positive_moving(parent_individual_like_pos, subset(parent_individual_descriptive, Child == i))
parent_individual_like_pos$Child <- rep(i, nrow(parent_individual_like_pos))
individual_emotion_like_data <- rbind(parent_individual_like_pos, individual_emotion_like_data)

}}

for (i in emotion_want_children){

    child_individual_want_neg <- subset(child_emotion_neg, Head %in% c('want') & Child == i)

  parent_individual_want_neg <- subset(parent_emotion_neg, Head %in% c('want') & Child == i)
  
   child_individual_want_pos <- subset(child_emotion_pos, Head %in% c('want') & Child == i)

  parent_individual_want_pos <- subset(parent_emotion_pos, Head %in% c('want') & Child == i)

child_individual_want_neg <- data.frame(table(child_individual_want_neg$Age))

  if (nrow(child_individual_want_neg) != 0){
names(child_individual_want_neg) <- c('Age', 'Freq')
child_individual_want_neg$Role <- rep('Child', nrow(child_individual_want_neg))
child_individual_want_neg$Head <- rep('want', nrow(child_individual_want_neg))
temp <- merge(child_individual_want_neg, subset(child_individual_descriptive, Child == i)[, -c(4)], by.x = 'Age', all.x = TRUE)
child_individual_want_neg <- temp
child_individual_want_neg$Total_ratio <- child_individual_want_neg$Freq / child_individual_want_neg$N_utterance
child_individual_want_neg$Ratio <- child_individual_want_neg$Freq / sum(child_individual_want_neg$Freq)
child_individual_want_neg$Polarity <- rep('negative', nrow(child_individual_want_neg))
child_individual_want_neg$Measure <- rep('negative construction ratio', nrow(child_individual_want_neg))
child_individual_want_neg$Which <- rep('ratio', nrow(child_individual_want_neg))
child_individual_want_neg$Function <- rep('Rejection', nrow(child_individual_want_neg))
child_individual_want_neg <- negative_moving(child_individual_want_neg, subset(child_individual_descriptive, Child == i))
child_individual_want_neg$Child <- rep(i, nrow(child_individual_want_neg))
individual_emotion_want_data <- rbind(child_individual_want_neg, individual_emotion_want_data)

}
  

parent_individual_want_neg <- data.frame(table(parent_individual_want_neg$Age))

if (nrow(parent_individual_want_neg) != 0){
names(parent_individual_want_neg) <- c('Age', 'Freq')
parent_individual_want_neg$Role <- rep('Parent', nrow(parent_individual_want_neg))
parent_individual_want_neg$Head <- rep('want', nrow(parent_individual_want_neg))
temp <- merge(parent_individual_want_neg, subset(parent_individual_descriptive, Child == i)[, -c(4)], by.x = 'Age', all.x = TRUE)
parent_individual_want_neg <- temp
parent_individual_want_neg$Total_ratio <- parent_individual_want_neg$Freq / parent_individual_want_neg$N_utterance
parent_individual_want_neg$Ratio <- parent_individual_want_neg$Freq / sum(parent_individual_want_neg$Freq)
parent_individual_want_neg$Polarity <- rep('negative', nrow(parent_individual_want_neg))
parent_individual_want_neg$Measure <- rep('negative construction ratio', nrow(parent_individual_want_neg))
parent_individual_want_neg$Which <- rep('ratio', nrow(parent_individual_want_neg))
parent_individual_want_neg$Function <- rep('Rejection', nrow(parent_individual_want_neg))
parent_individual_want_neg <- negative_moving(parent_individual_want_neg, subset(parent_individual_descriptive, Child == i))
parent_individual_want_neg$Child <- rep(i, nrow(parent_individual_want_neg))
individual_emotion_want_data <- rbind(parent_individual_want_neg, individual_emotion_want_data)

}
  

child_individual_want_pos <- data.frame(table(child_individual_want_pos$Age))

if (nrow(child_individual_want_pos) != 0){
names(child_individual_want_pos) <- c('Age', 'Freq')
child_individual_want_pos$Role <- rep('Child', nrow(child_individual_want_pos))
child_individual_want_pos$Head <- rep('want', nrow(child_individual_want_pos))
temp <- merge(child_individual_want_pos, subset(child_individual_descriptive, Child == i)[, -c(4)], by.x = 'Age', all.x = TRUE)
child_individual_want_pos <- temp
child_individual_want_pos$Total_ratio <- child_individual_want_pos$Freq / child_individual_want_pos$N_utterance
child_individual_want_pos$Ratio <- child_individual_want_pos$Freq / sum(child_individual_want_pos$Freq)
child_individual_want_pos$Polarity <- rep('positive', nrow(child_individual_want_pos))
child_individual_want_pos$Measure <- rep('positive construction ratio', nrow(child_individual_want_pos))
child_individual_want_pos$Which <- rep('ratio', nrow(child_individual_want_pos))
child_individual_want_pos$Function <- rep('Rejection', nrow(child_individual_want_pos))
child_individual_want_pos <- positive_moving(child_individual_want_pos, subset(child_individual_descriptive, Child == i))
child_individual_want_pos$Child <- rep(i, nrow(child_individual_want_pos))
individual_emotion_want_data <- rbind(child_individual_want_pos, individual_emotion_want_data)

}

parent_individual_want_pos <- data.frame(table(parent_individual_want_pos$Age))

  if (nrow(parent_individual_want_pos) != 0){
names(parent_individual_want_pos) <- c('Age', 'Freq')
parent_individual_want_pos$Role <- rep('Parent', nrow(parent_individual_want_pos))
parent_individual_want_pos$Head <- rep('want', nrow(parent_individual_want_pos))
temp <- merge(parent_individual_want_pos, subset(parent_individual_descriptive, Child == i)[, -c(4)], by.x = 'Age', all.x = TRUE)
parent_individual_want_pos <- temp
parent_individual_want_pos$Total_ratio <- parent_individual_want_pos$Freq / parent_individual_want_pos$N_utterance
parent_individual_want_pos$Ratio <- parent_individual_want_pos$Freq / sum(parent_individual_want_pos$Freq)
parent_individual_want_pos$Polarity <- rep('positive', nrow(parent_individual_want_pos))
parent_individual_want_pos$Measure <- rep('positive construction ratio', nrow(parent_individual_want_pos))
parent_individual_want_pos$Which <- rep('ratio', nrow(parent_individual_want_pos))
parent_individual_want_pos$Function <- rep('Rejection', nrow(parent_individual_want_pos))
parent_individual_want_pos <- positive_moving(parent_individual_want_pos, subset(parent_individual_descriptive, Child == i))
parent_individual_want_pos$Child <- rep(i, nrow(parent_individual_want_pos))
individual_emotion_want_data <- rbind(parent_individual_want_pos, individual_emotion_want_data)

}}

individual_emotion_like_data$Measure <- factor(individual_emotion_like_data$Measure, levels = c('negative construction ratio', 'negative construction moving ratio', 'positive construction ratio', 'positive construction moving ratio'))


individual_emotion_like_data <- subset(individual_emotion_like_data, Measure %in% c('negative construction moving ratio', 'positive construction moving ratio') & Child != '0')

individual_emotion_like_data_child <- subset(individual_emotion_like_data, Role == 'Child')
individual_emotion_like_data_parent <- subset(individual_emotion_like_data, Role == 'Parent')

individual_emotion_want_data$Measure <- factor(individual_emotion_want_data$Measure, levels = c('negative construction ratio', 'negative construction moving ratio', 'positive construction ratio', 'positive construction moving ratio'))


individual_emotion_want_data <- subset(individual_emotion_want_data, Measure %in% c('negative construction moving ratio', 'positive construction moving ratio') & Child != '0')

individual_emotion_want_data_child <- subset(individual_emotion_want_data, Role == 'Child')
individual_emotion_want_data_parent <- subset(individual_emotion_want_data, Role == 'Parent')


```{r individualemotionlike, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=9, set.cap.width=T, num.cols.cap=1, fig.cap='Individual Variation for  Rejection and its positive counterparts, when the head verb is like',warning=FALSE}

individual_emotion_like_data %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(log(Total_ratio), 2), group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("solid", 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(16, 16)) +
  scale_color_manual(values = c("steelblue", "mediumpurple4")) + 
  facet_grid( ~ Child ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)") + 
  ylim(-9.5, -2.5) +
  guides(linetype = guide_legend(nrow = 1))

```

```{r individualemotionwant, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=9, set.cap.width=T, num.cols.cap=1, fig.cap='Individual Variation for  Rejection and its positive counterparts, when the head verb is want',warning=FALSE}

individual_emotion_want_data %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(log(Total_ratio), 2), group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c("solid", 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(16, 16)) +
  scale_color_manual(values = c("steelblue", "mediumpurple4")) + 
  facet_grid( ~ Child ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)") + 
  ylim(-9.5, -2.5) +
  guides(linetype = guide_legend(nrow = 1))

```


epistemic_know_children = ''

children <- as.vector(unique(subset(epistemic, Age<=36)$Child))

for (i in 1:length(children)){
  select <- data.frame(subset(epistemic, Child == children[i] & Polarity == 'negative' & Role == 'Child' & Head %in% c('know') & grepl(' nan', children[i]) == FALSE))
    if (min(as.vector(unique(select$Age))) < 26 & as.numeric(length(unique(select$Age))) >= 8){
  epistemic_know_children = c(children[i], epistemic_know_children)
  }
}

epistemic_know_children = epistemic_know_children[1: length(epistemic_know_children) - 1]

individual_epistemic_know_data <- 0

epistemic_remember_children = ''

children <- as.vector(unique(subset(epistemic, Age<=36)$Child))

for (i in 1:length(children)){
  select <- data.frame(subset(epistemic, Child == children[i] & Polarity == 'negative' & Role == 'Child' & Head %in% c('remember') & grepl(' nan', children[i]) == FALSE))
    if (min(as.vector(unique(select$Age))) < 26){#} & as.numeric(length(unique(select$Age))) >= 2){
  epistemic_remember_children = c(children[i], epistemic_remember_children)
  }
}

epistemic_remember_children = epistemic_remember_children[1: length(epistemic_remember_children) - 1]

individual_epistemic_remember_data <- 0

epistemic_think_children = ''

children <- as.vector(unique(subset(epistemic, Age<=36)$Child))

for (i in 1:length(children)){
  select <- data.frame(subset(epistemic, Child == children[i] & Polarity == 'negative' & Role == 'Child' & Head %in% c('think') & grepl(' nan', children[i]) == FALSE))
    if (min(as.vector(unique(select$Age))) < 26){#} & as.numeric(length(unique(select$Age))) >= 8){
  epistemic_think_children = c(children[i], epistemic_think_children)
  }
}

epistemic_think_children = epistemic_think_children[1: length(epistemic_think_children) - 1]

individual_epistemic_think_data <- 0

  
for (i in epistemic_know_children){
  
  child_individual_epistemic_neg <- subset(epistemic_neg, Role %in% c('Child') & Child == i)
parent_individual_epistemic_neg <- subset(epistemic_neg, Role %in% c('Parent') & Child == i)

child_individual_epistemic_pos <- subset(epistemic_pos, Role %in% c('Child') & Child == i)
parent_individual_epistemic_pos <- subset(epistemic_pos, Role %in% c('Parent') & Child == i)

child_individual_know_neg <- subset(child_individual_epistemic_neg, Head %in% c('know'))

parent_individual_know_neg <- subset(parent_individual_epistemic_neg, Head %in% c('know'))

child_individual_know_neg <- data.frame(table(child_individual_know_neg$Age))

if (nrow(child_individual_know_neg) != 0){
  
names(child_individual_know_neg) <- c('Age', 'Freq')
child_individual_know_neg$Role <- rep('Child', nrow(child_individual_know_neg))
child_individual_know_neg$Head <- rep('know', nrow(child_individual_know_neg))
temp <- merge(child_individual_know_neg, subset(child_individual_descriptive, Child == i)[,-c(4)], by.x = 'Age', all.x = TRUE)
child_individual_know_neg <- temp
child_individual_know_neg$Total_ratio <- child_individual_know_neg$Freq / child_individual_know_neg$N_utterance
child_individual_know_neg$Ratio <- child_individual_know_neg$Freq / sum(child_individual_know_neg$Freq)
child_individual_know_neg$Polarity <- rep('negative', nrow(child_individual_know_neg))
child_individual_know_neg$Measure <- rep('negative construction ratio', nrow(child_individual_know_neg))
child_individual_know_neg$Which <- rep('ratio', nrow(child_individual_know_neg))
child_individual_know_neg$Function <- rep('Epistemic', nrow(child_individual_know_neg))
child_individual_know_neg <- negative_moving(child_individual_know_neg, subset(child_individual_descriptive, Child == i))
child_individual_know_neg$Child <- rep(i, nrow(child_individual_know_neg))
individual_epistemic_know_data <- rbind(child_individual_know_neg, individual_epistemic_know_data)

}


parent_individual_know_neg <- data.frame(table(parent_individual_know_neg$Age))

if (nrow(parent_individual_know_neg)){
  
names(parent_individual_know_neg) <- c('Age', 'Freq')
parent_individual_know_neg$Role <- rep('Parent', nrow(parent_individual_know_neg))
parent_individual_know_neg$Head <- rep('know', nrow(parent_individual_know_neg))
temp <- merge(parent_individual_know_neg, subset(parent_individual_descriptive, Child == i)[,-c(4)], by.x = 'Age', all.x = TRUE)
parent_individual_know_neg <- temp
parent_individual_know_neg$Total_ratio <- parent_individual_know_neg$Freq / parent_individual_know_neg$N_utterance
parent_individual_know_neg$Ratio <- parent_individual_know_neg$Freq / sum(parent_individual_know_neg$Freq)
parent_individual_know_neg$Polarity <- rep('negative', nrow(parent_individual_know_neg))
parent_individual_know_neg$Measure <- rep('negative construction ratio', nrow(parent_individual_know_neg))
parent_individual_know_neg$Which <- rep('ratio', nrow(parent_individual_know_neg))
parent_individual_know_neg$Function <- rep('Epistemic', nrow(parent_individual_know_neg))
parent_individual_know_neg <- negative_moving(parent_individual_know_neg, subset(parent_individual_descriptive, Child == i))
parent_individual_know_neg$Child <- rep(i, nrow(parent_individual_know_neg))
individual_epistemic_know_data <- rbind(parent_individual_know_neg, individual_epistemic_know_data)

}

child_individual_know_pos <- subset(child_individual_epistemic_pos, Head %in% c('know'))

parent_individual_know_pos <- subset(parent_individual_epistemic_pos, Head %in% c('know'))


child_individual_know_pos <- data.frame(table(child_individual_know_pos$Age))

if (nrow(child_individual_know_pos) != 0){
  
names(child_individual_know_pos) <- c('Age', 'Freq')
child_individual_know_pos$Role <- rep('Child', nrow(child_individual_know_pos))
child_individual_know_pos$Head <- rep('know', nrow(child_individual_know_pos))
temp <- merge(child_individual_know_pos, subset(child_individual_descriptive, Child == i)[,-c(4)], by.x = 'Age', all.x = TRUE)
child_individual_know_pos <- temp
child_individual_know_pos$Total_ratio <- child_individual_know_pos$Freq / child_individual_know_pos$N_utterance
child_individual_know_pos$Ratio <- child_individual_know_pos$Freq / sum(child_individual_know_pos$Freq)
child_individual_know_pos$Polarity <- rep('positive', nrow(child_individual_know_pos))
child_individual_know_pos$Measure <- rep('positive construction ratio', nrow(child_individual_know_pos))
child_individual_know_pos$Which <- rep('ratio', nrow(child_individual_know_pos))
child_individual_know_pos$Function <- rep('Epistemic', nrow(child_individual_know_pos))
child_individual_know_pos <- positive_moving(child_individual_know_pos, subset(child_individual_descriptive, Child == i))
child_individual_know_pos$Child <- rep(i, nrow(child_individual_know_pos))
individual_epistemic_know_data <- rbind(child_individual_know_pos, individual_epistemic_know_data)

}


parent_individual_know_pos <- data.frame(table(parent_individual_know_pos$Age))

if (nrow(parent_individual_know_pos)){
  
names(parent_individual_know_pos) <- c('Age', 'Freq')
parent_individual_know_pos$Role <- rep('Parent', nrow(parent_individual_know_pos))
parent_individual_know_pos$Head <- rep('know', nrow(parent_individual_know_pos))
temp <- merge(parent_individual_know_pos, subset(parent_individual_descriptive, Child == i)[,-c(4)], by.x = 'Age', all.x = TRUE)
parent_individual_know_pos <- temp
parent_individual_know_pos$Total_ratio <- parent_individual_know_pos$Freq / parent_individual_know_pos$N_utterance
parent_individual_know_pos$Ratio <- parent_individual_know_pos$Freq / sum(parent_individual_know_pos$Freq)
parent_individual_know_pos$Polarity <- rep('positive', nrow(parent_individual_know_pos))
parent_individual_know_pos$Measure <- rep('positive construction ratio', nrow(parent_individual_know_pos))
parent_individual_know_pos$Which <- rep('ratio', nrow(parent_individual_know_pos))
parent_individual_know_pos$Function <- rep('Epistemic', nrow(parent_individual_know_pos))
parent_individual_know_pos <- positive_moving(parent_individual_know_pos, subset(parent_individual_descriptive, Child == i))
parent_individual_know_pos$Child <- rep(i, nrow(parent_individual_know_pos))
individual_epistemic_know_data <- rbind(parent_individual_know_pos, individual_epistemic_know_data)

}}


for (i in epistemic_remember_children){
  
  child_individual_epistemic_neg <- subset(epistemic_neg, Role %in% c('Child') & Child == i)
parent_individual_epistemic_neg <- subset(epistemic_neg, Role %in% c('Parent') & Child == i)

child_individual_epistemic_pos <- subset(epistemic_pos, Role %in% c('Child') & Child == i)
parent_individual_epistemic_pos <- subset(epistemic_pos, Role %in% c('Parent') & Child == i)

child_individual_remember_neg <- subset(child_individual_epistemic_neg, Head %in% c('remember'))

parent_individual_remember_neg <- subset(parent_individual_epistemic_neg, Head %in% c('remember'))


child_individual_remember_neg <- data.frame(table(child_individual_remember_neg$Age))

if (nrow(child_individual_remember_neg) != 0){
  
names(child_individual_remember_neg) <- c('Age', 'Freq')
child_individual_remember_neg$Role <- rep('Child', nrow(child_individual_remember_neg))
child_individual_remember_neg$Head <- rep('remember', nrow(child_individual_remember_neg))
temp <- merge(child_individual_remember_neg, subset(child_individual_descriptive, Child == i)[,-c(4)], by.x = 'Age', all.x = TRUE)
child_individual_remember_neg <- temp
child_individual_remember_neg$Total_ratio <- child_individual_remember_neg$Freq / child_individual_remember_neg$N_utterance
child_individual_remember_neg$Ratio <- child_individual_remember_neg$Freq / sum(child_individual_remember_neg$Freq)
child_individual_remember_neg$Polarity <- rep('negative', nrow(child_individual_remember_neg))
child_individual_remember_neg$Measure <- rep('negative construction ratio', nrow(child_individual_remember_neg))
child_individual_remember_neg$Which <- rep('ratio', nrow(child_individual_remember_neg))
child_individual_remember_neg$Function <- rep('Epistemic', nrow(child_individual_remember_neg))
child_individual_remember_neg <- negative_moving(child_individual_remember_neg, subset(child_individual_descriptive, Child == i))
child_individual_remember_neg$Child <- rep(i, nrow(child_individual_remember_neg))
individual_epistemic_remember_data <- rbind(child_individual_remember_neg, individual_epistemic_remember_data)

}


parent_individual_remember_neg <- data.frame(table(parent_individual_remember_neg$Age))

if (nrow(parent_individual_remember_neg) != 0){
  
names(parent_individual_remember_neg) <- c('Age', 'Freq')
parent_individual_remember_neg$Role <- rep('Parent', nrow(parent_individual_remember_neg))
parent_individual_remember_neg$Head <- rep('remember', nrow(parent_individual_remember_neg))
temp <- merge(parent_individual_remember_neg, subset(parent_individual_descriptive, Child == i)[,-c(4)], by.x = 'Age', all.x = TRUE)
parent_individual_remember_neg <- temp
parent_individual_remember_neg$Total_ratio <- parent_individual_remember_neg$Freq / parent_individual_remember_neg$N_utterance
parent_individual_remember_neg$Ratio <- parent_individual_remember_neg$Freq / sum(parent_individual_remember_neg$Freq)
parent_individual_remember_neg$Polarity <- rep('negative', nrow(parent_individual_remember_neg))
parent_individual_remember_neg$Measure <- rep('negative construction ratio', nrow(parent_individual_remember_neg))
parent_individual_remember_neg$Which <- rep('ratio', nrow(parent_individual_remember_neg))
parent_individual_remember_neg$Function <- rep('Epistemic', nrow(parent_individual_remember_neg))
parent_individual_remember_neg <- negative_moving(parent_individual_remember_neg, subset(parent_individual_descriptive, Child == i))
parent_individual_remember_neg$Child <- rep(i, nrow(parent_individual_remember_neg))
individual_epistemic_remember_data <- rbind(parent_individual_remember_neg, individual_epistemic_remember_data)

}


child_individual_remember_pos <- subset(child_individual_epistemic_pos, Head %in% c('remember'))

parent_individual_remember_pos <- subset(parent_individual_epistemic_pos, Head %in% c('remember'))

child_individual_remember_pos <- data.frame(table(child_individual_remember_pos$Age))

if (nrow(child_individual_remember_pos) != 0){
  
names(child_individual_remember_pos) <- c('Age', 'Freq')
child_individual_remember_pos$Role <- rep('Child', nrow(child_individual_remember_pos))
child_individual_remember_pos$Head <- rep('remember', nrow(child_individual_remember_pos))
temp <- merge(child_individual_remember_pos, subset(child_individual_descriptive, Child == i)[,-c(4)], by.x = 'Age', all.x = TRUE)
child_individual_remember_pos <- temp
child_individual_remember_pos$Total_ratio <- child_individual_remember_pos$Freq / child_individual_remember_pos$N_utterance
child_individual_remember_pos$Ratio <- child_individual_remember_pos$Freq / sum(child_individual_remember_pos$Freq)
child_individual_remember_pos$Polarity <- rep('positive', nrow(child_individual_remember_pos))
child_individual_remember_pos$Measure <- rep('positive construction ratio', nrow(child_individual_remember_pos))
child_individual_remember_pos$Which <- rep('ratio', nrow(child_individual_remember_pos))
child_individual_remember_pos$Function <- rep('Epistemic', nrow(child_individual_remember_pos))
child_individual_remember_pos <- positive_moving(child_individual_remember_pos, subset(child_individual_descriptive, Child == i))
child_individual_remember_pos$Child <- rep(i, nrow(child_individual_remember_pos))
individual_epistemic_remember_data <- rbind(child_individual_remember_pos, individual_epistemic_remember_data)

}


parent_individual_remember_pos <- data.frame(table(parent_individual_remember_pos$Age))

if (nrow(parent_individual_remember_pos) != 0){
  
names(parent_individual_remember_pos) <- c('Age', 'Freq')
parent_individual_remember_pos$Role <- rep('Parent', nrow(parent_individual_remember_pos))
parent_individual_remember_pos$Head <- rep('remember', nrow(parent_individual_remember_pos))
temp <- merge(parent_individual_remember_pos, subset(parent_individual_descriptive, Child == i)[,-c(4)], by.x = 'Age', all.x = TRUE)
parent_individual_remember_pos <- temp
parent_individual_remember_pos$Total_ratio <- parent_individual_remember_pos$Freq / parent_individual_remember_pos$N_utterance
parent_individual_remember_pos$Ratio <- parent_individual_remember_pos$Freq / sum(parent_individual_remember_pos$Freq)
parent_individual_remember_pos$Polarity <- rep('positive', nrow(parent_individual_remember_pos))
parent_individual_remember_pos$Measure <- rep('positive construction ratio', nrow(parent_individual_remember_pos))
parent_individual_remember_pos$Which <- rep('ratio', nrow(parent_individual_remember_pos))
parent_individual_remember_pos$Function <- rep('Epistemic', nrow(parent_individual_remember_pos))
parent_individual_remember_pos <- positive_moving(parent_individual_remember_pos, subset(parent_individual_descriptive, Child == i))
parent_individual_remember_pos$Child <- rep(i, nrow(parent_individual_remember_pos))
individual_epistemic_remember_data <- rbind(parent_individual_remember_pos, individual_epistemic_remember_data)


}}

for (i in epistemic_think_children){
  
child_individual_epistemic_neg <- subset(epistemic_neg, Role %in% c('Child') & Child == i)
parent_individual_epistemic_neg <- subset(epistemic_neg, Role %in% c('Parent') & Child == i)

child_individual_epistemic_pos <- subset(epistemic_pos, Role %in% c('Child') & Child == i)
parent_individual_epistemic_pos <- subset(epistemic_pos, Role %in% c('Parent') & Child == i)

child_individual_think_neg <- subset(child_individual_epistemic_neg, Head %in% c('think'))

parent_individual_think_neg <- subset(parent_individual_epistemic_neg, Head %in% c('think'))


child_individual_think_neg <- data.frame(table(child_individual_think_neg$Age))

if (nrow(child_individual_think_neg) != 0){
  
names(child_individual_think_neg) <- c('Age', 'Freq')
child_individual_think_neg$Role <- rep('Child', nrow(child_individual_think_neg))
child_individual_think_neg$Head <- rep('think', nrow(child_individual_think_neg))
temp <- merge(child_individual_think_neg, subset(child_individual_descriptive, Child == i)[,-c(4)], by.x = 'Age', all.x = TRUE)
child_individual_think_neg <- temp
child_individual_think_neg$Total_ratio <- child_individual_think_neg$Freq / child_individual_think_neg$N_utterance
child_individual_think_neg$Ratio <- child_individual_think_neg$Freq / sum(child_individual_think_neg$Freq)
child_individual_think_neg$Polarity <- rep('negative', nrow(child_individual_think_neg))
child_individual_think_neg$Measure <- rep('negative construction ratio', nrow(child_individual_think_neg))
child_individual_think_neg$Which <- rep('ratio', nrow(child_individual_think_neg))
child_individual_think_neg$Function <- rep('Epistemic', nrow(child_individual_think_neg))
child_individual_think_neg <- negative_moving(child_individual_think_neg, subset(child_individual_descriptive, Child == i))
child_individual_think_neg$Child <- rep(i, nrow(child_individual_think_neg))
individual_epistemic_think_data <- rbind(child_individual_think_neg, individual_epistemic_think_data)

}


parent_individual_think_neg <- data.frame(table(parent_individual_think_neg$Age))

if (nrow(parent_individual_think_neg) != 0){
  
names(parent_individual_think_neg) <- c('Age', 'Freq')
parent_individual_think_neg$Role <- rep('Parent', nrow(parent_individual_think_neg))
parent_individual_think_neg$Head <- rep('think', nrow(parent_individual_think_neg))
temp <- merge(parent_individual_think_neg, subset(parent_individual_descriptive, Child == i)[,-c(4)], by.x = 'Age', all.x = TRUE)
parent_individual_think_neg <- temp
parent_individual_think_neg$Total_ratio <- parent_individual_think_neg$Freq / parent_individual_think_neg$N_utterance
parent_individual_think_neg$Ratio <- parent_individual_think_neg$Freq / sum(parent_individual_think_neg$Freq)
parent_individual_think_neg$Polarity <- rep('negative', nrow(parent_individual_think_neg))
parent_individual_think_neg$Measure <- rep('negative construction ratio', nrow(parent_individual_think_neg))
parent_individual_think_neg$Which <- rep('ratio', nrow(parent_individual_think_neg))
parent_individual_think_neg$Function <- rep('Epistemic', nrow(parent_individual_think_neg))
parent_individual_think_neg <- negative_moving(parent_individual_think_neg, subset(parent_individual_descriptive, Child == i))
parent_individual_think_neg$Child <- rep(i, nrow(parent_individual_think_neg))
individual_epistemic_think_data <- rbind(parent_individual_think_neg, individual_epistemic_think_data)

}


child_individual_think_pos <- subset(child_individual_epistemic_pos, Head %in% c('think'))

parent_individual_think_pos <- subset(parent_individual_epistemic_pos, Head %in% c('think'))


child_individual_think_pos <- data.frame(table(child_individual_think_pos$Age))

if (nrow(child_individual_think_pos)){
  
names(child_individual_think_pos) <- c('Age', 'Freq')
child_individual_think_pos$Role <- rep('Child', nrow(child_individual_think_pos))
child_individual_think_pos$Head <- rep('think', nrow(child_individual_think_pos))
temp <- merge(child_individual_think_pos, subset(child_individual_descriptive, Child == i)[,-c(4)], by.x = 'Age', all.x = TRUE)
child_individual_think_pos <- temp
child_individual_think_pos$Total_ratio <- child_individual_think_pos$Freq / child_individual_think_pos$N_utterance
child_individual_think_pos$Ratio <- child_individual_think_pos$Freq / sum(child_individual_think_pos$Freq)
child_individual_think_pos$Polarity <- rep('positive', nrow(child_individual_think_pos))
child_individual_think_pos$Measure <- rep('positive construction ratio', nrow(child_individual_think_pos))
child_individual_think_pos$Which <- rep('ratio', nrow(child_individual_think_pos))
child_individual_think_pos$Function <- rep('Epistemic', nrow(child_individual_think_pos))
child_individual_think_pos <- positive_moving(child_individual_think_pos, subset(child_individual_descriptive, Child == i))
child_individual_think_pos$Child <- rep(i, nrow(child_individual_think_pos))
individual_epistemic_think_data <- rbind(child_individual_think_pos, individual_epistemic_think_data)

}

parent_individual_think_pos <- data.frame(table(parent_individual_think_pos$Age))

if (nrow(parent_individual_think_pos) != 0){
  
names(parent_individual_think_pos) <- c('Age', 'Freq')
parent_individual_think_pos$Role <- rep('Parent', nrow(parent_individual_think_pos))
parent_individual_think_pos$Head <- rep('think', nrow(parent_individual_think_pos))
temp <- merge(parent_individual_think_pos, subset(parent_individual_descriptive, Child == i)[,-c(4)], by.x = 'Age', all.x = TRUE)
parent_individual_think_pos <- temp
parent_individual_think_pos$Total_ratio <- parent_individual_think_pos$Freq / parent_individual_think_pos$N_utterance
parent_individual_think_pos$Ratio <- parent_individual_think_pos$Freq / sum(parent_individual_think_pos$Freq)
parent_individual_think_pos$Polarity <- rep('positive', nrow(parent_individual_think_pos))
parent_individual_think_pos$Measure <- rep('positive construction ratio', nrow(parent_individual_think_pos))
parent_individual_think_pos$Which <- rep('ratio', nrow(parent_individual_think_pos))
parent_individual_think_pos$Function <- rep('Epistemic', nrow(parent_individual_think_pos))
parent_individual_think_pos <- positive_moving(parent_individual_think_pos, subset(parent_individual_descriptive, Child == i))
parent_individual_think_pos$Child <- rep(i, nrow(parent_individual_think_pos))
individual_epistemic_think_data <- rbind(parent_individual_think_pos, individual_epistemic_think_data)

}}


individual_epistemic_know_data$Measure <- factor(individual_epistemic_know_data$Measure, levels = c('negative construction ratio', 'negative construction moving ratio', 'positive construction ratio', 'positive construction moving ratio'))

individual_epistemic_know_data <- subset(individual_epistemic_know_data, Measure %in% c('negative construction moving ratio', 'positive construction moving ratio') & Child != '0')

individual_epistemic_know_data_child <- subset(individual_epistemic_know_data, Role == 'Child')
individual_epistemic_know_data_parent <- subset(individual_epistemic_know_data, Role == 'Parent')

individual_epistemic_remember_data$Measure <- factor(individual_epistemic_remember_data$Measure, levels = c('negative construction ratio', 'negative construction moving ratio', 'positive construction ratio', 'positive construction moving ratio'))

individual_epistemic_remember_data <- subset(individual_epistemic_remember_data, Measure %in% c('negative construction moving ratio', 'positive construction moving ratio') & Child != '0')

individual_epistemic_remember_data_child <- subset(individual_epistemic_remember_data, Role == 'Child')
individual_epistemic_remember_data_parent <- subset(individual_epistemic_remember_data, Role == 'Parent')


individual_epistemic_think_data$Measure <- factor(individual_epistemic_think_data$Measure, levels = c('negative construction ratio', 'negative construction moving ratio', 'positive construction ratio', 'positive construction moving ratio'))

individual_epistemic_think_data <- subset(individual_epistemic_think_data, Measure %in% c('negative construction moving ratio', 'positive construction moving ratio') & Child != '0')

individual_epistemic_think_data_child <- subset(individual_epistemic_think_data, Role == 'Child')
individual_epistemic_think_data_parent <- subset(individual_epistemic_think_data, Role == 'Parent')


```{r individualepistemicknow, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=9, set.cap.width=T, num.cols.cap=1, fig.cap='Individual variation for Epistemic negation and its positive counterparts, when the head verb is know', warning=FALSE}


individual_epistemic_know_data %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(log(Total_ratio), 2), group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c('solid', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(16, 16)) +
  scale_color_manual(values = c("steelblue", "mediumpurple4")) +
  facet_grid(  ~ Child ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)") + 
  guides(linetype = guide_legend(nrow = 2))

```

```{r individualepistemicremember, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=9, set.cap.width=T, num.cols.cap=1, fig.cap='Individual variation for Epistemic negation and its positive counterparts, when the head verb is remember', warning=FALSE}


individual_epistemic_remember_data%>% 
  ggplot(aes(as.numeric(as.character(Age)), round(log(Total_ratio), 2), group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c('solid', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(16, 16)) +
  scale_color_manual(values = c("steelblue", "mediumpurple4")) +
  facet_grid(  ~ Child ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)") + 
  guides(linetype = guide_legend(nrow = 2))

```

```{r individualepistemicthink, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=9, set.cap.width=T, num.cols.cap=1, fig.cap='Individual variation for Epistemic negation and its positive counterparts, when the head verb is think', warning=FALSE}


individual_epistemic_think_data %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(log(Total_ratio), 2), group = Measure, color = Measure)) +
  geom_line(aes(linetype=Measure), alpha = 1) +
  scale_linetype_manual(values=c('solid', 'solid')) +
  geom_point(aes(color = Measure, shape = Measure), size = 1) +
  scale_shape_manual(values = c(16, 16)) +
  scale_color_manual(values = c("steelblue", "mediumpurple4")) +
  facet_grid(  ~ Child ~ Role) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=12, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("log(ratio)") + 
  guides(linetype = guide_legend(nrow = 2))

```

-->